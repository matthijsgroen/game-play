/*! For license information please see game.667212a4751ba4d16c9e.js.LICENSE */
!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=177)}([function(t,e,i){"use strict";i.r(e);i(178);const n=window.Crafty;delete window.Crafty,n.fn.forEach=function(t){this.each((function(e){t(this,e)}))},e.default=n},function(t,e,i){var n;t.exports=(n=n||function(t,e){var i=Object.create||function(){function t(){}return function(e){var i;return t.prototype=e,i=new t,t.prototype=null,i}}(),n={},r=n.lib={},o=r.Base={extend:function(t){var e=i(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},s=r.WordArray=o.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||h).stringify(this)},concat:function(t){var e=this.words,i=t.words,n=this.sigBytes,r=t.sigBytes;if(this.clamp(),n%4)for(var o=0;o<r;o++){var s=i[o>>>2]>>>24-o%4*8&255;e[n+o>>>2]|=s<<24-(n+o)%4*8}else for(o=0;o<r;o+=4)e[n+o>>>2]=i[o>>>2];return this.sigBytes+=r,this},clamp:function(){var e=this.words,i=this.sigBytes;e[i>>>2]&=4294967295<<32-i%4*8,e.length=t.ceil(i/4)},clone:function(){var t=o.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var i,n=[],r=function(e){e=e;var i=987654321,n=4294967295;return function(){var r=((i=36969*(65535&i)+(i>>16)&n)<<16)+(e=18e3*(65535&e)+(e>>16)&n)&n;return r/=4294967296,(r+=.5)*(t.random()>.5?1:-1)}},o=0;o<e;o+=4){var a=r(4294967296*(i||t.random()));i=987654071*a(),n.push(4294967296*a()|0)}return new s.init(n,e)}}),a=n.enc={},h=a.Hex={stringify:function(t){for(var e=t.words,i=t.sigBytes,n=[],r=0;r<i;r++){var o=e[r>>>2]>>>24-r%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(t){for(var e=t.length,i=[],n=0;n<e;n+=2)i[n>>>3]|=parseInt(t.substr(n,2),16)<<24-n%8*4;return new s.init(i,e/2)}},c=a.Latin1={stringify:function(t){for(var e=t.words,i=t.sigBytes,n=[],r=0;r<i;r++){var o=e[r>>>2]>>>24-r%4*8&255;n.push(String.fromCharCode(o))}return n.join("")},parse:function(t){for(var e=t.length,i=[],n=0;n<e;n++)i[n>>>2]|=(255&t.charCodeAt(n))<<24-n%4*8;return new s.init(i,e)}},u=a.Utf8={stringify:function(t){try{return decodeURIComponent(escape(c.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return c.parse(unescape(encodeURIComponent(t)))}},l=r.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=u.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var i=this._data,n=i.words,r=i.sigBytes,o=this.blockSize,a=r/(4*o),h=(a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0))*o,c=t.min(4*h,r);if(h){for(var u=0;u<h;u+=o)this._doProcessBlock(n,u);var l=n.splice(0,h);i.sigBytes-=c}return new s.init(l,c)},clone:function(){var t=o.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),d=(r.Hasher=l.extend({cfg:o.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,i){return new t.init(i).finalize(e)}},_createHmacHelper:function(t){return function(e,i){return new d.HMAC.init(t,i).finalize(e)}}}),n.algo={});return n}(Math),n)},function(t,e,i){var n=i(48),r=i(30),o=i(79),s=i(50),a=Object.prototype,h=a.hasOwnProperty,c=n((function(t,e){t=Object(t);var i=-1,n=e.length,c=n>2?e[2]:void 0;for(c&&o(e[0],e[1],c)&&(n=1);++i<n;)for(var u=e[i],l=s(u),d=-1,f=l.length;++d<f;){var p=l[d],y=t[p];(void 0===y||r(y,a[p])&&!h.call(t,p))&&(t[p]=u[p])}return t}));t.exports=c},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e,i){"use strict";i.r(e),function(t){i.d(e,"isPaused",(function(){return o})),i.d(e,"togglePause",(function(){return s}));var n=i(19);let r=!1;const o=()=>r,s=()=>{(r=!r)?(Object(n.setGameSpeed)(0),t("Delay").each((function(){return this.pauseDelays()})),t("Tween").each((function(){return this.pauseTweens()})),t("Particles").each((function(){return this.pauseParticles()})),t("SpriteAnimation").each((function(){return this.pauseAnimation()})),t("PlayerControlledShip").each((function(){this.disableControls||(this.disabledThroughPause=!0,this.disableControl())}))):(Object(n.setGameSpeed)(1),t("Delay").each((function(){return this.resumeDelays()})),t("Tween").each((function(){return this.resumeTweens()})),t("Particles").each((function(){return this.resumeParticles()})),t("SpriteAnimation").each((function(){return this.resumeAnimation()})),t("PlayerControlledShip").each((function(){this.disabledThroughPause&&(this.disabledThroughPause=null,this.enableControl())}))),t.trigger("GamePause",r)}}.call(this,i(0).default)},function(t,e,i){var n;t.exports=(n=i(1),i(16),void(n.lib.Cipher||function(t){var e=n,i=e.lib,r=i.Base,o=i.WordArray,s=i.BufferedBlockAlgorithm,a=e.enc,h=(a.Utf8,a.Base64),c=e.algo.EvpKDF,u=i.Cipher=s.extend({cfg:r.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,i){this.cfg=this.cfg.extend(i),this._xformMode=t,this._key=e,this.reset()},reset:function(){s.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function t(t){return"string"==typeof t?m:g}return function(e){return{encrypt:function(i,n,r){return t(n).encrypt(e,i,n,r)},decrypt:function(i,n,r){return t(n).decrypt(e,i,n,r)}}}}()}),l=(i.StreamCipher=u.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),e.mode={}),d=i.BlockCipherMode=r.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}}),f=l.CBC=function(){var e=d.extend();function i(e,i,n){var r=this._iv;if(r){var o=r;this._iv=t}else o=this._prevBlock;for(var s=0;s<n;s++)e[i+s]^=o[s]}return e.Encryptor=e.extend({processBlock:function(t,e){var n=this._cipher,r=n.blockSize;i.call(this,t,e,r),n.encryptBlock(t,e),this._prevBlock=t.slice(e,e+r)}}),e.Decryptor=e.extend({processBlock:function(t,e){var n=this._cipher,r=n.blockSize,o=t.slice(e,e+r);n.decryptBlock(t,e),i.call(this,t,e,r),this._prevBlock=o}}),e}(),p=(e.pad={}).Pkcs7={pad:function(t,e){for(var i=4*e,n=i-t.sigBytes%i,r=n<<24|n<<16|n<<8|n,s=[],a=0;a<n;a+=4)s.push(r);var h=o.create(s,n);t.concat(h)},unpad:function(t){var e=255&t.words[t.sigBytes-1>>>2];t.sigBytes-=e}},y=(i.BlockCipher=u.extend({cfg:u.cfg.extend({mode:f,padding:p}),reset:function(){u.reset.call(this);var t=this.cfg,e=t.iv,i=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=i.createEncryptor;else n=i.createDecryptor,this._minBufferSize=1;this._mode&&this._mode.__creator==n?this._mode.init(this,e&&e.words):(this._mode=n.call(i,this,e&&e.words),this._mode.__creator=n)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);var e=this._process(!0)}else e=this._process(!0),t.unpad(e);return e},blockSize:4}),i.CipherParams=r.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}})),v=(e.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext,i=t.salt;if(i)var n=o.create([1398893684,1701076831]).concat(i).concat(e);else n=e;return n.toString(h)},parse:function(t){var e=h.parse(t),i=e.words;if(1398893684==i[0]&&1701076831==i[1]){var n=o.create(i.slice(2,4));i.splice(0,4),e.sigBytes-=16}return y.create({ciphertext:e,salt:n})}},g=i.SerializableCipher=r.extend({cfg:r.extend({format:v}),encrypt:function(t,e,i,n){n=this.cfg.extend(n);var r=t.createEncryptor(i,n),o=r.finalize(e),s=r.cfg;return y.create({ciphertext:o,key:i,iv:s.iv,algorithm:t,mode:s.mode,padding:s.padding,blockSize:t.blockSize,formatter:n.format})},decrypt:function(t,e,i,n){return n=this.cfg.extend(n),e=this._parse(e,n.format),t.createDecryptor(i,n).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}}),_=(e.kdf={}).OpenSSL={execute:function(t,e,i,n){n||(n=o.random(8));var r=c.create({keySize:e+i}).compute(t,n),s=o.create(r.words.slice(e),4*i);return r.sigBytes=4*e,y.create({key:r,iv:s,salt:n})}},m=i.PasswordBasedCipher=g.extend({cfg:g.cfg.extend({kdf:_}),encrypt:function(t,e,i,n){var r=(n=this.cfg.extend(n)).kdf.execute(i,t.keySize,t.ivSize);n.iv=r.iv;var o=g.encrypt.call(this,t,e,r.key,n);return o.mixIn(r),o},decrypt:function(t,e,i,n){n=this.cfg.extend(n),e=this._parse(e,n.format);var r=n.kdf.execute(i,t.keySize,t.ivSize,e.salt);return n.iv=r.iv,g.decrypt.call(this,t,e,r.key,n)}})}()))},function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return r}));const n="easeInOutQuad",r="linear"},function(t,e,i){for(var n=i(179),r=i(100),o=i(63),s=i(15),a=i(22),h=i(61),c=i(28),u=c("iterator"),l=c("toStringTag"),d=h.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=r(f),y=0;y<p.length;y++){var v,g=p[y],_=f[g],m=s[g],b=m&&m.prototype;if(b&&(b[u]||a(b,u,d),b[l]||a(b,l,g),h[g]=d,_))for(v in n)b[v]||o(b,v,n[v],!0)}},function(t,e){var i=Array.isArray;t.exports=i},function(t,e,i){"use strict";i.r(e),function(t){i(7);var n=i(52),r=i.n(n),o=i(84),s=i.n(o),a=i(19),h=i(4);const c={start(){this.resetCredits(),!1===this.settings().sound&&t.audio.mute(),this.gameTime=0,Object(a.setGameSpeed)(1),t.bind("UpdateFrame",e=>{Object(h.isPaused)()||(this.gameTime+=e.dt),e.dt=e.dt*Object(a.getGameSpeed)(),e.inGameTime=this.gameTime,t.trigger("GameLoop",e)}),t.paths({audio:"./",images:"./"});const e=document.getElementById("cr-stage");t.init(1024,576,e),t.background("#000000"),t.timer.FPS(1e3/17),t.e("Player, Color").attr({name:"Player 1",z:0,playerNumber:1}).setName("Player 1").color("#FF0000"),t.e("AnalogKeyboardControls, PlayerAssignable").controls({fire:t.keys.SPACE,switchWeapon:t.keys.PERIOD,super:t.keys.ENTER,up:t.keys.UP_ARROW,down:t.keys.DOWN_ARROW,left:t.keys.LEFT_ARROW,right:t.keys.RIGHT_ARROW,pause:t.keys.P}),t.e("AnalogKeyboardControls, PlayerAssignable").controls({fire:t.keys.G,switchWeapon:t.keys.H,up:t.keys.W,down:t.keys.S,left:t.keys.A,right:t.keys.D,pause:t.keys.Q}),t.e("GamepadControls, PlayerAssignable").controls({gamepadIndex:0,fire:0,switchWeapon:2,super:4,pause:9,up:12,down:13,left:14,right:15}),t.e("GamepadControls, PlayerAssignable").controls({gamepadIndex:1,fire:0,switchWeapon:2,super:4,pause:9,up:12,down:13,left:14,right:15}),t.enterScene("Intro")},resetCredits(){this.credits=2},highscores(){const t=function(){const t=localStorage.getItem("SPDLZR");if(!t)return[];const e=t.slice(0,20),i=t.slice(20),n=r.a.AES.decrypt(i,e).toString(r.a.enc.Utf8);return n.length>1?JSON.parse(n):[]}(),e="SPL",i=[{initials:e,score:3e4},{initials:e,score:2e4},{initials:e,score:1e4},{initials:e,score:5e3},{initials:e,score:2500},{initials:e,score:1500},{initials:e,score:1e3},{initials:e,score:5e3},{initials:e,score:2e3},{initials:e,score:1500}].concat(t);return s()(i,"score").reverse()},settings(){const t=localStorage.getItem("SPDLZRS");let e={};return t&&(e=JSON.parse(t)),{sound:!0,...e}},changeSettings(t={}){const e={...this.settings(),...t},i=JSON.stringify(e);return localStorage.setItem("SPDLZRS",i)}};e.default=c}.call(this,i(0).default)},function(t,e,i){var n=i(106),r="object"==typeof self&&self&&self.Object===Object&&self,o=n||r||Function("return this")();t.exports=o},function(t,e,i){"use strict";i.r(e),i.d(e,"lookup",(function(){return o}));let n=null;const r=[];for(n=1e6;n--;)r.push(Math.random());const o=()=>++n>=r.length?r[n=0]:r[n]},function(t,e,i){"use strict";i.r(e);var n=i(55),r=i.n(n),o=i(151),s=i.n(o),a=i(152),h=i.n(a);r.a.parallel=h.a,r.a.sequence=s.a,e.default=r.a},function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,e){var i=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=i)},function(t,e,i){var n,r,o,s,a,h,c,u;t.exports=(u=i(1),i(65),i(66),r=(n=u).lib,o=r.Base,s=r.WordArray,a=n.algo,h=a.MD5,c=a.EvpKDF=o.extend({cfg:o.extend({keySize:4,hasher:h,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var i=this.cfg,n=i.hasher.create(),r=s.create(),o=r.words,a=i.keySize,h=i.iterations;o.length<a;){c&&n.update(c);var c=n.update(t).finalize(e);n.reset();for(var u=1;u<h;u++)c=n.finalize(c),n.reset();r.concat(c)}return r.sigBytes=4*a,r}}),n.EvpKDF=function(t,e,i){return c.create(i).compute(t,e)},u.EvpKDF)},function(t,e,i){var n=i(243),r=i(246);t.exports=function(t,e){var i=r(t,e);return n(i)?i:void 0}},function(t,e,i){var n=i(70),r=i(76);t.exports=function(t){return null!=t&&r(t.length)&&!n(t)}},function(t,e,i){"use strict";i.r(e),function(t){i.d(e,"getGameSpeed",(function(){return r})),i.d(e,"setGameSpeed",(function(){return o}));let n=1;const r=()=>n,o=e=>(n=e,t("SpriteAnimation").each((function(){if(!this.has("TimeManager"))return this.animationSpeed=e})),t("Delay").each((function(){if(!this.has("TimeManager"))return this.delaySpeed=e})),t("Tween").each((function(){if(!this.has("TimeManager"))return this.tweenSpeed=e})));t.bind("NewEntity",e=>{const i=t(e.id);i.has("TimeManager")||(i.has("SpriteAnimation")&&(i.animationSpeed=n),i.has("Delay")&&(i.delaySpeed=n),i.has("Tween")&&(i.tweenSpeed=n))})}.call(this,i(0).default)},function(t){t.exports=JSON.parse('{"battleship.deck":{"attributes":{"width":1390,"height":170},"hitbox":[20,60,1280,60,1280,188,20,188],"sprites":[["aircraftCarrierStart",{"x":0}],["aircraftCarrierTopFlat",{"x":192}],["aircraftCarrierTopFlat",{"x":320}],["aircraftCarrierTopFlat",{"x":448}],["aircraftCarrierTopFlat",{"x":576}],["aircraftCarrierTopFlat",{"x":704}],["aircraftCarrierTopFlat",{"x":832}],["aircraftCarrierTopFlat",{"x":960}],["aircraftCarrierTopFlat",{"x":1088}],["aircraftCarrierEnd",{"x":1216}],["aircraftCarrierBottomFlat",{"x":192,"y":64}],["aircraftCarrierBottomSpace",{"x":320,"y":64}],["aircraftCarrierBottomFlat",{"x":448,"y":64}],["aircraftCarrierBottomFlat",{"x":576,"y":64}],["aircraftCarrierBottomFlat",{"x":704,"y":64}],["aircraftCarrierBottomSpace",{"x":832,"y":64}],["aircraftCarrierBottomFlat",{"x":960,"y":64}],["aircraftCarrierBottomFlat",{"x":1088,"y":64}],["aircraftCarrierHole",{"x":110,"y":120,"z":1}],["aircraftCarrierHole",{"x":190,"y":120,"z":1}],["aircraftCarrierHole",{"x":270,"y":120,"z":1}],["aircraftCarrierHole",{"x":430,"y":120,"z":1}],["aircraftCarrierHole",{"x":510,"y":120,"z":1}],["aircraftCarrierHole",{"x":590,"y":120,"z":1}],["aircraftCarrierHole",{"x":670,"y":120,"z":1}],["aircraftCarrierHole",{"x":750,"y":120,"z":1}],["aircraftCarrierHole",{"x":830,"y":120,"z":1}]],"attachHooks":[["cabin1",{"x":294,"y":24,"z":7,"attachAlign":["bottom","left"]}],["heliPlace1",{"x":496,"y":24,"z":2,"attachAlign":["bottom","left"]}],["heliPlace2",{"x":616,"y":24,"z":1,"attachAlign":["bottom","left"]}],["cabin2",{"x":832,"y":24,"z":7,"attachAlign":["bottom","left"]}],["engineCore",{"x":976,"y":-60,"z":8,"attachAlign":["top","left"]}],["hatch1",{"x":320,"y":32,"z":2,"attachAlign":["top","left"]}],["hatch2",{"x":512,"y":32,"z":2,"attachAlign":["top","left"]}],["hatch3",{"x":704,"y":32,"z":2,"attachAlign":["top","left"]}]]},"battleship.firstCabin":{"attributes":{"width":192,"height":130},"sprites":[["aircraftCarrierCabinEnd",{"x":-16,"y":-15,"flipX":true}],["aircraftCarrierCabinRadar",{"x":48,"y":-15,"flipX":true}],["aircraftCarrierCabin",{"x":112,"y":-15}],["aircraftCarrierCabinStart",{"x":176,"y":-15,"flipX":true}],["aircraftCarrierRadar",{"x":64,"y":-23,"z":1}],["aircraftCarrierAntenna",{"x":128,"y":-65,"z":1,"flipX":true}],["aircraftCarrier5",{"x":128,"y":55,"z":1}]]},"battleship.firstCabinDestroyed":{"attributes":{"width":192,"height":66},"sprites":[["aircraftCarrierCabinEndBroken",{"x":-16,"y":-15,"flipX":true}],["aircraftCarrierCabinRadarBroken",{"x":48,"y":-15,"flipX":true}],["aircraftCarrierCabinBroken",{"x":112,"y":-15}],["aircraftCarrierCabinStartBroken",{"x":176,"y":-15,"flipX":true}]]},"battleship.secondCabin":{"attributes":{"width":256,"height":130},"hitbox":[0,55,32,40,32,0,260,0,260,128,0,128],"sprites":[["aircraftCarrierCabinEnd",{"x":-16,"y":-15,"flipX":true}],["aircraftCarrierCabinRadar",{"x":48,"y":-15,"flipX":true}],["aircraftCarrierCabin",{"x":112,"y":-15}],["aircraftCarrierCabin",{"x":176,"y":-15}],["aircraftCarrierCabinStart",{"x":240,"y":-15,"flipX":true}],["aircraftCarrierAntenna",{"x":64,"y":-63,"z":1,"flipX":true}],["aircraftCarrierAntenna",{"x":160,"y":-63,"z":1,"flipX":true}],["aircraftCarrierClosed",{"x":128,"y":49,"z":1}],["aircraftCarrier5",{"x":76,"y":40,"z":1}]]},"battleship.secondCabinOpen":{"attributes":{"width":256,"height":130},"sprites":[["aircraftCarrierCabinEnd",{"x":-16,"y":-15,"flipX":true}],["aircraftCarrierCabinRadar",{"x":48,"y":-15,"flipX":true}],["aircraftCarrierCabin",{"x":112,"y":-15}],["aircraftCarrierCabin",{"x":176,"y":-15}],["aircraftCarrierCabinStart",{"x":240,"y":-15,"flipX":true}],["aircraftCarrierAntenna",{"x":64,"y":-63,"z":1,"flipX":true}],["aircraftCarrierAntenna",{"x":160,"y":-63,"z":1,"flipX":true}],["aircraftCarrierOpened",{"x":114,"y":47,"z":1}],["aircraftCarrier5",{"x":76,"y":40,"z":1}]]},"battleship.secondCabinDestroyed":{"attributes":{"width":256,"height":66},"sprites":[["aircraftCarrierCabinEndBroken",{"x":-16,"y":-15,"flipX":true}],["aircraftCarrierCabinRadarBroken",{"x":48,"y":-15,"flipX":true}],["aircraftCarrierCabinBroken",{"x":112,"y":-15}],["aircraftCarrierCabinBroken",{"x":176,"y":-15}],["aircraftCarrierCabinStartBroken",{"x":240,"y":-15,"flipX":true}]]},"battleship.engine":{"attributes":{"width":96,"height":96},"hitbox":[16,16,80,16,80,80,16,80],"sprites":[["aircraftCarrierEngine",{"x":0,"y":0}]]},"battleship.heli":{"attributes":{"width":128,"height":64,"scale":0.8},"sprites":[["helicopterLanded",{"x":0,"y":0}]]}}')},function(t,e,i){"use strict";var n=i(162);e.a={...n}},function(t,e,i){var n=i(58),r=i(98);t.exports=i(34)?function(t,e,i){return n.f(t,e,r(1,i))}:function(t,e,i){return t[e]=i,t}},function(t,e,i){var n,r,o;t.exports=(o=i(1),r=(n=o).lib.WordArray,n.enc.Base64={stringify:function(t){var e=t.words,i=t.sigBytes,n=this._map;t.clamp();for(var r=[],o=0;o<i;o+=3)for(var s=(e[o>>>2]>>>24-o%4*8&255)<<16|(e[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|e[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;a<4&&o+.75*a<i;a++)r.push(n.charAt(s>>>6*(3-a)&63));var h=n.charAt(64);if(h)for(;r.length%4;)r.push(h);return r.join("")},parse:function(t){var e=t.length,i=this._map,n=this._reverseMap;if(!n){n=this._reverseMap=[];for(var o=0;o<i.length;o++)n[i.charCodeAt(o)]=o}var s=i.charAt(64);if(s){var a=t.indexOf(s);-1!==a&&(e=a)}return function(t,e,i){for(var n=[],o=0,s=0;s<e;s++)if(s%4){var a=i[t.charCodeAt(s-1)]<<s%4*2,h=i[t.charCodeAt(s)]>>>6-s%4*2;n[o>>>2]|=(a|h)<<24-o%4*8,o++}return r.create(n,o)}(t,e,n)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},o.enc.Base64)},function(t,e,i){var n;t.exports=(n=i(1),function(t){var e=n,i=e.lib,r=i.WordArray,o=i.Hasher,s=e.algo,a=[];!function(){for(var e=0;e<64;e++)a[e]=4294967296*t.abs(t.sin(e+1))|0}();var h=s.MD5=o.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,e){for(var i=0;i<16;i++){var n=e+i,r=t[n];t[n]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}var o=this._hash.words,s=t[e+0],h=t[e+1],f=t[e+2],p=t[e+3],y=t[e+4],v=t[e+5],g=t[e+6],_=t[e+7],m=t[e+8],b=t[e+9],x=t[e+10],w=t[e+11],C=t[e+12],S=t[e+13],D=t[e+14],k=t[e+15],P=o[0],T=o[1],E=o[2],M=o[3];P=c(P,T,E,M,s,7,a[0]),M=c(M,P,T,E,h,12,a[1]),E=c(E,M,P,T,f,17,a[2]),T=c(T,E,M,P,p,22,a[3]),P=c(P,T,E,M,y,7,a[4]),M=c(M,P,T,E,v,12,a[5]),E=c(E,M,P,T,g,17,a[6]),T=c(T,E,M,P,_,22,a[7]),P=c(P,T,E,M,m,7,a[8]),M=c(M,P,T,E,b,12,a[9]),E=c(E,M,P,T,x,17,a[10]),T=c(T,E,M,P,w,22,a[11]),P=c(P,T,E,M,C,7,a[12]),M=c(M,P,T,E,S,12,a[13]),E=c(E,M,P,T,D,17,a[14]),P=u(P,T=c(T,E,M,P,k,22,a[15]),E,M,h,5,a[16]),M=u(M,P,T,E,g,9,a[17]),E=u(E,M,P,T,w,14,a[18]),T=u(T,E,M,P,s,20,a[19]),P=u(P,T,E,M,v,5,a[20]),M=u(M,P,T,E,x,9,a[21]),E=u(E,M,P,T,k,14,a[22]),T=u(T,E,M,P,y,20,a[23]),P=u(P,T,E,M,b,5,a[24]),M=u(M,P,T,E,D,9,a[25]),E=u(E,M,P,T,p,14,a[26]),T=u(T,E,M,P,m,20,a[27]),P=u(P,T,E,M,S,5,a[28]),M=u(M,P,T,E,f,9,a[29]),E=u(E,M,P,T,_,14,a[30]),P=l(P,T=u(T,E,M,P,C,20,a[31]),E,M,v,4,a[32]),M=l(M,P,T,E,m,11,a[33]),E=l(E,M,P,T,w,16,a[34]),T=l(T,E,M,P,D,23,a[35]),P=l(P,T,E,M,h,4,a[36]),M=l(M,P,T,E,y,11,a[37]),E=l(E,M,P,T,_,16,a[38]),T=l(T,E,M,P,x,23,a[39]),P=l(P,T,E,M,S,4,a[40]),M=l(M,P,T,E,s,11,a[41]),E=l(E,M,P,T,p,16,a[42]),T=l(T,E,M,P,g,23,a[43]),P=l(P,T,E,M,b,4,a[44]),M=l(M,P,T,E,C,11,a[45]),E=l(E,M,P,T,k,16,a[46]),P=d(P,T=l(T,E,M,P,f,23,a[47]),E,M,s,6,a[48]),M=d(M,P,T,E,_,10,a[49]),E=d(E,M,P,T,D,15,a[50]),T=d(T,E,M,P,v,21,a[51]),P=d(P,T,E,M,C,6,a[52]),M=d(M,P,T,E,p,10,a[53]),E=d(E,M,P,T,x,15,a[54]),T=d(T,E,M,P,h,21,a[55]),P=d(P,T,E,M,m,6,a[56]),M=d(M,P,T,E,k,10,a[57]),E=d(E,M,P,T,g,15,a[58]),T=d(T,E,M,P,S,21,a[59]),P=d(P,T,E,M,y,6,a[60]),M=d(M,P,T,E,w,10,a[61]),E=d(E,M,P,T,f,15,a[62]),T=d(T,E,M,P,b,21,a[63]),o[0]=o[0]+P|0,o[1]=o[1]+T|0,o[2]=o[2]+E|0,o[3]=o[3]+M|0},_doFinalize:function(){var e=this._data,i=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;i[r>>>5]|=128<<24-r%32;var o=t.floor(n/4294967296),s=n;i[15+(r+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),i[14+(r+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),e.sigBytes=4*(i.length+1),this._process();for(var a=this._hash,h=a.words,c=0;c<4;c++){var u=h[c];h[c]=16711935&(u<<8|u>>>24)|4278255360&(u<<24|u>>>8)}return a},clone:function(){var t=o.clone.call(this);return t._hash=this._hash.clone(),t}});function c(t,e,i,n,r,o,s){var a=t+(e&i|~e&n)+r+s;return(a<<o|a>>>32-o)+e}function u(t,e,i,n,r,o,s){var a=t+(e&n|i&~n)+r+s;return(a<<o|a>>>32-o)+e}function l(t,e,i,n,r,o,s){var a=t+(e^i^n)+r+s;return(a<<o|a>>>32-o)+e}function d(t,e,i,n,r,o,s){var a=t+(i^(e|~n))+r+s;return(a<<o|a>>>32-o)+e}e.MD5=o._createHelper(h),e.HmacMD5=o._createHmacHelper(h)}(Math),n.MD5)},function(t,e,i){var n=i(10).Symbol;t.exports=n},function(t,e,i){var n=i(116),r=i(117),o=i(18);t.exports=function(t){return o(t)?n(t):r(t)}},function(t,e,i){"use strict";(function(t){i.d(e,"b",(function(){return s})),i.d(e,"a",(function(){return a}));var n=i(93),r=i.n(n);const o=t=>t[0],s=t=>o(r()(t)),a=e=>o(r()(t(e).get()))}).call(this,i(0).default)},function(t,e,i){var n=i(94)("wks"),r=i(57),o=i(15).Symbol,s="function"==typeof o;(t.exports=function(t){return n[t]||(n[t]=s&&o[t]||(s?o:r)("Symbol."+t))}).store=n},function(t,e,i){var n=i(25),r=i(227),o=i(228),s="[object Null]",a="[object Undefined]",h=n?n.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?a:s:h&&h in Object(t)?r(t):o(t)}},function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},function(t,e){t.exports=function(t){return function(e){return t(e)}}},function(t,e,i){var n=i(272),r=i(69),o=i(273),s=i(274),a=i(275),h=i(29),c=i(107),u=c(n),l=c(r),d=c(o),f=c(s),p=c(a),y=h;(n&&"[object DataView]"!=y(new n(new ArrayBuffer(1)))||r&&"[object Map]"!=y(new r)||o&&"[object Promise]"!=y(o.resolve())||s&&"[object Set]"!=y(new s)||a&&"[object WeakMap]"!=y(new a))&&(y=function(t){var e=h(t),i="[object Object]"==e?t.constructor:void 0,n=i?c(i):"";if(n)switch(n){case u:return"[object DataView]";case l:return"[object Map]";case d:return"[object Promise]";case f:return"[object Set]";case p:return"[object WeakMap]"}return e}),t.exports=y},function(t,e,i){var n=i(133),r=i(134);t.exports=function(t,e,i,o){var s=!i;i||(i={});for(var a=-1,h=e.length;++a<h;){var c=e[a],u=o?o(i[c],t[c],c,i,t):void 0;void 0===u&&(u=t[c]),s?r(i,c,u):n(i,c,u)}return i}},function(t,e,i){t.exports=!i(96)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(t,e){var i={}.hasOwnProperty;t.exports=function(t,e){return i.call(t,e)}},function(t,e,i){var n,r,o,s,a,h;t.exports=(h=i(1),r=(n=h).lib,o=r.Base,s=r.WordArray,(a=n.x64={}).Word=o.extend({init:function(t,e){this.high=t,this.low=e}}),a.WordArray=o.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:8*t.length},toX32:function(){for(var t=this.words,e=t.length,i=[],n=0;n<e;n++){var r=t[n];i.push(r.high),i.push(r.low)}return s.create(i,this.sigBytes)},clone:function(){for(var t=o.clone.call(this),e=t.words=this.words.slice(0),i=e.length,n=0;n<i;n++)e[n]=e[n].clone();return t}}),h)},function(t,e,i){var n=i(226),r=i(14),o=Object.prototype,s=o.hasOwnProperty,a=o.propertyIsEnumerable,h=n(function(){return arguments}())?n:function(t){return r(t)&&s.call(t,"callee")&&!a.call(t,"callee")};t.exports=h},function(t,e){t.exports=function(t,e){for(var i=-1,n=null==t?0:t.length,r=Array(n);++i<n;)r[i]=e(t[i],i,t);return r}},function(t,e,i){var n=i(233),r=i(234),o=i(235),s=i(236),a=i(237);function h(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}h.prototype.clear=n,h.prototype.delete=r,h.prototype.get=o,h.prototype.has=s,h.prototype.set=a,t.exports=h},function(t,e,i){var n=i(30);t.exports=function(t,e){for(var i=t.length;i--;)if(n(t[i][0],e))return i;return-1}},function(t,e,i){var n=i(17)(Object,"create");t.exports=n},function(t,e,i){var n=i(255);t.exports=function(t,e){var i=t.__data__;return n(e)?i["string"==typeof e?"string":"hash"]:i.map}},function(t,e,i){(function(t){var n=i(10),r=i(269),o=e&&!e.nodeType&&e,s=o&&"object"==typeof t&&t&&!t.nodeType&&t,a=s&&s.exports===o?n.Buffer:void 0,h=(a?a.isBuffer:void 0)||r;t.exports=h}).call(this,i(73)(t))},function(t,e){var i=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||i)}},function(t,e,i){var n=i(29),r=i(14),o="[object Symbol]";t.exports=function(t){return"symbol"==typeof t||r(t)&&n(t)==o}},function(t,e,i){var n=i(45),r=1/0;t.exports=function(t){if("string"==typeof t||n(t))return t;var e=t+"";return"0"==e&&1/t==-r?"-0":e}},function(t,e){t.exports=function(t){return t}},function(t,e,i){var n=i(47),r=i(299),o=i(301);t.exports=function(t,e){return o(r(t,e,n),t+"")}},function(t,e){var i,n,r=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(i===setTimeout)return setTimeout(t,0);if((i===o||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:o}catch(t){i=o}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(t){n=s}}();var h,c=[],u=!1,l=-1;function d(){u&&h&&(u=!1,h.length?c=h.concat(c):l=-1,c.length&&f())}function f(){if(!u){var t=a(d);u=!0;for(var e=c.length;e;){for(h=c,c=[];++l<e;)h&&h[l].run();l=-1,e=c.length}h=null,u=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function y(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];c.push(new p(t,e)),1!==c.length||u||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=y,r.addListener=y,r.once=y,r.off=y,r.removeListener=y,r.removeAllListeners=y,r.emit=y,r.prependListener=y,r.prependOnceListener=y,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(t,e,i){var n=i(116),r=i(311),o=i(18);t.exports=function(t){return o(t)?n(t,!0):r(t)}},function(t,e,i){"use strict";i.r(e);i(7),i(389);e.default=(t,e)=>({_pool:[],_maxSize:e,get(){if(this._pool.length>0){var e=this._pool.pop();return e.unfreeze(),e}var i=t();return i.addComponent("Poolable"),i.setupPool(this),i},recycle(t){this._pool.length>=this._maxSize?t.destroy():(t.freeze(),this._pool.push(t))},clean(){this._pool.forEach(t=>t.destroy()),this._pool=[]}})},function(t,e,i){var n;t.exports=(n=i(1),i(36),i(200),i(201),i(23),i(24),i(65),i(104),i(202),i(105),i(203),i(204),i(205),i(66),i(206),i(16),i(5),i(207),i(208),i(209),i(210),i(211),i(212),i(213),i(214),i(215),i(216),i(217),i(218),i(219),i(220),i(221),i(222),n)},function(t){t.exports=JSON.parse('{"droneShip":{"sprites":[["aircraftCarrierStart",{"x":0,"y":0,"z":-19}],["aircraftCarrierRadar",{"x":256,"y":-24,"z":-18}],["aircraftCarrierBottomFlat",{"x":192,"y":64,"z":-21}],["aircraftCarrierTopFlat",{"x":192,"y":0,"z":-21}],["aircraftCarrierBottomFlat",{"x":320,"y":64,"z":-21}],["aircraftCarrierTopFlat",{"x":320,"y":0,"z":-21}],["aircraftCarrierEnd",{"x":448,"y":0,"z":-21}]]}}')},function(t,e,i){"use strict";var n=i(20),r=i(163),o=i(164),s=i(165),a=i(53),h=i(87),c=i(166),u=i(167),l=i(168);const d={...n,...r,...u,...o,...s,...a,...h,...c,...l};e.a=d},function(t,e,i){var n;!function(r){"use strict";void 0===(n=function(t){var e=i(324),n=i(326),r=i(327),o=i(328),s=i(329),a=i(330),h=i(331),c=i(332),u=i(333),l=i(129),d=[n,r,o,a,h,s,c,e,u].reduce((function(t,e){return e(t)}),i(335)),f=i(131)(d);function p(t,e,i,n){var r=d.resolve(t);return arguments.length<2?r:r.then(e,i,n)}function y(t){return function(){for(var e=0,i=arguments.length,n=new Array(i);e<i;++e)n[e]=arguments[e];return f(t,this,n)}}function v(t){for(var e=0,i=arguments.length-1,n=new Array(i);e<i;++e)n[e]=arguments[e+1];return f(t,this,n)}function g(){var t=d._defer();function e(e){t._handler.resolve(e)}function i(e){t._handler.reject(e)}function n(e){t._handler.notify(e)}this.promise=t,this.resolve=e,this.reject=i,this.notify=n,this.resolver={resolve:e,reject:i,notify:n}}return p.promise=function(t){return new d(t)},p.resolve=d.resolve,p.reject=d.reject,p.lift=y,p.try=v,p.attempt=v,p.iterate=d.iterate,p.unfold=d.unfold,p.join=function(){return d.all(arguments)},p.all=function(t){return p(t,d.all)},p.settle=function(t){return p(t,d.settle)},p.any=y(d.any),p.some=y(d.some),p.race=y(d.race),p.map=function(t,e){return p(t,(function(t){return d.map(t,e)}))},p.filter=function(t,e){return p(t,(function(t){return d.filter(t,e)}))},p.reduce=y(d.reduce),p.reduceRight=y(d.reduceRight),p.isPromiseLike=function(t){return t&&"function"==typeof t.then},p.Promise=d,p.defer=function(){return new g},p.TimeoutError=l,p}.call(e,i,e,t))||(t.exports=n)}(i(3))},function(t,e){var i=t.exports={version:"2.6.1"};"number"==typeof __e&&(__e=i)},function(t,e){var i=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++i+n).toString(36))}},function(t,e,i){var n=i(59),r=i(181),o=i(182),s=Object.defineProperty;e.f=i(34)?Object.defineProperty:function(t,e,i){if(n(t),e=o(e,!0),n(i),r)try{return s(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(t[e]=i.value),t}},function(t,e,i){var n=i(60);t.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e){t.exports={}},function(t,e,i){var n=i(184),r=i(99);t.exports=function(t){return n(r(t))}},function(t,e,i){var n=i(15),r=i(22),o=i(35),s=i(57)("src"),a=Function.toString,h=(""+a).split("toString");i(56).inspectSource=function(t){return a.call(t)},(t.exports=function(t,e,i,a){var c="function"==typeof i;c&&(o(i,"name")||r(i,"name",e)),t[e]!==i&&(c&&(o(i,s)||r(i,s,t[e]?""+t[e]:h.join(String(e)))),t===n?t[e]=i:a?t[e]?t[e]=i:r(t,e,i):(delete t[e],r(t,e,i)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[s]||a.call(this)}))},function(t,e,i){var n=i(94)("keys"),r=i(57);t.exports=function(t){return n[t]||(n[t]=r(t))}},function(t,e,i){var n,r,o,s,a,h,c,u;t.exports=(u=i(1),r=(n=u).lib,o=r.WordArray,s=r.Hasher,a=n.algo,h=[],c=a.SHA1=s.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var i=this._hash.words,n=i[0],r=i[1],o=i[2],s=i[3],a=i[4],c=0;c<80;c++){if(c<16)h[c]=0|t[e+c];else{var u=h[c-3]^h[c-8]^h[c-14]^h[c-16];h[c]=u<<1|u>>>31}var l=(n<<5|n>>>27)+a+h[c];l+=c<20?1518500249+(r&o|~r&s):c<40?1859775393+(r^o^s):c<60?(r&o|r&s|o&s)-1894007588:(r^o^s)-899497514,a=s,s=o,o=r<<30|r>>>2,r=n,n=l}i[0]=i[0]+n|0,i[1]=i[1]+r|0,i[2]=i[2]+o|0,i[3]=i[3]+s|0,i[4]=i[4]+a|0},_doFinalize:function(){var t=this._data,e=t.words,i=8*this._nDataBytes,n=8*t.sigBytes;return e[n>>>5]|=128<<24-n%32,e[14+(n+64>>>9<<4)]=Math.floor(i/4294967296),e[15+(n+64>>>9<<4)]=i,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=s.clone.call(this);return t._hash=this._hash.clone(),t}}),n.SHA1=s._createHelper(c),n.HmacSHA1=s._createHmacHelper(c),u.SHA1)},function(t,e,i){var n,r,o,s;t.exports=(n=i(1),o=(r=n).lib.Base,s=r.enc.Utf8,void(r.algo.HMAC=o.extend({init:function(t,e){t=this._hasher=new t.init,"string"==typeof e&&(e=s.parse(e));var i=t.blockSize,n=4*i;e.sigBytes>n&&(e=t.finalize(e)),e.clamp();for(var r=this._oKey=e.clone(),o=this._iKey=e.clone(),a=r.words,h=o.words,c=0;c<i;c++)a[c]^=1549556828,h[c]^=909522486;r.sigBytes=o.sigBytes=n,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher,i=e.finalize(t);return e.reset(),e.finalize(this._oKey.clone().concat(i))}})))},function(t,e){t.exports=function(t,e){for(var i=-1,n=e.length,r=t.length;++i<n;)t[r+i]=e[i];return t}},function(t,e,i){var n=i(39),r=i(238),o=i(239),s=i(240),a=i(241),h=i(242);function c(t){var e=this.__data__=new n(t);this.size=e.size}c.prototype.clear=r,c.prototype.delete=o,c.prototype.get=s,c.prototype.has=a,c.prototype.set=h,t.exports=c},function(t,e,i){var n=i(17)(i(10),"Map");t.exports=n},function(t,e,i){var n=i(29),r=i(13),o="[object AsyncFunction]",s="[object Function]",a="[object GeneratorFunction]",h="[object Proxy]";t.exports=function(t){if(!r(t))return!1;var e=n(t);return e==s||e==a||e==o||e==h}},function(t,e,i){var n=i(247),r=i(254),o=i(256),s=i(257),a=i(258);function h(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}h.prototype.clear=n,h.prototype.delete=r,h.prototype.get=o,h.prototype.has=s,h.prototype.set=a,t.exports=h},function(t,e,i){var n=i(267),r=i(115),o=Object.prototype.propertyIsEnumerable,s=Object.getOwnPropertySymbols,a=s?function(t){return null==t?[]:(t=Object(t),n(s(t),(function(e){return o.call(t,e)})))}:r;t.exports=a},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){var i=9007199254740991,n=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){var r=typeof t;return!!(e=null==e?i:e)&&("number"==r||"symbol"!=r&&n.test(t))&&t>-1&&t%1==0&&t<e}},function(t,e,i){var n=i(270),r=i(31),o=i(77),s=o&&o.isTypedArray,a=s?r(s):n;t.exports=a},function(t,e){var i=9007199254740991;t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=i}},function(t,e,i){(function(t){var n=i(106),r=e&&!e.nodeType&&e,o=r&&"object"==typeof t&&t&&!t.nodeType&&t,s=o&&o.exports===r&&n.process,a=function(){try{var t=o&&o.require&&o.require("util").types;return t||s&&s.binding&&s.binding("util")}catch(t){}}();t.exports=a}).call(this,i(73)(t))},function(t,e,i){var n=i(8),r=i(45),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;t.exports=function(t,e){if(n(t))return!1;var i=typeof t;return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=t&&!r(t))||(s.test(t)||!o.test(t)||null!=e&&t in Object(e))}},function(t,e,i){var n=i(30),r=i(18),o=i(74),s=i(13);t.exports=function(t,e,i){if(!s(i))return!1;var a=typeof e;return!!("number"==a?r(i)&&o(e,i.length):"string"==a&&e in i)&&n(i[e],t)}},function(t,e,i){(function(n){var r;!function(o){"use strict";void 0===(r=function(t){var e,r="undefined"!=typeof setTimeout&&setTimeout,o=function(t,e){return setTimeout(t,e)},s=function(t){return clearTimeout(t)},a=function(t){return r(t,0)};if(void 0!==n&&"[object process]"===Object.prototype.toString.call(n))a=function(t){return n.nextTick(t)};else if(e="undefined"!=typeof MutationObserver&&MutationObserver||"undefined"!=typeof WebKitMutationObserver&&WebKitMutationObserver)a=function(t){var e,i=document.createTextNode("");new t((function(){var t=e;e=void 0,t()})).observe(i,{characterData:!0});var n=0;return function(t){e=t,i.data=n^=1}}(e);else if(!r){var h=i(325);o=function(t,e){return h.setTimer(e,t)},s=h.cancelTimer,a=h.runOnLoop||h.runOnContext}return{setTimer:o,clearTimer:s,asap:a}}.call(e,i,e,t))||(t.exports=r)}(i(3))}).call(this,i(49))},function(t,e,i){var n=i(358),r=4;t.exports=function(t){return n(t,r)}},function(t,e,i){var n=i(112);t.exports=function(t){var e=new t.constructor(t.byteLength);return new n(e).set(new n(t)),e}},function(t,e,i){(function(e,n){var r,o,s=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};r=i(426).default,o=new(function(){function t(){this.buildingBlocks={},this.elements={},this.assets={}}return t.prototype.defineBlock=function(t){return this.buildingBlocks[t.prototype.name]=t},t.prototype.defineElement=function(t,e){return this.elements[t]=e},t.prototype.defineAssets=function(t,e){return this.assets[t]=e},t.prototype.loadAssets=function(t){var i,n;return n=function(){var e,n,r;for(r=[],e=0,n=t.length;e<n;e++)i=t[e],r.push(this._loadAssetMap(i));return r}.call(this),e.all(n)},t.prototype._loadAssetMap=function(t){var i,r,o,a,h,c,u,l,d,f,p;for(r in null==this.entityAssets&&(this.entityAssets={}),i=null,o=null,f=this.assets)l=f[r],s.call(l.contents,t)>=0&&(i=r,o=l);if(!i)throw new Error("no asset map defined for "+t);return this.entityAssets[i]?this.entityAssets[i].promise:(a=e.defer(),this.entityAssets[i]={assets:o,promise:a.promise},p=o.spriteMap,(d=function(){var t,e;for(c in e=[],t=o.sprites)h=t[c],(u={sprites:{}}).sprites[p]=h,e.push(u);return e}())[0].audio=o.audio,n.load(d.pop(),(function(){for(var t,e;d.length>0;)t=d.pop().sprites[p],e=n.paths().images+p,n.sprite(t.tile,t.tileh,e,t.map,t.paddingX,t.paddingY,t.paddingAroundBorder);return a.resolve()})),a.promise)},t.prototype.createLevel=function(t){return null==t&&(t={namespace:"City"}),new r(this,t)},t}()),t.exports=o}).call(this,i(12).default,i(0).default)},function(t,e,i){var n=i(223),r=i(229),o=i(48),s=i(79),a=o((function(t,e){if(null==t)return[];var i=e.length;return i>1&&s(t,e[0],e[1])?e=[]:i>2&&s(e[0],e[1],e[2])&&(e=[e[0]]),r(t,n(e,1),[])}));t.exports=a},function(t,e,i){t.exports=i.p+"assets/a810753c506fa3cabaf5992a31ff926f.png"},function(t){t.exports=JSON.parse('{"tile":32,"tileh":32,"map":{"waterHorizon":[0,17,8,5],"waterMiddle":[32,0,16,6],"waterFront1":[0,29,16,3],"waterFront2":[16,29,16,3],"coastStart":[18,12,8,1],"coast":[8,17,8,1],"cityBridge":[0,24,16,5],"cityStart":[0,0,16,9],"city":[16,0,16,9],"cityLayer2":[0,9,12,8],"cityDistance":[32,6,8,7],"cityDistanceBaseBottom":[32,9,8,4],"cityDistanceBaseTop":[40,6,8,7],"bigBuildingTop":[16,13,13,6],"bigBuildingBrokenTop":[30,13,13,6],"bigBuildingLayer":[16,19,13,4],"bigBuildingBottom":[16,23,13,6],"bigBuildingBottom2":[30,23,13,6],"glass":[12,9,4,3],"cloud":[16,9,8,3],"shadow":[16,12,2,1],"bridgeDeck":[0,32,16,6],"damagedBridgeDeck":[0,48,16,6],"bridgePillar":[36,29,6,17],"bridgePillarBroken":[42,29,6,17],"bigGlare":[0,38,7,7],"sun":[12,13,3,3],"chute":[12,12,1,1],"directGlare":[8,18,6,6],"aircraftCarrierEnd":[30,43,6,5],"aircraftCarrierStart":[19,43,6,5],"aircraftCarrierBottomFlat":[22,45,4,3],"aircraftCarrierBottomSpace":[26,45,4,3],"aircraftCarrierTopFlat":[26,43,4,2],"aircraftCarrierClosed":[8,44,4,3],"aircraftCarrierOpened":[12,44,5,3],"aircraftCarrier5":[14,41,1,1],"aircraftCarrier7":[14,40,1,1],"aircraftCarrierEngine":[15,40,3,3],"aircraftCarrierEngineMeter":[14,42,1,1],"aircraftCarrierOpenHatch":[31,38,5,1],"aircraftCarrierHatchLid":[31,39,5,1],"aircraftCarrierCabinStart":[7,38,1,6],"aircraftCarrierCabinRadar":[8,38,2,6],"aircraftCarrierCabin":[10,38,2,6],"aircraftCarrierCabinEnd":[12,38,2,6],"aircraftCarrierCabinStartBroken":[18,39,1,4],"aircraftCarrierCabinRadarBroken":[19,39,2,4],"aircraftCarrierCabinBroken":[21,39,2,4],"aircraftCarrierCabinEndBroken":[23,39,2,4],"aircraftCarrierRadar":[26,38,2,2],"aircraftCarrierRadarEmit":[23,38,2,1],"aircraftCarrierAntenna":[29,38,2,3],"aircraftCarrierWires":[25,38,1,1],"aircraftCarrierHole":[26,40,1,1],"boxes":[28,39,1,1],"boxesFalling":[28,38,1,1],"debris1":[44,13,4,4]}}')},function(t){t.exports=JSON.parse('{"introShip":{"attributes":{"width":800,"height":128},"sprites":[["aircraftCarrierBottomFlat",{"x":-64,"y":10,"z":5}],["aircraftCarrierBottomSpace",{"x":64,"y":10,"z":5}],["aircraftCarrierBottomFlat",{"x":192,"y":10,"z":5}],["aircraftCarrierBottomFlat",{"x":320,"y":10,"z":5}],["aircraftCarrierBottomFlat",{"x":448,"y":10,"z":5}],["aircraftCarrierBottomFlat",{"x":576,"y":10,"z":5}],["aircraftCarrierEnd",{"x":704,"y":-54}],["aircraftCarrierTopFlat",{"x":-64,"y":-54}],["aircraftCarrierTopFlat",{"x":64,"y":-54}],["aircraftCarrierTopFlat",{"x":192,"y":-54}],["aircraftCarrierTopFlat",{"x":320,"y":-54}],["aircraftCarrierTopFlat",{"x":448,"y":-54}],["aircraftCarrierTopFlat",{"x":576,"y":-54}],["boxes",{"x":622,"y":-64,"z":5}],["aircraftCarrierCabinStart",{"x":96,"y":-178}],["aircraftCarrierCabinRadar",{"x":128,"y":-178}],["aircraftCarrierCabin",{"x":192,"y":-178}],["aircraftCarrierCabinRadar",{"x":256,"y":-178}],["aircraftCarrierCabin",{"x":320,"y":-178}],["aircraftCarrierCabinEnd",{"x":384,"y":-178}],["aircraftCarrierRadar",{"x":232,"y":-185}],["aircraftCarrierAntenna",{"x":316,"y":-227}],["aircraftCarrierAntenna",{"x":158,"y":-227}],["aircraftCarrier7",{"x":192,"y":-116,"z":1}],["aircraftCarrier7",{"x":320,"y":-116,"z":1}]],"attachHooks":[["BoxesLocation",{"x":550,"y":-16,"z":23}],["BoxesLocation",{"x":614,"y":-16,"z":23}]]}}')},function(t,e,i){t.exports=i.p+"assets/577a8b419fa67677d1541bb96e968a52.png"},function(t){t.exports=JSON.parse('{"tile":32,"tileh":32,"map":{"playerShip":[0,0,3,2],"playerShipDamaged":[0,2,3,2],"muzzleFlash":[10,0,1,1],"shipEngineFire":[4,5,3,1],"freddie":[3,1,3,2],"standardMine":[3,3,1,1],"standardDrone":[0,4,2,2],"standardDroneDamage":[2,4,2,2],"standardRocket":[4,4,2,1],"helicopter":[0,6,4,2],"heliDamaged":[8,6,4,2],"helicopterLanded":[12,8,4,2],"standardLargeDrone":[0,8,3,3],"eyeStart":[6,0,1,1],"wingLoaded":[12,2,2,1],"rapidFireBoost":[11,0,1,1],"speedBoost":[12,0,1,1],"damageBoost":[13,0,1,1],"aimBoost":[14,0,1,1],"heart":[13,1,1,1],"star":[14,1,1,1],"powerUpBox":[10,1,1,1],"sphere1":[7,3,1,1],"laserTank":[0,11,6,3],"laserTankBarrel":[6,11,4,2],"mineCannon":[13,7,3,1],"turretFoot":[12,7,1,1]}}')},function(t,e,i){t.exports=i.p+"assets/c3ce4b75f71b356ea1b50ab501f75690.png"},function(t){t.exports=JSON.parse('{"tile":32,"tileh":32,"map":{"backgroundPlanet":[10,0,8,8],"dinoHead":[0,0,3,2],"dinoBody":[3,0,5,4],"dinoArm":[1,4,2,2],"dinoNeck":[3,4,2,2],"dinoJaw":[0,2,3,2],"dinoTail":[2,6,4,2],"dinoUpperLeg":[5,4,2,2],"dinoLowerLeg":[1,6,1,2],"dinoFeet":[0,6,1,1],"dinoToes":[0,5,1,1],"dinoTongue":[0,4,1,1],"dinoBackFeet":[0,7,1,1],"dinoBackUpperLeg":[6,6,2,2],"dinoBackLowerLeg":[7,4,1,2],"dinoBackToes":[8,4,1,1],"dinoTentacles":[8,0,2,1]}}')},function(t,e,i){"use strict";(function(t){i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return a}));i(7);var n=i(21),r=i(54),o=i(27);const s=e=>{(Object(o.a)("Scenery")||t.e("Scenery")).setNextScenery(e)},a=({vx:e,vy:i})=>{(Object(o.a)("Scenery")||t.e("Scenery")).setScrollVelocity({vx:e,vy:i})};t.c("SceneryBlock",{init(){this.requires("2D, Motion"),this.bind("Move",this.sceneryBlockMoved),this.bind("Freeze",this.sceneryBlockFreeze),this.bind("Unfreeze",this.sceneryBlockUnfreeze)},remove(){this.unbind("Move",this.sceneryBlockMoved)},sceneryBlockFreeze(){this._children.forEach(t=>t.freeze())},sceneryBlockUnfreeze(){this._children.forEach(t=>t.unfreeze())},moveScenery(e,i,{vx:n,vy:r}){this.shift(e,i);const o=e-n/t.timer.FPS(),s=i-r/t.timer.FPS();this._children.forEach(t=>{1!==t.distance&&t.shift(-o*(1-t.distance),-s*(1-t.distance))})},sceneryBlockMoved(){const t={v1:this.x,v2:this.x+this.w,v3:1/0,v4:-1/0};this._children.forEach(e=>{1!==e.distance&&(e.shift(-this.dx*(1-e.distance),-this.dy*(1-e.distance)),e.distance===this.farthestDistance&&(e.x<t.v3&&(t.v3=e.x),e.x+e.w>t.v4&&(t.v4=e.x+e.w)))}),this.sceneryVectors=t}});const h=(e,i)=>(t.viewport.width-(t.viewport.width-i*e)/2)/(i*e)*i,c=1,u=2,l=3;t.c("Scenery",{init(){this.currentScenery=null,this.movingDirection={vx:0,vy:0},this.blocks=[],this.delay=null,this.bind("UpdateFrame",this.verifySceneryContent)},remove(){this.unbind("UpdateFrame",this.verifySceneryContent),this.blocks.forEach(t=>t.destroy())},setNextScenery(t){n.a[t]&&(0===this.blocks.length?this.startScenery(t,{direction:l}):this.currentScenery=t)},startScenery(e,{startXPos:i=0,startYPos:o=0,direction:s=c}={}){const a=n.a[e];let d=this.blocks.find(t=>t.__frozen&&t.sceneryName===e);if(d){d.unfreeze();const t=i-d.x,e=o-d.y;d.moveScenery(t,e,this.movingDirection)}else{let n=this.blocks.find(t=>t.__frozen);if((d=((e,i,n)=>{const o=t.e("SceneryBlock").attr({x:i,y:n,w:e.width,h:e.height}),s=t.viewport.width/2,a=t.viewport.height/2,h=o.w/2,c=o.h/2,u=i+h,l=n+c;let d=1;return e.elements.forEach(i=>{const n=void 0===i.distance?1:i.distance,f=(i.x<0?e.width*n:0)+i.x,p=(i.y<0?e.height*n:0)+i.y;let y;if(n<d&&(d=n),i.composition&&(y=t.e("2D, Composable").compose(r.a[i.composition]).attr({z:i.z})),i.components){const e=["2D"].concat(i.components);y=t.e(e.join(", ")).attr({z:i.z||0,w:i.w,h:i.h})}const v=u*n+s*(1-n)-h*n,g=l*n+a*(1-n)-c*n;y.attr({x:v+f,y:g+p,distance:n}),o.attach(y)}),o.attr({farthestDistance:d}),o})(a,i,o)).sceneryName=e,n){const t=this.blocks.indexOf(n);n.destroy(),this.blocks[t]=d}else this.blocks.push(d)}if(d.attr(this.movingDirection),s===c||s===l){const t=i+d.w,e=this.currentScenery||a.right;h(d.farthestDistance,a.width)>t&&(this.currentScenery=null,this.startScenery(e,{startXPos:t,startYPos:o,direction:c}))}if(s===u||s===l){const t=this.currentScenery||a.left,e=i-n.a[t].width;-h(d.farthestDistance,a.width)<e&&(this.currentScenery=null,this.startScenery(t,{startXPos:e,startYPos:o,direction:u}))}},setScrollVelocity({vx:t,vy:e}){this.movingDirection={vx:t,vy:e},this.blocks.forEach(i=>i.attr({vx:t,vy:e})),this.checkCountDown=5},verifySceneryContent(){const{vx:e,vy:i}=this.movingDirection;if(0===e&&0===i)return;if(this.checkCountDown--,this.checkCountDown>0)return;const r=t.timer.FPS();this.checkCountDown=Math.min(300/Math.abs(e)*r,300/Math.abs(i)*r);const o=this.blocks.reduce((t,e)=>{if(e.__frozen)return t;const i=e.sceneryVectors;return{v1:t.v1<i.v1?t.v1:i.v1,v2:t.v2>i.v2?t.v2:i.v2,v3:t.v3<i.v3?t.v3:i.v3,v4:t.v4>i.v4?t.v4:i.v4,left:t.v1<i.v1?t.left:e,right:t.v2>i.v2?t.right:e}},{v1:1/0,v2:-1/0,v3:1/0,v4:-1/0,left:null,right:null});if(e<0&&o.left.sceneryVectors.v4<0&&(o.left.attr({vx:0,vy:0}),o.left.freeze()),e>0&&o.right.sceneryVectors.v3>t.viewport.width&&(o.right.attr({vx:0,vy:0}),o.right.freeze()),e<0&&o.v4<t.viewport.width+300){const t=o.right,i=this.currentScenery||n.a[t.sceneryName].right;return this.currentScenery=null,void this.startScenery(i,{startXPos:o.v2+e/r,startYPos:0,direction:c})}if(e>0&&o.v3>-300){const t=o.left,i=this.currentScenery||n.a[t.sceneryName].left;this.currentScenery=null;const s=n.a[i],a=o.v1-s.width;this.startScenery(i,{startXPos:a+e/r,startYPos:0,direction:u})}else;}})}).call(this,i(0).default)},function(t,e,i){var n=i(439),r=i(440),o=i(8);t.exports=function(t){return(o(t)?n:r)(t)}},function(t,e,i){var n=i(56),r=i(15),o=r["__core-js_shared__"]||(r["__core-js_shared__"]={});(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:n.version,mode:i(95)?"pure":"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})},function(t,e){t.exports=!1},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,i){var n=i(60),r=i(15).document,o=n(r)&&n(r.createElement);t.exports=function(t){return o?r.createElement(t):{}}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,i){var n=i(193),r=i(102);t.exports=Object.keys||function(t){return n(t,r)}},function(t,e){var i=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:i)(t)}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,i){var n=i(58).f,r=i(35),o=i(28)("toStringTag");t.exports=function(t,e,i){t&&!r(t=i?t:t.prototype,o)&&n(t,o,{configurable:!0,value:e})}},function(t,e,i){var n;t.exports=(n=i(1),function(t){var e=n,i=e.lib,r=i.WordArray,o=i.Hasher,s=e.algo,a=[],h=[];!function(){function e(e){for(var i=t.sqrt(e),n=2;n<=i;n++)if(!(e%n))return!1;return!0}function i(t){return 4294967296*(t-(0|t))|0}for(var n=2,r=0;r<64;)e(n)&&(r<8&&(a[r]=i(t.pow(n,.5))),h[r]=i(t.pow(n,1/3)),r++),n++}();var c=[],u=s.SHA256=o.extend({_doReset:function(){this._hash=new r.init(a.slice(0))},_doProcessBlock:function(t,e){for(var i=this._hash.words,n=i[0],r=i[1],o=i[2],s=i[3],a=i[4],u=i[5],l=i[6],d=i[7],f=0;f<64;f++){if(f<16)c[f]=0|t[e+f];else{var p=c[f-15],y=(p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3,v=c[f-2],g=(v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10;c[f]=y+c[f-7]+g+c[f-16]}var _=n&r^n&o^r&o,m=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),b=d+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&u^~a&l)+h[f]+c[f];d=l,l=u,u=a,a=s+b|0,s=o,o=r,r=n,n=b+(m+_)|0}i[0]=i[0]+n|0,i[1]=i[1]+r|0,i[2]=i[2]+o|0,i[3]=i[3]+s|0,i[4]=i[4]+a|0,i[5]=i[5]+u|0,i[6]=i[6]+l|0,i[7]=i[7]+d|0},_doFinalize:function(){var e=this._data,i=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return i[r>>>5]|=128<<24-r%32,i[14+(r+64>>>9<<4)]=t.floor(n/4294967296),i[15+(r+64>>>9<<4)]=n,e.sigBytes=4*i.length,this._process(),this._hash},clone:function(){var t=o.clone.call(this);return t._hash=this._hash.clone(),t}});e.SHA256=o._createHelper(u),e.HmacSHA256=o._createHmacHelper(u)}(Math),n.SHA256)},function(t,e,i){var n;t.exports=(n=i(1),i(36),function(){var t=n,e=t.lib.Hasher,i=t.x64,r=i.Word,o=i.WordArray,s=t.algo;function a(){return r.create.apply(r,arguments)}var h=[a(1116352408,3609767458),a(1899447441,602891725),a(3049323471,3964484399),a(3921009573,2173295548),a(961987163,4081628472),a(1508970993,3053834265),a(2453635748,2937671579),a(2870763221,3664609560),a(3624381080,2734883394),a(310598401,1164996542),a(607225278,1323610764),a(1426881987,3590304994),a(1925078388,4068182383),a(2162078206,991336113),a(2614888103,633803317),a(3248222580,3479774868),a(3835390401,2666613458),a(4022224774,944711139),a(264347078,2341262773),a(604807628,2007800933),a(770255983,1495990901),a(1249150122,1856431235),a(1555081692,3175218132),a(1996064986,2198950837),a(2554220882,3999719339),a(2821834349,766784016),a(2952996808,2566594879),a(3210313671,3203337956),a(3336571891,1034457026),a(3584528711,2466948901),a(113926993,3758326383),a(338241895,168717936),a(666307205,1188179964),a(773529912,1546045734),a(1294757372,1522805485),a(1396182291,2643833823),a(1695183700,2343527390),a(1986661051,1014477480),a(2177026350,1206759142),a(2456956037,344077627),a(2730485921,1290863460),a(2820302411,3158454273),a(3259730800,3505952657),a(3345764771,106217008),a(3516065817,3606008344),a(3600352804,1432725776),a(4094571909,1467031594),a(275423344,851169720),a(430227734,3100823752),a(506948616,1363258195),a(659060556,3750685593),a(883997877,3785050280),a(958139571,3318307427),a(1322822218,3812723403),a(1537002063,2003034995),a(1747873779,3602036899),a(1955562222,1575990012),a(2024104815,1125592928),a(2227730452,2716904306),a(2361852424,442776044),a(2428436474,593698344),a(2756734187,3733110249),a(3204031479,2999351573),a(3329325298,3815920427),a(3391569614,3928383900),a(3515267271,566280711),a(3940187606,3454069534),a(4118630271,4000239992),a(116418474,1914138554),a(174292421,2731055270),a(289380356,3203993006),a(460393269,320620315),a(685471733,587496836),a(852142971,1086792851),a(1017036298,365543100),a(1126000580,2618297676),a(1288033470,3409855158),a(1501505948,4234509866),a(1607167915,987167468),a(1816402316,1246189591)],c=[];!function(){for(var t=0;t<80;t++)c[t]=a()}();var u=s.SHA512=e.extend({_doReset:function(){this._hash=new o.init([new r.init(1779033703,4089235720),new r.init(3144134277,2227873595),new r.init(1013904242,4271175723),new r.init(2773480762,1595750129),new r.init(1359893119,2917565137),new r.init(2600822924,725511199),new r.init(528734635,4215389547),new r.init(1541459225,327033209)])},_doProcessBlock:function(t,e){for(var i=this._hash.words,n=i[0],r=i[1],o=i[2],s=i[3],a=i[4],u=i[5],l=i[6],d=i[7],f=n.high,p=n.low,y=r.high,v=r.low,g=o.high,_=o.low,m=s.high,b=s.low,x=a.high,w=a.low,C=u.high,S=u.low,D=l.high,k=l.low,P=d.high,T=d.low,E=f,M=p,B=y,O=v,z=g,A=_,j=m,L=b,F=x,R=w,H=C,I=S,G=D,W=k,U=P,N=T,q=0;q<80;q++){var X=c[q];if(q<16)var V=X.high=0|t[e+2*q],Y=X.low=0|t[e+2*q+1];else{var K=c[q-15],Q=K.high,$=K.low,J=(Q>>>1|$<<31)^(Q>>>8|$<<24)^Q>>>7,Z=($>>>1|Q<<31)^($>>>8|Q<<24)^($>>>7|Q<<25),tt=c[q-2],et=tt.high,it=tt.low,nt=(et>>>19|it<<13)^(et<<3|it>>>29)^et>>>6,rt=(it>>>19|et<<13)^(it<<3|et>>>29)^(it>>>6|et<<26),ot=c[q-7],st=ot.high,at=ot.low,ht=c[q-16],ct=ht.high,ut=ht.low;V=(V=(V=J+st+((Y=Z+at)>>>0<Z>>>0?1:0))+nt+((Y+=rt)>>>0<rt>>>0?1:0))+ct+((Y+=ut)>>>0<ut>>>0?1:0),X.high=V,X.low=Y}var lt,dt=F&H^~F&G,ft=R&I^~R&W,pt=E&B^E&z^B&z,yt=M&O^M&A^O&A,vt=(E>>>28|M<<4)^(E<<30|M>>>2)^(E<<25|M>>>7),gt=(M>>>28|E<<4)^(M<<30|E>>>2)^(M<<25|E>>>7),_t=(F>>>14|R<<18)^(F>>>18|R<<14)^(F<<23|R>>>9),mt=(R>>>14|F<<18)^(R>>>18|F<<14)^(R<<23|F>>>9),bt=h[q],xt=bt.high,wt=bt.low,Ct=U+_t+((lt=N+mt)>>>0<N>>>0?1:0),St=gt+yt;U=G,N=W,G=H,W=I,H=F,I=R,F=j+(Ct=(Ct=(Ct=Ct+dt+((lt+=ft)>>>0<ft>>>0?1:0))+xt+((lt+=wt)>>>0<wt>>>0?1:0))+V+((lt+=Y)>>>0<Y>>>0?1:0))+((R=L+lt|0)>>>0<L>>>0?1:0)|0,j=z,L=A,z=B,A=O,B=E,O=M,E=Ct+(vt+pt+(St>>>0<gt>>>0?1:0))+((M=lt+St|0)>>>0<lt>>>0?1:0)|0}p=n.low=p+M,n.high=f+E+(p>>>0<M>>>0?1:0),v=r.low=v+O,r.high=y+B+(v>>>0<O>>>0?1:0),_=o.low=_+A,o.high=g+z+(_>>>0<A>>>0?1:0),b=s.low=b+L,s.high=m+j+(b>>>0<L>>>0?1:0),w=a.low=w+R,a.high=x+F+(w>>>0<R>>>0?1:0),S=u.low=S+I,u.high=C+H+(S>>>0<I>>>0?1:0),k=l.low=k+W,l.high=D+G+(k>>>0<W>>>0?1:0),T=d.low=T+N,d.high=P+U+(T>>>0<N>>>0?1:0)},_doFinalize:function(){var t=this._data,e=t.words,i=8*this._nDataBytes,n=8*t.sigBytes;return e[n>>>5]|=128<<24-n%32,e[30+(n+128>>>10<<5)]=Math.floor(i/4294967296),e[31+(n+128>>>10<<5)]=i,t.sigBytes=4*e.length,this._process(),this._hash.toX32()},clone:function(){var t=e.clone.call(this);return t._hash=this._hash.clone(),t},blockSize:32});t.SHA512=e._createHelper(u),t.HmacSHA512=e._createHmacHelper(u)}(),n.SHA512)},function(t,e,i){(function(e){var i="object"==typeof e&&e&&e.Object===Object&&e;t.exports=i}).call(this,i(225))},function(t,e){var i=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return i.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},function(t,e,i){var n=i(259),r=i(14);t.exports=function t(e,i,o,s,a){return e===i||(null==e||null==i||!r(e)&&!r(i)?e!=e&&i!=i:n(e,i,o,s,t,a))}},function(t,e,i){var n=i(110),r=i(262),o=i(111),s=1,a=2;t.exports=function(t,e,i,h,c,u){var l=i&s,d=t.length,f=e.length;if(d!=f&&!(l&&f>d))return!1;var p=u.get(t);if(p&&u.get(e))return p==e;var y=-1,v=!0,g=i&a?new n:void 0;for(u.set(t,e),u.set(e,t);++y<d;){var _=t[y],m=e[y];if(h)var b=l?h(m,_,y,e,t,u):h(_,m,y,t,e,u);if(void 0!==b){if(b)continue;v=!1;break}if(g){if(!r(e,(function(t,e){if(!o(g,e)&&(_===t||c(_,t,i,h,u)))return g.push(e)}))){v=!1;break}}else if(_!==m&&!c(_,m,i,h,u)){v=!1;break}}return u.delete(t),u.delete(e),v}},function(t,e,i){var n=i(71),r=i(260),o=i(261);function s(t){var e=-1,i=null==t?0:t.length;for(this.__data__=new n;++e<i;)this.add(t[e])}s.prototype.add=s.prototype.push=r,s.prototype.has=o,t.exports=s},function(t,e){t.exports=function(t,e){return t.has(e)}},function(t,e,i){var n=i(10).Uint8Array;t.exports=n},function(t,e,i){var n=i(114),r=i(72),o=i(26);t.exports=function(t){return n(t,o,r)}},function(t,e,i){var n=i(67),r=i(8);t.exports=function(t,e,i){var o=e(t);return r(t)?o:n(o,i(t))}},function(t,e){t.exports=function(){return[]}},function(t,e,i){var n=i(268),r=i(37),o=i(8),s=i(43),a=i(74),h=i(75),c=Object.prototype.hasOwnProperty;t.exports=function(t,e){var i=o(t),u=!i&&r(t),l=!i&&!u&&s(t),d=!i&&!u&&!l&&h(t),f=i||u||l||d,p=f?n(t.length,String):[],y=p.length;for(var v in t)!e&&!c.call(t,v)||f&&("length"==v||l&&("offset"==v||"parent"==v)||d&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||a(v,y))||p.push(v);return p}},function(t,e,i){var n=i(44),r=i(271),o=Object.prototype.hasOwnProperty;t.exports=function(t){if(!n(t))return r(t);var e=[];for(var i in Object(t))o.call(t,i)&&"constructor"!=i&&e.push(i);return e}},function(t,e){t.exports=function(t,e){return function(i){return t(e(i))}}},function(t,e,i){var n=i(13);t.exports=function(t){return t==t&&!n(t)}},function(t,e){t.exports=function(t,e){return function(i){return null!=i&&(i[t]===e&&(void 0!==e||t in Object(i)))}}},function(t,e,i){var n=i(122),r=i(46);t.exports=function(t,e){for(var i=0,o=(e=n(e,t)).length;null!=t&&i<o;)t=t[r(e[i++])];return i&&i==o?t:void 0}},function(t,e,i){var n=i(8),r=i(78),o=i(279),s=i(282);t.exports=function(t,e){return n(t)?t:r(t,e)?[t]:o(s(t))}},function(t,e,i){var n=i(17),r=function(){try{var t=n(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=r},function(t,e,i){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i=function(t,e){var i=t[1]||"",n=t[3];if(!n)return i;if(e&&"function"==typeof btoa){var r=(s=n,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),o=n.sources.map((function(t){return"/*# sourceURL="+n.sourceRoot+t+" */"}));return[i].concat(o).concat([r]).join("\n")}var s;return[i].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+i+"}":i})).join("")},e.i=function(t,i){"string"==typeof t&&(t=[[null,t,""]]);for(var n={},r=0;r<this.length;r++){var o=this[r][0];null!=o&&(n[o]=!0)}for(r=0;r<t.length;r++){var s=t[r];null!=s[0]&&n[s[0]]||(i&&!s[2]?s[2]=i:i&&(s[2]="("+s[2]+") and ("+i+")"),e.push(s))}},e}},function(t,e,i){var n,r,o={},s=(n=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===r&&(r=n.apply(this,arguments)),r}),a=function(t,e){return e?e.querySelector(t):document.querySelector(t)},h=function(t){var e={};return function(t,i){if("function"==typeof t)return t();if(void 0===e[t]){var n=a.call(this,t,i);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}}(),c=null,u=0,l=[],d=i(307);function f(t,e){for(var i=0;i<t.length;i++){var n=t[i],r=o[n.id];if(r){r.refs++;for(var s=0;s<r.parts.length;s++)r.parts[s](n.parts[s]);for(;s<n.parts.length;s++)r.parts.push(m(n.parts[s],e))}else{var a=[];for(s=0;s<n.parts.length;s++)a.push(m(n.parts[s],e));o[n.id]={id:n.id,refs:1,parts:a}}}}function p(t,e){for(var i=[],n={},r=0;r<t.length;r++){var o=t[r],s=e.base?o[0]+e.base:o[0],a={css:o[1],media:o[2],sourceMap:o[3]};n[s]?n[s].parts.push(a):i.push(n[s]={id:s,parts:[a]})}return i}function y(t,e){var i=h(t.insertInto);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=l[l.length-1];if("top"===t.insertAt)n?n.nextSibling?i.insertBefore(e,n.nextSibling):i.appendChild(e):i.insertBefore(e,i.firstChild),l.push(e);else if("bottom"===t.insertAt)i.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var r=h(t.insertAt.before,i);i.insertBefore(e,r)}}function v(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=l.indexOf(t);e>=0&&l.splice(e,1)}function g(t){var e=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var n=function(){0;return i.nc}();n&&(t.attrs.nonce=n)}return _(e,t.attrs),y(t,e),e}function _(t,e){Object.keys(e).forEach((function(i){t.setAttribute(i,e[i])}))}function m(t,e){var i,n,r,o;if(e.transform&&t.css){if(!(o="function"==typeof e.transform?e.transform(t.css):e.transform.default(t.css)))return function(){};t.css=o}if(e.singleton){var s=u++;i=c||(c=g(e)),n=w.bind(null,i,s,!1),r=w.bind(null,i,s,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",_(e,t.attrs),y(t,e),e}(e),n=S.bind(null,i,e),r=function(){v(i),i.href&&URL.revokeObjectURL(i.href)}):(i=g(e),n=C.bind(null,i),r=function(){v(i)});return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else r()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=s()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var i=p(t,e);return f(i,e),function(t){for(var n=[],r=0;r<i.length;r++){var s=i[r];(a=o[s.id]).refs--,n.push(a)}t&&f(p(t,e),e);for(r=0;r<n.length;r++){var a;if(0===(a=n[r]).refs){for(var h=0;h<a.parts.length;h++)a.parts[h]();delete o[a.id]}}}};var b,x=(b=[],function(t,e){return b[t]=e,b.filter(Boolean).join("\n")});function w(t,e,i,n){var r=i?"":n.css;if(t.styleSheet)t.styleSheet.cssText=x(e,r);else{var o=document.createTextNode(r),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(o,s[e]):t.appendChild(o)}}function C(t,e){var i=e.css,n=e.media;if(n&&t.setAttribute("media",n),t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}function S(t,e,i){var n=i.css,r=i.sourceMap,o=void 0===e.convertToAbsoluteUrls&&r;(e.convertToAbsoluteUrls||o)&&(n=d(n)),r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var s=new Blob([n],{type:"text/css"}),a=t.href;t.href=URL.createObjectURL(s),a&&URL.revokeObjectURL(a)}},function(t,e,i){var n=i(127);t.exports=function(t){var e=t.length;return e?t[n(0,e-1)]:void 0}},function(t,e){var i=Math.floor,n=Math.random;t.exports=function(t,e){return t+i(n()*(e-t+1))}},function(t,e,i){var n=i(316),r=i(26);t.exports=function(t){return null==t?[]:n(t,r(t))}},function(t,e,i){var n;!function(r){"use strict";void 0===(n=function(){function t(e){Error.call(this),this.message=e,this.name=t.name,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t)}return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}.call(e,i,e,t))||(t.exports=n)}(i(3))},function(t,e,i){var n;!function(r){"use strict";void 0===(n=function(){return{pending:t,fulfilled:i,rejected:e,inspect:function(t){var n=t.state();return 0===n?{state:"pending"}:n>0?i(t.value):e(t.value)}};function t(){return{state:"pending"}}function e(t){return{state:"rejected",reason:t}}function i(t){return{state:"fulfilled",value:t}}}.call(e,i,e,t))||(t.exports=n)}(i(3))},function(t,e,i){var n;!function(r){"use strict";void 0===(n=function(){return t.tryCatchResolve=e,t;function t(t,i){return arguments.length<2&&(i=e),function(e,r,o){var s=t._defer(),a=o.length,h=new Array(a);return n({f:e,thisArg:r,args:o,params:h,i:a-1,call:i},s._handler),s};function n(e,n){if(e.i<0)return i(e.f,e.thisArg,e.params,n);t._handler(e.args[e.i]).fold(r,e,void 0,n)}function r(t,e,i){t.params[t.i]=e,t.i-=1,n(t,i)}}function e(t,e,i,n){try{n.resolve(t.apply(e,i))}catch(t){n.reject(t)}}}.call(e,i,e,t))||(t.exports=n)}(i(3))},function(t,e,i){(function(e){var i;t.exports=function t(e,n,r){function o(a,h){if(!n[a]){if(!e[a]){if(!h&&"function"==typeof i&&i)return i(a,!0);if(s)return s(a,!0);throw new Error("Cannot find module '"+a+"'")}var c=n[a]={exports:{}};e[a][0].call(c.exports,(function(t){var i=e[a][1][t];return o(i||t)}),c,c.exports,t,e,n,r)}return n[a].exports}for(var s="function"==typeof i&&i,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(t,e,i){var n=e.exports=t("../when");n.callbacks=t("../callbacks"),n.cancelable=t("../cancelable"),n.delay=t("../delay"),n.fn=t("../function"),n.guard=t("../guard"),n.keys=t("../keys"),n.nodefn=n.node=t("../node"),n.parallel=t("../parallel"),n.pipeline=t("../pipeline"),n.poll=t("../poll"),n.sequence=t("../sequence"),n.timeout=t("../timeout")},{"../callbacks":2,"../cancelable":3,"../delay":4,"../function":5,"../guard":6,"../keys":7,"../node":26,"../parallel":27,"../pipeline":28,"../poll":29,"../sequence":30,"../timeout":31,"../when":32}],2:[function(t,e,i){!function(t){t((function(t){var e=t("./when").Promise,i=t("./lib/liftAll"),n=Array.prototype.slice,r=t("./lib/apply")(e,(function(t,e,i,n){i.push(h(n.resolve,n),h(n.reject,n)),function(t,e,i,n){try{t.apply(e,i)}catch(t){n.reject(t)}}(t,e,i,n)}));return{lift:o,liftAll:function(t,e,n){return i(o,e,n,t)},apply:function(t,e){return r(t,this,e||[])},call:function(t){return r(t,this,n.call(arguments,1))},promisify:function(t,i){return function(){var n=this;return e.all(arguments).then((function(r){var o,h,c=e._defer();return"number"==typeof i.callback&&(o=s(r,i.callback)),"number"==typeof i.errback&&(h=s(r,i.errback)),h<o?(a(r,h,c._handler.reject,c._handler),a(r,o,c._handler.resolve,c._handler)):(a(r,o,c._handler.resolve,c._handler),a(r,h,c._handler.reject,c._handler)),t.apply(n,r),c}))}}};function o(t){var e=arguments.length>1?n.call(arguments,1):[];return function(){return r(t,this,e.concat(n.call(arguments)))}}function s(t,e){return e<0?t.length+e+2:e}function a(t,e,i,n){"number"==typeof e&&t.splice(e,0,h(i,n))}function h(t,e){return function(){arguments.length>1?t.call(e,n.call(arguments)):t.apply(e,arguments)}}}))}((function(i){e.exports=i(t)}))},{"./lib/apply":11,"./lib/liftAll":23,"./when":32}],3:[function(t,e,i){!function(t){t((function(){return function(t,e){return t.cancel=function(){try{t.reject(e(t))}catch(e){t.reject(e)}return t.promise},t}}))}((function(t){e.exports=t()}))},{}],4:[function(t,e,i){!function(t){t((function(t){var e=t("./when");return function(t,i){return e(i).delay(t)}}))}((function(i){e.exports=i(t)}))},{"./when":32}],5:[function(t,e,i){!function(t){t((function(t){var e=t("./when"),i=e.try,n=t("./lib/liftAll"),r=t("./lib/apply")(e.Promise),o=Array.prototype.slice;return{lift:s,liftAll:function(t,e,i){return n(s,e,i,t)},call:i,apply:function(t,e){return r(t,this,null==e?[]:o.call(e))},compose:function(t){var n=o.call(arguments,1);return function(){var r=this,s=o.call(arguments),a=i.apply(r,[t].concat(s));return e.reduce(n,(function(t,e){return e.call(r,t)}),a)}}};function s(t){var e=arguments.length>1?o.call(arguments,1):[];return function(){return r(t,this,e.concat(o.call(arguments)))}}}))}((function(i){e.exports=i(t)}))},{"./lib/apply":11,"./lib/liftAll":23,"./when":32}],6:[function(t,e,i){!function(t){t((function(t){var e=t("./when"),i=Array.prototype.slice;return n.n=function(t){var i=0,n=[];return function(){return e.promise((function(e){i<t?e(r):n.push(e),i+=1}))};function r(){i=Math.max(i-1,0),n.length>0&&n.shift()(r)}},n;function n(t,n){return function(){var r=i.call(arguments);return e(t()).withThis(this).then((function(t){return e(n.apply(this,r)).finally(t)}))}}}))}((function(i){e.exports=i(t)}))},{"./when":32}],7:[function(t,e,i){!function(t){"use strict";t((function(t){var e=t("./when"),i=e.Promise,n=e.resolve;return{all:e.lift(r),map:function(t,e){return n(t).then((function(t){return r(Object.keys(t).reduce((function(e,r){return e[r]=n(t[r]).fold(i,r),e}),{}))}));function i(t,i){return e(i,t)}},settle:function(t){var r=Object.keys(t),o={};if(0===r.length)return n(o);var s=i._defer(),a=i._handler(s),h=r.map((function(e){return t[e]}));return e.settle(h).then((function(t){!function(t,e,i,n){for(var r=0;r<t.length;r++)i[t[r]]=e[r];n.resolve(i)}(r,t,o,a)})),s}};function r(t){for(var e,n=i._defer(),r=i._handler(n),o={},s=Object.keys(t),a=s.length,h=0;h<s.length;++h)e=s[h],i._handler(t[e]).fold(c,e,o,r);return 0===a&&r.resolve(o),n;function c(t,e,i){this[t]=e,0==--a&&i.resolve(o)}}}))}((function(i){e.exports=i(t)}))},{"./when":32}],8:[function(t,e,i){!function(t){"use strict";t((function(t){return t("./makePromise")({scheduler:new(t("./Scheduler"))(t("./env").asap)})}))}((function(i){e.exports=i(t)}))},{"./Scheduler":9,"./env":21,"./makePromise":24}],9:[function(t,e,i){!function(t){"use strict";t((function(){function t(t){this._async=t,this._running=!1,this._queue=this,this._queueLen=0,this._afterQueue={},this._afterQueueLen=0;var e=this;this.drain=function(){e._drain()}}return t.prototype.enqueue=function(t){this._queue[this._queueLen++]=t,this.run()},t.prototype.afterQueue=function(t){this._afterQueue[this._afterQueueLen++]=t,this.run()},t.prototype.run=function(){this._running||(this._running=!0,this._async(this.drain))},t.prototype._drain=function(){for(var t=0;t<this._queueLen;++t)this._queue[t].run(),this._queue[t]=void 0;for(this._queueLen=0,this._running=!1,t=0;t<this._afterQueueLen;++t)this._afterQueue[t].run(),this._afterQueue[t]=void 0;this._afterQueueLen=0},t}))}((function(t){e.exports=t()}))},{}],10:[function(t,e,i){!function(t){"use strict";t((function(){function t(e){Error.call(this),this.message=e,this.name=t.name,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t)}return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}))}((function(t){e.exports=t()}))},{}],11:[function(t,e,i){!function(t){"use strict";t((function(){return t.tryCatchResolve=e,t;function t(t,i){return arguments.length<2&&(i=e),function(e,r,o){var s=t._defer(),a=o.length,h=new Array(a);return n({f:e,thisArg:r,args:o,params:h,i:a-1,call:i},s._handler),s};function n(e,n){if(e.i<0)return i(e.f,e.thisArg,e.params,n);t._handler(e.args[e.i]).fold(r,e,void 0,n)}function r(t,e,i){t.params[t.i]=e,t.i-=1,n(t,i)}}function e(t,e,i,n){try{n.resolve(t.apply(e,i))}catch(t){n.reject(t)}}}))}((function(t){e.exports=t()}))},{}],12:[function(t,e,i){!function(t){"use strict";t((function(t){var e=t("../state"),i=t("../apply");return function(t){var n=i(t),r=t.resolve,o=t.all,s=Array.prototype.reduce,a=Array.prototype.reduceRight,h=Array.prototype.slice;return t.any=function(e){for(var i,n,r=t._defer(),o=r._handler,s=e.length>>>0,a=s,h=[],c=0;c<s;++c)if(void 0!==(n=e[c])||c in e){if((i=t._handler(n)).state()>0){o.become(i),t._visitRemaining(e,c,i);break}i.visit(o,u,l)}else--a;return 0===a&&o.reject(new RangeError("any(): array must not be empty")),r;function u(t){h=null,this.resolve(t)}function l(t){this.resolved||(h.push(t),0==--a&&this.reject(h))}},t.some=function(e,i){var n,r,o,s=t._defer(),a=s._handler,h=[],c=[],u=e.length>>>0,l=0;for(o=0;o<u;++o)(void 0!==(r=e[o])||o in e)&&++l;for(i=Math.max(i,0),n=l-i+1,l=Math.min(i,l),i>l?a.reject(new RangeError("some(): array must contain at least "+i+" item(s), but had "+l)):0===l&&a.resolve(h),o=0;o<u;++o)(void 0!==(r=e[o])||o in e)&&t._handler(r).visit(a,d,f,a.notify);return s;function d(t){this.resolved||(h.push(t),0==--l&&(c=null,this.resolve(h)))}function f(t){this.resolved||(c.push(t),0==--n&&(h=null,this.reject(c)))}},t.settle=function(t){return o(t.map(c))},t.map=function(e,i){return t._traverse(i,e)},t.filter=function(e,i){var n=h.call(e);return t._traverse(i,n).then((function(e){return function(e,i){for(var n=i.length,r=new Array(n),o=0,s=0;o<n;++o)i[o]&&(r[s++]=t._handler(e[o]).value);return r.length=s,r}(n,e)}))},t.reduce=function(t,e){return arguments.length>2?s.call(t,u(e),arguments[2]):s.call(t,u(e))},t.reduceRight=function(t,e){return arguments.length>2?a.call(t,u(e),arguments[2]):a.call(t,u(e))},t.prototype.spread=function(t){return this.then(o).then((function(e){return t.apply(this,e)}))},t;function c(i){var n;return i instanceof t&&(n=i._handler.join()),n&&0===n.state()||!n?r(i).then(e.fulfilled,e.rejected):(n._unreport(),e.inspect(n))}function u(t){return function(e,i,r){return n(t,void 0,[e,i,r])}}}}))}((function(i){e.exports=i(t)}))},{"../apply":11,"../state":25}],13:[function(t,e,i){!function(t){"use strict";t((function(){return function(i){var n=i.resolve,r=i.reject,o=i.prototype.catch;function s(t,e){return function(i){return function(t,e){return function(t){return t===Error||null!=t&&t.prototype instanceof Error}(e)?t instanceof e:e(t)}(i,e)?t.call(this,i):r(i)}}function a(t,e,i,r){var o=t.call(e);return function(t){return("object"==typeof t||"function"==typeof t)&&null!==t}(o)?function(t,e,i){return n(t).then((function(){return e(i)}))}(o,i,r):i(r)}return i.prototype.done=function(t,e){this._handler.visit(this._handler.receiver,t,e)},i.prototype.catch=i.prototype.otherwise=function(e){return arguments.length<2?o.call(this,e):"function"!=typeof e?this.ensure(t):o.call(this,s(arguments[1],e))},i.prototype.finally=i.prototype.ensure=function(t){return"function"!=typeof t?this:this.then((function(i){return a(t,this,e,i)}),(function(e){return a(t,this,r,e)}))},i.prototype.else=i.prototype.orElse=function(t){return this.then(void 0,(function(){return t}))},i.prototype.yield=function(t){return this.then((function(){return t}))},i.prototype.tap=function(t){return this.then(t).yield(this)},i};function t(){throw new TypeError("catch predicate must be a function")}function e(t){return t}}))}((function(t){e.exports=t()}))},{}],14:[function(t,e,i){!function(t){"use strict";t((function(){return function(t){return t.prototype.fold=function(e,i){var n=this._beget();return this._handler.fold((function(i,n,r){t._handler(i).fold((function(t,i,n){n.resolve(e.call(this,i,t))}),n,this,r)}),i,n._handler.receiver,n._handler),n},t}}))}((function(t){e.exports=t()}))},{}],15:[function(t,e,i){!function(t){"use strict";t((function(t){var e=t("../state").inspect;return function(t){return t.prototype.inspect=function(){return e(t._handler(this))},t}}))}((function(i){e.exports=i(t)}))},{"../state":25}],16:[function(t,e,i){!function(t){"use strict";t((function(){return function(t){var e=t.resolve;return t.iterate=function(t,e,n,r){return i((function(e){return[e,t(e)]}),e,n,r)},t.unfold=i,t;function i(t,n,r,o){return e(o).then((function(i){return e(n(i)).then((function(n){return n?i:e(t(i)).spread(s)}))}));function s(o,s){return e(r(o)).then((function(){return i(t,n,r,s)}))}}}}))}((function(t){e.exports=t()}))},{}],17:[function(t,e,i){!function(t){"use strict";t((function(){return function(t){return t.prototype.progress=function(t){return this.then(void 0,void 0,t)},t}}))}((function(t){e.exports=t()}))},{}],18:[function(t,e,i){!function(t){"use strict";t((function(t){var e=t("../env"),i=t("../TimeoutError");function n(t,i,n,r){return e.setTimer((function(){t(n,r,i)}),i)}return function(t){function r(t,e,i){n(o,t,e,i)}function o(t,e){e.resolve(t)}function s(t,e,n){var r=void 0===t?new i("timed out after "+n+"ms"):t;e.reject(r)}return t.prototype.delay=function(t){var e=this._beget();return this._handler.fold(r,t,void 0,e._handler),e},t.prototype.timeout=function(t,i){var r=this._beget(),o=r._handler,a=n(s,t,i,r._handler);return this._handler.visit(o,(function(t){e.clearTimer(a),this.resolve(t)}),(function(t){e.clearTimer(a),this.reject(t)}),o.notify),r},t}}))}((function(i){e.exports=i(t)}))},{"../TimeoutError":10,"../env":21}],19:[function(t,e,i){!function(t){"use strict";t((function(t){var e=t("../env").setTimer,i=t("../format");return function(t){var o,s=r,a=r;"undefined"!=typeof console&&(o=console,s=void 0!==o.error?function(t){o.error(t)}:function(t){o.log(t)},a=void 0!==o.info?function(t){o.info(t)}:function(t){o.log(t)}),t.onPotentiallyUnhandledRejection=function(t){f(l,t)},t.onPotentiallyUnhandledRejectionHandled=function(t){f(d,t)},t.onFatalRejection=function(t){f(n,t.value)};var h=[],c=[],u=null;function l(t){t.handled||(c.push(t),s("Potentially unhandled rejection ["+t.id+"] "+i.formatError(t.value)))}function d(t){var e=c.indexOf(t);e>=0&&(c.splice(e,1),a("Handled previous rejection ["+t.id+"] "+i.formatObject(t.value)))}function f(t,i){h.push(t,i),null===u&&(u=e(p,0))}function p(){for(u=null;h.length>0;)h.shift()(h.shift())}return t};function n(t){throw t}function r(){}}))}((function(i){e.exports=i(t)}))},{"../env":21,"../format":22}],20:[function(t,e,i){!function(t){"use strict";t((function(){return function(t){return t.prototype.with=t.prototype.withThis=function(t){var e=this._beget(),i=e._handler;return i.receiver=t,this._handler.chain(i,t),e},t}}))}((function(t){e.exports=t()}))},{}],21:[function(t,i,n){!function(t){"use strict";t((function(t){var i,n="undefined"!=typeof setTimeout&&setTimeout,r=function(t,e){return setTimeout(t,e)},o=function(t){return clearTimeout(t)},s=function(t){return n(t,0)};if(void 0!==e&&"[object process]"===Object.prototype.toString.call(e))s=function(t){return e.nextTick(t)};else if(i="undefined"!=typeof MutationObserver&&MutationObserver||"undefined"!=typeof WebKitMutationObserver&&WebKitMutationObserver)s=function(t){var e,i=document.createTextNode("");new t((function(){var t=e;e=void 0,t()})).observe(i,{characterData:!0});var n=0;return function(t){e=t,i.data=n^=1}}(i);else if(!n){var a=t("vertx");r=function(t,e){return a.setTimer(e,t)},o=a.cancelTimer,s=a.runOnLoop||a.runOnContext}return{setTimer:r,clearTimer:o,asap:s}}))}((function(e){i.exports=e(t)}))},{}],22:[function(t,e,i){!function(t){"use strict";t((function(){return{formatError:function(e){var i="object"==typeof e&&null!==e&&(e.stack||e.message)?e.stack||e.message:t(e);return e instanceof Error?i:i+" (WARNING: non-Error used)"},formatObject:t,tryStringify:e};function t(t){var i=String(t);return"[object Object]"===i&&"undefined"!=typeof JSON&&(i=e(t,i)),i}function e(t,e){try{return JSON.stringify(t)}catch(t){return e}}}))}((function(t){e.exports=t()}))},{}],23:[function(t,e,i){!function(t){"use strict";t((function(){return function(e,i,n,r){return void 0===i&&(i=t),Object.keys(r).reduce((function(t,n){var o=r[n];return"function"==typeof o?i(t,e(o),n):t}),void 0===n?function(t){return"function"==typeof t?t.bind():Object.create(t)}(r):n)};function t(t,e,i){return t[i]=e,t}}))}((function(t){e.exports=t()}))},{}],24:[function(t,i,n){!function(t){"use strict";t((function(){return function(t){var i=t.scheduler,n=null!=e&&"function"==typeof e.emit?function(t,i){return"unhandledRejection"===t?e.emit(t,i.value,i):e.emit(t,i)}:"undefined"!=typeof self&&function(){if("function"==typeof CustomEvent)try{return new CustomEvent("unhandledRejection")instanceof CustomEvent}catch(t){}return!1}()?function(t,e){return function(i,n){var r=new e(i,{detail:{reason:n.value,key:n},bubbles:!1,cancelable:!0});return!t.dispatchEvent(r)}}(self,CustomEvent):"undefined"!=typeof self&&function(){if("undefined"!=typeof document&&"function"==typeof document.createEvent)try{return document.createEvent("CustomEvent").initCustomEvent("eventType",!1,!0,{}),!0}catch(t){}return!1}()?function(t,e){return function(i,n){var r=e.createEvent("CustomEvent");return r.initCustomEvent(i,!1,!0,{reason:n.value,key:n}),!t.dispatchEvent(r)}}(self,document):H,r=Object.create||function(t){function e(){}return e.prototype=t,new e};function o(t,e){this._handler=t===y?e:function(t){var e=new _;try{t((function(t){e.resolve(t)}),i,(function(t){e.notify(t)}))}catch(t){i(t)}return e;function i(t){e.reject(t)}}(t)}function s(t){return O(t)?t:new o(y,new m(f(t)))}function a(t){return new o(y,new m(new C(t)))}function h(){return P}function c(t,e,i){for(var n,r="function"==typeof e?function(n,r,o){o.resolved||u(i,l,n,t(e,r,n),o)}:l,s=new _,a=i.length>>>0,h=new Array(a),c=0;c<i.length&&!s.resolved;++c)void 0!==(n=i[c])||c in i?u(i,r,c,n,s):--a;return 0===a&&s.become(new x(h)),new o(y,s);function l(t,e,i){h[t]=e,0==--a&&i.become(new x(h))}}function u(t,e,i,n,r){if(z(n)){var o=function(t){return O(t)?t._handler.join():p(t)}(n),s=o.state();0===s?o.fold(e,i,void 0,r):s>0?e(i,o.value,r):(r.become(o),l(t,i+1,o))}else e(i,n,r)}function l(t,e,i){for(var n=e;n<t.length;++n)d(f(t[n]),i)}function d(t,e){if(t!==e){var i=t.state();0===i?t.visit(t,void 0,t._unreport):i<0&&t._unreport()}}function f(t){return O(t)?t._handler.join():z(t)?p(t):new x(t)}function p(t){try{var e=t.then;return"function"==typeof e?new b(e,t):new x(t)}catch(t){return new C(t)}}function y(){}function v(){}o.resolve=s,o.reject=a,o.never=h,o._defer=function(){return new o(y,new _)},o._handler=f,o.prototype.then=function(t,e,i){var n=this._handler,r=n.join().state();if("function"!=typeof t&&r>0||"function"!=typeof e&&r<0)return new this.constructor(y,n);var o=this._beget(),s=o._handler;return n.chain(s,n.receiver,t,e,i),o},o.prototype.catch=function(t){return this.then(void 0,t)},o.prototype._beget=function(){return function(t,e){var i=new _(t.receiver,t.join().context);return new e(y,i)}(this._handler,this.constructor)},o.all=function(t){return c(R,null,t)},o.race=function(t){return"object"!=typeof t||null===t?a(new TypeError("non-iterable passed to race()")):0===t.length?h():1===t.length?s(t[0]):function(t){var e,i,n,r=new _;for(e=0;e<t.length;++e)if(void 0!==(i=t[e])||e in t){if(0!==(n=f(i)).state()){r.become(n),l(t,e+1,n);break}n.visit(r,r.resolve,r.reject)}return new o(y,r)}(t)},o._traverse=function(t,e){return c(L,t,e)},o._visitRemaining=l,y.prototype.when=y.prototype.become=y.prototype.notify=y.prototype.fail=y.prototype._unreport=y.prototype._report=H,y.prototype._state=0,y.prototype.state=function(){return this._state},y.prototype.join=function(){for(var t=this;void 0!==t.handler;)t=t.handler;return t},y.prototype.chain=function(t,e,i,n,r){this.when({resolver:t,receiver:e,fulfilled:i,rejected:n,progress:r})},y.prototype.visit=function(t,e,i,n){this.chain(g,t,e,i,n)},y.prototype.fold=function(t,e,i,n){this.when(new B(t,e,i,n))},F(y,v),v.prototype.become=function(t){t.fail()};var g=new v;function _(t,e){o.createContext(this,e),this.consumers=void 0,this.receiver=t,this.handler=void 0,this.resolved=!1}function m(t){this.handler=t}function b(t,e){_.call(this),i.enqueue(new M(t,e,this))}function x(t){o.createContext(this),this.value=t}F(y,_),_.prototype._state=0,_.prototype.resolve=function(t){this.become(f(t))},_.prototype.reject=function(t){this.resolved||this.become(new C(t))},_.prototype.join=function(){if(!this.resolved)return this;for(var t=this;void 0!==t.handler;)if((t=t.handler)===this)return this.handler=new C(new TypeError("Promise cycle"));return t},_.prototype.run=function(){var t=this.consumers,e=this.handler;this.handler=this.handler.join(),this.consumers=void 0;for(var i=0;i<t.length;++i)e.when(t[i])},_.prototype.become=function(t){this.resolved||(this.resolved=!0,this.handler=t,void 0!==this.consumers&&i.enqueue(this),void 0!==this.context&&t._report(this.context))},_.prototype.when=function(t){this.resolved?i.enqueue(new T(t,this.handler)):void 0===this.consumers?this.consumers=[t]:this.consumers.push(t)},_.prototype.notify=function(t){this.resolved||i.enqueue(new E(t,this))},_.prototype.fail=function(t){var e=void 0===t?this.context:t;this.resolved&&this.handler.join().fail(e)},_.prototype._report=function(t){this.resolved&&this.handler.join()._report(t)},_.prototype._unreport=function(){this.resolved&&this.handler.join()._unreport()},F(y,m),m.prototype.when=function(t){i.enqueue(new T(t,this))},m.prototype._report=function(t){this.join()._report(t)},m.prototype._unreport=function(){this.join()._unreport()},F(_,b),F(y,x),x.prototype._state=1,x.prototype.fold=function(t,e,i,n){!function(t,e,i,n,r){if("function"!=typeof t)return r.become(i);o.enterContext(i),function(t,e,i,n,r){try{t.call(n,e,i,r)}catch(t){r.become(new C(t))}}(t,e,i.value,n,r),o.exitContext()}(t,e,this,i,n)},x.prototype.when=function(t){A(t.fulfilled,this,t.receiver,t.resolver)};var w=0;function C(t){o.createContext(this),this.id=++w,this.value=t,this.handled=!1,this.reported=!1,this._report()}function S(t,e){this.rejection=t,this.context=e}function D(t){this.rejection=t}F(y,C),C.prototype._state=-1,C.prototype.fold=function(t,e,i,n){n.become(this)},C.prototype.when=function(t){"function"==typeof t.rejected&&this._unreport(),A(t.rejected,this,t.receiver,t.resolver)},C.prototype._report=function(t){i.afterQueue(new S(this,t))},C.prototype._unreport=function(){this.handled||(this.handled=!0,i.afterQueue(new D(this)))},C.prototype.fail=function(t){this.reported=!0,n("unhandledRejection",this),o.onFatalRejection(this,void 0===t?this.context:t)},S.prototype.run=function(){this.rejection.handled||this.rejection.reported||(this.rejection.reported=!0,n("unhandledRejection",this.rejection)||o.onPotentiallyUnhandledRejection(this.rejection,this.context))},D.prototype.run=function(){this.rejection.reported&&(n("rejectionHandled",this.rejection)||o.onPotentiallyUnhandledRejectionHandled(this.rejection))},o.createContext=o.enterContext=o.exitContext=o.onPotentiallyUnhandledRejection=o.onPotentiallyUnhandledRejectionHandled=o.onFatalRejection=H;var k=new y,P=new o(y,k);function T(t,e){this.continuation=t,this.handler=e}function E(t,e){this.handler=e,this.value=t}function M(t,e,i){this._then=t,this.thenable=e,this.resolver=i}function B(t,e,i,n){this.f=t,this.z=e,this.c=i,this.to=n,this.resolver=g,this.receiver=this}function O(t){return t instanceof o}function z(t){return("object"==typeof t||"function"==typeof t)&&null!==t}function A(t,e,i,n){if("function"!=typeof t)return n.become(e);o.enterContext(e),function(t,e,i,n){try{n.become(f(t.call(i,e)))}catch(t){n.become(new C(t))}}(t,e.value,i,n),o.exitContext()}function j(t,e,i,n,r){if("function"!=typeof t)return r.notify(e);o.enterContext(i),function(t,e,i,n){try{n.notify(t.call(i,e))}catch(t){n.notify(t)}}(t,e,n,r),o.exitContext()}function L(t,e,i){try{return t(e,i)}catch(t){return a(t)}}function F(t,e){e.prototype=r(t.prototype),e.prototype.constructor=e}function R(t,e){return e}function H(){}return T.prototype.run=function(){this.handler.join().when(this.continuation)},E.prototype.run=function(){var t=this.handler.consumers;if(void 0!==t)for(var e,i=0;i<t.length;++i)j((e=t[i]).progress,this.value,this.handler,e.receiver,e.resolver)},M.prototype.run=function(){var t=this.resolver;!function(t,e,i,n,r){try{t.call(e,i,n,r)}catch(t){n(t)}}(this._then,this.thenable,(function(e){t.resolve(e)}),(function(e){t.reject(e)}),(function(e){t.notify(e)}))},B.prototype.fulfilled=function(t){this.f.call(this.c,this.z,t,this.to)},B.prototype.rejected=function(t){this.to.reject(t)},B.prototype.progress=function(t){this.to.notify(t)},o}}))}((function(t){i.exports=t()}))},{}],25:[function(t,e,i){!function(t){"use strict";t((function(){return{pending:t,fulfilled:i,rejected:e,inspect:function(t){var n=t.state();return 0===n?{state:"pending"}:n>0?i(t.value):e(t.value)}};function t(){return{state:"pending"}}function e(t){return{state:"rejected",reason:t}}function i(t){return{state:"fulfilled",value:t}}}))}((function(t){e.exports=t()}))},{}],26:[function(t,e,i){!function(t){t((function(t){var e=t("./when"),i=t("./lib/liftAll"),n=t("./lib/env").setTimer,r=Array.prototype.slice,o=t("./lib/apply")(e.Promise,(function(t,e,i,n){var r=a(n);try{switch(i.length){case 2:t.call(e,i[0],i[1],r);break;case 1:t.call(e,i[0],r);break;case 0:t.call(e,r);break;default:i.push(r),t.apply(e,i)}}catch(t){n.reject(t)}}));return{lift:s,liftAll:function(t,e,n){return i(s,e,n,t)},apply:function(t,e){return o(t,this,e||[])},call:function(t){return o(t,this,r.call(arguments,1))},createCallback:a,bindCallback:h,liftCallback:function(t){return function(e){return h(e,t)}}};function s(t){var e=arguments.length>1?r.call(arguments,1):[];return function(){var i,n=e.length,r=arguments.length,s=new Array(r+n);for(i=0;i<n;++i)s[i]=e[i];for(i=0;i<r;++i)s[i+n]=arguments[i];return o(t,this,s)}}function a(t){return function(e,i){e?t.reject(e):arguments.length>2?t.resolve(r.call(arguments,1)):t.resolve(i)}}function h(t,i){return t=e(t),i&&t.then((function(t){r(null,t)}),r),t;function r(t,e){n((function(){i(t,e)}),0)}}}))}((function(i){e.exports=i(t)}))},{"./lib/apply":11,"./lib/env":21,"./lib/liftAll":23,"./when":32}],27:[function(t,e,i){!function(t){t((function(t){var e=t("./when"),i=e.Promise.all,n=Array.prototype.slice;return function(t){return i(n.call(arguments,1)).then((function(i){return e.map(t,(function(t){return t.apply(void 0,i)}))}))}}))}((function(i){e.exports=i(t)}))},{"./when":32}],28:[function(t,e,i){!function(t){t((function(t){var e=t("./when"),i=e.Promise.all,n=Array.prototype.slice;return function(t){var r=function(t,e){return r=function(t,e){return e(t)},e.apply(null,t)};return i(n.call(arguments,1)).then((function(i){return e.reduce(t,(function(t,e){return r(t,e)}),i)}))}}))}((function(i){e.exports=i(t)}))},{"./when":32}],29:[function(t,e,i){!function(t){"use strict";t((function(t){var e=t("./when"),i=e.try,n=t("./cancelable");return function(t,r,o,s){var a,h,c;function u(t){i(r).then(l,c),void 0!==t&&a.notify(t)}function l(){h||e(t(),(function(t){e(o(t),(function(e){return e?function(t){a.resolve(t)}(t):u(t)}),(function(){u(t)}))}),c)}return h=!1,a=n(e.defer(),(function(){h=!0})),c=a.reject,o=o||function(){return!1},"function"!=typeof r&&(r=function(t){return function(){return e().delay(t)}}(r)),s?u():l(),a.promise=Object.create(a.promise),a.promise.cancel=a.cancel,a.promise}}))}((function(i){e.exports=i(t)}))},{"./cancelable":3,"./when":32}],30:[function(t,e,i){!function(t){t((function(t){var e=t("./when"),i=e.Promise.all,n=Array.prototype.slice;return function(t){var r=[];return i(n.call(arguments,1)).then((function(i){return e.reduce(t,(function(t,n){return e(n.apply(void 0,i),o)}),r)}));function o(t){return r.push(t),r}}}))}((function(i){e.exports=i(t)}))},{"./when":32}],31:[function(t,e,i){!function(t){t((function(t){var e=t("./when");return function(t,i){return e(i).timeout(t)}}))}((function(i){e.exports=i(t)}))},{"./when":32}],32:[function(t,e,i){!function(t){"use strict";t((function(t){var e=t("./lib/decorators/timed"),i=t("./lib/decorators/array"),n=t("./lib/decorators/flow"),r=t("./lib/decorators/fold"),o=t("./lib/decorators/inspect"),s=t("./lib/decorators/iterate"),a=t("./lib/decorators/progress"),h=t("./lib/decorators/with"),c=t("./lib/decorators/unhandledRejection"),u=t("./lib/TimeoutError"),l=[i,n,r,s,a,o,h,e,c].reduce((function(t,e){return e(t)}),t("./lib/Promise")),d=t("./lib/apply")(l);function f(t,e,i,n){var r=l.resolve(t);return arguments.length<2?r:r.then(e,i,n)}function p(t){return function(){for(var e=0,i=arguments.length,n=new Array(i);e<i;++e)n[e]=arguments[e];return d(t,this,n)}}function y(t){for(var e=0,i=arguments.length-1,n=new Array(i);e<i;++e)n[e]=arguments[e+1];return d(t,this,n)}function v(){var t=l._defer();function e(e){t._handler.resolve(e)}function i(e){t._handler.reject(e)}function n(e){t._handler.notify(e)}this.promise=t,this.resolve=e,this.reject=i,this.notify=n,this.resolver={resolve:e,reject:i,notify:n}}return f.promise=function(t){return new l(t)},f.resolve=l.resolve,f.reject=l.reject,f.lift=p,f.try=y,f.attempt=y,f.iterate=l.iterate,f.unfold=l.unfold,f.join=function(){return l.all(arguments)},f.all=function(t){return f(t,l.all)},f.settle=function(t){return f(t,l.settle)},f.any=p(l.any),f.some=p(l.some),f.race=p(l.race),f.map=function(t,e){return f(t,(function(t){return l.map(t,e)}))},f.filter=function(t,e){return f(t,(function(t){return l.filter(t,e)}))},f.reduce=p(l.reduce),f.reduceRight=p(l.reduceRight),f.isPromiseLike=function(t){return t&&"function"==typeof t.then},f.Promise=l,f.defer=function(){return new v},f.TimeoutError=u,f}))}((function(i){e.exports=i(t)}))},{"./lib/Promise":8,"./lib/TimeoutError":10,"./lib/apply":11,"./lib/decorators/array":12,"./lib/decorators/flow":13,"./lib/decorators/fold":14,"./lib/decorators/inspect":15,"./lib/decorators/iterate":16,"./lib/decorators/progress":17,"./lib/decorators/timed":18,"./lib/decorators/unhandledRejection":19,"./lib/decorators/with":20}]},{},[1])(1)}).call(this,i(49))},function(t,e,i){var n=i(134),r=i(30),o=Object.prototype.hasOwnProperty;t.exports=function(t,e,i){var s=t[e];o.call(t,e)&&r(s,i)&&(void 0!==i||e in t)||n(t,e,i)}},function(t,e,i){var n=i(123);t.exports=function(t,e,i){"__proto__"==e&&n?n(t,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[e]=i}},function(t,e){t.exports=function(t,e){var i=-1,n=t.length;for(e||(e=Array(n));++i<n;)e[i]=t[i];return e}},function(t,e,i){var n=i(67),r=i(137),o=i(72),s=i(115),a=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)n(e,o(t)),t=r(t);return e}:s;t.exports=a},function(t,e,i){var n=i(118)(Object.getPrototypeOf,Object);t.exports=n},function(t,e,i){t.exports=i(378)},function(t,e,i){(function(t){const e=(t,e)=>{let i;const n=1/(e.length-1),r=Math.floor(t/n),o=e[r];return((t,e,i)=>[Math.round(e[0]*(1-t)+i[0]*t),Math.round(e[1]*(1-t)+i[1]*t),Math.round(e[2]*(1-t)+i[2]*t)])((t-r*n)/n,o,null!=(i=e[r+1])?i:o)},i=t=>`#${t.map(t=>`0${t.toString(16)}`.slice(-2)).join("")}`,n=t=>[parseInt(t.slice(1,3),16),parseInt(t.slice(3,5),16),parseInt(t.slice(5,7),16)];t.c("ColorFade",{colorFade(t,e,i){const{duration:r,skip:o}=t;return this.duration=r,this._bottomColors=e.map(n),this._topColors=i.map(n),this.v=Math.max(o||0,0),this.bind("GameLoop",this._recolor),this},remove(){this.trigger("ColorFadeFinished"),this.unbind("GameLoop",this._recolor)},_recolor(t){this.v+=t.dt;let n=this.v/this.duration;n<0&&(n=0),n>=1&&(this.unbind("GameLoop",this._recolor),n=1);const r=e(n,this._bottomColors),o=e(n,this._topColors);this.bottomColor(r),this.topColor(o),this.trigger("ColorFadeUpdate",{topColor:i(o),bottomColor:i(r)}),n>=1&&this.trigger("ColorFadeFinished")}})}).call(this,i(0).default)},function(t,e,i){(function(t){t.c("Delta2D",{required:"2D",properties:{dx:{set:function(t){this.shift(t-this._dx,0),this._dx=t},get:function(){return this._dx},enumerable:!0,configurable:!1},_dx:{value:0,writable:!0,enumerable:!1,configurable:!1},dy:{set:function(t){this.shift(0,t-this._dy),this._dy=t},get:function(){return this._dy},enumerable:!0,configurable:!1},_dy:{value:0,writable:!0,enumerable:!1,configurable:!1}}})}).call(this,i(0).default)},function(t,e,i){(function(t){t.c("TweenPromise",{init(){this.requires("Tween")},tweenPromise(...t){return new Promise(e=>{this.one("TweenEnd",()=>e(this)),this.tween(...t)})}})}).call(this,i(0).default)},function(t,e,i){"use strict";i.r(e),i.d(e,"levels",(function(){return n})),i.d(e,"determineLevel",(function(){return r})),i.d(e,"levelProgress",(function(){return o})),i.d(e,"levelInfo",(function(){return s}));const n=[{xp:200,reward:100,name:"Nice"},{xp:700,reward:500,name:"Good"},{xp:1400,reward:1e3,name:"Great"},{xp:3e3,reward:2e3,name:"Excellent"},{xp:7e3,reward:5e3,name:"Wondeful"},{xp:15e3,reward:1e4,name:"Superb"},{xp:3e4,reward:2e4,name:"Godlike"},{xp:55e3,reward:4e4,name:"Funky"},{xp:115e3,reward:8e4,name:"Fantastic"},{xp:145e3,reward:1e5,name:"Amazing"}],r=t=>{let e=t;for(let t=0;t<n.length;t++){const i=n[t];if(e<i.xp)return t;e-=i.xp}return n.length-1},o=t=>{let e=t;for(let t=0;t<n.length;t++){const i=n[t];if(e<i.xp)return e/i.xp;e-=i.xp}return 1},s=t=>n[t-1]},function(t,e,i){"use strict";(function(t){i(7);t.c("Scalable",{properties:{scale:{set(t){this._updateScale(t)},get(){return this._scale},configurable:!0,enumerable:!0},_scale:{value:1,writable:!0,enumerable:!1,configurable:!1}},_updateScale(t){const e=this._scale;this._scale=t;const i=this.w,n=this.h;this.w=this.w/e*t,this.h=this.h/e*t,this._children.forEach(r=>{const o=r.x-this.x,s=r.y-this.y;"function"==typeof r.attr&&r.attr({x:this.x+o/e*t,y:this.y+s/e*t,w:(r.w+i-this.w)/e*t,h:(r.h+n-this.h)/e*t})}),this.map&&this.map.points&&(this.map.points=this.map.points.map((i,n)=>{const r=n%2==0?this.x:this.y;return r+(i-r)/e*t}))}})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var e=i(13),n=i.n(e);t.c("ColorEffects",{colorDesaturation(e){if(null===e)return this;const i={};return t.assignColor(e,i),this.attr({desaturationColor:i}),this.trigger("Invalidate"),this},colorOverride(e,i){if(null==i&&(i="all"),null==e)return this;let r={};return n()(e)?r=e:t.assignColor(e,r),this.attr({overrideColor:r,overrideColorMode:i}),this.trigger("Invalidate"),this},clearColorOverride(){return this.attr({overrideColor:null,overrideColorMode:"all"}),this.trigger("Invalidate"),this},saturationGradient(t,e){return this.attr({topDesaturation:t,bottomDesaturation:e}),this}})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){i(7),i(146),i(143),i(404),i(141),i(140);const e={sprites:[],attachHooks:[],attributes:{},hitbox:[]},n={top:0,center:.5,bottom:1},r={left:0,center:.5,right:1},o=["x","y","w","h","rotation"],s=(t,e)=>{let i=null;return t.appliedDefinition.sprites.forEach((t,n)=>{t[1].key===e&&(i=n)}),null===i?null:t.composableParts[i]};t.c("Composable",{init(){this.appliedDefinition=e,this.composableParts=[],this.currentAttachHooks={},this.currentZ=this.z,this.bind("Reorder",this.updateChildrenOrder),this.bind("Freeze",this.composableFreeze),this.bind("Unfreeze",this.composableUnfreeze)},composableFreeze(){this._children.forEach(t=>t.freeze())},composableUnfreeze(){this._children.forEach(t=>t.unfreeze())},compose(t){const i={...e,...t};return this.setOwnAttributes(i.attributes),this.buildSprites(i.sprites),this.appliedDefinition=t,this.forEachPart((t,e)=>{const i=this.spriteOptions(e);if(!i.attachTo)return;const n=s(this,i.attachTo);n&&n.attach(t)}),this.buildAttachHooks(i.attachHooks),i.hitbox.length>0&&(this.addComponent("Collision"),this.collision(i.hitbox)),i.attributes.scale&&(this.addComponent("Scalable"),this.attr({scale:i.attributes.scale})),this},updateChildrenOrder(){const t=this.z-this.currentZ;this.forEachPart(e=>{e.z+=t}),Object.entries(this.currentAttachHooks).forEach(([,e])=>{e.z+=t,e.currentAttachment&&(e.currentAttachment.z+=t)}),this.currentZ=this.z},setOwnAttributes(t){const e={};t.width&&(e.w=t.width),t.height&&(e.h=t.height),this.attr(e)},buildSprites(t){const e=[],i=this.appliedDefinition.sprites;let n=0;t.forEach((t,r,o)=>{const s=i[n];if(s){if(t[0]!==s[0]){const e=o[r+1];if(e&&e[0]===s[0])return this.composableParts.splice(n,0,this.createAndAttachSprite(t)),void n++;const i=this.composableParts[n];this.detach(i),i.destroy(),this.composableParts.splice(n,1,this.createAndAttachSprite(t)),n++}else if(t[0]===s[0]){const e=this.composableParts[n];this.applySpriteOptions(e,t[1]),n++}}else e.push(t)}),this.composableParts.slice(n).forEach(t=>{this.detach(t),t.destroy()}),this.composableParts=this.composableParts.slice(0,n).concat(e.map(t=>this.createAndAttachSprite(t)))},createAndAttachSprite([e,i]){const n=t.e(`2D, WebGL, Delta2D, ${e}`);return this.applySpriteOptions(n,i),n.attr({originalSize:{w:n.w,h:n.h}}),this.attach(n),n},applySpriteOptions(t,e){if(t.attr({x:this.x+(e.x||0),y:this.y+(e.y||0),z:this.z+(e.z||0)}),e.key&&t.attr({key:e.key}),e.crop){const[i,n,r,o]=e.crop;t.crop(o,i,t.w-n-o,t.h-r-i)}if(e.flipX&&t.flip("X"),e.ro){const[i,n]=e.ro;t.origin(i,n),e.rotation&&t.attr({rotation:e.rotation})}if(e.hitbox&&(t.addComponent("Collision"),t.collision(e.hitbox)),e.hideBelow&&t.addComponent("HideBelow").attr({hideBelow:e.hideBelow}),e.horizon){const[i,n]=e.horizon;t.addComponent("Horizon").saturationGradient(i,n)}},forEachPart(t){this.composableParts.forEach((e,i,n)=>t(e,i,n))},spriteOptions(t){return this.appliedDefinition.sprites[t][1]},attachEntity(t,e){const i=((t,e)=>(t.attachHooks.find(([t])=>t===e)||[])[1]||{})(this.appliedDefinition,t),o=this.currentAttachHooks[t];if(!o)return;if(o.currentAttachment&&o.currentAttachment.destroy(),!e)return void o.attr({currentAttachment:null});const s=i.attachAlign||["top","left"],a=o.x-r[s[1]]*e.w,h=o.y-n[s[0]]*e.h;e.attr({x:a,y:h,z:o.z}),o.attach(e),o.attr({currentAttachment:e})},clearAttachment(t){this.attachEntity(t,null)},buildAttachHooks(e){e.forEach(([e,i])=>{const n=this.currentAttachHooks[e]||t.e("2D");if(n.attr({x:this.x+(i.x||0),y:this.y+(i.y||0),z:this.z+(i.z||0),w:10,h:10,currentAttachment:n.currentAttachment||null}),i.attachTo){const t=s(this,i.attachTo);t?t.attach(n):this.attach(n)}else this.attach(n);this.currentAttachHooks[e]=n})},async displayFrame(t,e,i){const n="default"===t?(t=>{const e={};return t.sprites.filter(([,t])=>t.key).map(([,t])=>e[t.key]={z:0,rotation:0,...t,x:0,y:0}),e})(this.appliedDefinition):this.appliedDefinition.frames[t];if(!n)return;const r=Object.entries(n).map(([t,n])=>{const r=this.composableParts.find(e=>e.attr("key")===t);if(!r)return;const s={z:0,w:r.originalSize.w,h:r.originalSize.h,...(this.appliedDefinition.sprites.find(([,e])=>e.key===t)||[])[1],x:0,y:0};r.addComponent("TweenPromise");const a=(t=>Object.entries(t).filter(([t])=>o.includes(t)).map(([t,e])=>"x"===t?["dx",e]:"y"===t?["dy",e]:[t,e]).reduce((t,[e,i])=>({...t,[e]:i}),{}))({...s,...n});return r.tweenPromise(a,e,i)});await Promise.all(r)}})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){i(7),i(144),i(139),i(147);t.c("Backdrop",{init(){this.requires("2D, WebGL, Gradient, ColorFade"),this.attr({x:0,y:0,w:t.viewport.width,h:t.viewport.height,z:-1e4})}});let e="#000000";t.c("Horizon",{init(){this.requires("ColorEffects"),this.colorDesaturation(e)}})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var e=i(155),n=i.n(e),r=i(156),o=i.n(r);t.extend({defaultGradientShader(e){return e?this._defaultGradientShader=e:(void 0===this._defaultGradientShader&&(this._defaultGradientShader=new t.WebGLShader(n.a,o.a,[{name:"aPosition",width:2},{name:"aOrientation",width:3},{name:"aLayer",width:2},{name:"aColor",width:4}],(function(){}))),this._defaultGradientShader)}}),t.c("Gradient",{init(){this._topColor={_red:0,_green:0,_blue:0,_strength:1},this._bottomColor={_red:0,_green:0,_blue:0,_strength:1},this.ready=!0,this.bind("Draw",this._drawGradient),this.has("WebGL")&&this._establishShader("Gradient",t.defaultGradientShader()),this.trigger("Invalidate")},remove(){this.unbind("Draw",this._drawGradient),this.has("DOM")&&(this._element.style.backgroundColor="transparent"),this.trigger("Invalidate")},_drawGradient(t){"webgl"===t.type&&t.program.writeVector("aColor",this._topColor._red/255,this._topColor._green/255,this._topColor._blue/255,this._topColor._strength,this._bottomColor._red/255,this._bottomColor._green/255,this._bottomColor._blue/255,this._bottomColor._strength)},topColor(t,e){return t?(this._setColor(this._topColor,t,e),this):this._topColor},bottomColor(t,e){return t?(this._setColor(this._bottomColor,t,e),this):this._bottomColor},_setColor(e,i,n){"string"==typeof i?t.assignColor(i,e):(e._red=i[0],e._green=i[1],e._blue=i[2]),void 0!==n&&(e._strength=n),this.trigger("Invalidate")}})}).call(this,i(0).default)},function(t,e,i){(function(e,n){var r,o,s,a=[].slice;o=i(70),s=i(417),r=function(){function t(t,e,i){this.level=t,this.generator=e,this.settings=i,this.createdElements=[],this.createdBindings=[]}return t.prototype.screenHeight=480,t.prototype.loadAssets=function(){var t,i;return null==(i="function"==typeof this.assets?this.assets():void 0)?e():(t=e.defer(),n.load(i,(function(){return t.resolve()})),t.promise)},t.prototype.build=function(t){if(!this.generated)return null==this.x&&(this.x=t.x),null==this.y&&(this.y=t.y),this.notifyOffsetX=0,this.generated=!0,this.generate(),this._notifyEnterFunction(this.notifyOffsetX)},t.prototype._notifyEnterFunction=function(t){var e;return e=this,n.e("2D, Collision, ViewportRelativeMotion").attr({w:10,h:800}).viewportRelativeMotion({x:this.x+t,y:40,offsetY:this.y-40,xspeed:1,speed:0}).onHit("ScrollFront",(function(){if(!this.triggeredFront)return n.trigger("EnterBlock",e),this.triggeredFront=!0})).onHit("PlayerControlledShip",(function(){if(!this.triggeredPlayerFront)return n.trigger("PlayerEnterBlock",e),this.triggeredPlayerFront=!0})).onHit("ScrollWall",(function(){return n.trigger("LeaveBlock",e),this.destroy()}))},t.prototype.generate=function(){var t;return null!=(t=this.settings.generate)?t.apply(this):void 0},t.prototype.enter=function(){var t;return null!=(t=this.settings.enter)?t.apply(this):void 0},t.prototype.playerEnter=function(){var t;return null!=(t=this.settings.playerEnter)?t.apply(this):void 0},t.prototype.playerLeave=function(){var t;return null!=(t=this.settings.playerLeave)?t.apply(this):void 0},t.prototype.inScreen=function(){var t;return null!=(t=this.settings.inScreen)?t.apply(this):void 0},t.prototype.outScreen=function(){var t;return null!=(t=this.settings.outScreen)?t.apply(this):void 0},t.prototype.leave=function(){var t;return null!=(t=this.settings.leave)?t.apply(this):void 0},t.prototype.clean=function(){var t,e,i,r,o,s,a;for(e=0,r=(s=this.createdElements).length;e<r;e++)s[e].destroy();for(this.createdElements=[],i=0,o=(a=this.createdBindings).length;i<o;i++)t=a[i],n.unbind(t.event,t.callback);return this.createdBindings=[]},t.prototype.add=function(t,e,i){return i.addComponent("ViewportRelativeMotion").viewportRelativeMotion({x:this.x+t,y:e+40,offsetY:this.y-40,speed:1}),this.createdElements.push(i)},t.prototype.addBackground=function(t,e,i,n){return i.addComponent("ViewportRelativeMotion").viewportRelativeMotion({x:this.x+t,y:e+40,offsetY:this.y-40,speed:n}),this.createdElements.push(i)},t.prototype.addElement=function(){var t,e;return e=arguments[0],t=2<=arguments.length?a.call(arguments,1):[],this.generator.elements[e].apply(this,t)},t.prototype.bind=function(t,e,i){return o(e)&&void 0===i&&(i=e,e={}),i=!0===e.once?n.one(t,i):n.bind(t,i),this.createdBindings.push({event:t,callback:i})},t.prototype.unbind=function(t){var e,i,r,o,h;for(h=[],i=0,r=(o=this.createdBindings).length;i<r;i++)(e=o[i]).event===t&&(h.push(e),n.unbind(e.event,e.callback));return this.createdBindings=s.apply(null,[this.createdBindings].concat(a.call(h)))},t.prototype.canCleanup=function(){var t,e,i,r,o;for(t=-1*n.viewport._x,i=0,r=(o=this.createdElements).length;i<r;i++)if((e=o[i]).x+e.w>=t)return!1;return!0},t}(),t.exports={default:r}}).call(this,i(12).default,i(0).default)},function(t,e,i){var n=i(127);t.exports=function(t,e){var i=-1,r=t.length,o=r-1;for(e=void 0===e?r:e;++i<e;){var s=n(i,o),a=t[s];t[s]=t[i],t[i]=a}return t.length=e,t}},function(t,e,i){var n=i(126),r=i(315),o=i(8);t.exports=function(t){return(o(t)?n:r)(t)}},function(t,e,i){var n;i(3),void 0===(n=function(t){var e=i(132),n=e.Promise.all,r=Array.prototype.slice;return function(t){var i=[];return n(r.call(arguments,1)).then((function(n){return e.reduce(t,(function(t,i){return e(i.apply(void 0,n),o)}),i)}));function o(t){return i.push(t),i}}}.call(e,i,e,t))||(t.exports=n)},function(t,e,i){var n;i(3),void 0===(n=function(t){var e=i(132),n=e.Promise.all,r=Array.prototype.slice;return function(t){return n(r.call(arguments,1)).then((function(i){return e.map(t,(function(t){return t.apply(void 0,i)}))}))}}.call(e,i,e,t))||(t.exports=n)},function(t,e){t.exports="attribute vec2 aPosition;\nattribute vec3 aOrientation;\nattribute vec2 aLayer;\nattribute vec4 aColor;\nattribute vec4 aDesaturation;\nattribute vec2 aGradient;\n\nvarying lowp vec4 vColor;\nvarying lowp vec4 vDesaturation;\nvarying lowp vec2 vGradient;\nvarying lowp vec2 vLayer;\nuniform  vec4 uViewport;\n\nmat4 viewportScale = mat4(2.0 / uViewport.z, 0, 0, 0,    0, -2.0 / uViewport.w, 0,0,    0, 0,1,0,    -1,+1,0,1);\nvec4 viewportTranslation = vec4(uViewport.xy, 0, 0);\n\nvoid main() {\n  vec2 pos = aPosition;\n  vec2 entityOrigin = aOrientation.xy;\n  mat2 entityRotationMatrix = mat2(cos(aOrientation.z), sin(aOrientation.z), -sin(aOrientation.z), cos(aOrientation.z));\n\n  pos = entityRotationMatrix * (pos - entityOrigin) + entityOrigin;\n  gl_Position = viewportScale * (viewportTranslation + vec4(pos, 1.0/(1.0+exp(aLayer.x) ), 1) );\n\n  vColor = aColor;\n  vDesaturation = aDesaturation;\n  vGradient = aGradient;\n  vLayer = aLayer;\n}\n\n"},function(t,e){t.exports="precision mediump float;\nvarying lowp vec4 vColor;\nvarying lowp vec2 vGradient;\nvarying lowp vec4 vDesaturation;\nvarying lowp vec2 vLayer;\nvoid main(void) {\n\n  //gl_FragColor = vec4(vColor.rgb*vColor.a*vLayer.y, vColor.a*vLayer.y);\n\n  mediump float mixFactor = vGradient.x;\n\n  mediump float lightness = (0.2126*vColor.r + 0.7152*vColor.g + 0.0722*vColor.b);\n  mediump float lightnessBase = (0.2126*vDesaturation.r + 0.7152*vDesaturation.g + 0.0722*vDesaturation.b);\n  mediump vec4 baseColor = vec4(vDesaturation.rgb, vColor.a) * (1.0 + (lightness - lightnessBase));\n  mediump vec4 mixColor = vec4(\n      (baseColor.rgba * mixFactor) + (vColor.rgba * (1.0 - mixFactor))\n      );\n\n  gl_FragColor = vec4(\n      mixColor.rgb * vColor.a * vLayer.y,\n      vColor.a * vLayer.y\n      );\n}\n\n"},function(t,e){t.exports="attribute vec2 aPosition;\nattribute vec3 aOrientation;\nattribute vec2 aLayer;\nattribute vec4 aColor;\n\nvarying lowp vec4 vColor;\nvarying lowp vec2 vLayer;\nuniform  vec4 uViewport;\n\nmat4 viewportScale = mat4(2.0 / uViewport.z, 0, 0, 0,    0, -2.0 / uViewport.w, 0,0,    0, 0,1,0,    -1,+1,0,1);\nvec4 viewportTranslation = vec4(uViewport.xy, 0, 0);\n\nvoid main() {\n  vec2 pos = aPosition;\n  vec2 entityOrigin = aOrientation.xy;\n  mat2 entityRotationMatrix = mat2(cos(aOrientation.z), sin(aOrientation.z), -sin(aOrientation.z), cos(aOrientation.z));\n\n  pos = entityRotationMatrix * (pos - entityOrigin) + entityOrigin;\n  gl_Position = viewportScale * (viewportTranslation + vec4(pos, 1.0/(1.0+exp(aLayer.x) ), 1) );\n\n  vColor = aColor;\n  vLayer = aLayer;\n}\n\n"},function(t,e){t.exports="precision mediump float;\nvarying lowp vec4 vColor;\nvarying lowp vec2 vLayer;\nvoid main(void) {\n  gl_FragColor = vec4(vColor.rgb*vColor.a*vLayer.y, vColor.a*vLayer.y);\n}\n"},function(t,e){t.exports="attribute vec2 aPosition;\nattribute vec4 aSpriteDimensions;\nattribute vec3 aOrientation;\nattribute vec2 aLayer;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute vec4 aOverrideColor;\nattribute vec4 aGradient;\n\nvarying mediump vec3 vTextureCoord;\nvarying lowp vec4 vColor;\nvarying lowp vec4 vOverrideColor;\nvarying lowp vec4 vGradient;\nvarying lowp vec4 vSpriteDimensions;\n\nuniform vec4 uViewport;\nuniform mediump vec2 uTextureDimensions;\n\nmat4 viewportScale = mat4(2.0 / uViewport.z, 0, 0, 0,    0, -2.0 / uViewport.w, 0,0,    0, 0,1,0,    -1,+1,0,1);\nvec4 viewportTranslation = vec4(uViewport.xy, 0, 0);\n\nvoid main() {\n  vec2 pos = aPosition;\n  vec2 entityOrigin = aOrientation.xy;\n  mat2 entityRotationMatrix = mat2(cos(aOrientation.z), sin(aOrientation.z), -sin(aOrientation.z), cos(aOrientation.z));\n\n  pos = entityRotationMatrix * (pos - entityOrigin) + entityOrigin ;\n  gl_Position = viewportScale * (viewportTranslation + vec4(pos, 1.0/(1.0+exp(aLayer.x) ), 1) );\n  vTextureCoord = vec3(aTextureCoord, aLayer.y);\n  vColor = aColor;\n  vOverrideColor = aOverrideColor;\n  vGradient = aGradient;\n  vSpriteDimensions = aSpriteDimensions;\n}\n\n"},function(t,e){t.exports="precision mediump float;\nvarying mediump vec3 vTextureCoord;\nvarying mediump vec4 vColor;\nvarying mediump vec4 vOverrideColor;\nvarying mediump vec4 vGradient;\nvarying mediump vec4 vSpriteDimensions;\n\nuniform sampler2D uSampler;\nuniform mediump vec2 uTextureDimensions;\n\nfloat random(vec3 scale, float seed) {\n  // use the fragment position for a different seed per-pixel\n  return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\nvec3 rgb2hsv(vec3 c) {\n  vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n  vec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n  vec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n  //vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n  //vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n  float d = q.x - min(q.w, q.y);\n  float e = 1.0e-10;\n  return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c) {\n  vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nvoid main() {\n  highp vec2 coord =   vTextureCoord.xy / uTextureDimensions;\n  float blur = vGradient.z;\n\n  if ((vGradient.a >= 0.0) && (vTextureCoord.y >= vGradient.a)) {\n    gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n    return;\n  }\n\n  mediump vec4 texelColor = texture2D(uSampler, coord);\n\n  if (blur > 0.0) {\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    // randomize the lookup values to hide the fixed number of samples\n    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n    for (float t = -30.0; t <= 30.0; t++) {\n      float percent = (t + offset - 0.5) / 30.0;\n      float weight = 1.0 - abs(percent);\n      vec4 sample = texture2D(uSampler, coord + (blur * percent) / uTextureDimensions);\n      // switch to pre-multiplied alpha to correctly blur transparent images\n      sample.rgb *= sample.a;\n\n      color += sample * weight;\n      total += weight;\n    }\n\n    texelColor = color / total;\n    texelColor.rgb /= texelColor.a + 0.00001;\n  }\n\n  mediump float yCoord = (vTextureCoord.y - vSpriteDimensions.y) / vSpriteDimensions.a;\n  mediump float mixFactor = (vGradient.x * (1.0 - yCoord)) + (vGradient.y * yCoord);\n\n  mediump float lightness = (0.2126*texelColor.r + 0.7152*texelColor.g + 0.0722*texelColor.b);\n  if (vOverrideColor.a == 1.0) {\n    texelColor = vec4(vOverrideColor.rgb * (lightness * 1.3), texelColor.a);\n  }\n  if (vOverrideColor.a == 3.0) {\n    texelColor = vec4(vOverrideColor.rgb, texelColor.a);\n  }\n  if (vOverrideColor.a == 2.0) {\n    vec3 texelHSV = rgb2hsv(texelColor.rgb);\n    if ((texelHSV.x < .84) && (texelHSV.x > .82)) {\n      vec3 overrideHSV = rgb2hsv(vOverrideColor.rgb);\n      texelHSV.x = overrideHSV.x;\n      texelHSV.y *= overrideHSV.y;\n      texelHSV.z *= overrideHSV.z;\n      vec3 texelRGB = hsv2rgb(texelHSV);\n      texelColor = vec4(texelRGB.rgb, texelColor.a);\n    }\n  }\n\n  mediump float lightnessBase = (0.2126*vColor.r + 0.7152*vColor.g + 0.0722*vColor.b);\n  mediump vec4 baseColor = vec4(vColor.rgb, texelColor.a) * (1.0 + (lightness - lightnessBase));\n  mediump vec4 mixColor = vec4(\n      (baseColor.rgba * mixFactor) + (texelColor.rgba * (1.0 - mixFactor))\n      );\n\n  if (vColor.a > 1.0) {\n    mixColor.rgb = vColor.rgb;\n  }\n\n  gl_FragColor = vec4(\n      mixColor.rgb * vColor.a * texelColor.a * vTextureCoord.z,\n      texelColor.a * vTextureCoord.z\n      );\n}\n\n"},function(t,e,i){"use strict";(function(t){i(7);var n=i(160);e.a=()=>({loadSpriteSheets:async e=>new Promise(i=>{const r={sprites:{}};n.a.filter(t=>e.includes(t.name)).forEach(t=>{r.sprites[t.image]=t.map}),t.load(r,i)})})}).call(this,i(0).default)},function(t,e,i){"use strict";var n=i(88),r=i.n(n),o=i(89),s=i(85),a=i.n(s),h=i(86),c=i(90),u=i.n(c),l=i(91);const d=[{name:"city-enemies",image:r.a,map:o},{name:"city-scenery",image:a.a,map:h},{name:"dino",image:u.a,map:l}];e.a=d},function(t,e,i){"use strict";(function(t){e.a=e=>{const i=async(t,...e)=>await t(...e),n=async e=>{const i=Math.floor(e/40);return new Promise(e=>t.e("Delay").delay(()=>{},40,i,(function(){e(),this.destroy()})))};return{until:async(t,i)=>{let n=!1;for(t(e).then(()=>{n=!0});!n;)await i(e)},waitWhile:async(t,...e)=>{let r=await i(t,...e);for(;r;)await n(50),r=await i(t,...e)},wait:n,exec:async(t,...i)=>{await t(e,...i)},call:i}}}).call(this,i(0).default)},function(t){t.exports=JSON.parse('{"City.Coast":{"width":1024,"height":576,"right":"City.Coast","left":"City.Coast","elements":[{"x":0,"y":-65,"composition":"ocean.front"},{"x":0,"y":-45,"components":["ShipSolid","BulletSolid","GravityLiquid"],"w":1024,"h":45},{"x":0,"y":-30,"composition":"ocean.middle","distance":0.5},{"x":0,"y":-30,"composition":"ocean.horizon","distance":0.25},{"x":0,"y":-46,"composition":"city.horizon","distance":0.25}]},"City.CoastStart":{"width":1024,"height":576,"right":"City.Coast","left":"City.Ocean","elements":[{"x":0,"y":-65,"composition":"ocean.front"},{"x":0,"y":-45,"components":["ShipSolid","BulletSolid","GravityLiquid"],"w":1024,"h":45},{"x":0,"y":-30,"composition":"ocean.middle","distance":0.5},{"x":0,"y":-30,"composition":"ocean.horizon","distance":0.25},{"x":0,"y":-46,"composition":"city.horizonStart","distance":0.25}]},"City.Ocean":{"width":1024,"height":576,"right":"City.Ocean","left":"City.Ocean","elements":[{"x":0,"y":-65,"composition":"ocean.front"},{"x":0,"y":-45,"components":["ShipSolid","BulletSolid","GravityLiquid"],"w":1024,"h":45},{"x":0,"y":-30,"composition":"ocean.middle","distance":0.5},{"x":0,"y":-30,"composition":"ocean.horizon","distance":0.25}]},"City.BayStart":{"width":1024,"height":576,"right":"City.Bay","left":"City.Coast","elements":[{"x":0,"y":-65,"composition":"ocean.front"},{"x":0,"y":-45,"components":["ShipSolid","BulletSolid","GravityLiquid"],"w":1024,"h":45},{"x":0,"y":-30,"composition":"ocean.middle","distance":0.5},{"x":0,"y":-30,"composition":"ocean.horizon","distance":0.25},{"x":0,"y":-46,"composition":"city.horizon","distance":0.25},{"x":0,"y":-180,"composition":"city.cityStart","distance":0.5}]},"City.Bay":{"width":1024,"height":576,"left":"City.Bay","right":"City.Bay","elements":[{"x":0,"y":-65,"z":-20,"composition":"ocean.front"},{"x":0,"y":-45,"components":["ShipSolid","BulletSolid","GravityLiquid"],"w":1024,"h":45},{"x":0,"y":-30,"composition":"ocean.middle","distance":0.5},{"x":0,"y":-30,"composition":"ocean.horizon","distance":0.25},{"x":0,"y":-46,"composition":"city.horizon","distance":0.25},{"x":0,"y":-180,"composition":"city.city","distance":0.5},{"x":0,"y":-210,"composition":"city.layer2","distance":0.375}]}}')},function(t){t.exports=JSON.parse('{"bulletCannon":{"attributes":{"width":100,"height":42},"sprites":[["turretFoot",{"x":64,"y":24}],["mineCannon",{"x":0,"y":0,"key":"barrel","ro":[82,24],"hitbox":[5,10,94,10,94,28,5,28]}]],"frames":{"up":{"barrel":{"rotation":90}}}}}')},function(t){t.exports=JSON.parse('{"dino":{"attributes":{"width":200,"height":153},"sprites":[["dinoBody",{"z":2,"ro":[82,24],"key":"body"}],["dinoTentacles",{"x":26,"y":37,"z":2,"ro":[16,16],"attachTo":"body"}],["dinoArm",{"x":16,"y":82,"z":3,"ro":[34,16],"key":"arm","attachTo":"body"}],["dinoNeck",{"x":-32,"y":42,"z":1,"ro":[50,16],"key":"neck","attachTo":"body"}],["dinoJaw",{"x":-89,"y":52,"z":1,"ro":[70,16],"key":"jaw","attachTo":"neck"}],["dinoTongue",{"x":-39,"y":52,"z":-1,"ro":[70,16],"attachTo":"neck","key":"tongue"}],["dinoHead",{"x":-94,"y":23,"z":2,"ro":[70,37],"key":"head","attachTo":"neck"}],["dinoTail",{"x":124,"y":24,"z":1,"ro":[10,22],"attachTo":"body"}],["dinoUpperLeg",{"x":116,"y":46,"z":3,"ro":[32,16],"key":"upperLeg","attachTo":"body"}],["dinoLowerLeg",{"x":144,"y":86,"z":5,"rotation":-55,"ro":[16,16],"key":"lowerLeg","attachTo":"upperLeg"}],["dinoFeet",{"x":172,"y":114,"z":6,"ro":[26,8],"key":"feet","attachTo":"lowerLeg"}],["dinoToes",{"x":157,"y":118,"z":7,"ro":[22,20],"attachTo":"feet"}],["dinoBackUpperLeg",{"x":114,"y":36,"z":-3,"ro":[22,20],"key":"backUpperLeg","attachTo":"body"}],["dinoBackLowerLeg",{"x":114,"y":63,"z":-2,"ro":[16,20],"key":"backLowerLeg","attachTo":"backUpperLeg"}],["dinoBackFeet",{"x":98,"y":95,"z":-1,"ro":[24,16],"key":"backFeet","attachTo":"backLowerLeg"}],["dinoBackToes",{"x":82,"y":95,"z":0,"ro":[26,11],"key":"backToes","attachTo":"backFeet"}]],"frames":{"roar1":{"head":{"rotation":40},"jaw":{"rotation":-42,"x":-8},"tongue":{"x":-20},"neck":{"rotation":0},"body":{"rotation":20},"arm":{"rotation":-40},"tail":{"rotation":-10},"topLeg":{"rotation":25},"bottomLeg":{"rotation":-50},"feet":{"rotation":-10},"toes":{"rotation":-10},"upperLegBack":{"rotation":10},"lowerLegBack":{"rotation":-60},"feetBack":{"rotation":-80},"toesBack":{"rotation":0}}}}}')},function(t){t.exports=JSON.parse('{"drone":{"attributes":{"width":60,"height":50},"hitbox":[0,20,50,0,60,40,0,50],"sprites":[["standardDrone",{"x":-2,"y":-11}]]},"damagedDrone":{"attributes":{"width":60,"height":50},"sprites":[["standardDroneDamage",{"x":-2,"y":-11}]]}}')},function(t){t.exports=JSON.parse('{"ocean.front":{"attributes":{"width":1024,"height":96},"sprites":[["waterFront1",{"z":-20,"key":"left"}],["waterFront2",{"x":512,"z":-20,"key":"right"}]],"frames":{"wave":{"left":{"w":600,"h":75,"y":21},"right":{"x":88,"w":424,"h":75,"y":21}}}},"ocean.middle":{"attributes":{"width":512,"height":192},"sprites":[["waterMiddle",{"z":-500,"key":"middle","horizon":[0.7,0.4]}]],"frames":{"wave":{"middle":{"y":10}}}},"ocean.horizon":{"attributes":{"width":256,"height":160},"sprites":[["waterHorizon",{"z":-600,"horizon":[1,0.2]}]]}}')},function(t){t.exports=JSON.parse('{"city.horizon":{"attributes":{"width":256,"height":160},"sprites":[["coast",{"z":-598,"horizon":[0.9,0.8]}]]},"city.horizonStart":{"attributes":{"width":256,"height":160},"sprites":[["coastStart",{"z":-598,"horizon":[0.9,0.8]}]]},"city.cityStart":{"attributes":{"width":512,"height":288},"sprites":[["cityStart",{"z":-305,"horizon":[0.4,0.4]}]]},"city.city":{"attributes":{"width":512,"height":288},"sprites":[["city",{"z":-305,"horizon":[0.4,0.4]}]]},"city.layer2":{"attributes":{"width":384,"height":256},"sprites":[["cityLayer2",{"z":-505,"horizon":[0.6,0.6]}]]}}')},function(t){t.exports=JSON.parse('{"shipHatch":{"attributes":{"width":128,"height":32},"sprites":[["aircraftCarrierOpenHatch",{"y":-4,"x":-12}],["aircraftCarrierHatchLid",{"y":-2,"x":-12,"key":"lid","crop":[2,0,0,0],"z":3}],["aircraftCarrierWires",{"x":68,"y":-20,"z":-1}],["aircraftCarrierHatchLid",{"x":-11,"y":80,"z":1,"key":"floor","crop":[18,3,0,0],"hideBelow":28}]],"attachHooks":[["payload",{"x":64,"y":86,"z":6,"attachAlign":["bottom","center"],"attachTo":"floor"}]],"frames":{"open":{"lid":{"x":-30,"y":16},"floor":{"x":0,"y":0}},"risen":{"lid":{"x":-30,"y":16},"floor":{"y":-65}}}}}')},function(t,e,i){"use strict";(function(t){i(7);e.a=()=>({setWeapons:async e=>{t("PlayerControlledShip").each((function(){this.clearItems(),e.forEach(t=>{this.installItem({type:"weapon",contains:t})})}))},spawnShip:()=>{t("Player").each((function(){this.addComponent("ShipSpawnable"),this.spawnPosition(()=>({x:200,y:100}))})),t("Player ControlScheme").each((function(){this.attr({shipType:"PlayerSpaceship"}),this.spawnShip()}))}})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){i.d(e,"a",(function(){return s}));i(7),i(145);var n=i(171),r=i(54);const o=e=>{if(!e)return{};let i=e.x,n=e.y;return e.rx&&(i=t.viewport.width*e.rx),e.ry&&(n=t.viewport.height*e.ry),{x:i,y:n}},s=(e,i={})=>{const{location:n,...r}=i;return t.e("2D, WebGL, EntityDefinition").attr({x:0,y:0,w:40,h:40}).applyDefinition(e).attr({...o(n),...r})},a=(e,i)=>{if(i.composition){const t=r.a[i.composition];e.addComponent("Composable").compose(t)}i.entity&&e.addComponent("EntityDefinition").applyDefinition(i.entity),i.components&&i.components.forEach(t=>{if("string"==typeof t)e.addComponent(t);else{const[i,n]=t;e.addComponent(i).attr(n)}}),i.attachments&&"function"==typeof e.attachEntity&&Object.entries(i.attachments).forEach(([i,n])=>{if(n){const r=n?t.e("2D, WebGL"):null;a(r,n),e.attachEntity(i,r);const o=n.name||i;e[o]=r}else e.clearAttachment(i)})};t.c("EntityDefinition",{init(){this.appliedEntityDefinition=null,this.showState=this.showState.bind(this)},applyDefinition(t){const e=n.a.find(e=>e.name===t);this.addComponent(t);const i=e.structure;return a(this,i),this.appliedEntityDefinition=e,this},showState(t){const e="default"===t?this.appliedEntityDefinition.structure:this.appliedEntityDefinition.states[t];e&&a(this,e)}})}).call(this,i(0).default)},function(t,e,i){"use strict";var n=i(172),r=i(173);e.a=[n,r]},function(t){t.exports=JSON.parse('{"name":"BattleShip","structure":{"composition":"battleship.deck","components":["ShipSolid","GravitySolid",["commented-WaterSplashes",{"waterRadius":10,"minSplashDuration":600,"defaultWaterCooldown":400,"waterSplashSpeed":700,"minWaterOffset":-20}],["HideBelow",{"hideBelow":540,"z":-12}]],"attachments":{"cabin1":{"composition":"battleship.firstCabin"},"cabin2":{"composition":"battleship.secondCabin","components":["DamageSupport"]},"hatch1":{"composition":"shipHatch","attachments":{"payload":{"name":"turret","composition":"bulletCannon","components":["DamageSupport",["Aimable",{"aimParts":["barrel"]}]]}}},"hatch2":{"composition":"shipHatch","attachments":{"payload":{"name":"turret","composition":"bulletCannon","components":["DamageSupport",["Aimable",{"aimParts":["barrel"]}]]}}},"hatch3":{"composition":"shipHatch","attachments":{"payload":{"name":"turret","composition":"bulletCannon","components":["DamageSupport",["Aimable",{"aimParts":["barrel"]}]]}}}}},"states":{"fase3":{"attachments":{"cabin2":{"composition":"battleship.secondCabinOpen"},"engineCore":{"composition":"battleship.engine"}}},"fase4":{"attachments":{"cabin1":{"composition":"battleship.firstCabinDestroyed"}}},"fase5":{"attachments":{"cabin2":{"composition":"battleship.secondCabinDestroyed"},"engineCore":null}}},"habitats":[{"name":"Ocean","scenery":"City.Ocean","scrollSpeed":{"vx":-100,"vy":0},"background":["#366eab","#d6d5d5"]}]}')},function(t){t.exports=JSON.parse('{"name":"WarDrone","structure":{"composition":"drone","components":["DamageSupport","GravitySupport"]},"states":{"damaged":{"composition":"damagedDrone"}},"habitats":[{"name":"Ocean","scenery":"Ocean"}]}')},function(t,e,i){(function(e,n){var r,o,s=function(t,e){return function(){return t.apply(e,arguments)}};o=i(4).togglePause,r=function(){function t(){var t;this._handleFire=s(this._handleFire,this),this._handleDown=s(this._handleDown,this),this._handleUp=s(this._handleUp,this),e.bind("GamePause",(t=this,function(e){return e?(t.createMenu(),t.showPlayers()):t.remove()}))}return t.prototype.createMenu=function(){return this._buildMenu([{text:"Resume",execute:function(){return o()}},{text:function(){return e.audio.muted?"Sound [off]":"Sound [on]"},execute:function(){return e.audio.toggleMute(),n.changeSettings({sound:!e.audio.muted})}},{text:"Restart",execute:function(){return o(),n.resetCredits(),e("Player").each((function(){return this.softReset()})),e.enterScene("Game")}},{text:"Quit",execute:function(){return o(),e("Player").each((function(){return this.reset()})),e.enterScene("Intro")}}])},t.prototype._buildMenu=function(t){var i,n,r,o,s,a,h,c,u,l;for(this.options=t,o=e.e("2D, UILayerDOM, Color, PauseMenu").attr({x:.35*e.viewport.width,y:.3*e.viewport.height,w:.3*e.viewport.width,h:32*(this.options.length+2),z:100,alpha:.5}).color("#000000"),l=e.e("2D, UILayerDOM, Text").attr({x:o.x,y:o.y+20,w:o.w,z:110}).text("Game Paused").textColor("#D0D0D0").textAlign("center").textFont({size:"15px",weight:"bold",family:"Press Start 2P"}),o.attach(l),i=n=0,r=(h=this.options).length;n<r;i=++n)a=h[i],s=e.e("2D, UILayerDOM, Text").attr({x:o.x+60,y:o.y+50+35*i,w:o.w-60,z:110}).text(null!=(c="function"==typeof a.text?a.text():void 0)?c:a.text).textColor("#D0D0D0").textAlign("left").textFont({size:"15px",weight:"bold",family:"Press Start 2P"}),o.attach(s),a.entity=s;return this.selected=0,this.selectionChar=e.e("2D, UILayerDOM, Text").attr({x:o.x+20,w:40,z:110}).text(">").textColor("#0000FF").textAlign("left").textFont({size:"15px",weight:"bold",family:"Press Start 2P"}),o.attach(this.selectionChar),this.updateSelection(),u=this,e("Player").each((function(){return this.bind("Up",u._handleUp),this.bind("Down",u._handleDown),this.bind("Fire",u._handleFire)}))},t.prototype._handleUp=function(){return this.selected=(this.options.length+this.selected-1)%this.options.length,this.updateSelection()},t.prototype._handleDown=function(){return this.selected=(this.options.length+this.selected+1)%this.options.length,this.updateSelection()},t.prototype.updateSelection=function(){return this.selectionChar.attr({y:this.options[this.selected].entity.y})},t.prototype._handleFire=function(){return setTimeout((t=this,function(){var e,i;return(i=t.options[t.selected]).execute(),i.entity.text(null!=(e="function"==typeof i.text?i.text():void 0)?e:i.text)}));var t},t.prototype.showPlayers=function(){return e("Player").each((function(){var t,i,n,r,o,s,a,h,c,u,l,d;if(this.ship){for(d=.05,2===this.playerNumber&&(d=.7),"function"==typeof(t=e.e("2D, WebGL, playerShip, ColorEffects, PauseMenu").attr({w:71,h:45,x:(d+.07)*e.viewport.width,y:.3*e.viewport.height+20,z:101}).flip("X")).colorOverride&&t.colorOverride(this.color(),"partial"),u=["Score: "+this.points,"Lives: "+(this.lives-1),"","&nbsp;&nbsp; Speed: &nbsp;&nbsp;&nbsp;&nbsp;+"+this.ship.primaryWeapon.stats.speed,"&nbsp;&nbsp; RapidFire: +"+this.ship.primaryWeapon.stats.rapid,"&nbsp;&nbsp; AimAssist: +"+this.ship.primaryWeapon.stats.aim,"&nbsp;&nbsp; Damage: &nbsp;&nbsp;&nbsp;+"+this.ship.primaryWeapon.stats.damage],l=e.e("2D, WebGL, Color, PauseMenu").attr({x:d*e.viewport.width,y:.3*e.viewport.height,w:.25*e.viewport.width,h:20*(u.length+5),z:100,alpha:.3}).color("#000"),a=[],i=r=0,o=u.length;r<o;i=++r)s=u[i],c=e.e("2D, UILayerDOM, Text").attr({x:l.x+20,y:l.y+85+20*i,w:l.w-60,z:110}).text(s).textColor("#D0D0D0").textAlign("left").textFont({size:"8px",weight:"bold",family:"Press Start 2P"}),l.attach(c),2<i&&i<7?(h=["speedBoost","rapidFireBoost","aimBoost","damageBoost"],n=e.e("2D, WebGL, ColorEffects, PauseMenu").addComponent(h[i-3]).attr({x:l.x+20,y:l.y+82+20*i,w:12,h:12,z:110}).colorOverride("white","partial"),a.push(l.attach(n))):a.push(void 0);return a}}))},t.prototype.remove=function(){var t;return t=this,e("Player").each((function(){return this.unbind("Up",t._handleUp),this.unbind("Down",t._handleDown),this.unbind("Fire",t._handleFire)})),e("PauseMenu").each((function(){return this.destroy()}))},t}(),t.exports=r}).call(this,i(0).default,i(9).default)},function(t,e,i){"use strict";var n=i(159),r=i(161),o=i(92);var s=()=>({setScrollingSpeed:async(t,e)=>{Object(o.b)({vx:-t,vy:e})},setScenery:async t=>{Object(o.a)(t)}}),a=i(169),h=i(6),c=i(170);var u=()=>({spawn:(t,e)=>Object(c.a)(t,e),displayFrame:async(t,e,i,n=h.b)=>{await t.displayFrame(e,i,n)}});i.d(e,"a",(function(){return l}));const l=()=>{const t={...Object(n.a)(),...s(),...Object(a.a)(),...u()};return Object.assign(t,Object(r.a)(t)),t}},function(t,e,i){"use strict";var n=i(27),r=i(6);var o=async({spawn:t,wait:e,until:i,call:o,displayFrame:s,waitWhile:a})=>{const h=t("BattleShip",{location:{rx:-.1,ry:.7},defaultSpeed:85});await e(4e3),await o(h.cabin2.allowDamage,{health:4e3}),await i(async({waitWhile:t})=>{await t(h.cabin2.hasHealth),await o(h.showState,"fase3")},async t=>{await(async({call:t,until:e,displayFrame:i},{ship:o})=>{const s=Object(n.b)([o.hatch1,o.hatch2,o.hatch3]);await i(s,"open",500,r.a),await i(s,"risen",500,r.a);const a=Object(n.a)("PlayerSpaceship");await t(s.turret.aim,{target:a}),await e(async({wait:t})=>{await t(5e3)},async({call:t,wait:e})=>{await t(s.turret.aim,{target:a}),await e(200)}),await t(s.turret.resetAim),await i(s,"open",500,r.a),await i(s,"default",500,r.a)})(t,{ship:h})});const c=h.hatch1;await s(c,"open",500,r.a),await s(c,"risen",500,r.a),await s(c.turret,"up",500,r.a),await o(c.turret.allowDamage,{health:500}),await a(c.turret.hasHealth),await s(c.turret,"default",500,r.a),await s(c,"open",500,r.a),await s(c,"default",500,r.a),await o(h.showState,"fase4"),await e(4e4),h.destroy()};e.a=async({setScrollingSpeed:t,setScenery:e,loadSpriteSheets:i,spawnShip:n,exec:r,wait:s})=>{await i(["city-enemies","city-scenery"]),await t(300,0),await e("City.Ocean"),await n(),await s(3e4),await r(o)}},function(t,e,i){"use strict";i.r(e),function(t,e){i(305),i(308),i(446),i(415),i(437),i(445);t.start(!1);const n=()=>{const t=document.getElementById("cr-stage"),e=t.clientHeight,i=t.clientWidth,n=window.innerHeight-60,r=window.innerWidth,o=n/e,s=r/i,a=Math.min(o,s);t.style.transform=`scale(${a})`;const h=Math.max(0,.5*(r-i*a));t.style.left=`${h}px`,document.getElementsByTagName("footer")[0].style.top=`${576*a}px`};window.addEventListener("resize",n),document.querySelector("button").addEventListener("click",()=>{document.getElementById("theater").requestFullscreen(),document.body.classList.add("fullscreen"),n(),document.addEventListener("fullscreenchange",()=>{document.fullscreenElement||(document.body.classList.remove("fullscreen"),n())})}),setTimeout(n,0),document.getElementById("version").textContent=e.env.VERSION}.call(this,i(9).default,i(49))},function(t,e,i){var n,r;!function t(e,i,n){function o(a,h){if(!i[a]){if(!e[a]){if(!h&&("function"==typeof r&&r))return r(a,!0);if(s)return s(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=i[a]={exports:{}};e[a][0].call(u.exports,(function(t){var i=e[a][1][t];return o(i||t)}),u,u.exports,t,e,i,n)}return i[a].exports}for(var s="function"==typeof r&&r,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(t,e,i){var n,r,o=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function h(t){if(n===setTimeout)return setTimeout(t,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(t){n=s}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var c,u=[],l=!1,d=-1;function f(){l&&c&&(l=!1,c.length?u=c.concat(u):d=-1,u.length&&p())}function p(){if(!l){var t=h(f);l=!0;for(var e=u.length;e;){for(c=u,u=[];++d<e;)c&&c[d].run();d=-1,e=u.length}c=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function y(t,e){this.fun=t,this.array=e}function v(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];u.push(new y(t,e)),1!==u.length||l||h(p)},y.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],2:[function(t,e,i){function n(t,e,i,n){Object.defineProperty(t,e,{enumerable:!1,configurable:!1,get:function(){return i[n]},set:function(t){i[n]=t}})}e.exports={defineAliases:function(t){n(t,"image_whitelist",t,"imageWhitelist"),n(t,"mouseDispatch",t.s("Mouse"),"processEvent"),n(t,"mouseButtonsDown",t.s("Mouse"),"_buttonDown"),n(t,"lastEvent",t.s("Mouse"),"lastMouseEvent"),n(t,"mouseObjs",t.s("Mouse"),"mouseObjs"),n(t,"keyboardDispatch",t.s("Keyboard"),"processEvent"),n(t,"keydown",t.s("Keyboard"),"_keyDown"),n(t,"resetKeyDown",t.s("Keyboard"),"resetKeyDown"),n(t,"touchDispatch",t,"_touchDispatch"),n(t,"touchObjs",t.s("Touch"),"touchObjs"),t.touchHandler={},n(t.touchHandler,"fingers",t.s("Touch"),"touchPoints")}}},{}],3:[function(t,e,i){var n=t("../core/core.js");function r(t){this.button=t}function o(t){this.key=t}function s(t){this.inputs=t}r.prototype={isDown:function(){var t=this.mouseSystem;return t||(this.mouseSystem=t=n.s("Mouse")),t.isButtonDown(this.button)}},o.prototype={isDown:function(){var t=this.keyboardSystem;return t||(this.keyboardSystem=t=n.s("Keyboard")),t.isKeyDown(this.key)}},s.prototype={timeDown:null,isActive:function(){for(var t in this.inputs){if(this.inputs[t].isDown())return this.timeDown||(this.timeDown=Date.now()),!0}return delete this.timeDown,!1},destroy:function(){for(var t in this.inputs)"function"==typeof this.inputs[t].destroy&&this.inputs[t].destroy()}},n.s("Controls",{init:function(){this._dpads={},this._triggers={},n.s("Mouse").bind("MouseDown",this.updateTriggers.bind(this)),n.s("Mouse").bind("MouseUp",this.updateTriggers.bind(this)),n.s("Mouse").bind("DoubleClick",this.updateTriggers.bind(this)),n.s("Mouse").bind("Click",this.updateTriggers.bind(this))},events:{EnterFrame:"runEvents",KeyDown:"updateTriggers",KeyUp:"updateTriggers"},updateTriggers:function(t){for(var e in this._triggers){var i=this._triggers[e];this.updateTriggerInput(i)}},runEvents:function(){for(var t in this._dpads){var e=this._dpads[t];e.oldX=e.x,e.oldY=e.y,this.updateDpadInput(e,e.multipleDirectionBehavior),this.updateActiveDirection(e,e.normalize),e.event.x=e.x,e.event.y=e.y,e.x===e.oldX&&e.y===e.oldY||n.trigger("DirectionalInput",e.event)}},getDpad:function(t){return this._dpads[t]},isTriggerDown:function(t){return this._triggers[t].active},defineTriggerGroup:function(t,e){var i;if(Array.isArray(e))i=e;else{if(i=[],e.mouseButtons)for(var a in e.mouseButtons)i.push(new r(e.mouseButtons[a]));if(e.keys)for(var h in e.keys)i.push(new o(e.keys[h]))}this.destroyTriggerGroup(t),this._triggers[t]={name:t,input:new s(i),downFor:0,active:!1},n.trigger("ControlDefined",{type:"TriggerGroup",name:t})},destroyTriggerGroup:function(t){this._triggers[t]&&(this._triggers[t].input.destroy(),delete this._triggers[t],n.trigger("ControlDestroyed",{type:"TriggerGroup",name:t}))},defineDpad:function(t,e,i){var r={};for(var a in e){var h=e[a],c=n.keys[a]||a;r[h]||(r[h]=[]),r[h].push(new o(c))}var u={};for(var l in r)u[l]={input:new s(r[l]),active:!1,n:this.parseDirection(l)};void 0===i&&(i={}),void 0===i.normalize&&(i.normalize=!1),void 0===i.multipleDirectionBehavior&&(i.multipleDirectionBehavior="all"),this.destroyDpad(t),this._dpads[t]={name:t,directions:u,x:0,y:0,oldX:0,oldY:0,event:{x:0,y:0,name:t},normalize:i.normalize,multipleDirectionBehavior:i.multipleDirectionBehavior},n.trigger("ControlDefined",{type:"Dpad",name:t})},destroyDpad:function(t){if(this._dpads[t]){for(var e in this._dpads[t].parsedDefinition)this._dpads[t].parsedDefinition[e].input.destroy();delete this._dpads[t],n.trigger("ControlDestroyed",{type:"Dpad",name:t})}},parseDirection:function(t){return{x:Math.round(1e3*Math.cos(t*(Math.PI/180)))/1e3,y:Math.round(1e3*Math.sin(t*(Math.PI/180)))/1e3}},updateActiveDirection:function(t,e){var i=0,n=0;for(var r in t.directions){var o=t.directions[r];o.active&&(i+=o.n.x,n+=o.n.y)}if(i=-1e-10<i&&i<1e-10?0:i,n=-1e-10<n&&n<1e-10?0:n,e){var s=Math.sqrt(i*i+n*n);s>0&&(i/=s,n/=s)}t.x=i,t.y=n},updateTriggerInput:function(t){t.active?t.input.isActive()||(t.active=!1,n.trigger("TriggerInputUp",t),t.downFor=0):t.input.isActive()&&(t.downFor=Date.now()-t.input.timeDown,t.active=!0,n.trigger("TriggerInputDown",t))},updateDpadInput:function(t,e){var i,n,r;for(i in t.directions)(n=t.directions[i]).active=!1,n.input.isActive()&&("all"===e?n.active=!0:r?("first"===e&&r.input.timeDown>n.input.timeDown&&(r=n),"last"===e&&r.input.timeDown<n.input.timeDown&&(r=n)):r=n);r&&(r.active=!0)}})},{"../core/core.js":10}],4:[function(t,e,i){var n=t("../core/core.js");n.c("Draggable",{_origX:null,_origY:null,_oldX:null,_oldY:null,_dir:null,required:"MouseDrag",events:{StartDrag:"_startDrag",Dragging:"_drag"},enableDrag:function(){return this.uniqueBind("Dragging",this._drag),this},disableDrag:function(){return this.unbind("Dragging",this._drag),this},dragDirection:function(t){if(void 0===t)this._dir=null;else if(+t===t)this._dir={x:Math.cos(t/180*Math.PI),y:Math.sin(t/180*Math.PI)};else if(0===t.x&&0===t.y)this._dir={x:0,y:0};else{var e=Math.sqrt(t.x*t.x+t.y*t.y);this._dir={x:t.x/e,y:t.y/e}}return this},_startDrag:function(t){this._origX=t.realX,this._origY=t.realY,this._oldX=this._x,this._oldY=this._y},_drag:function(t){if(this._dir){if(0!==this._dir.x||0!==this._dir.y){var e=(t.realX-this._origX)*this._dir.x+(t.realY-this._origY)*this._dir.y;this.x=this._oldX+e*this._dir.x,this.y=this._oldY+e*this._dir.y}}else this.x=this._oldX+(t.realX-this._origX),this.y=this._oldY+(t.realY-this._origY)}}),n.c("Controllable",{init:function(){this._inputBindings={DirectionalInput:{},TriggerInputDown:{},TriggerInputUp:{}}},events:{DirectionalInput:function(t){this._inputBindings.DirectionalInput[t.name]&&this._inputBindings.DirectionalInput[t.name].call(this,t)},TriggerInputDown:function(t){this._inputBindings.TriggerInputDown[t.name]&&this._inputBindings.TriggerInputDown[t.name].call(this,t)},TriggerInputUp:function(t){this._inputBindings.TriggerInputUp[t.name]&&this._inputBindings.TriggerInputUp[t.name].call(this,t)}},linkInput:function(t,e,i){return this._inputBindings[t][e]=i,this},unlinkInput:function(t,e){return delete this._inputBindings[t][e],this},disableControls:!1,enableControl:function(){return this.disableControls=!1,this},disableControl:function(){return this.disableControls=!0,this}}),n.c("Multiway",{_speed:null,init:function(){this.requires("Motion, Controllable"),this._dpadName="MultiwayDpad"+this[0],this._speed={x:150,y:150},this._direction={x:0,y:0}},remove:function(){this.disableControls||(this.vx=this.vy=0),this.unlinkInput("DirectionalInput",this._dpadName),n.s("Controls").destroyDpad(this._dpadName)},events:{UpdateFrame:function(){this.disableControls||(void 0!==this._speed.x&&null!==this._speed.x&&(this.vx=this._speed.x*this._direction.x),void 0!==this._speed.y&&null!==this._speed.y&&(this.vy=this._speed.y*this._direction.y))}},_updateDirection:function(t){this._direction.x=t.x,this._direction.y=t.y},multiway:function(t,e,i){var r=n.s("Controls");return e?this.speed(t):e=t,r.defineDpad(this._dpadName,e,i),this.linkInput("DirectionalInput",this._dpadName,this._updateDirection),this},speed:function(t){return"object"==typeof t?(this._speed.x=t.x,this._speed.y=t.y):(this._speed.x=t,this._speed.y=t),this}}),n.c("Jumper",{_jumpSpeed:300,canJump:!0,init:function(){this.requires("Supportable, Motion, Controllable")},remove:function(){this.unlinkInput("TriggerInputDown",this._jumpTriggerName),n.s("Controls").destroyTriggerGroup(this._jumpTriggerName)},_keydown_jumper:function(t){this.disableControls||this.jump()},jump:function(){var t=this.ground;return this.canJump=!!t,this.trigger("CheckJumping",t),this.canJump&&(this.vy=-this._jumpSpeed),this},jumper:function(t,e){if(e?this._jumpSpeed=t:e=t,this._jumpTriggerName="JumpTrigger"+this[0],Array.isArray(e)){for(var i=[],r=0;r<e.length;++r){var o=e[r],s=n.keys[o]||o;i.push(s)}n.s("Controls").defineTriggerGroup(this._jumpTriggerName,{keys:i})}else n.s("Controls").defineTriggerGroup(this._jumpTriggerName,e);return this.linkInput("TriggerInputDown",this._jumpTriggerName,this._keydown_jumper),this},jumpSpeed:function(t){return this._jumpSpeed=t,this}}),n.c("Fourway",{init:function(){this.requires("Multiway")},fourway:function(t,e){return this.multiway(t||this._speed,{UP_ARROW:-90,DOWN_ARROW:90,RIGHT_ARROW:0,LEFT_ARROW:180,W:-90,S:90,D:0,A:180,Z:-90,Q:180},e),this}}),n.c("Twoway",{init:function(){this.requires("Multiway, Jumper")},twoway:function(t,e){var i=t||this._speed;return this.multiway({x:i},{RIGHT_ARROW:0,LEFT_ARROW:180,D:0,A:180,Q:180}),this.jumper(e||2*t||this._jumpSpeed,[n.keys.UP_ARROW,n.keys.W,n.keys.Z]),this}})},{"../core/core.js":10}],5:[function(t,e,i){var n=t("../core/core.js");n.__keyboardStateTemplate={_keyDown:null,init:function(){this._keyDown={},this.triggerKeyEvent=this.triggerKeyEvent||this.trigger},isKeyDown:function(t){return"string"==typeof t&&(t=n.keys[t]),!!this._keyDown[t]},resetKeyDown:function(){var t={key:-1,eventName:"KeyUp"},e=this._keyDown;for(var i in e)!0===e[i]&&(t.key=+i,this.triggerKey("KeyUp",t));return this},triggerKey:function(t,e){var i=e.key;return"KeyDown"===t?!0!==this._keyDown[i]&&(this._keyDown[i]=!0,this.triggerKeyEvent(t,e)):"KeyUp"===t?!0===this._keyDown[i]&&(this._keyDown[i]=!1,this.triggerKeyEvent(t,e)):this.triggerKeyEvent(t,e),this}},n.c("KeyboardState",n.__keyboardStateTemplate),n.s("Keyboard",n.extend.call({triggerKeyEvent:function(t,e){n.trigger(t,e)}},n.__keyboardStateTemplate),{},!1)},{"../core/core.js":10}],6:[function(t,e,i){t("../core/core.js").extend({keys:{BACKSPACE:8,TAB:9,ENTER:13,PAUSE:19,CAPS:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,MULTIPLY:106,ADD:107,SUBSTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SHIFT:16,CTRL:17,ALT:18,PLUS:187,COMMA:188,MINUS:189,PERIOD:190,PULT_UP:29460,PULT_DOWN:29461,PULT_LEFT:4,PULT_RIGHT:5},mouseButtons:{LEFT:0,MIDDLE:1,RIGHT:2}})},{"../core/core.js":10}],7:[function(t,e,i){var n=t("../core/core.js");n.__mouseStateTemplate={_buttonDown:null,lastMouseEvent:null,init:function(){this._buttonDown={},this.triggerMouseEvent=this.triggerMouseEvent||this.trigger,this.lastMouseEvent={eventName:"",mouseButton:-1,target:null,realX:0,realY:0,clientX:0,clientY:0,originalEvent:null}},isButtonDown:function(t){return"string"==typeof t&&(t=n.mouseButtons[t]),!!this._buttonDown[t]},resetButtonDown:function(){var t=this.lastMouseEvent,e=this._buttonDown;for(var i in e)!0===e[i]&&(t.mouseButton=+i,t.eventName="MouseUp",this.triggerMouse("MouseUp",t));return this},triggerMouse:function(t,e){var i=this.lastMouseEvent;i.eventName=t,i.mouseButton=e.mouseButton,i.target=e.target,i.realX=e.realX,i.realY=e.realY,i.clientX=e.clientX,i.clientY=e.clientY,i.originalEvent=e.originalEvent;var n=e.mouseButton;return"MouseDown"===t?!0!==this._buttonDown[n]&&(this._buttonDown[n]=!0,this.triggerMouseEvent(t,e)):"MouseUp"===t?!0===this._buttonDown[n]&&(this._buttonDown[n]=!1,this.triggerMouseEvent(t,e)):this.triggerMouseEvent(t,e),this}},n.c("MouseState",n.__mouseStateTemplate),n.s("Mouse",n.extend.call({triggerMouseEvent:function(t,e){n.trigger(t,e)}},n.__mouseStateTemplate),{},!1)},{"../core/core.js":10}],8:[function(t,e,i){var n=t("../core/core.js");n.__touchStateTemplate={touchPoints:null,_touchPointsPool:null,init:function(){this.touchPoints=[],this._touchPointsPool=[],this.triggerTouchEvent=this.triggerTouchEvent||this.trigger},resetTouchPoints:function(){for(var t,e=this.touchPoints,i=e.length;i--;)(t=e[i]).eventName="TouchCancel",this.triggerTouch("TouchCancel",t);return this},triggerTouch:function(t,e){switch(t){case"TouchStart":this._handleStart(e);break;case"TouchMove":this._handleMove(e);break;case"TouchCancel":case"TouchEnd":this._handleEnd(e);break;default:this.triggerTouchEvent(t,e)}return this},_indexOfTouchPoint:function(t){for(var e=this.touchPoints,i=0,n=e.length;i<n;i++)if(e[i].identifier===t)return i;return-1},_setTouchPoint:function(t,e){t.eventName=e.eventName,t.identifier=e.identifier,t.target=e.target,t.entity=e.entity,t.realX=e.realX,t.realY=e.realY,t.originalEvent=e.originalEvent},_handleStart:function(t){var e=this._indexOfTouchPoint(t.identifier);if(!(e>=0?this.touchPoints[e]:null)){var i=this._touchPointsPool.pop()||{};this._setTouchPoint(i,t),this.touchPoints.push(i),this.triggerTouchEvent(i.eventName,i)}},_handleMove:function(t){var e=this._indexOfTouchPoint(t.identifier),i=e>=0?this.touchPoints[e]:null;i&&(this._setTouchPoint(i,t),this.triggerTouchEvent(i.eventName,i))},_handleEnd:function(t){var e=this._indexOfTouchPoint(t.identifier),i=e>=0?this.touchPoints[e]:null;i&&(this._setTouchPoint(i,t),this.triggerTouchEvent(i.eventName,i),this.touchPoints.splice(e,1),i.target=null,i.entity=null,i.originalEvent=null,this._touchPointsPool.push(i))}},n.c("TouchState",n.__touchStateTemplate),n.s("Touch",n.extend.call({triggerTouchEvent:function(t,e){n.trigger(t,e)}},n.__touchStateTemplate),{},!1)},{"../core/core.js":10}],9:[function(t,e,i){var n=t("../core/core.js"),r=function(t,e){this.timePerFrame=1e3/n.timer.FPS(),this.duration=t,"function"==typeof e?this.easing_function=e:"string"==typeof e&&this.standardEasingFunctions[e]?this.easing_function=this.standardEasingFunctions[e]:this.easing_function=this.standardEasingFunctions.linear,this.reset()};r.prototype={duration:0,clock:0,steps:null,complete:!1,paused:!1,reset:function(){this.loops=1,this.clock=0,this.complete=!1,this.paused=!1},repeat:function(t){this.loops=t},setProgress:function(t,e){this.clock=this.duration*t,void 0!==e&&(this.loops=e)},pause:function(){this.paused=!0},resume:function(){this.paused=!1,this.complete=!1},tick:function(t){if(!this.paused&&!this.complete)for(this.clock+=t,this.frames=Math.floor(this.clock/this.timePerFrame);this.clock>=this.duration&&!1===this.complete;)this.loops--,this.loops>0?this.clock-=this.duration:this.complete=!0},time:function(){return Math.min(this.clock/this.duration,1)},value:function(){return this.easing_function(this.time())},standardEasingFunctions:{linear:function(t){return t},smoothStep:function(t){return(3-2*t)*t*t},smootherStep:function(t){return(6*t*t-15*t+10)*t*t*t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<.5?2*t*t:(4-2*t)*t-1}}},e.exports=r},{"../core/core.js":10}],10:[function(t,e,i){var r,o,s,a,h,c,u,l,d,f=t("./version"),p=function(t){return new p.fn.init(t)};s={},u=Array.prototype.slice,l=/\s*,\s*/,d=/\s+/;var y,v,g,_,m,b,x,w,C,S,D,k,P=function(){r=1,o=0,a={},c={},h={},[]};function T(){var t=r++;return t in a?T():t}P(),p.fn=p.prototype={init:function(t){if("string"!=typeof t)return t||(t=0)in a||(a[t]=this),t in a?(this[0]=t,this.length=1,this.__c||(this.__c={}),this._callbacks||p._addCallbackMethods(this),a[t]||(a[t]=this),a[t]):(this.length=0,this);var e,i,n,r,o,s,h,u,f,y=0,v=!1,g=!1;if("*"===t){for(e in u=0,a)this[u]=+e,u++;return this.length=u,1===u?a[this[0]]:this}if(-1!==t.indexOf(",")?(g=!0,i=l):-1!==t.indexOf(" ")&&(v=!0,i=d),g){for(r={},u=0,f=(n=t.split(i)).length;u<f;u++)for(h in o=c[n[u]])r[h]=+h;for(h in r)this[y++]=r[h]}else if(v){for(h in n=t.split(i),r={},o=c[n[0]],s=c[n[1]],o)void 0!==s[h]&&(r[h]=+h);for(u=2,f=n.length;u<f;u++)for(h in o=c[n[u]],r)void 0===o[h]&&(r[h]=-1);for(h in r)(u=r[h])>=0&&(this[y++]=u)}else for(h in o=c[t])this[y++]=+h;return this.length=y,1===y?a[this[y-1]]:(p._addCallbackMethods(this),this)},setName:function(t){var e=String(t);return this._entityName=e,this.trigger("NewEntityName",e),this},getName:function(t){return this._entityName},addComponent:function(t){var e,i,n,r=0;for(e=1===arguments.length&&-1!==t.indexOf(",")?t.split(l):arguments;r<e.length;r++)if(i=e[r],!0!==this.__c[i]){if(this.__c[i]=!0,(c[i]=c[i]||{})[this[0]]=this,n=s[i],this.extend(n),n&&"required"in n&&this.requires(n.required),n&&"properties"in n){var o=n.properties;for(var a in o)Object.defineProperty(this,a,o[a])}if(n&&"events"in n){var h=n.events;for(var u in h){var d="function"==typeof h[u]?h[u]:n[h[u]];this.bind(u,d)}}n&&"init"in n&&n.init.call(this)}return this.trigger("NewComponent",e),this},toggleComponent:function(t){var e,i,n=0;if(arguments.length>1)for(e=arguments.length;n<e;n++)this.has(arguments[n])?this.removeComponent(arguments[n]):this.addComponent(arguments[n]);else if(-1!==t.indexOf(","))for(e=(i=t.split(l)).length;n<e;n++)this.has(i[n])?this.removeComponent(i[n]):this.addComponent(i[n]);else this.has(t)?this.removeComponent(t):this.addComponent(t);return this},requires:function(){return this.addComponent.apply(this,arguments)},removeComponent:function(t,e){var i=s[t];if(this.trigger("RemoveComponent",t),i&&"events"in i){var n=i.events;for(var r in n){var o="function"==typeof n[r]?n[r]:i[n[r]];this.unbind(r,o)}}if(i&&"remove"in i&&i.remove.call(this,!1),!1===e&&i)for(var a in i)delete this[a];return delete this.__c[t],c[t]&&delete c[t][this[0]],this},getId:function(){return this[0]},has:function(t){return!!this.__c[t]},attr:function(t,e,i,n){return 1===arguments.length&&"string"==typeof arguments[0]?this._attr_get(t):this._attr_set(t,e,i,n)},_attr_get:function(t,e){var i,n;return null==e&&(e=this),t.indexOf(".")>-1?(i=(n=t.split(".")).shift(),n.join("."),this._attr_get(n.join("."),e[i])):e[t]},_attr_set:function(){var t,e,i;return"string"==typeof arguments[0]?(t=this._set_create_object(arguments[0],arguments[1]),e=!!arguments[2],i=arguments[3]||arguments[0].indexOf(".")>-1):(t=arguments[0],e=!!arguments[1],i=!!arguments[2]),e||this.trigger("Change",t),i?this._recursive_extend(t,this):this.extend.call(this,t),this},_set_create_object:function(t,e){var i,n,r,o={};return t.indexOf(".")>-1?(n=(i=t.split(".")).shift(),r=i.join("."),o[n]=this._set_create_object(r,e)):o[t]=e,o},_recursive_extend:function(t,e){var i;for(i in t)t[i].constructor===Object?e[i]=this._recursive_extend(t[i],e[i]):e[i]=t[i];return e},toArray:function(){return u.call(this,0)},timeout:function(t,e){return this.each((function(){var i=this;setTimeout((function(){t.call(i)}),e)})),this},bind:function(t,e){if(1===this.length)this._bindCallback(t,e);else for(var i=0;i<this.length;i++){var n=a[this[i]];n&&n._bindCallback(t,e)}return this},uniqueBind:function(t,e){this.unbind(t,e),this.bind(t,e)},one:function(t,e){var i=this,n=function(r){e.call(i,r),i.unbind(t,n)};return i.bind(t,n)},unbind:function(t,e){var i,n;for(i=0;i<this.length;i++)(n=a[this[i]])&&n._unbindCallbacks(t,e);return this},trigger:function(t,e){if(1===this.length)this._runCallbacks(t,e);else for(var i=0;i<this.length;i++){var n=a[this[i]];n&&n._runCallbacks(t,e)}return this},each:function(t){for(var e=0,i=this.length;e<i;e++)a[this[e]]&&t.call(a[this[e]],e);return this},get:function(t){var e=this.length;if(void 0!==t){if(t>=e||t+e<0)return;return t>=0?a[this[t]]:a[this[t+e]]}for(var i=0,n=[];i<e;i++)a[this[i]]&&n.push(a[this[i]]);return n},clone:function(){var t,e,i=this.__c,n=p.e();for(t in i)n.addComponent(t);for(e in this)"0"!==e&&"_global"!==e&&"_changed"!==e&&"function"!=typeof this[e]&&"object"!=typeof this[e]&&(n[e]=this[e]);return n},setter:function(t,e){return this.defineField(t,(function(){}),e)},defineField:function(t,e,i){return p.defineField(this,t,e,i),this},destroy:function(){this.each((function(){var t;for(var e in this.trigger("Remove"),this.__c)(t=s[e])&&"remove"in t&&t.remove.call(this,!0),delete c[e][this[0]];this._unbindAll(),delete a[this[0]]}))},freeze:function(){if(1!==this.length||this.__frozen)for(var t=0;t<this.length;t++){var e=a[this[t]];e&&!e.__frozen&&(e.trigger("Freeze",e),e._freezeCallbacks(),e.__frozen=!0)}else this.trigger("Freeze",this),this._freezeCallbacks(),this.__frozen=!0;return this},unfreeze:function(){if(1===this.length&&this.__frozen)this.__frozen=!1,this._unfreezeCallbacks(),this.trigger("Unfreeze",this);else for(var t=0;t<this.length;t++){var e=a[this[t]];e&&e.__frozen&&(e.__frozen=!1,e._unfreezeCallbacks(),e.trigger("Unfreeze",e))}return this}},p.fn.init.prototype=p.fn,p.extend=p.fn.extend=function(t){var e;if(!t)return this;for(e in t)this!==t[e]&&(this[e]=t[e]);return this},p._callbackMethods={_bindCallback:function(t,e){var i=this._callbacks[t];i||((i=this._callbacks[t]=(h[t]||(h[t]={}))[this[0]]=[]).context=this,i.depth=0),i.push(e)},_runCallbacks:function(t,e){if(this._callbacks[t]&&!this.__callbacksFrozen){var i,n=this._callbacks[t],r=n.length;for(n.depth++,i=0;i<r;i++)void 0===n[i]?n.depth<=1&&(n.splice(i,1),i--,r--,0===n.length&&(delete this._callbacks[t],delete h[t][this[0]])):n[i].call(this,e);n.depth--}},_unbindCallbacks:function(t,e){if(this._callbacks[t])for(var i=this._callbacks[t],n=0;n<i.length;n++)e&&i[n]!==e||delete i[n]},_unbindAll:function(){if(this._callbacks)for(var t in this.__callbacksFrozen=!1,this._callbacks)this._callbacks[t]&&(this._unbindCallbacks(t),delete h[t][this[0]])},_freezeCallbacks:function(){if(this._callbacks){for(var t in this._callbacks)this._callbacks[t]&&delete h[t][this[0]];this.__callbacksFrozen=!0}},_unfreezeCallbacks:function(){if(this._callbacks)for(var t in this.__callbacksFrozen=!1,this._callbacks)this._callbacks[t]&&(h[t][this[0]]=this._callbacks[t])}},p._addCallbackMethods=function(t){t.extend(p._callbackMethods),t._callbacks={}},p._addCallbackMethods(p),p.extend({0:"global",init:function(t,e,i){if(!this._preBindDone)for(var n=0;n<this._bindOnInit.length;n++){var r=this._bindOnInit[n];p.bind(r.event,r.handler)}return p.viewport.init(t,e,i),this.trigger("Load"),this.timer.init(),this},initAsync:function(t,e,i,n){"object"!=typeof t&&(n=i,i=e,e=t,t=[]);var r=[];for(var o in t)"function"==typeof t[o]?r.push(t[o](p)):r.push(t[o]);if("complete"!==document.readyState)var s=new Promise((function(t,e){window.onload=t,r.push(s)}));return Promise.all(r).then((function(r){return p.init(e,i,n),r.slice(0,t.length)}))},_bindOnInit:[],_preBindDone:!1,_preBind:function(t,e){this._bindOnInit.push({event:t,handler:e})},getVersion:function(){return f},stop:function(t){if(p.trigger("CraftyStop",t),this.timer.stop(),t){for(var e in p.audio.remove(),p._systems)p._systems[e].destroy();if(p.stage&&p.stage.elem.parentNode){var i=document.createElement("div");i.id=p.stage.elem.id,p.stage.elem.parentNode.replaceChild(i,p.stage.elem)}p._unbindAll(),p._addCallbackMethods(p),this._preBindDone=!1,P()}return this},pause:function(t){return(1===arguments.length?t:!this._paused)?(this.trigger("Pause"),this._paused=!0,setTimeout((function(){p.timer.stop()}),0)):(this.trigger("Unpause"),this._paused=!1,setTimeout((function(){p.timer.init()}),0)),this},isPaused:function(){return this._paused},timer:(b="fixed",x=5,w=40,C=0,S=0,D=50,k=1e3/D,{init:function(){void 0===m&&(m=Date.now()-k);var t="undefined"!=typeof window&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||null);t?(g=function(){p.timer.step(),null!==g&&(_=t(g))})():g=setInterval((function(){p.timer.step()}),1e3/D)},stop:function(){p.trigger("CraftyStopTimer"),"function"!=typeof g&&clearInterval(g);var t="undefined"!=typeof window&&(window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||null);t&&t(_),g=null},steptype:function(t,e){if("variable"===t||"semifixed"===t)b=t,e&&(w=e),p.trigger("NewSteptype",{mode:b,maxTimeStep:w});else{if("fixed"!==t){if(void 0!==t)throw"Invalid step type specified";return{mode:b,maxTimeStep:"variable"===b||"semifixed"===b?w:x}}b="fixed",e&&(x=e),p.trigger("NewSteptype",{mode:b,maxTimeStep:x})}},step:function(){var t,e,i,n=0,r=Date.now();if(C>0&&p.trigger("MeasureWaitTime",r-C),m+S>=r)C=r;else{var s=r-(m+S);s>20*k&&(S+=s-k,s=k),"fixed"===b?(n=Math.ceil(s/k),n=Math.min(n,x),e=k):"variable"===b?(n=1,e=s,e=Math.min(e,w)):"semifixed"===b&&(e=s/(n=Math.ceil(s/w)));for(var a=0;a<n;a++){i=r;var h={frame:o++,dt:e,gameTime:m};p.trigger("EnterFrame",h),p.trigger("UpdateFrame",h),p.trigger("ExitFrame",h),m+=e,r=Date.now(),p.trigger("MeasureFrameTime",r-i)}n>0&&(t=r,p.trigger("PreRender"),p.trigger("RenderScene"),p.trigger("PostRender"),r=Date.now(),p.trigger("MeasureRenderTime",r-t)),C=r}},FPS:function(t){if(void 0===t)return D;k=1e3/(D=t),p.trigger("FPSChange",t)},simulateFrames:function(t,e){for(e=e||k;t-- >0;){var i={frame:o++,dt:e};p.trigger("EnterFrame",i),p.trigger("UpdateFrame",i),p.trigger("ExitFrame",i)}p.trigger("PreRender"),p.trigger("RenderScene"),p.trigger("PostRender")}}),e:function(){var t=T();return a[t]=null,a[t]=p(t),arguments.length>0&&a[t].addComponent.apply(a[t],arguments),a[t].setName("Entity #"+t),a[t].addComponent("obj"),p.trigger("NewEntity",{id:t}),a[t]},c:function(t,e){s[t]=e},trigger:function(t,e){var i,n,r=h[t]||(h[t]={});for(i in r)r.hasOwnProperty(i)&&(n=r[i])&&0!==n.length&&n.context._runCallbacks(t,e)},bind:function(t,e){return this._bindCallback(t,e),e},uniqueBind:function(t,e){return this.unbind(t,e),this.bind(t,e)},one:function(t,e){var i=this,n=function(r){e.call(i,r),i.unbind(t,n)};return i.bind(t,n)},unbind:function(t,e){this._unbindCallbacks(t,e)},frame:function(){return o},entities:function(){return a},components:function(){return s},isComp:function(t){return t in s},debug:function(t){return"handlers"===t?h:a},settings:(y={},v={},{register:function(t,e){v[t]=e},modify:function(t,e){v[t]&&(v[t].call(y[t],e),y[t]=e)},get:function(t){return y[t]}}),defineField:function(t,e,i,n){Object.defineProperty(t,e,{get:i,set:n,configurable:!1,enumerable:!0})},clone:function t(e){if(null===e||"object"!=typeof e)return e;var i=e.constructor();for(var n in e)i[n]=t(e[n]);return i}}),void 0===(n=function(){return p}.apply(i,[]))||(e.exports=n),e.exports=p},{"./version":20}],11:[function(t,e,i){(function(e){var i=t("../core/core.js"),n="undefined"!=typeof window&&window.document;!function(){var t=i.support={},r="undefined"!=typeof navigator&&navigator.userAgent.toLowerCase()||void 0!==e&&e.version,o=/(webkit)[ \/]([\w.]+)/.exec(r)||/(o)pera(?:.*version)?[ \/]([\w.]+)/.exec(r)||/(ms)ie ([\w.]+)/.exec(r)||/(moz)illa(?:.*? rv:([\w.]+))?/.exec(r)||/(v)\d+\.(\d+)/.exec(r)||[],s=/iPad|iPod|iPhone|Android|webOS|IEMobile/i.exec(r);if(s&&(i.mobile=s[0]),t.defineProperty=function(){if(!("defineProperty"in Object))return!1;try{Object.defineProperty({},"x",{})}catch(t){return!1}return!0}(),t.audio="undefined"!=typeof window&&"canPlayType"in n.createElement("audio"),t.prefix=o[1]||o[0],"moz"===t.prefix&&(t.prefix="Moz"),"o"===t.prefix&&(t.prefix="O"),"v"===t.prefix&&(t.prefix="node"),o[2]&&(t.versionName=o[2],t.version=+o[2].split(".")[0]),t.canvas="undefined"!=typeof window&&"getContext"in n.createElement("canvas"),t.canvas){var a;try{var h=n.createElement("canvas");(a=h.getContext("webgl")||h.getContext("experimental-webgl")).viewportWidth=t.canvas.width,a.viewportHeight=t.canvas.height}catch(t){}t.webgl=!!a}else t.webgl=!1;t.css3dtransform="undefined"!=typeof window&&(void 0!==n.createElement("div").style.Perspective||void 0!==n.createElement("div").style[t.prefix+"Perspective"]),t.deviceorientation="undefined"!=typeof window&&(void 0!==window.DeviceOrientationEvent||void 0!==window.OrientationEvent),t.devicemotion="undefined"!=typeof window&&void 0!==window.DeviceMotionEvent}()}).call(this,t("_process"))},{"../core/core.js":10,_process:1}],12:[function(t,e,i){var n=t("../core/core.js"),r=t("./utility");e.exports={assets:{},__paths:{audio:"",images:""},paths:function(t){if(void 0===t)return this.__paths;t.audio&&(this.__paths.audio=t.audio),t.images&&(this.__paths.images=t.images)},asset:function(t,e){return 1===arguments.length?n.assets[t]:n.assets[t]?void 0:(n.assets[t]=e,this.trigger("NewAsset",{key:t,value:e}),e)},imageWhitelist:["jpg","jpeg","gif","png","svg"],load:function(t,e,i,o){if(Array.isArray(t))n.log("Calling Crafty.load with an array of assets no longer works; see the docs for more details.");else{t="string"==typeof t?JSON.parse(t):t;var s,a,h,c,u,l,d=0,f=(t.audio?Object.keys(t.audio).length:0)+(t.images?Object.keys(t.images).length:0)+(t.sprites?Object.keys(t.sprites).length:0),p=n.paths(),y=function(t,e){return-1===e.search("://")?"audio"===t?p.audio+e:p.images+e:e},v=function(t){return n.asset(t)||null},g=function(t){return"data"===r.fileTypeOf(t).schema?URL.createObjectURL(r.toBlob(t)):t},_=function(t,e){t.onload=b,"webkit"===n.support.prefix&&(t.src=""),t.src=e};for(c in t)for(u in t[c])if(t[c].hasOwnProperty(u)){if(s=t[c][u],h=null,"audio"===c){s="object"==typeof s?s:{"":s+""};var m=Object.keys(s).filter((function(t){var e,i=y(c,s[t]);if(!v(i)&&(e=s[t],n.support.audio&&n.audio.supports(r.fileTypeOf(e).type))&&!n.audio.sounds[u])return g(i)}));m[0]&&(h=n.audio.add(u,m)),h&&(h=h.obj),h&&h.addEventListener&&h.addEventListener("canplaythrough",b,!1)}else a=y(c,u="sprites"===c?u:s),!v(a)&&(l=u,-1<n.imageWhitelist.indexOf(r.fileTypeOf(l).type))&&(h=new Image,a=g(a),"sprites"===c&&n.sprite(s.tile,s.tileh,a,s.map,s.paddingX,s.paddingY,s.paddingAroundBorder),n.asset(a,h),_(h,a));h?h.onerror=x:x.call({src:a})}0===f&&e&&e()}function b(){var t=this.src;this.removeEventListener&&this.removeEventListener("canplaythrough",b,!1),d++,i&&i({loaded:d,total:f,percent:d/f*100,src:t}),d===f&&e&&e()}function x(){var t=this.src;o&&o({loaded:d,total:f,percent:d/f*100,src:t}),++d===f&&e&&e()}},removeAssets:function(t){t="string"==typeof t?JSON.parse(t):t;var e,i,r,o,s=n.paths(),a=function(t,e){return-1===e.search("://")?"audio"===t?s.audio+e:s.images+e:e};for(r in t)for(o in t[r])if(t[r].hasOwnProperty(o))if(e=t[r][o],"audio"===r)if("object"==typeof e)for(var h in e)i=a(r,e[h]),n.asset(i)&&n.audio.remove(o);else"string"==typeof e&&(i=a(r,e),n.asset(i)&&n.audio.remove(o));else if(i=a(r,o="sprites"===r?o:e),n.asset(i)){if("sprites"===r)for(var c in e.map)delete n.components()[c];delete n.assets[i]}}}},{"../core/core.js":10,"./utility":19}],13:[function(t,e,i){var n=t("../core/core.js");e.exports={init:function(){this.changed=[],this.bind("Change",this._changed_attributes),this.bind("Change",this._changed_triggers)},_changed_triggers:function(t,e){var i;for(i in e=n.extend.call({pre:""},e),t)this.trigger("Change["+e.pre+i+"]",t[i]),t[i].constructor===Object&&this._changed_triggers(t[i],{pre:e.pre+i+"."})},_changed_attributes:function(t){var e;for(e in t)this.changed.push(e);return this},is_dirty:function(t){return 0===arguments.length?!!this.changed.length:this.changed.indexOf(t)>-1}}},{"../core/core.js":10}],14:[function(t,e,i){var n=t("../core/core.js");e.exports={_scenes:{},_current:null,scene:function(t,e,i){1!==arguments.length&&"function"==typeof arguments[1]?n.defineScene(t,e,i):n.enterScene(t,arguments[1])},defineScene:function(t,e,i){if("function"!=typeof e)throw"Init function is the wrong type.";this._scenes[t]={},this._scenes[t].initialize=e,void 0!==i&&(this._scenes[t].uninitialize=i)},enterScene:function(t,e){if("function"==typeof e)throw"Scene data cannot be a function";n.trigger("SceneDestroy",{newScene:t}),n.viewport.reset(),n("2D").each((function(){this.has("Persist")||this.destroy()})),null!==this._current&&"uninitialize"in this._scenes[this._current]&&this._scenes[this._current].uninitialize.call(this);var i=this._current;this._current=t,n.trigger("SceneChange",{oldScene:i,newScene:t}),this._scenes.hasOwnProperty(t)?this._scenes[t].initialize.call(this,e):n.error('The scene "'+t+'" does not exist')}}},{"../core/core.js":10}],15:[function(t,e,i){var n=t("../core/core.js");try{var r="undefined"!=typeof window&&window.localStorage||new t("node-localstorage").LocalStorage("./localStorage")}catch(t){r=null}var o=function(t,e){var i=e;if(!r)return n.error("Local storage is not accessible.  (Perhaps you are including crafty.js cross-domain?)"),!1;if(1===arguments.length)try{return JSON.parse(r.getItem(t))}catch(e){return r.getItem(t)}else"object"==typeof e&&(i=JSON.stringify(e)),r.setItem(t,i)};o.remove=function(t){r?r.removeItem(t):n.error("Local storage is not accessible.  (Perhaps you are including crafty.js cross-domain?)")},e.exports=o},{"../core/core.js":10}],16:[function(t,e,i){var n,r=t("../core/core.js");r._systems={},r.s=function(t,e,i,n){if(!e)return r._systems[t];"boolean"==typeof i&&(n=i,i=null),!1===n?(r._systems[t]=new r.CraftySystem(t,e,i),r.trigger("SystemLoaded",t)):r._registerLazySystem(t,e,i)},r._registerLazySystem=function(t,e,i){Object.defineProperty(r._systems,t,{get:function(){return Object.defineProperty(r._systems,t,{value:new r.CraftySystem(t,e,i),writable:!0,enumerable:!0,configurable:!0}),r.trigger("SystemLoaded",t),r._systems[t]},configurable:!0})},r.CraftySystem=(n=1,function(t,e,i){if(this.name=t,!e)return this;if(this._systemTemplate=e,this.extend(e),this.options=function(t,e){var i={};for(var n in e)i[n]=e[n];for(n in t)n in e||(i[n]=t[n]);return i}(this.options,i),r._addCallbackMethods(this),this[0]="system"+n++,"properties"in e){var o=e.properties;for(var s in o)Object.defineProperty(this,s,o[s])}if("events"in e){var a=e.events;for(var h in a){var c="function"==typeof a[h]?a[h]:e[a[h]];this.bind(h,c)}}"function"==typeof this.init&&this.init(t)}),r.CraftySystem.prototype={extend:function(t){for(var e in t)void 0===this[e]&&(this[e]=t[e])},bind:function(t,e){return this._bindCallback(t,e),this},trigger:function(t,e){return this._runCallbacks(t,e),this},unbind:function(t,e){return this._unbindCallbacks(t,e),this},one:function(t,e){var i=this,n=function(r){e.call(i,r),i.unbind(t,n)};return i.bind(t,n)},uniqueBind:function(t,e){return this.unbind(t,e),this.bind(t,e)},destroy:function(){r.trigger("SystemDestroyed",this),"function"==typeof this.remove&&this.remove(),this._unbindAll(),delete r._systems[this.name]}}},{"../core/core.js":10}],17:[function(t,e,i){e.exports={delaySpeed:1,init:function(){this._delays=[],this._delaysPaused=!1,this.bind("UpdateFrame",(function(t){if(!this._delaysPaused)for(var e=this._delays.length;--e>=0;){var i=this._delays[e];if(!1===i)this._delays.splice(e,1);else{for(i.accumulator+=t.dt*this.delaySpeed;i.accumulator>=i.delay&&i.repeat>=0;)i.accumulator-=i.delay,i.repeat--,i.callback.call(this);i.repeat<0&&(this._delays.splice(e,1),"function"==typeof i.callbackOff&&i.callbackOff.call(this))}}}))},delay:function(t,e,i,n){return this._delays.push({accumulator:0,callback:t,callbackOff:n,delay:e,repeat:(i<0?1/0:i)||0}),this},cancelDelay:function(t){for(var e=this._delays.length;--e>=0;){var i=this._delays[e];i&&i.callback===t&&(this._delays[e]=!1)}return this},pauseDelays:function(){this._delaysPaused=!0},resumeDelays:function(){this._delaysPaused=!1}}},{}],18:[function(t,e,i){var n=t("../core/core.js");e.exports={tweenSpeed:1,init:function(){this.tweenGroup={},this.tweenStart={},this.tweens=[],this.uniqueBind("UpdateFrame",this._tweenTick)},_tweenTick:function(t){var e,i,n;for(n=this.tweens.length-1;n>=0;n--)(e=this.tweens[n]).easing.tick(t.dt*this.tweenSpeed),i=e.easing.value(),this._doTween(e.props,i),e.easing.complete&&(this.tweens.splice(n,1),this._endTween(e.props))},_doTween:function(t,e){for(var i in t)this[i]=(1-e)*this.tweenStart[i]+e*t[i]},tween:function(t,e,i){var r={props:t,easing:new n.easing(e,i)};for(var o in t)void 0!==this.tweenGroup[o]&&this.cancelTween(o),this.tweenStart[o]=this[o],this.tweenGroup[o]=t;return this.tweens.push(r),this},cancelTween:function(t){if("string"==typeof t)"object"==typeof this.tweenGroup[t]&&delete this.tweenGroup[t][t];else if("object"==typeof t)for(var e in t)this.cancelTween(e);return this},pauseTweens:function(){this.tweens.map((function(t){t.easing.pause()}))},resumeTweens:function(){this.tweens.map((function(t){t.easing.resume()}))},_endTween:function(t){var e=!1;for(var i in t)e=!0,delete this.tweenGroup[i];e&&this.trigger("TweenEnd",t)}}},{"../core/core.js":10}],19:[function(t,e,i){i.blobOf=function(t){var e=new XMLHttpRequest;return e.responseType="blob",e.open("GET",t),new Promise((function(t,i){e.onload=function(){t(this.response)},e.onerror=i,e.send()}))};var n=/^data:(.+?\/(.+?))?(;base64)?,(\S+)/;i.fileTypeOf=function(t){var e=/^(?:(\w+):)?.+?(?:\.(\w+))?$/.exec(t);switch(e[1]){case"data":return{schema:"data",type:n.exec(t)[2]};case"blob":return i.blobOf(t).then((function(t){return{schema:"blob",type:t.type}}));default:return{schema:e[1],type:e[2]}}};var r=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;i.toBlob=function(t){var e=(t=n.exec(t))[1],i=t[3],o=t[4];o=i?window.atob(o):o;for(var s=new ArrayBuffer(o.length),a=new Uint8Array(s),h=0;o[h];h++)a[h]=o.charCodeAt(h);if(!r)return new window.Blob([s],{type:e});var c=new r;return c.append(s),c.getBlob(e)}},{}],20:[function(t,e,i){e.exports="0.8.0"},{}],21:[function(t,e,i){e.exports=function(e){e&&(t=e);var i=t("./core/core");t("./core/extensions"),i.easing=t("./core/animation"),i.c("Model",t("./core/model")),i.extend(t("./core/scenes")),i.storage=t("./core/storage"),i.c("Delay",t("./core/time")),i.c("Tween",t("./core/tween"));var n=t("./spatial/spatial-grid");return i.HashMap=n,i.map=new n,t("./core/systems"),t("./spatial/2d"),t("./spatial/motion"),t("./spatial/platform"),t("./spatial/collision"),t("./spatial/rect-manager"),t("./spatial/math"),t("./controls/controls-system"),t("./controls/controls"),t("./controls/keyboard"),t("./controls/keycodes"),t("./controls/mouse"),t("./controls/touch"),t("./debug/logging"),i}},{"./controls/controls":4,"./controls/controls-system":3,"./controls/keyboard":5,"./controls/keycodes":6,"./controls/mouse":7,"./controls/touch":8,"./core/animation":9,"./core/core":10,"./core/extensions":11,"./core/model":13,"./core/scenes":14,"./core/storage":15,"./core/systems":16,"./core/time":17,"./core/tween":18,"./debug/logging":24,"./spatial/2d":55,"./spatial/collision":56,"./spatial/math":57,"./spatial/motion":58,"./spatial/platform":59,"./spatial/rect-manager":60,"./spatial/spatial-grid":61}],22:[function(t,e,i){var n=t("./crafty-common.js")();n.extend(t("./core/loader")),n.extend(t("./inputs/dom-events")),t("./graphics/layers"),t("./graphics/canvas"),t("./graphics/canvas-layer"),t("./graphics/webgl"),t("./graphics/webgl-layer"),t("./graphics/color"),t("./graphics/dom"),t("./graphics/dom-helper"),t("./graphics/dom-layer"),t("./graphics/drawing"),t("./graphics/gl-textures"),t("./graphics/renderable"),t("./graphics/html"),t("./graphics/image"),t("./graphics/particles"),t("./graphics/sprite-animation"),t("./graphics/sprite"),t("./graphics/text"),t("./graphics/viewport"),t("./isometric/diamond-iso"),t("./isometric/isometric"),t("./inputs/util"),t("./inputs/device"),t("./inputs/keyboard"),t("./inputs/lifecycle"),t("./inputs/mouse"),t("./inputs/pointer"),t("./inputs/touch"),t("./sound/sound"),t("./debug/debug-layer"),t("./aliases").defineAliases(n),window&&(window.Crafty=n),e.exports=n},{"./aliases":2,"./core/loader":12,"./crafty-common.js":21,"./debug/debug-layer":23,"./graphics/canvas":26,"./graphics/canvas-layer":25,"./graphics/color":27,"./graphics/dom":30,"./graphics/dom-helper":28,"./graphics/dom-layer":29,"./graphics/drawing":31,"./graphics/gl-textures":32,"./graphics/html":33,"./graphics/image":34,"./graphics/layers":35,"./graphics/particles":36,"./graphics/renderable":37,"./graphics/sprite":39,"./graphics/sprite-animation":38,"./graphics/text":40,"./graphics/viewport":41,"./graphics/webgl":43,"./graphics/webgl-layer":42,"./inputs/device":44,"./inputs/dom-events":45,"./inputs/keyboard":46,"./inputs/lifecycle":47,"./inputs/mouse":48,"./inputs/pointer":49,"./inputs/touch":50,"./inputs/util":51,"./isometric/diamond-iso":52,"./isometric/isometric":53,"./sound/sound":54}],23:[function(t,e,i){var n=t("../core/core.js"),r=window.document;n.c("DebugCanvas",{init:function(){this.requires("2D"),n.DebugCanvas.context||n.DebugCanvas.init(),n.DebugCanvas.add(this),this._debug={alpha:1,lineWidth:1},this.bind("RemoveComponent",this.onDebugRemove),this.bind("Remove",this.onDebugDestroy)},onDebugRemove:function(t){"DebugCanvas"===t&&n.DebugCanvas.remove(this)},onDebugDestroy:function(t){n.DebugCanvas.remove(this)},debugAlpha:function(t){return this._debug.alpha=t,this},debugFill:function(t){return void 0===t&&(t="red"),this._debug.fillStyle=t,this},debugStroke:function(t){return void 0===t&&(t="red"),this._debug.strokeStyle=t,this},debugDraw:function(t){var e=t.globalAlpha,i=this._debug;i.alpha&&(t.globalAlpha=this._debug.alpha),i.strokeStyle&&(t.strokeStyle=i.strokeStyle),i.lineWidth&&(t.lineWidth=i.lineWidth),i.fillStyle&&(t.fillStyle=i.fillStyle),this.trigger("DebugDraw",t),t.globalAlpha=e}}),n.c("DebugRectangle",{init:function(){this.requires("2D, DebugCanvas")},debugRectangle:function(t){return this.debugRect=t,this.unbind("DebugDraw",this.drawDebugRect),this.bind("DebugDraw",this.drawDebugRect),this},drawDebugRect:function(t){var e=this.debugRect;null!=e&&e._h&&e._w&&(this._debug.fillStyle&&t.fillRect(e._x,e._y,e._w,e._h),this._debug.strokeStyle&&t.strokeRect(e._x,e._y,e._w,e._h))}}),n.c("WiredMBR",{init:function(){this.requires("DebugRectangle").debugStroke("purple")},events:{PreRender:function(){this.debugRectangle(this._mbr||this)}}});var o={init:function(){this.requires("DebugRectangle").debugFill("pink")},events:{PreRender:function(){this.debugRectangle(this._mbr||this)}}};n.c("SolidMBR",o),n.c("VisibleMBR",o),n.c("DebugPolygon",{init:function(){this.requires("2D, DebugCanvas")},debugPolygon:function(t){return this.polygon=t,this.unbind("DebugDraw",this.drawDebugPolygon),this.bind("DebugDraw",this.drawDebugPolygon),this},drawDebugPolygon:function(t){if(void 0!==this.polygon){t.beginPath();for(var e=this.polygon.points,i=e.length,n=0;n<i;n+=2)t.lineTo(e[n],e[n+1]);t.closePath(),this._debug.fillStyle&&t.fill(),this._debug.strokeStyle&&t.stroke()}}}),n.c("WiredHitBox",{init:function(){this.requires("DebugPolygon").debugStroke("red").matchHitBox(),this.bind("NewHitbox",this.matchHitBox)},matchHitBox:function(){this.debugPolygon(this.map)}}),n.c("SolidHitBox",{init:function(){this.requires("Collision, DebugPolygon").debugFill("orange").debugAlpha(.7).matchHitBox(),this.bind("NewHitbox",this.matchHitBox)},matchHitBox:function(){this.debugPolygon(this.map)}}),n.c("WiredAreaMap",{init:function(){this.requires("DebugPolygon").debugStroke("green").matchAreaMap(),this.bind("NewAreaMap",this.matchAreaMap)},matchAreaMap:function(){this.debugPolygon(this.mapArea)}}),n.c("SolidAreaMap",{init:function(){this.requires("DebugPolygon").debugFill("lime").debugAlpha(.7).matchAreaMap(),this.bind("NewAreaMap",this.matchAreaMap)},matchAreaMap:function(){this.debugPolygon(this.mapArea)}}),n.DebugCanvas={context:null,entities:[],onetimeEntities:[],add:function(t){this.entities.push(t)},remove:function(t){for(var e=this.entities,i=e.length-1;i>=0;i--)e[i]===t&&e.splice(i,1)},init:function(){if(!n.DebugCanvas.context){if(!n.support.canvas)return n.trigger("NoCanvas"),void n.stop();var t;(t=r.createElement("canvas")).width=n.viewport.width,t.height=n.viewport.height,t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.id="debug-canvas",t.style.zIndex=1e5,n.stage.elem.appendChild(t),n.DebugCanvas.context=t.getContext("2d"),n.DebugCanvas._canvas=t}n.unbind("RenderScene",n.DebugCanvas.renderScene),n.bind("RenderScene",n.DebugCanvas.renderScene)},renderScene:function(t){t=t||n.viewport.rect();var e,i=n.DebugCanvas.entities,r=0,o=i.length,s=n.DebugCanvas.context,a=n.viewport;s.setTransform(a._scale,0,0,a._scale,Math.round(a._x*a._scale),Math.round(a._y*a._scale)),s.clearRect(t._x,t._y,t._w,t._h);for(var h=null;r<o;r++)h!==(e=i[r])._drawLayer&&(e._drawLayer?(a=e._drawLayer._viewportRect(),s.setTransform(a._scale,0,0,a._scale,Math.round(-a._x*a._scale),Math.round(-a._y*a._scale))):(a=n.viewport,s.setTransform(a._scale,0,0,a._scale,Math.round(a._x*a._scale),Math.round(a._y*a._scale))),h=e._drawLayer),e.debugDraw(s)}}},{"../core/core.js":10}],24:[function(t,e,i){var n=t("../core/core.js");n.extend({loggingEnabled:!0,log:function(){n.loggingEnabled&&("undefined"!=typeof window?window.console:console)&&console.log&&console.log.apply(console,arguments)},error:function(){n.loggingEnabled&&("undefined"!=typeof window?window.console:console)&&console.error&&console.error.apply(console,arguments)}})},{"../core/core.js":10}],25:[function(t,e,i){var n=t("../core/core.js");n._registerLayerTemplate("Canvas",{type:"Canvas",layerCount:0,_changedObjs:null,_dirtyRects:null,_dirtyCells:null,_viewKeys:null,__tempRect:null,__tempSearchRect:null,__tempScreenRect:null,dirty:function(t){this._changedObjs.push(t)},attach:function(t){t._drawContext=this.context,this.layerCount++},detach:function(t){this.dirty(t),t._drawContext=null,this.layerCount--},context:null,_canvas:null,events:{LayerInit:"layerInit",LayerRemove:"layerRemove",RenderScene:"_render",PixelartSet:"_setPixelart",ViewportResize:"_resize"},layerInit:function(){if(!n.support.canvas)return n.trigger("NoCanvas"),void n.stop();var t;this._changedObjs=[],this._dirtyRects=[],this._dirtyCells={},this._viewKeys={x1:0,y1:0,x2:0,y2:0},this.__tempRect={_x:0,_y:0,_w:0,_h:0},this.__tempSearchRect={_x:0,_y:0,_w:0,_h:0},this.__tempScreenRect={_x:0,_y:0,_w:0,_h:0},(t=document.createElement("canvas")).width=n.viewport.width,t.height=n.viewport.height,t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.style.zIndex=this.options.z,n.stage.elem.appendChild(t),this.context=t.getContext("2d"),this._canvas=t;var e=n.viewport._scale;1!==e&&this.context.scale(e,e)},layerRemove:function(){this._canvas.parentNode.removeChild(this._canvas)},_render:function(){var t=this._dirtyViewport,e=this._changedObjs.length,i=this.context;if(e||t){var n=this.options;if(t&&n){var r=this._viewportRect(),o=r._scale,s=-r._x*o,a=-r._y*o;i.setTransform(o,0,0,o,Math.round(s),Math.round(a))}e/this.layerCount>.6||t?this._drawAll():this._drawDirtyCells(),this._clean()}},_drawDirtyCells:function(t){var e,i,r=this._viewportRect(),o=this.__tempRect,s=this._dirtyRects,a=n.rectManager.integerBounds,h=this.context;for(t=a(t||r),this._createDirtyCells(t),this._createDirtyRects(),e=0,i=s.length;e<i;e+=4)o._x=s[e+0],o._y=s[e+1],o._w=s[e+2],o._h=s[e+3],this._drawRect(o);if(!0===this.debugDirty){var c=n.frame(),u=(6*c+0)%255,l=(6*c+85)%255,d=(6*c+170)%255;for(h.strokeStyle="rgb("+u+", "+l+", "+d+")",e=0,i=s.length;e<i;e+=4)h.strokeRect(s[e+0],s[e+1],s[e+2],s[e+3])}},_drawAll:function(t){var e=this._viewportRect();this._drawRect(t||e)},_drawRect:function(t){var e,i,r,o,s,a=n.rectManager.integerBounds,h=this.context,c=this.__tempSearchRect,u=this.__tempScreenRect;for(u=a(u=this._viewTransformRect(t,u,!0)),t=a(t),c._x=t._x,c._y=t._y,c._w=t._w-1,c._h=t._h-1,(r=n.map.search(c)).sort(this._sort),h.save(),h.save(),h.setTransform(1,0,0,1,0,0),h.beginPath(),h.rect(u._x,u._y,u._w,u._h),h.clearRect(u._x,u._y,u._w,u._h),h.restore(),h.clip(),s=-1/0,e=0,i=r.length;e<i;++e)(o=r[e])._globalZ>s&&o._visible&&o._drawLayer===this&&(o.draw(h),o._changed=!1,s=o._globalZ);h.restore()},debug:function(){n.log(this._changedObjs)},_clean:function(){var t,e,i,n,r,o=this._changedObjs;for(n=0,r=o.length;n<r;n++)t=(i=o[n])._entry.keys,void 0===(e=i.staleKeys)&&(i.staleKeys=e={x1:0,y1:0,x2:0,y2:0}),e.x1=t.x1,e.y1=t.y1,e.x2=t.x2,e.y2=t.y2,i._changed=!1;o.length=0,this._dirtyCells={},this._dirtyRects.length=0,this._dirtyViewport=!1},_createDirtyCells:function(t){var e,i,r,o,s,a,h=this._changedObjs,c=this._dirtyCells,u=n.HashMap.key(t,this._viewKeys);for(e=0,i=h.length;e<i;e++){if(a=(s=h[e]).staleKeys)for(r=a.x1;r<=a.x2;r++)for(o=a.y1;o<=a.y2;o++)u.x1<=r&&r<=u.x2&&u.y1<=o&&o<=u.y2&&(c[r<<16^o]=!0);for(r=(a=s._entry.keys).x1;r<=a.x2;r++)for(o=a.y1;o<=a.y2;o++)u.x1<=r&&r<=u.x2&&u.y1<=o&&o<=u.y2&&(c[r<<16^o]=!0)}},_createDirtyRects:function(){var t,e,i,r=n.HashMap.cellsize(),o=this._dirtyCells,s=this._dirtyRects;for(var a in o)e=(i=(t=+a)<<16>>16)<0?~(t>>16):t>>16,s.push(e*r,i*r,r,r)},_resize:function(){var t=this._canvas;t.width=n.viewport.width,t.height=n.viewport.height},_setPixelart:function(t){var e=this.context;e.imageSmoothingEnabled=!t,e.mozImageSmoothingEnabled=!t,e.webkitImageSmoothingEnabled=!t,e.oImageSmoothingEnabled=!t,e.msImageSmoothingEnabled=!t}})},{"../core/core.js":10}],26:[function(t,e,i){var n=t("../core/core.js");n.c("Canvas",{init:function(){this.requires("Renderable"),this.currentRect={},this._customLayer||this._attachToLayer(n.s("DefaultCanvasLayer"))},remove:function(){this._detachFromLayer()},drawVars:{type:"canvas",pos:{},ctx:null,coord:[0,0,0,0],co:{x:0,y:0,w:0,h:0}},draw:function(t,e,i,n,r){if(this.ready){var o=this.drawVars.pos;o._x=this._x+(e||0),o._y=this._y+(i||0),o._w=n||this._w,o._h=r||this._h;var s,a=t||this._drawContext,h=this.__coord||[0,0,0,0],c=this.drawVars.co;return c.x=h[0]+(e||0),c.y=h[1]+(i||0),c.w=n||h[2],c.h=r||h[3],(this._flipX||this._flipY||this._rotation)&&a.save(),0!==this._rotation&&(a.translate(this._origin.x+this._x,this._origin.y+this._y),o._x=-this._origin.x,o._y=-this._origin.y,a.rotate(this._rotation%360*(Math.PI/180))),(this._flipX||this._flipY)&&(a.scale(this._flipX?-1:1,this._flipY?-1:1),this._flipX&&(o._x=-(o._x+o._w)),this._flipY&&(o._y=-(o._y+o._h))),this._alpha<1&&(s=a.globalAlpha,a.globalAlpha=this._alpha),this.drawVars.ctx=a,this.trigger("Draw",this.drawVars),(0!==this._rotation||this._flipX||this._flipY)&&a.restore(),s&&(a.globalAlpha=s),this}}})},{"../core/core.js":10}],27:[function(t,e,i){var n=t("../core/core.js"),r=window.document;n.extend({assignColor:function(){var t=r.createElement("div");t.style.display="none";var e=!1,i={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#00ff00",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"};function n(t){return t._red=t._blue=t._green=0,t}function o(t){var e=t.toString(16);return 1===e.length&&(e="0"+e),e}function s(t,e){var i,r,o,s=t.length;if(7===s)i=t.substr(1,2),r=t.substr(3,2),o=t.substr(5,2);else{if(4!==s)return n(e);i=t.substr(1,1),i+=i,r=t.substr(2,1),r+=r,o=t.substr(3,1),o+=o}return e._red=parseInt(i,16),e._green=parseInt(r,16),e._blue=parseInt(o,16),e}var a=/rgba?\s*\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,?\s*([0-9.]+)?\)/;function h(t,e){var i=a.exec(t);return null===i||4!==i.length&&5!==i.length?n(e):(e._red=Math.round(parseFloat(i[1])),e._green=Math.round(parseFloat(i[2])),e._blue=Math.round(parseFloat(i[3])),i[4]&&(e._strength=parseFloat(i[4])),e)}function c(n,r){var a,c,u;void 0===i[n]?(!1===e&&(window.document.body.appendChild(t),e=!0),t.style.color=n,h(window.getComputedStyle(t).color,r),i[n]=(a=r._red,c=r._green,u=r._blue,"#"+o(a)+o(c)+o(u))):s(i[n],r);return r}return function(t,e){e=e||{};"#"===(t=t.trim().toLowerCase())[0]?s(t,e):"r"===t[0]&&"g"===t[1]&&"b"===t[2]?h(t,e):c(t,e),e._strength=e._strength||1,e._color=function(t){return"rgba("+t._red+", "+t._green+", "+t._blue+", "+t._strength+")"}(e)}}()}),n.defaultShader("Color",new n.WebGLShader("attribute vec2 aPosition;\nattribute vec3 aOrientation;\nattribute vec2 aLayer;\nattribute vec4 aColor;\n\nvarying lowp vec4 vColor;\n\nuniform  vec4 uViewport;\n\nmat4 viewportScale = mat4(2.0 / uViewport.z, 0, 0, 0,    0, -2.0 / uViewport.w, 0,0,    0, 0,1,0,    -1,+1,0,1);\nvec4 viewportTranslation = vec4(uViewport.xy, 0, 0);\n\nvoid main() {\n  vec2 pos = aPosition;\n  vec2 entityOrigin = aOrientation.xy;\n  mat2 entityRotationMatrix = mat2(cos(aOrientation.z), sin(aOrientation.z), -sin(aOrientation.z), cos(aOrientation.z));\n\n  pos = entityRotationMatrix * (pos - entityOrigin) + entityOrigin;\n  gl_Position = viewportScale * (viewportTranslation + vec4(pos, 1.0/(1.0+exp(aLayer.x) ), 1) );\n  vColor = vec4(aColor.rgb*aColor.a*aLayer.y, aColor.a*aLayer.y);\n}","precision mediump float;\nvarying lowp vec4 vColor;\nvoid main(void) {\n\tgl_FragColor = vColor;\n}",[{name:"aPosition",width:2},{name:"aOrientation",width:3},{name:"aLayer",width:2},{name:"aColor",width:4}],(function(t,e){t.program.writeVector("aColor",e._red/255,e._green/255,e._blue/255,e._strength)}))),n.c("Color",{_red:0,_green:0,_blue:0,_strength:1,_color:"",ready:!0,init:function(){this.__coord=this.__coord||[0,0,0,0],this.bind("Draw",this._drawColor),this._drawLayer&&this._setupColor(this._drawLayer),this.trigger("Invalidate")},events:{LayerAttached:"_setupColor"},remove:function(){this.unbind("Draw",this._drawColor),this.has("DOM")&&(this._element.style.backgroundColor="transparent"),this.trigger("Invalidate")},_setupColor:function(t){"WebGL"===t.type&&this._establishShader("Color",n.defaultShader("Color"))},_drawColor:function(t){this._color&&("DOM"===t.type?(t.style.backgroundColor=this._color,t.style.lineHeight=0):"canvas"===t.type?(t.ctx.fillStyle=this._color,t.ctx.fillRect(t.pos._x,t.pos._y,t.pos._w,t.pos._h)):"webgl"===t.type&&t.program.draw(t,this))},color:function(t){return 0===arguments.length?this._color:(arguments.length>=3?(this._red=arguments[0],this._green=arguments[1],this._blue=arguments[2],"number"==typeof arguments[3]&&(this._strength=arguments[3])):(n.assignColor(t,this),"number"==typeof arguments[1]&&(this._strength=arguments[1])),this._color="rgba("+this._red+", "+this._green+", "+this._blue+", "+this._strength+")",this.trigger("Invalidate"),this)}})},{"../core/core.js":10}],28:[function(t,e,i){var n=t("../core/core.js"),r=window.document;n.extend({domHelper:{innerPosition:function(t,e){e=e||{};var i=t.getBoundingClientRect(),n=i.left+(window.pageXOffset?window.pageXOffset:r.body.scrollLeft),o=i.top+(window.pageYOffset?window.pageYOffset:r.body.scrollTop),s=parseInt(this.getStyle(t,"border-left-width")||0,10)||parseInt(this.getStyle(t,"borderLeftWidth")||0,10)||0,a=parseInt(this.getStyle(t,"border-top-width")||0,10)||parseInt(this.getStyle(t,"borderTopWidth")||0,10)||0;return e.x=n+s,e.y=o+a,e},getStyle:function(t,e){var i;return t.currentStyle?i=t.currentStyle[this.camelize(e)]:window.getComputedStyle&&(i=r.defaultView.getComputedStyle(t,null).getPropertyValue(this.csselize(e))),i},camelize:function(t){return t.replace(/-+(.)?/g,(function(t,e){return e?e.toUpperCase():""}))},csselize:function(t){return t.replace(/[A-Z]/g,(function(t){return t?"-"+t.toLowerCase():""}))},translate:function(t,e,i,o){o=o||{};var s,a=r.documentElement,h=r.body;return i?(s=i._viewportRect(),o.x=(t-n.stage.x+(a&&a.scrollLeft||h&&h.scrollLeft||0))/s._scale+s._x,o.y=(e-n.stage.y+(a&&a.scrollTop||h&&h.scrollTop||0))/s._scale+s._y):(s=n.viewport,o.x=(t-n.stage.x+(a&&a.scrollLeft||h&&h.scrollLeft||0))/s._scale-s._x,o.y=(e-n.stage.y+(a&&a.scrollTop||h&&h.scrollTop||0))/s._scale-s._y),o}}})},{"../core/core.js":10}],29:[function(t,e,i){var n=t("../core/core.js"),r=window.document;n._registerLayerTemplate("DOM",{type:"DOM",_changedObjs:[],_div:null,events:{LayerInit:"layerInit",LayerRemove:"layerRemove",RenderScene:"_render",PixelartSet:"_setPixelart"},layerInit:function(){this._changedObjs=[];var t=this._div=r.createElement("div");n.stage.elem.appendChild(t),t.style.position="absolute",t.style.zIndex=this.options.z,t.style.transformStyle="preserve-3d"},layerRemove:function(){this._div.parentNode.removeChild(this._div)},_setPixelArt:function(t){var e=this._div.style,i=n.domHelper.camelize;t?(e[i("image-rendering")]="optimizeSpeed",e[i("image-rendering")]="-moz-crisp-edges",e[i("image-rendering")]="-o-crisp-edges",e[i("image-rendering")]="-webkit-optimize-contrast",e[i("-ms-interpolation-mode")]="nearest-neighbor",e[i("image-rendering")]="optimize-contrast",e[i("image-rendering")]="pixelated",e[i("image-rendering")]="crisp-edges"):(e[i("image-rendering")]="optimizeQuality",e[i("-ms-interpolation-mode")]="bicubic",e[i("image-rendering")]="auto")},debug:function(){n.log(this._changedObjs)},_render:function(){var t=this._changedObjs;if(this._dirtyViewport&&(this._setViewport(),this._dirtyViewport=!1),t.length){for(var e=0,i=t.length;e<i;++e)t[e].draw()._changed=!1;t.length=0}},dirty:function(t){this._changedObjs.push(t)},attach:function(t){t._drawContext=this.context,this._div.appendChild(t._element),t._element.style.position="absolute",t._element.id="ent"+t[0]},detach:function(t){this._div.removeChild(t._element)},_setViewport:function(){var t=this._div.style,e=this._viewportRect(),i=e._scale,r=-e._x*i,o=-e._y*i;t.transform=t[n.support.prefix+"Transform"]="scale("+i+", "+i+")",t.left=Math.round(r)+"px",t.top=Math.round(o)+"px",t.zIndex=this.options.z}})},{"../core/core.js":10}],30:[function(t,e,i){var n=t("../core/core.js"),r=window.document;n.c("DOM",{_element:null,_cssStyles:null,avoidCss3dTransforms:!1,init:function(){this.requires("Renderable"),this._cssStyles={visibility:"",left:"",top:"",width:"",height:"",zIndex:"",opacity:"",transformOrigin:"",transform:""},this._element=r.createElement("div"),this._customLayer||this._attachToLayer(n.s("DefaultDOMLayer")),this.bind("NewComponent",this._updateClass),this.bind("RemoveComponent",this._removeClass)},remove:function(){this._detachFromLayer(),this.unbind("NewComponent",this._updateClass),this.unbind("RemoveComponent",this._removeClass)},getDomId:function(){return this._element.id},_removeClass:function(t){var e,i=this.__c,n="";for(e in i)e!==t&&(n+=" "+e);n=n.substr(1),this._element.className=n},_updateClass:function(){var t,e=this.__c,i="";for(t in e)i+=" "+t;i=i.substr(1),this._element.className=i},DOM:function(t){if(t&&t.nodeType){var e=this._drawLayer;this._detachFromLayer(),this._element=t,this._attachToLayer(e)}return this},draw:function(){var t=this._element.style,e=this.__coord||[0,0,0,0],i={x:e[0],y:e[1],w:e[2],h:e[3]},r=n.support.prefix,o=[];if(this._cssStyles.visibility!==this._visible&&(this._cssStyles.visibility=this._visible,this._visible?t.visibility="visible":t.visibility="hidden"),n.support.css3dtransform&&!this.avoidCss3dTransforms?o.push("translate3d("+~~this._x+"px,"+~~this._y+"px,0)"):(this._cssStyles.left!==this._x&&(this._cssStyles.left=this._x,t.left=~~this._x+"px"),this._cssStyles.top!==this._y&&(this._cssStyles.top=this._y,t.top=~~this._y+"px")),this._cssStyles.width!==this._w&&(this._cssStyles.width=this._w,t.width=~~this._w+"px"),this._cssStyles.height!==this._h&&(this._cssStyles.height=this._h,t.height=~~this._h+"px"),this._cssStyles.zIndex!==this._z&&(this._cssStyles.zIndex=this._z,t.zIndex=this._z),this._cssStyles.opacity!==this._alpha&&(this._cssStyles.opacity=this._alpha,t.opacity=this._alpha,t[r+"Opacity"]=this._alpha),this._mbr){var s=this._origin.x+"px "+this._origin.y+"px";t.transformOrigin=s,t[r+"TransformOrigin"]=s,n.support.css3dtransform?o.push("rotateZ("+this._rotation+"deg)"):o.push("rotate("+this._rotation+"deg)")}return this._flipX&&o.push("scaleX(-1)"),this._flipY&&o.push("scaleY(-1)"),this._cssStyles.transform!==o.join(" ")&&(this._cssStyles.transform=o.join(" "),t.transform=this._cssStyles.transform,t[r+"Transform"]=this._cssStyles.transform),this.trigger("Draw",{style:t,type:"DOM",co:i}),this},_setCssProperty:function(t,e,i){"number"==typeof i&&(i+="px"),t[e=n.domHelper.camelize(e)]=i,this.trigger("SetStyle",e)},css:function(t,e){var i,r,o=this._element,s=o.style;if("object"==typeof t)for(i in t)t.hasOwnProperty(i)&&(r=t[i],this._setCssProperty(s,i,r));else{if(!e)return n.domHelper.getStyle(o,t);this._setCssProperty(s,t,e)}return this.trigger("Invalidate"),this}})},{"../core/core.js":10}],31:[function(t,e,i){var n=t("../core/core.js");n.extend({background:function(t){n.stage.elem.style.background=t},_pixelartEnabled:!1,pixelart:function(t){n._pixelartEnabled=t,n.trigger("PixelartSet",t)}})},{"../core/core.js":10}],32:[function(t,e,i){var n=t("../core/core.js");function r(t,e){this.gl=t,this.webgl=e,this.max_units=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this.bound_textures=[],this.registered_textures={},this.active=null}function o(t,e){this.manager=t,this.gl=t.gl,this.glTexture=this.gl.createTexture(),this.id=e,this.active=!1,this.unit=null,this.powerOfTwo=!1}n.TextureManager=r,r.prototype={reset:function(){for(var t=0;t<this.bound_textures.length;t++)this.bound_textures[t].unbind();this.bound_textures=[],this.active=null},makeTexture:function(t,e,i){var n=this.webgl,r="texture-(r:"+i+")-"+t;if(void 0!==this.registered_textures[r])return this.registered_textures[r];var s=new o(this,r);return this.registered_textures[r]=s,this.bindTexture(s),s.setImage(e),s.setFilter(n.texture_filter),s.setRepeat(i),s},smallest:function(){for(var t=1/0,e=null,i=0;i<this.bound_textures.length;i++){var n=this.bound_textures[i];n.size<t&&(t=n.size,e=i)}return e},getAvailableUnit:function(){return this.bound_textures.length<this.max_units?this.bound_textures.length:this.smallest()},bindTexture:function(t){if(null===t.unit){var e=this.getAvailableUnit();this.bound_textures[e]&&this.unbindTexture(this.bound_textures[e]),this.bound_textures[e]=t,t.bind(e)}},unbindTexture:function(t){t.unbind()},setActiveTexture:function(t){this.active!==t.id&&(this.gl.activeTexture(this.gl[t.name]),this.active=t.unit)}},n.TextureWrapper=o,o.prototype={bind:function(t){var e=this.gl;this.unit=t,this.name="TEXTURE"+t,this.manager.setActiveTexture(this),e.bindTexture(e.TEXTURE_2D,this.glTexture)},isActive:function(){return this.manager.active===this.unit},unbind:function(){this.unit=null,this.name=null,this.isActive()&&(this.manager.active=null)},setImage:function(t){if(!this.isActive())throw"Trying to set image of texture that isn't active";this.width=t.width,this.height=t.height,this.size=t.width*t.height,this.powerOfTwo=!(Math.log(t.width)/Math.LN2!==Math.floor(Math.log(t.width)/Math.LN2)||Math.log(t.height)/Math.LN2!==Math.floor(Math.log(t.height)/Math.LN2));var e=this.gl;e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t)},setFilter:function(t){if(!this.isActive())throw"Trying to set filter of texture that isn't active";var e=this.gl;e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t)},setRepeat:function(t){if(!this.isActive())throw"Trying to set repeat property of texture that isn't active";if(t&&!this.powerOfTwo)throw"Can't create a repeating image whose dimensions aren't a power of 2 in WebGL contexts";var e=this.gl;this.repeatMode=t?e.REPEAT:e.CLAMP_TO_EDGE,e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,this.repeatMode),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,this.repeatMode)},setToProgram:function(t,e,i){if(null===this.unit)throw"Trying to use texture not set to a texture unit.";var n=this.gl;n.useProgram(t),n.uniform1i(n.getUniformLocation(t,e),this.unit),n.uniform2f(n.getUniformLocation(t,i),this.width,this.height)}}},{"../core/core.js":10}],33:[function(t,e,i){t("../core/core.js").c("HTML",{inner:"",init:function(){this.requires("2D, DOM")},replace:function(t){return this.inner=t,this._element.innerHTML=t,this},append:function(t){return this.inner+=t,this._element.innerHTML+=t,this},prepend:function(t){return this.inner=t+this.inner,this._element.innerHTML=t+this.inner,this}})},{"../core/core.js":10}],34:[function(t,e,i){var n=t("../core/core.js");n.defaultShader("Image",new n.WebGLShader("attribute vec2 aPosition;\nattribute vec3 aOrientation;\nattribute vec2 aLayer;\nattribute vec2 aTextureCoord;\n\nvarying mediump vec3 vTextureCoord;\n\nuniform vec4 uViewport;\nuniform mediump vec2 uTextureDimensions;\n\nmat4 viewportScale = mat4(2.0 / uViewport.z, 0, 0, 0,    0, -2.0 / uViewport.w, 0,0,    0, 0,1,0,    -1,+1,0,1);\nvec4 viewportTranslation = vec4(uViewport.xy, 0, 0);\n\nvoid main() {\n  vec2 pos = aPosition;\n  vec2 entityOrigin = aOrientation.xy;\n  mat2 entityRotationMatrix = mat2(cos(aOrientation.z), sin(aOrientation.z), -sin(aOrientation.z), cos(aOrientation.z));\n  \n  pos = entityRotationMatrix * (pos - entityOrigin) + entityOrigin ;\n  gl_Position = viewportScale * (viewportTranslation + vec4(pos, 1.0/(1.0+exp(aLayer.x) ), 1) );\n  vTextureCoord = vec3(aTextureCoord, aLayer.y);\n}","varying mediump vec3 vTextureCoord;\n  \nuniform sampler2D uSampler;\nuniform mediump vec2 uTextureDimensions;\n\nvoid main(void) {\n  highp vec2 coord =   vTextureCoord.xy / uTextureDimensions;\n  mediump vec4 base_color = texture2D(uSampler, coord);\n  gl_FragColor = vec4(base_color.rgb*base_color.a*vTextureCoord.z, base_color.a*vTextureCoord.z);\n}",[{name:"aPosition",width:2},{name:"aOrientation",width:3},{name:"aLayer",width:2},{name:"aTextureCoord",width:2}],(function(t,e){var i=t.pos;t.program.writeVector("aTextureCoord",0,0,0,i._h,i._w,0,i._w,i._h)}))),n.c("Image",{_repeat:"repeat",ready:!1,init:function(){this.bind("Draw",this._drawImage),this.bind("LayerAttached",this._setupImage)},remove:function(){this.unbind("LayerAttached",this._setupImage),this.unbind("Draw",this._drawImage)},image:function(t,e){if(this.__image=t,this._repeat=e||"no-repeat",this.img=n.asset(t),this.img)this._setupImage(this._drawLayer);else{this.img=new Image,n.asset(t,this.img),this.img.src=t;var i=this;this.img.onload=function(){i._setupImage(i._drawLayer)}}return this.trigger("Invalidate"),this},_setupImage:function(t){this.img&&t&&("Canvas"===t.type?this._pattern=this._drawContext.createPattern(this.img,this._repeat):"WebGL"===t.type&&(this._establishShader("image:"+this.__image,n.defaultShader("Image")),this.program.setTexture(this._drawLayer.makeTexture(this.__image,this.img,"no-repeat"!==this._repeat))),"no-repeat"===this._repeat&&(this.w=this.w||this.img.width,this.h=this.h||this.img.height),this.ready=!0,this.trigger("Invalidate"))},_drawImage:function(t){if("canvas"===t.type){if(!this.ready||!this._pattern)return;var e=t.ctx;e.fillStyle=this._pattern,e.save(),e.translate(t.pos._x,t.pos._y),e.fillRect(0,0,t.pos._w,t.pos._h),e.restore()}else"DOM"===t.type?this.__image&&(t.style.backgroundImage="url("+this.__image+")",t.style.backgroundRepeat=this._repeat):"webgl"===t.type&&t.program.draw(t,this)}})},{"../core/core.js":10}],35:[function(t,e,i){var n=t("../core/core.js");n.extend({_drawLayerTemplates:{},_drawLayers:[],_addDrawLayerInstance:function(t){n._drawLayers.push(t),this._drawLayers.sort((function(t,e){return t.options.z-e.options.z}))},_removeDrawLayerInstance:function(t){var e=this._drawLayers.indexOf(t);e>=0&&this._drawLayers.splice(e,1),this._drawLayers.sort((function(t,e){return t.options.z-e.options.z}))},_registerLayerTemplate:function(t,e){this._drawLayerTemplates[t]=e;var i=this._commonLayerProperties;for(var n in i)e[n]||(e[n]=i[n])},_commonLayerProperties:{options:{xResponse:1,yResponse:1,scaleResponse:1,z:0},_pointerEntities:0,_dirtyViewport:!1,_cachedViewportRect:null,init:function(){this._cachedViewportRect={},this.trigger("LayerInit"),this.uniqueBind("InvalidateViewport",(function(){this._dirtyViewport=!0})),this.trigger("PixelartSet",n._pixelartEnabled),n._addDrawLayerInstance(this)},remove:function(){this.trigger("LayerRemove"),n._removeDrawLayerInstance(this)},_sort:function(t,e){return t._globalZ-e._globalZ},_viewportRect:function(t){var e=this._cachedViewportRect;if(t)return e;var i=n.viewport,r=this.options,o=Math.pow(i._scale,r.scaleResponse);return e._scale=o,e._w=i._width/o,e._h=i._height/o,e._x=r.xResponse*-i._x-.5*(r.xResponse-1)*(1-1/o)*i._width,e._y=r.yResponse*-i._y-.5*(r.yResponse-1)*(1-1/o)*i._height,e},_viewTransformRect:function(t,e,i){var n=this._viewportRect(i),r=n._scale;return(e=e||{})._x=t._x*r+Math.round(-n._x*r),e._y=t._y*r+Math.round(-n._y*r),e._w=t._w*r,e._h=t._h*r,e}},createLayer:function(t,e,i){var r=this._drawLayerTemplates[e];n.s(t,r,i),n.c(t,{init:function(){this.requires("Renderable"),this._customLayer=!0,this.requires(r.type),this._attachToLayer(n.s(t))},remove:function(){this._detachFromLayer()}})}})},{"../core/core.js":10}],36:[function(t,e,i){var n=t("../core/core.js");n.c("Particles",{required:"Renderable",ready:!0,_particlesPaused:!1,init:function(){this._Particles=n.clone(this._Particles),this._Particles.init(),this._Particles.parentEntity=this},events:{UpdateFrame:function(){!this._particlesPaused&&this._Particles.active&&(this._Particles.update(),this.trigger("Invalidate"))},Draw:function(t){this._Particles.active&&"canvas"===t.type&&this._Particles.render(t)}},particles:function(t){return this._Particles.config(t),this._Particles.start(),this},_Particles:{presets:{maxParticles:150,size:18,sizeRandom:4,speed:1,speedRandom:1.2,lifeSpan:29,lifeSpanRandom:7,angle:65,angleRandom:34,startColour:[255,131,0,1],startColourRandom:[48,50,45,0],endColour:[245,35,0,0],endColourRandom:[60,60,60,0],sharpness:20,sharpnessRandom:10,spread:10,duration:-1,fastMode:!1,gravity:{x:0,y:.1},jitter:0,originOffset:{x:0,y:0}},emissionRate:0,elapsedFrames:0,emitCounter:0,active:!0,particles:[],init:function(){for(var t in this.presets)this[t]=this.presets[t]},config:function(t){for(var e in t=t||{})this[e]=t[e];if(this.emissionRate=this.maxParticles/this.lifeSpan,this.particles.length!==this.maxParticles){this.particles.length=0;for(var i=0,n=this.maxParticles;i<n;++i)this.particles.push(new this.Particle)}},start:function(){this.active=!0,this.elapsedFrames=0,this.emitCounter=0;for(var t=this.particles,e=0,i=t.length;e<i;++e)t[e].timeToLive=0;this.parentEntity.trigger("ParticleStart")},stop:function(){this.active=!1,this.parentEntity.trigger("ParticleEnd")},initParticle:function(t){var e,i,n,r,o,s,a,h,c,u,l,d,f,p;t.timeToLive=r=this.lifeSpan+this.lifeSpanRandom*this.RANDM1TO1(),t.positionX=this.originOffset.x+this.spread*this.RANDM1TO1(),t.positionY=this.originOffset.y+this.spread*this.RANDM1TO1(),e=(this.angle+this.angleRandom*this.RANDM1TO1())*(Math.PI/180),i=this.speed+this.speedRandom*this.RANDM1TO1(),t.directionX=Math.sin(e)*i,t.directionY=-Math.cos(e)*i,n=this.size+this.sizeRandom*this.RANDM1TO1(),t.size=n=n<0?0:~~n,o=this.sharpness+this.sharpnessRandom*this.RANDM1TO1(),t.sharpness=o=o>100?100:o<0?0:o,t.sizeSmall=~~(n/200*o),s=a=this.startColour[0]+this.startColourRandom[0]*this.RANDM1TO1(),t.colourR=s>255?255:s<0?0:~~s,s=h=this.startColour[1]+this.startColourRandom[1]*this.RANDM1TO1(),t.colourG=s>255?255:s<0?0:~~s,s=c=this.startColour[2]+this.startColourRandom[2]*this.RANDM1TO1(),t.colourB=s>255?255:s<0?0:~~s,s=u=this.startColour[3]+this.startColourRandom[3]*this.RANDM1TO1(),t.colourA=s>1?1:s<0?0:~~(100*s)/100,l=this.endColour[0]+this.endColourRandom[0]*this.RANDM1TO1(),d=this.endColour[1]+this.endColourRandom[1]*this.RANDM1TO1(),f=this.endColour[2]+this.endColourRandom[2]*this.RANDM1TO1(),p=this.endColour[3]+this.endColourRandom[3]*this.RANDM1TO1(),t.deltaColourR=(l-a)/r,t.deltaColourG=(d-h)/r,t.deltaColourB=(f-c)/r,t.deltaColourA=(p-u)/r},update:function(){var t=this.RANDM1TO1,e=this.gravity.x,i=this.gravity.y,n=this.jitter;this.elapsedFrames++,this.duration>=0&&this.duration<this.elapsedFrames&&this.stop();var r=this.emissionRate>0?1/this.emissionRate:1/0;this.emitCounter++;for(var o,s,a=this.particles,h=0,c=a.length;h<c;++h)(s=a[h]).timeToLive>0?(s.directionX+=e,s.directionY+=i,s.positionX+=s.directionX,s.positionY+=s.directionY,n&&(s.positionX+=n*t(),s.positionY+=n*t()),o=s.colourR+s.deltaColourR,s.colourR=o>255?255:o<0?0:~~o,o=s.colourG+s.deltaColourG,s.colourG=o>255?255:o<0?0:~~o,o=s.colourB+s.deltaColourB,s.colourB=o>255?255:o<0?0:~~o,o=s.colourA+s.deltaColourA,s.colourA=o>1?1:o<0?0:~~(100*o)/100,s.timeToLive--):this.emitCounter>r&&(this.initParticle(s),this.emitCounter-=r)},render:function(t){for(var e,i=t.ctx,n=this.particles,r=0,o=n.length;r<o;r++){var s=(e=n[r]).size,a=s>>1;if(!(e.positionX<0||e.positionX+s>t.pos._w||e.positionY<0||e.positionY+s>t.pos._h)){var h=~~(t.pos._x+e.positionX),c=~~(t.pos._y+e.positionY),u=e.colourR,l=e.colourG,d=e.colourB,f="rgba("+u+","+l+","+d+","+e.colourA+")";if(this.fastMode)i.fillStyle=f;else{var p="rgba("+u+","+l+","+d+",0)",y=i.createRadialGradient(h+a,c+a,e.sizeSmall,h+a,c+a,a);y.addColorStop(0,f),y.addColorStop(.9,p),i.fillStyle=y}i.fillRect(h,c,s,s)}}},Particle:function(){this.positionX=0,this.positionY=0,this.directionX=0,this.directionY=0,this.size=0,this.sizeSmall=0,this.timeToLive=0,this.colourR=0,this.colourG=0,this.colourB=0,this.colourA=0,this.deltaColourR=0,this.deltaColourG=0,this.deltaColourB=0,this.deltaColourA=0,this.sharpness=0},RANDM1TO1:function(){return 2*Math.random()-1}},pauseParticles:function(){this._particlesPaused=!0},resumeParticles:function(){this._particlesPaused=!1}})},{"../core/core.js":10}],37:[function(t,e,i){t("../core/core.js").c("Renderable",{_changed:!1,_alpha:1,_visible:!0,_setterRenderable:function(t,e){this[t]!==e&&(this[t]=e,this.trigger("Invalidate"))},properties:{alpha:{set:function(t){this._setterRenderable("_alpha",t)},get:function(){return this._alpha},configurable:!0,enumerable:!0},_alpha:{enumerable:!1},visible:{set:function(t){this._setterRenderable("_visible",t)},get:function(){return this._visible},configurable:!0,enumerable:!0},_visible:{enumerable:!1}},init:function(){},_hideOnUnfreeze:!1,events:{Freeze:function(){this._hideOnUnfreeze=!this._visible,this._visible=!1,this.trigger("Invalidate")},Unfreeze:function(){this._visible=!this._hideOnUnfreeze,this.trigger("Invalidate")}},_invalidateRenderable:function(){!1===this._changed&&(this._changed=!0,this._drawLayer.dirty(this))},_attachToLayer:function(t){this._drawLayer&&this._detachFromLayer(),this._drawLayer=t,t.attach(this),this.bind("Invalidate",this._invalidateRenderable),this.trigger("LayerAttached",t),this.trigger("Invalidate")},_detachFromLayer:function(){this._drawLayer&&(this._drawLayer.detach(this),this.unbind("Invalidate",this._invalidateRenderable),this.trigger("LayerDetached",this._drawLayer),delete this._drawLayer)},flip:function(t){return this["_flip"+(t=t||"X")]||(this["_flip"+t]=!0,this.trigger("Invalidate")),this},unflip:function(t){return this["_flip"+(t=t||"X")]&&(this["_flip"+t]=!1,this.trigger("Invalidate")),this}})},{"../core/core.js":10}],38:[function(t,e,i){var n=t("../core/core.js");n.c("SpriteAnimation",{_reels:null,_currentReelId:null,_currentReel:null,_isPlaying:!1,animationSpeed:1,init:function(){this._reels={}},reel:function(t,e,i,r,o,s){if(0===arguments.length)return this._currentReelId;if(1===arguments.length&&"string"==typeof t){if(void 0===this._reels[t])throw"The specified reel "+t+" is undefined.";return this.pauseAnimation(),this._currentReelId!==t&&(this._currentReelId=t,this._currentReel=this._reels[t],this._updateSprite(),this.trigger("ReelChange",this._currentReel)),this}var a,h;if((a={id:t,frames:[],currentFrame:0,easing:new n.easing(e),defaultLoops:1}).duration=a.easing.duration,"number"==typeof i)if(s=s||1/0,o>=0)for(h=0;h<o;++h)a.frames.push([i,r]),++i>=s&&(i=0,r++);else for(h=0;h>o;--h)a.frames.push([i,r]),--i<0&&(i=s-1,r--);else{if(3!==arguments.length||"object"!=typeof i)throw"Unrecognized arguments. Please see the documentation for 'reel(...)'.";a.frames=i}return this._reels[t]=a,this},animate:function(t,e){"string"==typeof t&&this.reel(t);var i=this._currentReel;if(null==i)throw"No reel is specified, and there is no currently active reel.";return this.pauseAnimation(),void 0===e&&(e="number"==typeof t?t:1),i.easing.reset(),this.loops(e),this._setFrame(0),this.bind("UpdateFrame",this._animationTick),this._isPlaying=!0,this.trigger("StartAnimation",i),this},resumeAnimation:function(){return!1===this._isPlaying&&null!==this._currentReel&&(this.bind("UpdateFrame",this._animationTick),this._isPlaying=!0,this._currentReel.easing.resume(),this.trigger("StartAnimation",this._currentReel)),this},pauseAnimation:function(){return!0===this._isPlaying&&(this.unbind("UpdateFrame",this._animationTick),this._isPlaying=!1,this._reels[this._currentReelId].easing.pause()),this},resetAnimation:function(){var t=this._currentReel;if(null===t)throw"No active reel to reset.";return this.reelPosition(0),t.easing.repeat(t.defaultLoops),this},loops:function(t){return 0===arguments.length?null!==this._currentReel?this._currentReel.easing.loops:0:(null!==this._currentReel&&(t<0&&(t=1/0),this._currentReel.easing.repeat(t),this._currentReel.defaultLoops=t),this)},reelPosition:function(t){if(null===this._currentReel)throw"No active reel.";if(0===arguments.length)return this._currentReel.currentFrame;var e,i=this._currentReel.frames.length;if("end"===t&&(t=i-1),t<1&&t>0)e=t,t=Math.floor(i*e);else{if(t!==Math.floor(t))throw"Position "+t+" is invalid.";t<0&&(t=i-1+t),e=t/i}return t=Math.min(t,i-1),t=Math.max(t,0),this._setProgress(e),this._setFrame(t),this},reelFrame:function(t){if(null===this._currentReel)throw"No active reel.";var e=this._currentReel.frames.indexOf(t);if(-1===e)throw"Frame name "+t+" is invalid.";return this.reelPosition(e),this},_animationTick:function(t){var e=this._reels[this._currentReelId];e.easing.tick(t.dt*this.animationSpeed);var i=e.easing.value(),n=Math.min(Math.floor(e.frames.length*i),e.frames.length-1);this._setFrame(n),!0===e.easing.complete&&(this.pauseAnimation(),this.trigger("AnimationEnd",this._currentReel))},_setFrame:function(t){var e=this._currentReel;t!==e.currentFrame&&(e.currentFrame=t,this._updateSprite(),this.trigger("FrameChange",e))},_updateSprite:function(){var t=this._currentReel,e=t.frames[t.currentFrame];"string"==typeof e?this.sprite(e):this.sprite(e[0],e[1])},_setProgress:function(t,e){this._currentReel.easing.setProgress(t,e)},isPlaying:function(t){return!!this._isPlaying&&(t?this._currentReelId===t:!!this._currentReelId)},getReel:function(t){if(0===arguments.length){if(!this._currentReelId)return null;t=this._currentReelId}return this._reels[t]}})},{"../core/core.js":10}],39:[function(t,e,i){var n=t("../core/core.js");n.defaultShader("Sprite",new n.WebGLShader("attribute vec2 aPosition;\nattribute vec3 aOrientation;\nattribute vec2 aLayer;\nattribute vec2 aTextureCoord;\n\nvarying mediump vec3 vTextureCoord;\n\nuniform vec4 uViewport;\nuniform mediump vec2 uTextureDimensions;\n\nmat4 viewportScale = mat4(2.0 / uViewport.z, 0, 0, 0,    0, -2.0 / uViewport.w, 0,0,    0, 0,1,0,    -1,+1,0,1);\nvec4 viewportTranslation = vec4(uViewport.xy, 0, 0);\n\nvoid main() {\n  vec2 pos = aPosition;\n  vec2 entityOrigin = aOrientation.xy;\n  mat2 entityRotationMatrix = mat2(cos(aOrientation.z), sin(aOrientation.z), -sin(aOrientation.z), cos(aOrientation.z));\n  \n  pos = entityRotationMatrix * (pos - entityOrigin) + entityOrigin ;\n  gl_Position = viewportScale * (viewportTranslation + vec4(pos, 1.0/(1.0+exp(aLayer.x) ), 1) );\n  vTextureCoord = vec3(aTextureCoord, aLayer.y);\n}","varying mediump vec3 vTextureCoord;\n  \nuniform sampler2D uSampler;\nuniform mediump vec2 uTextureDimensions;\n\nvoid main(void) {\n  highp vec2 coord =   vTextureCoord.xy / uTextureDimensions;\n  mediump vec4 base_color = texture2D(uSampler, coord);\n  gl_FragColor = vec4(base_color.rgb*base_color.a*vTextureCoord.z, base_color.a*vTextureCoord.z);\n}",[{name:"aPosition",width:2},{name:"aOrientation",width:3},{name:"aLayer",width:2},{name:"aTextureCoord",width:2}],(function(t,e){var i=t.co;t.program.writeVector("aTextureCoord",i.x,i.y,i.x,i.y+i.h,i.x+i.w,i.y,i.x+i.w,i.y+i.h)}))),n.extend({sprite:function(t,e,i,r,o,s,a){var h,c,u;"string"==typeof t&&(s=o,o=r,r=e,i=t,t=1,e=1),"string"==typeof e&&(s=o,o=r,r=i,i=e,e=t),!s&&o&&(s=o),o=parseInt(o||0,10),s=parseInt(s||0,10);var l=function(){this.ready=!0,this.trigger("Invalidate")};(u=n.asset(i))||((u=new Image).src=i,n.asset(i,u),u.onload=function(){for(var t in r)n(t).each(l)});var d=function(){this.requires("2D, Sprite"),this.__trim=[0,0,0,0],this.__image=i,this.__map=r,this.__coord=[this.__coord[0],this.__coord[1],this.__coord[2],this.__coord[3]],this.__tile=t,this.__tileh=e,this.__padding=[o,s],this.__padBorder=a,this.sprite(this.__coord[0],this.__coord[1],this.__coord[2],this.__coord[3]),this.img=u,this.img.complete&&this.img.width>0&&(this.ready=!0,this.trigger("Invalidate")),this.w=this.__coord[2],this.h=this.__coord[3],this._setupSpriteImage(this._drawLayer)};for(h in r)r.hasOwnProperty(h)&&(c=r[h],n.c(h,{ready:!1,__coord:[c[0],c[1],c[2]||1,c[3]||1],init:d}));return this}}),n.c("Sprite",{__image:"",__tile:0,__tileh:0,__padding:null,__trim:null,img:null,ready:!1,init:function(){this.__trim=[0,0,0,0],this.bind("Draw",this._drawSprite),this.bind("LayerAttached",this._setupSpriteImage)},remove:function(){this.unbind("Draw",this._drawSprite),this.unbind("LayerAttached",this._setupSpriteImage)},_setupSpriteImage:function(t){this.__image&&this.img&&t&&"WebGL"===t.type&&(this._establishShader(this.__image,n.defaultShader("Sprite")),this.program.setTexture(t.makeTexture(this.__image,this.img,!1)))},_drawSprite:function(t){var e=t.co,i=t.pos,n=t.ctx;if("canvas"===t.type)n.drawImage(this.img,e.x,e.y,e.w,e.h,i._x,i._y,i._w,i._h);else if("DOM"===t.type){var r=this._h/e.h,o=this._w/e.w,s=this._element.style,a=s.backgroundColor;"initial"===a&&(a="");var h=a+" url('"+this.__image+"') no-repeat";h!==s.background&&(s.background=h),s.backgroundPosition="-"+e.x*o+"px -"+e.y*r+"px",1===r&&1===o||(s.backgroundSize=this.img.width*o+"px "+this.img.height*r+"px")}else"webgl"===t.type&&t.program.draw(t,this)},sprite:function(t,e,i,n){if("string"==typeof t){var r=this.__map[t];if(!r)return this;t=r[0],e=r[1],i=r[2]||1,n=r[3]||1}return this.__coord=this.__coord||[0,0,0,0],this.__coord[0]=t*(this.__tile+this.__padding[0])+(this.__padBorder?this.__padding[0]:0)+this.__trim[0],this.__coord[1]=e*(this.__tileh+this.__padding[1])+(this.__padBorder?this.__padding[1]:0)+this.__trim[1],void 0!==i&&void 0!==n&&(this.__coord[2]=this.__trim[2]||i*this.__tile||this.__tile,this.__coord[3]=this.__trim[3]||n*this.__tileh||this.__tileh),this.trigger("Invalidate"),this},crop:function(t,e,i,n){var r=this._mbr||this.pos();return this.__trim=[],this.__trim[0]=t,this.__trim[1]=e,this.__trim[2]=i,this.__trim[3]=n,this.__coord[0]+=t,this.__coord[1]+=e,this.__coord[2]=i,this.__coord[3]=n,this._w=i,this._h=n,this.trigger("Invalidate",r),this}})},{"../core/core.js":10}],40:[function(t,e,i){var n,r,o=t("../core/core.js");o.c("Text",{_text:"",defaultSize:"10px",defaultFamily:"sans-serif",defaultVariant:"normal",defaultLineHeight:"normal",defaultTextAlign:"left",ready:!0,init:function(){this.requires("2D"),this._textFont={type:"",weight:"",size:this.defaultSize,lineHeight:this.defaultLineHeight,family:this.defaultFamily,variant:this.defaultVariant},this._textAlign=this.defaultTextAlign},events:{Draw:function(t){var e=this._fontString();if("DOM"===t.type){var i=this._element,n=i.style;n.color=this._textColor,n.font=e,n.textAlign=this._textAlign,i.innerHTML=this._text}else if("canvas"===t.type){var r=t.ctx;r.save(),r.textBaseline="top",r.fillStyle=this._textColor||"rgb(0,0,0)",r.font=e,r.textAlign=this._textAlign,r.fillText(this._text,t.pos._x,t.pos._y),r.restore()}},SetStyle:function(t){switch(t){case"textAlign":this._textAlign=this._element.style.textAlign;break;case"color":this.textColor(this._element.style.color);break;case"fontType":this._textFont.type=this._element.style.fontType;break;case"fontWeight":this._textFont.weight=this._element.style.fontWeight;break;case"fontSize":this._textFont.size=this._element.style.fontSize;break;case"fontFamily":this._textFont.family=this._element.style.fontFamily;break;case"fontVariant":this._textFont.variant=this._element.style.fontVariant;break;case"lineHeight":this._textFont.lineHeight=this._element.style.lineHeight}}},remove:function(){this.unbind(this._textUpdateEvent,this._dynamicTextUpdate)},_getFontHeight:(n=/([a-zA-Z]+)\b/,r={px:1,pt:4/3,pc:16,cm:96/2.54,mm:96/25.4,in:96,em:void 0,ex:void 0},function(t){var e=parseFloat(t),i=n.exec(t),o=i?i[1]:"px";return void 0!==r[o]?Math.ceil(e*r[o]):Math.ceil(e)}),_textGenerator:null,text:function(t,e){return null==t?this._text:("function"==typeof t?(this._text=t.call(this,e),this._textGenerator=t):(this._text=t,this._textGenerator=null),this.has("Canvas")&&this._resizeForCanvas(),this.trigger("Invalidate"),this)},_dynamicTextOn:!1,_textUpdateEvent:null,_dynamicTextUpdate:function(t){this._textGenerator&&this.text(this._textGenerator,t)},dynamicTextGeneration:function(t,e){return this.unbind(this._textUpdateEvent,this._dynamicTextUpdate),t&&(this._textUpdateEvent=e||"UpdateFrame",this.bind(this._textUpdateEvent,this._dynamicTextUpdate)),this},_resizeForCanvas:function(){var t=this._drawContext;t.font=this._fontString(),this.w=t.measureText(this._text).width;var e=this._textFont.size||this.defaultSize;this.h=1.1*this._getFontHeight(e),"left"===this._textAlign||"start"===this._textAlign?this.offsetBoundary(0,0,0,0):"center"===this._textAlign?this.offsetBoundary(this.w/2,0,-this.w/2,0):"end"!==this._textAlign&&"right"!==this._textAlign||this.offsetBoundary(this.w,0,-this.w,0)},_fontString:function(){return this._textFont.type+" "+this._textFont.variant+" "+this._textFont.weight+" "+this._textFont.size+" / "+this._textFont.lineHeight+" "+this._textFont.family},textColor:function(t){return o.assignColor(t,this),this._textColor="rgba("+this._red+", "+this._green+", "+this._blue+", "+this._strength+")",this.trigger("Invalidate"),this},textAlign:function(t){return this._textAlign=t,this.has("Canvas")&&this._resizeForCanvas(),this.trigger("Invalidate"),this},textFont:function(t,e){if(1===arguments.length){if("string"==typeof t)return this._textFont[t];if("object"==typeof t)for(var i in t)this._textFont[i]="family"===i?"'"+t[i]+"'":t[i]}else this._textFont[t]=e;return this.has("Canvas")&&this._resizeForCanvas(),this.trigger("Invalidate"),this},unselectable:function(){return this.has("DOM")&&(this.css({"-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",cursor:"default"}),this.trigger("Invalidate")),this}})},{"../core/core.js":10}],41:[function(t,e,i){var n=t("../core/core.js"),r=window.document;n.extend({viewport:{clampToEntities:!0,_width:0,_height:0,_x:0,_y:0,_scale:1,bounds:null,scroll:function(t,e){this[t]=e,n.trigger("ViewportScroll"),n.trigger("InvalidateViewport")},rect_object:{_x:0,_y:0,_w:0,_h:0},rect:function(t){return(t=t||this.rect_object)._x=-this._x,t._y=-this._y,t._w=this._width/this._scale,t._h=this._height/this._scale,t},pan:function(){var t,e,i,r,o;function s(s){o.tick(s.dt);var h=o.value();n.viewport.x=(1-h)*i+h*t,n.viewport.y=(1-h)*r+h*e,n.viewport._clamp(),o.complete&&(a(),n.trigger("CameraAnimationDone"))}function a(){n.unbind("UpdateFrame",s)}return n._preBind("StopCamera",a),function(a,h,c,u){n.trigger("StopCamera"),"reset"!==a&&(i=n.viewport._x,r=n.viewport._y,t=i-a,e=r-h,o=new n.easing(c,u),n.uniqueBind("UpdateFrame",s))}}(),follow:function(){var t,e,i;function r(){var t=n.viewport._scale;n.viewport.scroll("_x",-(this.x+this.w/2-n.viewport.width/2/t-e*t)),n.viewport.scroll("_y",-(this.y+this.h/2-n.viewport.height/2/t-i*t)),n.viewport._clamp()}return n._preBind("StopCamera",(function(){t&&(t.unbind("Move",r),t.unbind("ViewportScale",r),t.unbind("ViewportResize",r))})),function(o,s,a){o&&o.has("2D")&&(n.trigger("StopCamera"),t=o,e=void 0!==s?s:0,i=void 0!==a?a:0,o.bind("Move",r),o.bind("ViewportScale",r),o.bind("ViewportResize",r),r.call(o))}}(),centerOn:function(t,e){var i=t.x+n.viewport.x,r=t.y+n.viewport.y,o=t.w/2,s=t.h/2,a=i+o-n.viewport.width/2/n.viewport._scale,h=r+s-n.viewport.height/2/n.viewport._scale;n.viewport.pan(a,h,e)},zoom:function(){function t(){n.unbind("UpdateFrame",u)}var e,i,r,o,s,a,h,c;function u(i){var u,l;c.tick(i.dt),u=Math.pow(r,c.value()),l=1===r?c.value():(1/u-1)/(1/r-1),n.viewport.scale(u*e),n.viewport.scroll("_x",o*(1-l)+s*l),n.viewport.scroll("_y",a*(1-l)+h*l),n.viewport._clamp(),c.complete&&(t(),n.trigger("CameraAnimationDone"))}return n._preBind("StopCamera",t),function(t,l,d,f,p){t?(arguments.length<=2&&(f=l,l=n.viewport.x-n.viewport.width,d=n.viewport.y-n.viewport.height),n.trigger("StopCamera"),e=n.viewport._scale,i=e*(r=t),o=n.viewport.x,a=n.viewport.y,s=-(l-n.viewport.width/(2*i)),h=-(d-n.viewport.height/(2*i)),c=new n.easing(f,p),n.uniqueBind("UpdateFrame",u)):n.viewport.scale(1)}}(),scale:function(t){this._scale=t||1,n.trigger("InvalidateViewport"),n.trigger("ViewportScale")},mouselook:function(){var t,e=!1,i=!1,r={x:0,y:0},o={x:0,y:0};function s(t){i||t.target||(n.trigger("StopCamera"),r.x=t.clientX,r.y=t.clientY,i=!0)}function a(t){if(i){o.x=t.clientX-r.x,o.y=t.clientY-r.y,r.x=t.clientX,r.y=t.clientY;var e=n.viewport;e.x+=o.x/e._scale,e.y+=o.y/e._scale,e._clamp()}}function h(t){i&&(i=!1)}return function(i){t=n.s("Mouse"),i&&!e?(t.bind("MouseDown",s),t.bind("MouseMove",a),t.bind("MouseUp",h),e=i):!i&&e&&(t.unbind("MouseDown",s),t.unbind("MouseMove",a),t.unbind("MouseUp",h),e=i)}}(),_clamp:function(){if(this.clampToEntities){var t=n.clone(this.bounds)||n.map.boundaries();t.max.x*=this._scale,t.min.x*=this._scale,t.max.y*=this._scale,t.min.y*=this._scale,t.max.x-t.min.x>n.viewport.width?n.viewport.x<(-t.max.x+n.viewport.width)/this._scale?n.viewport.x=(-t.max.x+n.viewport.width)/this._scale:n.viewport.x>-t.min.x&&(n.viewport.x=-t.min.x):n.viewport.x=-1*(t.min.x+(t.max.x-t.min.x)/2-n.viewport.width/2),t.max.y-t.min.y>n.viewport.height?n.viewport.y<(-t.max.y+n.viewport.height)/this._scale?n.viewport.y=(-t.max.y+n.viewport.height)/this._scale:n.viewport.y>-t.min.y&&(n.viewport.y=-t.min.y):n.viewport.y=-1*(t.min.y+(t.max.y-t.min.y)/2-n.viewport.height/2)}},init:function(t,e,i){var o;if(void 0===i&&void 0===e&&void 0!==t&&"number"!=typeof t&&(i=t,t=window.innerWidth,e=window.innerHeight),n.createLayer("DefaultCanvasLayer","Canvas",{z:20}),n.createLayer("DefaultDOMLayer","DOM",{z:30}),n.createLayer("DefaultWebGLLayer","WebGL",{z:10}),this._defineViewportProperties(),this._x=0,this._y=0,this._scale=1,this.bounds=null,this._width=t||window.innerWidth,this._height=e||window.innerHeight,void 0===i&&(i="cr-stage"),"string"==typeof i)o=r.getElementById(i);else{if(!("undefined"!=typeof HTMLElement?i instanceof HTMLElement:i instanceof Element))throw new TypeError("stage_elem must be a string or an HTMLElement");o=i}n.stage={x:0,y:0,fullscreen:!1,elem:o||r.createElement("div")},t||e||(r.body.style.overflow="hidden",n.stage.fullscreen=!0),n.addEvent(this,window,"resize",n.viewport.reload),n.addEvent(this,window,"blur",(function(){n.settings.get("autoPause")&&(n._paused||n.pause())})),n.addEvent(this,window,"focus",(function(){n._paused&&n.settings.get("autoPause")&&n.pause()})),n.settings.register("stageSelectable",(function(t){n.stage.elem.onselectstart=t?function(){return!0}:function(){return!1}})),n.settings.modify("stageSelectable",!1),n.settings.register("stageContextMenu",(function(t){n.stage.elem.oncontextmenu=t?function(){return!0}:function(){return!1}})),n.settings.modify("stageContextMenu",!1),n.settings.register("autoPause",(function(){})),n.settings.modify("autoPause",!1),o||(r.body.appendChild(n.stage.elem),n.stage.elem.id=i);var s,a=n.stage.elem.style;if(a.width=this.width+"px",a.height=this.height+"px",a.overflow="hidden",n.bind("ViewportResize",(function(){n.trigger("InvalidateViewport")})),n.mobile){void 0!==typeof a.webkitTapHighlightColor&&(a.webkitTapHighlightColor="rgba(0,0,0,0)");var h=r.createElement("meta"),c=r.getElementsByTagName("head")[0];(h=r.createElement("meta")).setAttribute("name","apple-mobile-web-app-capable"),h.setAttribute("content","yes"),c.appendChild(h),n.addEvent(this,n.stage.elem,"touchmove",(function(t){t.preventDefault()}))}a.position="relative",s=n.domHelper.innerPosition(n.stage.elem),n.stage.x=s.x,n.stage.y=s.y,n.uniqueBind("ViewportResize",this._resize)},_resize:function(){n.stage.elem.style.width=n.viewport.width+"px",n.stage.elem.style.height=n.viewport.height+"px"},_defineViewportProperties:function(){Object.defineProperty(this,"x",{set:function(t){this.scroll("_x",t)},get:function(){return this._x},configurable:!0}),Object.defineProperty(this,"y",{set:function(t){this.scroll("_y",t)},get:function(){return this._y},configurable:!0}),Object.defineProperty(this,"width",{set:function(t){this._width=t,n.trigger("ViewportResize")},get:function(){return this._width},configurable:!0}),Object.defineProperty(this,"height",{set:function(t){this._height=t,n.trigger("ViewportResize")},get:function(){return this._height},configurable:!0})},reload:function(){var t,e=window.innerWidth,i=window.innerHeight;n.stage.fullscreen&&(this._width=e,this._height=i,n.trigger("ViewportResize")),t=n.domHelper.innerPosition(n.stage.elem),n.stage.x=t.x,n.stage.y=t.y},reset:function(){n.viewport.mouselook(!1),n.trigger("StopCamera"),n.viewport.scroll("_x",0),n.viewport.scroll("_y",0),n.viewport.scale(1)},onScreen:function(t){return n.viewport._x+t._x+t._w>0&&n.viewport._y+t._y+t._h>0&&n.viewport._x+t._x<n.viewport.width&&n.viewport._y+t._y<n.viewport.height}}})},{"../core/core.js":10}],42:[function(t,e,i){var n=t("../core/core.js"),r=window.document;function o(t,e){this.shader=e,this.layer=t,this.context=t.context,this.draw=function(){},this.array_size=16,this.max_size=1024,this._indexArray=new Uint16Array(6*this.array_size),this._indexBuffer=t.context.createBuffer()}o.prototype={initAttributes:function(t){this.attributes=t,this._attribute_table={};for(var e=0,i=0;i<t.length;i++){var n=t[i];this._attribute_table[n.name]=n,n.bytes=n.bytes||Float32Array.BYTES_PER_ELEMENT,n.type=n.type||this.context.FLOAT,n.offset=e,n.location=this.context.getAttribLocation(this.shader,n.name),this.context.enableVertexAttribArray(n.location),e+=n.width}this.stride=e,this._attributeArray=new Float32Array(4*this.array_size*this.stride),this._attributeBuffer=this.context.createBuffer(),this._registryHoles=[],this._registrySize=0},growArrays:function(t){if(!(this.array_size>=this.max_size)){var e=Math.min(t,this.max_size),i=new Float32Array(4*e*this.stride),n=new Uint16Array(6*e);i.set(this._attributeArray),n.set(this._indexArray),this._attributeArray=i,this._indexArray=n,this.array_size=e}},registerEntity:function(t){if(0===this._registryHoles.length){if(this._registrySize>=this.max_size)throw"Number of entities exceeds maximum limit.";this._registrySize>=this.array_size&&this.growArrays(2*this.array_size),t._glBufferIndex=this._registrySize,this._registrySize++}else t._glBufferIndex=this._registryHoles.pop()},unregisterEntity:function(t){"number"==typeof t._glBufferIndex&&this._registryHoles.push(t._glBufferIndex),t._glBufferIndex=null},resetRegistry:function(){this._maxElement=0,this._registryHoles.length=0},setCurrentEntity:function(t){this.ent_offset=4*t._glBufferIndex,this.ent=t},switchTo:function(){var t=this.context;t.useProgram(this.shader),t.bindBuffer(t.ARRAY_BUFFER,this._attributeBuffer);for(var e,i=this.attributes,n=0;n<i.length;n++)e=i[n],t.vertexAttribPointer(e.location,e.width,e.type,!1,this.stride*e.bytes,e.offset*e.bytes);var r=this.texture_obj;r&&null===r.unit&&this.layer.texture_manager.bindTexture(r),this.index_pointer=0},setTexture:function(t){void 0===this.texture_obj&&(t.setToProgram(this.shader,"uSampler","uTextureDimensions"),this.texture_obj=t)},addIndices:function(t){var e=this._indexArray,i=this.index_pointer;e[0+i]=0+t,e[1+i]=1+t,e[2+i]=2+t,e[3+i]=1+t,e[4+i]=2+t,e[5+i]=3+t,this.index_pointer+=6},renderBatch:function(){var t=this.context;t.bindBuffer(t.ARRAY_BUFFER,this._attributeBuffer),t.bufferData(t.ARRAY_BUFFER,this._attributeArray,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this._indexArray,t.STATIC_DRAW),t.drawElements(t.TRIANGLES,this.index_pointer,t.UNSIGNED_SHORT,0)},setViewportUniforms:function(t,e){var i=this.context;i.useProgram(this.shader),i.uniform4f(this.shader.viewport,-t._x,-t._y,t._w,t._h)},writeVector:function(t,e,i){for(var n=this._attribute_table[t],r=this.stride,o=n.offset+this.ent_offset*r,s=n.width,a=arguments.length-1,h=this._attributeArray,c=0;c<4;c++)for(var u=0;u<s;u++)h[o+r*c+u]=arguments[(s*c+u)%a+1]}},n._registerLayerTemplate("WebGL",{type:"WebGL",context:null,_compileShader:function(t,e){var i=this.context,n=i.createShader(e);if(i.shaderSource(n,t),i.compileShader(n),!i.getShaderParameter(n,i.COMPILE_STATUS))throw i.getShaderInfoLog(n);return n},_makeProgram:function(t){var e=this.context,i=this._compileShader(t.fragmentCode,e.FRAGMENT_SHADER),n=this._compileShader(t.vertexCode,e.VERTEX_SHADER),r=e.createProgram();if(e.attachShader(r,n),e.attachShader(r,i),e.linkProgram(r),!e.getProgramParameter(r,e.LINK_STATUS))throw"Could not initialise shaders";return r.viewport=e.getUniformLocation(r,"uViewport"),r},getProgramWrapper:function(t,e){if(void 0===this.programs[t]){var i=new o(this,this._makeProgram(e));i.name=t,i.initAttributes(e.attributeList),i.draw=e.drawCallback,i.setViewportUniforms(this._viewportRect(),this.options),this.programs[t]=i}return this.programs[t]},makeTexture:function(t,e,i){return this.texture_manager.makeTexture(t,e,i)},events:{LayerInit:"layerInit",LayerRemove:"layerRemove",RenderScene:"_render",PixelartSet:"_setPixelart",ViewportResize:"_resize"},layerInit:function(){if(!n.support.webgl)return n.trigger("NoWebGL"),void n.stop();var t,e;this.programs={},(t=r.createElement("canvas")).width=n.viewport.width,t.height=n.viewport.height,t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.style.zIndex=this.options.z,n.stage.elem.appendChild(t);try{(e=t.getContext("webgl",{premultipliedalpha:!0})||t.getContext("experimental-webgl",{premultipliedalpha:!0})).viewportWidth=t.width,e.viewportHeight=t.height}catch(t){return n.trigger("NoWebGL"),void n.stop()}this.context=e,this._canvas=t,e.clearColor(0,0,0,0),e.disable(e.DEPTH_TEST),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),e.enable(e.BLEND),this.texture_manager=new n.TextureManager(e,this),this._dirtyViewport=!0},layerRemove:function(){this._canvas.parentNode.removeChild(this._canvas)},_resize:function(){var t=this._canvas;t.width=n.viewport.width,t.height=n.viewport.height;var e=this.context;e.viewportWidth=t.width,e.viewportHeight=t.height},_setPixelart:function(t){var e=this.context;this.texture_filter=t?e.NEAREST:e.LINEAR},visible_gl:[],_render:function(t){t=t||this._viewportRect();var e=this.context;e.viewport(0,0,e.viewportWidth,e.viewportHeight),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);var i=this.programs;if(this._dirtyViewport){var r=this._viewportRect();for(var o in i)i[o].setViewportUniforms(r,this.options);this._dirtyViewport=!1}var s,a=n.map.search(t),h=0,c=a.length,u=this.visible_gl;for(u.length=0,h=0;h<c;h++)(s=a[h])._visible&&s.program&&s._drawLayer===this&&u.push(s);u.sort(this._sort),c=u.length;var l=null;for(h=0;h<c;h++)l!==(s=u[h]).program&&(null!==l&&l.renderBatch(),(l=s.program).index_pointer=0,l.switchTo()),s.draw(),s._changed=!1;null!==l&&l.renderBatch()},dirty:function(t){},attach:function(t){t._drawContext=this.context},detach:function(t){t.program&&t.program.unregisterEntity(t)}})},{"../core/core.js":10}],43:[function(t,e,i){var n=t("../core/core.js");n.extend({WebGLShader:function(t,e,i,n){this.vertexCode=t,this.fragmentCode=e,this.attributeList=i,this.drawCallback=n},defaultShader:function(t,e){if(this._defaultShaders=this._defaultShaders||{},1===arguments.length)return this._defaultShaders[t];this._defaultShaders[t]=e}}),n.c("WebGL",{init:function(){this.requires("Renderable"),this._customLayer||this._attachToLayer(n.s("DefaultWebGLLayer"))},remove:function(){this._detachFromLayer()},drawVars:{type:"webgl",pos:{},ctx:null,coord:[0,0,0,0],co:{x:0,y:0,w:0,h:0}},draw:function(){if(this.ready){var t=this.drawVars.pos;t._x=this._x,t._y=this._y,t._w=this._w,t._h=this._h;var e=this.__coord||[0,0,0,0],i=this.drawVars.co;i.x=e[0],i.y=e[1],i.w=e[2],i.h=e[3],this._flipX&&(i.x=i.x+i.w,i.w=-i.w),this._flipY&&(i.y=i.y+i.h,i.h=-i.h);var n=this._drawContext;this.drawVars.gl=n;var r=this.drawVars.program=this.program;return r.setCurrentEntity(this),r.writeVector("aPosition",this._x,this._y,this._x,this._y+this._h,this._x+this._w,this._y,this._x+this._w,this._y+this._h),r.writeVector("aOrientation",this._origin.x+this._x,this._origin.y+this._y,this._rotation*Math.PI/180),r.writeVector("aLayer",this._globalZ,this._alpha),this.trigger("Draw",this.drawVars),r.addIndices(r.ent_offset),this}},_establishShader:function(t,e){this.program=this._drawLayer.getProgramWrapper(t,e),this.program.registerEntity(this),this.ready=!0}})},{"../core/core.js":10}],44:[function(t,e,i){var n=t("../core/core.js");n.extend({device:{_deviceOrientationCallback:!1,_deviceMotionCallback:!1,_normalizeDeviceOrientation:function(t){var e;window.DeviceOrientationEvent?e={tiltLR:t.gamma,tiltFB:t.beta,dir:t.alpha,motUD:null}:window.OrientationEvent&&(e={tiltLR:90*t.x,tiltFB:-90*t.y,dir:null,motUD:t.z}),n.device._deviceOrientationCallback(e)},_normalizeDeviceMotion:function(t){var e=t.accelerationIncludingGravity,i=e.z>0?1:-1,r={acceleration:e,rawAcceleration:"["+Math.round(e.x)+", "+Math.round(e.y)+", "+Math.round(e.z)+"]",facingUp:i,tiltLR:Math.round(e.x/9.81*-90),tiltFB:Math.round((e.y+9.81)/9.81*90*i)};n.device._deviceMotionCallback(r)},deviceOrientation:function(t){this._deviceOrientationCallback=t,n.support.deviceorientation&&(window.DeviceOrientationEvent?n.addEvent(this,window,"deviceorientation",this._normalizeDeviceOrientation):window.OrientationEvent&&n.addEvent(this,window,"MozOrientation",this._normalizeDeviceOrientation))},deviceMotion:function(t){this._deviceMotionCallback=t,n.support.devicemotion&&window.DeviceMotionEvent&&n.addEvent(this,window,"devicemotion",this._normalizeDeviceMotion)}}})},{"../core/core.js":10}],45:[function(t,e,i){e.exports={_events:{},addEvent:function(t,e,i,n){3===arguments.length&&(n=i,i=e,e=window.document);var r=t[0]||"",o=function(e){n.call(t,e)};this._events[r+e+i+n]||(this._events[r+e+i+n]=o,e.addEventListener(i,o,!1))},removeEvent:function(t,e,i,n){3===arguments.length&&(n=i,i=e,e=window.document);var r=t[0]||"",o=this._events[r+e+i+n];o&&(e.removeEventListener(i,o,!1),delete this._events[r+e+i+n])}}},{}],46:[function(t,e,i){var n=t("../core/core.js");n.s("Keyboard",n.extend.call(n.extend.call(new n.__eventDispatcher,{_evt:{eventName:"",key:0,which:0,originalEvent:null},prepareEvent:function(t){var e=this._evt,i=t.type;return e.eventName="keydown"===i?"KeyDown":"keyup"===i?"KeyUp":i,e.which=null!==t.charCode?t.charCode:t.keyCode,e.key=t.keyCode||t.which,e.originalEvent=t,e},triggerKeyEvent:function(t,e){n.trigger(t,e)},dispatchEvent:function(t){var e=this.prepareEvent(t);this.triggerKey(e.eventName,e)}}),n.__keyboardStateTemplate),{},!1),n.c("Keyboard",{isDown:function(t){return n.s("Keyboard").isKeyDown(t)}})},{"../core/core.js":10}],47:[function(t,e,i){var n=t("../core/core.js"),r=window.document,o=void 0!==r.onwheel?"wheel":void 0!==r.onmousewheel?"mousewheel":"DOMMouseScroll";n._preBind("Load",(function(){n.addEvent(this,r.body,"mouseup",n.detectBlur),n.addEvent(n.s("Keyboard"),window,"blur",n.s("Keyboard").resetKeyDown),n.addEvent(n.s("Mouse"),window,"mouseup",n.s("Mouse").resetButtonDown),n.addEvent(n.s("Touch"),window,"touchend",n.s("Touch").resetTouchPoints),n.addEvent(n.s("Touch"),window,"touchcancel",n.s("Touch").resetTouchPoints),n.addEvent(n.s("Keyboard"),"keydown",n.s("Keyboard").processEvent),n.addEvent(n.s("Keyboard"),"keyup",n.s("Keyboard").processEvent),n.addEvent(n.s("Mouse"),n.stage.elem,"mousedown",n.s("Mouse").processEvent),n.addEvent(n.s("Mouse"),n.stage.elem,"mouseup",n.s("Mouse").processEvent),n.addEvent(n.s("Mouse"),n.stage.elem,"mousemove",n.s("Mouse").processEvent),n.addEvent(n.s("Mouse"),n.stage.elem,"click",n.s("Mouse").processEvent),n.addEvent(n.s("Mouse"),n.stage.elem,"dblclick",n.s("Mouse").processEvent),n.addEvent(this,n.stage.elem,"touchstart",this._touchDispatch),n.addEvent(this,n.stage.elem,"touchmove",this._touchDispatch),n.addEvent(this,n.stage.elem,"touchend",this._touchDispatch),n.addEvent(this,n.stage.elem,"touchcancel",this._touchDispatch),n.addEvent(this,n.stage.elem,"touchleave",this._touchDispatch),n.addEvent(n.s("MouseWheel"),n.stage.elem,o,n.s("MouseWheel").processEvent)})),n.bind("Pause",(function(){n.s("Keyboard").resetKeyDown(),n.s("Mouse").resetButtonDown()})),n._preBind("CraftyStop",(function(){n.s("Keyboard").resetKeyDown(),n.s("Mouse").resetButtonDown()})),n._preBind("CraftyStop",(function(){n.removeEvent(this,r.body,"mouseup",n.detectBlur),n.removeEvent(n.s("Keyboard"),window,"blur",n.s("Keyboard").resetKeyDown),n.removeEvent(n.s("Mouse"),window,"mouseup",n.s("Mouse").resetButtonDown),n.removeEvent(n.s("Touch"),window,"touchend",n.s("Touch").resetTouchPoints),n.removeEvent(n.s("Touch"),window,"touchcancel",n.s("Touch").resetTouchPoints),n.removeEvent(n.s("Keyboard"),"keydown",n.s("Keyboard").processEvent),n.removeEvent(n.s("Keyboard"),"keyup",n.s("Keyboard").processEvent),n.stage&&(n.removeEvent(n.s("Mouse"),n.stage.elem,"mousedown",n.s("Mouse").processEvent),n.removeEvent(n.s("Mouse"),n.stage.elem,"mouseup",n.s("Mouse").processEvent),n.removeEvent(n.s("Mouse"),n.stage.elem,"mousemove",n.s("Mouse").processEvent),n.removeEvent(n.s("Mouse"),n.stage.elem,"click",n.s("Mouse").processEvent),n.removeEvent(n.s("Mouse"),n.stage.elem,"dblclick",n.s("Mouse").processEvent),n.removeEvent(this,n.stage.elem,"touchstart",this._touchDispatch),n.removeEvent(this,n.stage.elem,"touchmove",this._touchDispatch),n.removeEvent(this,n.stage.elem,"touchend",this._touchDispatch),n.removeEvent(this,n.stage.elem,"touchcancel",this._touchDispatch),n.removeEvent(this,n.stage.elem,"touchleave",this._touchDispatch),n.removeEvent(n.s("MouseWheel"),n.stage.elem,o,n.s("MouseWheel").processEvent))}))},{"../core/core.js":10}],48:[function(t,e,i){var n=t("../core/core.js");n.s("MouseWheel",n.extend.call(new n.__eventDispatcher,{_evt:{eventName:"",direction:0,target:null,clientX:0,clientY:0,realX:0,realY:0,originalEvent:null},_mouseSystem:null,prepareEvent:function(t){var e=this._mouseSystem;e||(this._mouseSystem=e=n.s("Mouse"));var i=this._evt;return i.eventName="MouseWheelScroll",i.direction=t.detail<0||t.wheelDelta>0||t.deltaY<0?1:-1,i.clientX=void 0!==t.clientX?t.clientX:e.lastMouseEvent.clientX,i.clientY=void 0!==t.clientY?t.clientY:e.lastMouseEvent.clientY,n.translatePointerEventCoordinates(t,i),i.target=e.mouseObjs?n.findPointerEventTargetByComponent("Mouse",t):null,i.originalEvent=t,i},dispatchEvent:function(t){var e=this.prepareEvent(t);n.trigger("MouseWheelScroll",e)}}),{},!1),n.s("Mouse",n.extend.call(n.extend.call(new n.__eventDispatcher,{normedEventNames:{mousedown:"MouseDown",mouseup:"MouseUp",dblclick:"DoubleClick",click:"Click",mousemove:"MouseMove"},_evt:{eventName:"",mouseButton:-1,target:null,clientX:0,clientY:0,realX:0,realY:0,originalEvent:null},mouseObjs:0,over:null,prepareEvent:function(t){var e=this._evt,i=t.type;return e.eventName=this.normedEventNames[i]||i,void 0===t.which?e.mouseButton=t.button<2?n.mouseButtons.LEFT:4===t.button?n.mouseButtons.MIDDLE:n.mouseButtons.RIGHT:e.mouseButton=t.which<2?n.mouseButtons.LEFT:2===t.which?n.mouseButtons.MIDDLE:n.mouseButtons.RIGHT,e.clientX=t.clientX,e.clientY=t.clientY,n.translatePointerEventCoordinates(t,e),e.target=this.mouseObjs?n.findPointerEventTargetByComponent("Mouse",t):null,e.originalEvent=t,e},triggerMouseEvent:function(t,e){this.trigger(t,e);var i=this.over,n=e.target;"MouseMove"===t&&i!==n&&(i&&(e.eventName="MouseOut",e.target=i,i.trigger("MouseOut",e),e.eventName="MouseMove",e.target=n),this.over=n,n&&(e.eventName="MouseOver",n.trigger("MouseOver",e),e.eventName="MouseMove")),n&&n.trigger(t,e)},dispatchEvent:function(t){var e=this.prepareEvent(t);this.triggerMouse(e.eventName,e)}}),n.__mouseStateTemplate),{},!1),n.c("Mouse",{required:"AreaMap",init:function(){n.s("Mouse").mouseObjs++},remove:function(){n.s("Mouse").mouseObjs--}}),n.c("MouseDrag",{_dragging:!1,required:"Mouse",events:{MouseDown:"_ondown"},init:function(){this._ondown=this._ondown.bind(this),this._ondrag=this._ondrag.bind(this),this._onup=this._onup.bind(this)},_ondown:function(t){t.mouseButton===n.mouseButtons.LEFT&&this.startDrag(t)},_ondrag:function(t){if(!this._dragging||0===t.realX||0===t.realY)return!1;this.trigger("Dragging",t)},_onup:function(t){t.mouseButton===n.mouseButtons.LEFT&&this.stopDrag(t)},startDrag:function(t){if(!this._dragging)return this._dragging=!0,n.s("Mouse").bind("MouseMove",this._ondrag),n.s("Mouse").bind("MouseUp",this._onup),this.trigger("StartDrag",t||n.s("Mouse").lastMouseEvent),this},stopDrag:function(t){if(this._dragging)return this._dragging=!1,n.s("Mouse").unbind("MouseMove",this._ondrag),n.s("Mouse").unbind("MouseUp",this._onup),this.trigger("StopDrag",t||n.s("Mouse").lastMouseEvent),this}})},{"../core/core.js":10}],49:[function(t,e,i){var n=t("../core/core.js");n.extend({findPointerEventTargetByComponent:function(t,e,i){var r=e.target||e.srcElement||n.stage.elem;i=void 0!==i?i:e.clientY,e=void 0!==e.clientX?e.clientX:e;var o,s,a,h,c,u=null,l=-1/0;if("CANVAS"!==r.nodeName){for(;"string"!=typeof r.id&&-1===r.id.indexOf("ent");)r=r.parentNode;var d=n(parseInt(r.id.replace("ent",""),10));c=n.domHelper.translate(e,i,d._drawLayer),d.__c[t]&&d.isAt(c.x,c.y)&&(u=d)}if(!u)for(var f in n._drawLayers){var p=n._drawLayers[f];if(!(p._pointerEntities<=0))for(c=n.domHelper.translate(e,i,p),h=0,a=(s=n.map.unfilteredSearch({_x:c.x,_y:c.y,_w:1,_h:1})).length;h<a;++h)(o=s[h])._visible&&o._drawLayer===p&&o._globalZ>l&&o.__c[t]&&o.isAt(c.x,c.y)&&(l=o._globalZ,u=o)}return u},translatePointerEventCoordinates:function(t,e){e=e||t;var i=n.domHelper.translate(t.clientX,t.clientY,void 0,this.__pointerPos);e.realX=i.x,e.realY=i.y},__pointerPos:{x:0,y:0}}),n.c("AreaMap",{init:function(){this.has("Renderable")&&this._drawLayer&&this._drawLayer._pointerEntities++},remove:function(t){!t&&this.has("Renderable")&&this._drawLayer&&this._drawLayer._pointerEntities--},events:{LayerAttached:function(t){t._pointerEntities++},LayerDetached:function(t){t._pointerEntities--}},areaMap:function(t){if(arguments.length>1){var e=Array.prototype.slice.call(arguments,0);t=new n.polygon(e)}else t=t.constructor===Array?new n.polygon(t.slice()):t.clone();return t.shift(this._x,this._y),this.mapArea=t,this.attach(this.mapArea),this.trigger("NewAreaMap",t),this}}),n.c("Button",{init:function(){var t=!n.mobile||n.mobile&&!n.multitouch()?"Mouse":"Touch";this.requires(t)}})},{"../core/core.js":10}],50:[function(t,e,i){var n,r,o,s=t("../core/core.js");s.extend({multitouch:function(t){return"boolean"!=typeof t?this._multitouch:(this._multitouch=t,this)},_multitouch:!1,_touchDispatch:(r=0,o=0,function(t){s._multitouch?(n||(n=s.s("Touch")),n.processEvent(t)):function(t){var e,i;"touchstart"===t.type?e="mousedown":"touchmove"===t.type?e="mousemove":"touchend"===t.type?e="mouseup":"touchcancel"===t.type?e="mouseup":"touchleave"===t.type&&(e="mouseup"),t.touches&&t.touches.length?i=t.touches[0]:t.changedTouches&&t.changedTouches.length&&(i=t.changedTouches[0]);var n=document.createEvent("MouseEvent");if(n.initMouseEvent(e,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,t.relatedTarget),i.target.dispatchEvent(n),"mousedown"===e)r=i.clientX,o=i.clientY;else if("mouseup"===e){var s=i.clientX-r,a=i.clientY-o;s*s+a*a<=256&&(e="click",(n=document.createEvent("MouseEvent")).initMouseEvent(e,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,t.relatedTarget),i.target.dispatchEvent(n))}t.preventDefault()}(t)})}),s.s("Touch",s.extend.call(s.extend.call(new s.__eventDispatcher,{normedEventNames:{touchstart:"TouchStart",touchmove:"TouchMove",touchend:"TouchEnd",touchcancel:"TouchCancel"},_evt:{eventName:"",identifier:-1,target:null,entity:null,realX:0,realY:0,originalEvent:null},touchObjs:0,overs:{},prepareEvent:function(t,e){var i=this._evt;return i.eventName=this.normedEventNames[e]||e,i.identifier=t.identifier,s.translatePointerEventCoordinates(t,i),i.target=this.touchObjs?s.findPointerEventTargetByComponent("Touch",t):null,i.entity=i.target,i},triggerTouchEvent:function(t,e){this.trigger(t,e);var i=e.identifier,n=e.target,r=this.overs[i];r&&("TouchMove"===t&&r!==n||"TouchEnd"===t||"TouchCancel"===t)&&(e.eventName="TouchOut",e.target=r,e.entity=r,r.trigger("TouchOut",e),e.eventName=t,e.target=n,e.entity=n,delete this.overs[i]),n&&n.trigger(t,e),n&&("TouchStart"===t||"TouchMove"===t&&r!==n)&&(e.eventName="TouchOver",n.trigger("TouchOver",e),e.eventName=t,this.overs[i]=n)},dispatchEvent:function(t){for(var e,i=t.changedTouches,n=0,r=i.length;n<r;n++)(e=this.prepareEvent(i[n],t.type)).originalEvent=t,this.triggerTouch(e.eventName,e)}}),s.__touchStateTemplate),{},!1),s.c("Touch",{required:"AreaMap",init:function(){s.s("Touch").touchObjs++},remove:function(){s.s("Touch").touchObjs--}})},{"../core/core.js":10}],51:[function(t,e,i){var n=t("../core/core.js");n.__eventDispatcher=function(){},n.__eventDispatcher.prototype={processEvent:function(t){return this.dispatchEvent(t),this.preventBubbling(t)},dispatchEvent:function(t){},preventBubbling:function(t){if(n.selected&&!(8===t.key||t.key>=112&&t.key<=135))return t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,!(!t.target||"INPUT"!==t.target.nodeName&&"TEXTAREA"!==t.target.nodeName)||(t.preventDefault?t.preventDefault():t.returnValue=!1,!1)}},n.extend({selected:!0,detectBlur:function(t){var e=t.clientX>n.stage.x&&t.clientX<n.stage.x+n.viewport.width&&t.clientY>n.stage.y&&t.clientY<n.stage.y+n.viewport.height;!n.selected&&e&&n.trigger("CraftyFocus"),n.selected&&!e&&n.trigger("CraftyBlur"),n.selected=e}})},{"../core/core.js":10}],52:[function(t,e,i){var n=t("../core/core.js");n.extend({diamondIso:{_tile:{width:0,height:0},getTileDimensions:function(){return{w:this._tile.width,h:this._tile.height}},_map:{width:0,height:0},_origin:{x:0,y:0},_tiles:[],getTile:function(t,e,i){return this._tiles[t][e][i]},init:function(t,e,i,n,r,o){this._tile.width=parseInt(t,10),this._tile.height=parseInt(e,10)||parseInt(t,10)/2,this._tile.r=this._tile.width/this._tile.height,this._map.width=parseInt(i,10),this._map.height=parseInt(n,10)||parseInt(i,10);for(var s=0;s<i;s++){this._tiles[s]=Array();for(var a=0;a<n;a++)this._tiles[s][a]=Array()}return this.x=parseInt(r,10)||0,this.y=parseInt(o,10)||0,this.layerZLevel=i+n+1,this},place:function(t,e,i,n){var r=this.pos2px(e,i),o=t.h/this._tile.height;t.x=r.x,t.y=r.y-(o-2)*this._tile.height-this._tile.height*n,t.z=this.getZAtLoc(e,i,n);for(var s=0;s<=o-2;s++){var a=this._tiles[e][i][n+s];a&&a!==t&&a.destroy(),this._tiles[e][i][n+s]=t}return this},detachTile:function(t){for(var e=0;e<this._map.width;e++)for(var i=0;i<this._map.height;i++)for(var n=this._tiles[e][i].length,r=0;r<n;r++)if(this._tiles[e][i][r]&&t===this._tiles[e][i][r]){for(var o=t.h/this._tile.height,s=0;s<o;s++)this._tiles[e][i][r+s]=void 0;return{x:e,y:i,z:r}}return!1},centerAt:function(t,e){var i=this.pos2px(t,e);n.viewport.x=-i.x+n.viewport.width/2-this._tile.width,n.viewport.y=-i.y+n.viewport.height/2},getZAtLoc:function(t,e,i){return this.layerZLevel*i+t+e},pos2px:function(t,e){return{x:this.x+(t-e-1)*this._tile.width/2,y:this.y+(t+e)*this._tile.height/2}},px2pos:function(t,e){var i=(e-this.y)/this._tile.height,n=(t-this.x)/this._tile.width,r=i+n,o=i-n,s=r>0&&r<this._map.width,a=o>0&&o<this._map.height;if(s&&a)return{x:~~r,y:~~o}},getOverlappingTiles:function(t,e){var i=this.px2pos(t,e),n=[],r=~~i.x,o=~~i.y,s=this._map.width-r,a=this._map.height-o,h=Math.min(s,a),c=this._tiles[r][o][1];c&&n.push(c);for(var u=1;u<h;u++){var l=this._tiles[r+u][o+u][u];l&&n.push(l)}return n},polygon:function(t){t.requires("Collision");var e=[0,t.h-0-this._tile.height/2,0-this._tile.width/2,t.h-0-0,0-this._tile.width,t.h-0-this._tile.height/2,0-this._tile.width/2,t.h-0-this._tile.height];return new n.polygon(e)}}})},{"../core/core.js":10}],53:[function(t,e,i){var n=t("../core/core.js");n.extend({isometric:{_tile:{width:0,height:0},_elements:{},_pos:{x:0,y:0},_z:0,size:function(t,e){return this._tile.width=t,this._tile.height=e>0?e:t/2,this},place:function(t,e,i,r){var o=this.pos2px(t,e);return o.top-=i*(this._tile.height/2),r.x=o.left+n.viewport._x,r.y=o.top+n.viewport._y,r.z+=i,this},pos2px:function(t,e){return{left:t*this._tile.width+(1&e)*(this._tile.width/2),top:e*this._tile.height/2}},px2pos:function(t,e){return{x:-Math.ceil(-t/this._tile.width-.5*(1&e)),y:e/this._tile.height*2}},centerAt:function(t,e){if("number"==typeof t&&"number"==typeof e){var i=this.pos2px(t,e);return n.viewport._x=-i.left+n.viewport.width/2-this._tile.width/2,n.viewport._y=-i.top+n.viewport.height/2-this._tile.height/2,this}return{top:-n.viewport._y+n.viewport.height/2-this._tile.height/2,left:-n.viewport._x+n.viewport.width/2-this._tile.width/2}},area:function(){var t=this.centerAt(),e=this.px2pos(-t.left+n.viewport.width/2,-t.top+n.viewport.height/2),i=this.px2pos(-t.left-n.viewport.width/2,-t.top-n.viewport.height/2);return{x:{start:e.x,end:i.x},y:{start:e.y,end:i.y}}}}})},{"../core/core.js":10}],54:[function(t,e,i){var n=t("../core/core.js"),r=window.document;n.extend({audio:{sounds:{},supported:null,codecs:{ogg:'audio/ogg; codecs="vorbis"',wav:'audio/wav; codecs="1"',webma:'audio/webm; codecs="vorbis"',mp3:'audio/mpeg; codecs="mp3"',m4a:'audio/mp4; codecs="mp4a.40.2"'},volume:1,muted:!1,paused:!1,playCheck:null,_canPlay:function(){if(this.supported={},n.support.audio){var t,e=this.audioElement();for(var i in this.codecs)t=e.canPlayType(this.codecs[i]),this.supported[i]=""!==t&&"no"!==t}},supports:function(t){return null===this.supported&&this._canPlay(),!!this.supported[t]},audioElement:function(){return"undefined"!=typeof Audio?new Audio(""):r.createElement("audio")},create:function(t,e){var i=e.substr(e.lastIndexOf(".")+1).toLowerCase();if(!this.supports(i))return!1;var r=this.audioElement();return r.id=t,r.preload="auto",r.volume=n.audio.volume,r.src=e,n.asset(e,r),this.sounds[t]={obj:r,played:0,volume:n.audio.volume},this.sounds[t]},add:function(t,e){if(n.support.audio){var i,r;if(1===arguments.length&&"object"==typeof t)for(var o in t)for(i in t[o])if(r=n.audio.create(o,t[o][i]))break;if("string"==typeof t&&("string"==typeof e&&(r=n.audio.create(t,e)),"object"==typeof e))for(i in e)if(r=n.audio.create(t,e[i]))break;return r}},play:function(t,e,i){if(0!==e&&n.support.audio&&this.sounds[t]){var r=this.sounds[t],o=this.getOpenChannel();if(!o)return null;o.id=t,o.repeat=e;var s=o.obj;return o.volume=r.volume=r.obj.volume=i||n.audio.volume,s.volume=r.volume,s.src=r.obj.src,this.muted&&(s.volume=0),s.play(),r.played++,o.onEnd=function(){r.played<o.repeat||-1===o.repeat?(this.currentTime&&(this.currentTime=0),this.play(),r.played++):(o.active=!1,this.pause(),this.removeEventListener("ended",o.onEnd,!0),this.currentTime=0,n.trigger("SoundComplete",{id:o.id}))},s.addEventListener("ended",o.onEnd,!0),s}},maxChannels:7,setChannels:function(t){this.maxChannels=t,t<this.channels.length&&(this.channels.length=t)},channels:[],getOpenChannel:function(){for(var t=0;t<this.channels.length;t++){var e=this.channels[t];if(!1===e.active||e.obj.ended&&e.repeat<=this.sounds[e.id].played)return e.active=!0,e}if(t<this.maxChannels){var i={obj:this.audioElement(),active:!0,_is:function(t){return this.id===t&&this.active}};return this.channels.push(i),i}return null},remove:function(t){if(n.support.audio){var e,i,r=n.paths().audio;if(t)this.sounds[t]&&(i=(e=this.sounds[t]).obj.src.split("/").pop(),n.audio.stop(t),delete n.assets[r+i],delete n.assets[e.obj.src],delete n.audio.sounds[t]);else for(var o in this.sounds)i=(e=this.sounds[o]).obj.src.split("/").pop(),n.audio.stop(t),delete n.assets[r+i],delete n.assets[e.obj.src],delete n.audio.sounds[t]}},stop:function(t){var e;if(n.support.audio)for(var i in this.channels)e=this.channels[i],(!t&&e.active||e._is(t))&&(e.active=!1,e.obj.pause())},_mute:function(t){if(n.support.audio){var e;for(var i in this.channels)(e=this.channels[i]).obj.volume=t?0:e.volume;this.muted=t}},toggleMute:function(){this.muted?this._mute(!1):this._mute(!0)},mute:function(){this._mute(!0)},unmute:function(){this._mute(!1)},pause:function(t){var e;if(n.support.audio&&t&&this.sounds[t])for(var i in this.channels)(e=this.channels[i])._is(t)&&!e.obj.paused&&e.obj.pause()},unpause:function(t){var e;if(n.support.audio&&t&&this.sounds[t])for(var i in this.channels)(e=this.channels[i])._is(t)&&e.obj.paused&&e.obj.play()},togglePause:function(t){var e;if(n.support.audio&&t&&this.sounds[t])for(var i in this.channels)(e=this.channels[i])._is(t)&&(e.obj.paused?e.obj.play():e.obj.pause())},isPlaying:function(t){if(!n.support.audio)return!1;for(var e in this.channels)if(this.channels[e]._is(t))return!0;return!1}}})},{"../core/core.js":10}],55:[function(t,e,i){var n=t("../core/core.js"),r=Math.PI/180,o=function(t){var e=Math.cos(t);return e=-1e-10<e&&e<1e-10?0:e},s=function(t){var e=Math.sin(t);return e=-1e-10<e&&e<1e-10?0:e};n.c("2D",{_x:0,_y:0,_w:0,_h:0,_z:0,_globalZ:null,_rotation:0,_origin:null,_mbr:null,_entry:null,_children:null,_parent:null,properties:{x:{set:function(t){this._setter2d("_x",t)},get:function(){return this._x},configurable:!0,enumerable:!0},_x:{enumerable:!1},y:{set:function(t){this._setter2d("_y",t)},get:function(){return this._y},configurable:!0,enumerable:!0},_y:{enumerable:!1},w:{set:function(t){this._setter2d("_w",t)},get:function(){return this._w},configurable:!0,enumerable:!0},_w:{enumerable:!1},h:{set:function(t){this._setter2d("_h",t)},get:function(){return this._h},configurable:!0,enumerable:!0},_h:{enumerable:!1},z:{set:function(t){this._setter2d("_z",t)},get:function(){return this._z},configurable:!0,enumerable:!0},_z:{enumerable:!1},rotation:{set:function(t){this._setter2d("_rotation",t)},get:function(){return this._rotation},configurable:!0,enumerable:!0},_rotation:{enumerable:!1},ox:{set:function(t){var e=t-this._origin.x;this._setter2d("_x",e)},get:function(){return this._x+this._origin.x},configurable:!0,enumerable:!0},oy:{set:function(t){var e=t-this._origin.y;this._setter2d("_y",e)},get:function(){return this._y+this._origin.y},configurable:!0,enumerable:!0}},init:function(){this._globalZ=this[0],this._origin={x:0,y:0},this._bx1=0,this._bx2=0,this._by1=0,this._by2=0,this._children=[],this._entry=n.map.insert(this),this.bind("Move",(function(t){var e=this._cbr||this._mbr||this;this._entry.update(e),this._children.length>0&&this._cascade(t)})),this.bind("Rotate",(function(t){var e=this._cbr||this._mbr||this;this._entry.update(e),this._children.length>0&&this._cascadeRotation(t)})),this.bind("Remove",(function(){if(this._children){for(var t=0;t<this._children.length;t++)delete this._children[t]._parent,this._children[t].destroy&&this._children[t].destroy();this._children=[]}this._parent&&this._parent.detach(this),n.map.remove(this._entry),this.detach()}))},events:{Freeze:function(){n.map.remove(this._entry)},Unfreeze:function(){this._entry=n.map.insert(this,this._entry)}},offsetBoundary:function(t,e,i,n){return 1===arguments.length&&(e=i=n=t),this._bx1=t,this._bx2=i,this._by1=e,this._by2=n,this.trigger("BoundaryOffset"),this._calculateMBR(),this},_calculateMBR:function(){var t=this._origin.x+this._x,e=this._origin.y+this._y,i=-this._rotation*r,n=this._x-this._bx1-t,a=this._x+this._w+this._bx2-t,h=this._y-this._by1-e,c=this._y+this._h+this._by2-e,u=o(i),l=s(i),d=n*u+h*l,f=-n*l+h*u,p=a*u+h*l,y=-a*l+h*u,v=a*u+c*l,g=-a*l+c*u,_=n*u+c*l,m=-n*l+c*u,b=Math.floor(Math.min(d,p,v,_)+t),x=Math.floor(Math.min(f,y,g,m)+e),w=Math.ceil(Math.max(d,p,v,_)+t),C=Math.ceil(Math.max(f,y,g,m)+e);if(this._mbr?(this._mbr._x=b,this._mbr._y=x,this._mbr._w=w-b,this._mbr._h=C-x):this._mbr={_x:b,_y:x,_w:w-b,_h:C-x},this._cbr){var S=this._cbr,D=S.cx,k=S.cy,P=S.r,T=t+(D+this._x-t)*u+(k+this._y-e)*l,E=e-(D+this._x-t)*l+(k+this._y-e)*u;S._x=Math.min(T-P,b),S._y=Math.min(E-P,x),S._w=Math.max(T+P,w)-S._x,S._h=Math.max(E+P,C)-S._y}},_rotate:function(t){var e=this._rotation-t;0!==e&&(this._rotation=t,this._calculateMBR(),this.trigger("Rotate",e))},area:function(){return this._w*this._h},intersect:function(t,e,i,n){var r,o=this._mbr||this;return r="object"==typeof t?t:{_x:t,_y:e,_w:i,_h:n},o._x<r._x+r._w&&o._x+o._w>r._x&&o._y<r._y+r._h&&o._y+o._h>r._y},within:function(t,e,i,n){var r,o=this._mbr||this;return(r="object"==typeof t?t:{_x:t,_y:e,_w:i,_h:n})._x<=o._x&&r._x+r._w>=o._x+o._w&&r._y<=o._y&&r._y+r._h>=o._y+o._h},contains:function(t,e,i,n){var r,o=this._mbr||this;return(r="object"==typeof t?t:{_x:t,_y:e,_w:i,_h:n})._x>=o._x&&r._x+r._w<=o._x+o._w&&r._y>=o._y&&r._y+r._h<=o._y+o._h},pos:function(t){return(t=t||{})._x=this._x,t._y=this._y,t._w=this._w,t._h=this._h,t},mbr:function(t){return t=t||{},this._mbr?(t._x=this._mbr._x,t._y=this._mbr._y,t._w=this._mbr._w,t._h=this._mbr._h,t):this.pos(t)},isAt:function(t,e){if(this.mapArea)return this.mapArea.containsPoint(t,e);if(this.map)return this.map.containsPoint(t,e);var i=this._mbr||this;return i._x<=t&&i._x+i._w>=t&&i._y<=e&&i._y+i._h>=e},move:function(t,e){return"n"===t.charAt(0)&&(this.y-=e),"s"===t.charAt(0)&&(this.y+=e),"e"!==t&&"e"!==t.charAt(1)||(this.x+=e),"w"!==t&&"w"!==t.charAt(1)||(this.x-=e),this},shift:function(t,e,i,n){return(t||e)&&this._setPosition(this._x+t,this._y+e),i&&(this.w+=i),n&&(this.h+=n),this},_cascade:function(t){if(t){var e=this._x-t._x,i=this._y-t._y,n=this._w-t._w,r=this._h-t._h;this._cascadeInner(e,i,n,r)}},_cascadeInner:function(t,e,i,n){for(var r,o=0,s=this._children,a=s.length;o<a;++o)(r=s[o]).__frozen||r.shift(t,e,i,n)},_cascadeRotation:function(t){if(t)for(var e,i=0,n=this._children,a=n.length,h=t*r,c=o(h),u=s(h),l=this._origin.x+this._x,d=this._origin.y+this._y;i<a;++i)(e=n[i]).__frozen||"rotate"in e&&e.rotate(t,l,d,c,u)},attach:function(){for(var t,e=0,i=arguments,n=arguments.length;e<n;++e)(t=i[e])._parent&&t._parent.detach(t),t._parent=this,this._children.push(t);return this},detach:function(t){var e;if(!t){for(e=0;e<this._children.length;e++)this._children[e]._parent=null;return this._children=[],this}for(e=0;e<this._children.length;e++)this._children[e]===t&&this._children.splice(e,1);return t._parent=null,this},origin:function(t,e){if("string"==typeof t)if("centre"===t||"center"===t||-1===t.indexOf(" "))t=this._w/2,e=this._h/2;else{var i=t.split(" ");"top"===i[0]?e=0:"bottom"===i[0]?e=this._h:"middle"!==i[0]&&"center"!==i[1]&&"centre"!==i[1]||(e=this._h/2),"center"===i[1]||"centre"===i[1]||"middle"===i[1]?t=this._w/2:"left"===i[1]?t=0:"right"===i[1]&&(t=this._w)}if(this.rotation){var n=-this._rotation*r,a=t-this._origin.x,h=e-this._origin.y,c=o(n),u=s(n),l=a*(1-c)-h*u,d=h*(1-c)+a*u;this._cascadeInner(l,d,0,0)}return this._origin.x=t,this._origin.y=e,this._mbr&&this._calculateMBR(),this._entry.update(this._cbr||this._mbr||this),this.trigger("OriginChanged"),this.trigger("Invalidate"),this},rotate:function(t,e,i,n,r){var o,s;o=(this._x+this._origin.x-e)*n+(this._y+this._origin.y-i)*r+(e-this._origin.x),s=(this._y+this._origin.y-i)*n-(this._x+this._origin.x-e)*r+(i-this._origin.y),this._setter2d("_rotation",this._rotation-t),this._setter2d("_x",o),this._setter2d("_y",s)},_setPosition:function(t,e){if(t!==this._x||e!==this._y){var i=n.rectManager._pool.copy(this),r=this._mbr;r&&(r._x-=this._x-t,r._y-=this._y-e,this._cbr&&(this._cbr._x-=this._x-t,this._cbr._y-=this._y-e)),this._x=t,this._y=e,this.trigger("Move",i),this.trigger("Invalidate"),n.rectManager._pool.recycle(i)}},_setter2d:function(t,e){if(this[t]!==e){var i,r=n.rectManager._pool.copy(this);if("_rotation"===t)this._rotate(e);else if("_x"===t||"_y"===t)(i=this._mbr)&&(i[t]-=this[t]-e,this._cbr&&(this._cbr[t]-=this[t]-e)),this[t]=e,this.trigger("Move",r);else if("_h"===t||"_w"===t){i=this._mbr;var o=this[t];this[t]=e,i&&this._calculateMBR(),"_w"===t?this.trigger("Resize",{axis:"w",amount:e-o}):"_h"===t&&this.trigger("Resize",{axis:"h",amount:e-o}),this.trigger("Move",r)}else if("_z"===t){var s=e<<0;e=e===s?s:s+1,this._globalZ=1e5*e+this[0],this[t]=e,this.trigger("Reorder")}this[t]=e,this.trigger("Invalidate"),n.rectManager._pool.recycle(r)}}}),n.polygon=function(t){arguments.length>1&&(t=Array.prototype.slice.call(arguments,0)),this.points=t},n.polygon.prototype={containsPoint:function(t,e){var i,n,r=this.points,o=r.length/2,s=!1;for(i=0,n=o-1;i<o;n=i++)r[2*i+1]>e!=r[2*n+1]>e&&t<(r[2*n]-r[2*i])*(e-r[2*i+1])/(r[2*n+1]-r[2*i+1])+r[2*i]&&(s=!s);return s},shift:function(t,e){for(var i=0,n=this.points,r=n.length;i<r;i+=2)n[i]+=t,n[i+1]+=e},clone:function(){return new n.polygon(this.points.slice(0))},rotate:function(t,e,i,n,r){for(var o,s,a=0,h=this.points,c=h.length;a<c;a+=2)o=e+(h[a]-e)*n+(h[a+1]-i)*r,s=i-(h[a]-e)*r+(h[a+1]-i)*n,h[a]=o,h[a+1]=s},intersectRay:function(t,e){for(var i,n,r,o,s,a,h,c,u,l=this.points,d=1/0,f=t._x,p=e.x,y=t._y,v=e.y,g=0,_=l.length,m=l[_-2],b=l[_-1];g<_;g+=2)a=l[g],n=(m-f)*(u=(c=l[g+1])-b)-(b-y)*(h=a-m),o=(m-f)*v-(b-y)*p,0!==(s=p*u-v*h)?(i=n/s,(r=o/s)>=0&&r<=1&&i>=0&&i<d&&(d=i)):0!==n&&0!==o||((i=(m-f)*p+(b-y)*v)>=0&&i<d&&(d=i),(i=(a-f)*p+(c-y)*v)>=0&&i<d&&(d=i)),m=a,b=c;return d}},n.circle=function(t,e,i){var n;this.x=t,this.y=e,this.radius=i,this.points=[];for(var r=0;r<16;r+=2)n=r*Math.PI/8,this.points[r]=this.x+Math.sin(n)*i,this.points[r+1]=this.y+Math.cos(n)*i},n.circle.prototype={containsPoint:function(t,e){var i=this.radius,n=this.x-t,r=this.y-e;return n*n+r*r<i*i},shift:function(t,e){this.x+=t,this.y+=e;for(var i=0,n=this.points,r=n.length;i<r;i+=2)n[i]+=t,n[i+1]+=e},rotate:function(){}},n.matrix=function(t){this.mtx=t,this.width=t[0].length,this.height=t.length},n.matrix.prototype={x:function(t){if(this.width===t.height){for(var e=[],i=0;i<this.height;i++){e[i]=[];for(var r=0;r<t.width;r++){for(var o=0,s=0;s<this.width;s++)o+=this.mtx[i][s]*t.mtx[s][r];e[i][r]=o}}return new n.matrix(e)}},e:function(t,e){return t<1||t>this.mtx.length||e<1||e>this.mtx[0].length?null:this.mtx[t-1][e-1]}}},{"../core/core.js":10}],56:[function(t,e,i){var n=t("../core/core.js"),r=Math.PI/180;n.extend({raycast:function(t,e){for(var i,r,o="obj",s=1/0,a=!0,h=2,c=arguments.length;h<c;++h)"number"===(r=typeof(i=arguments[h]))?s=i+1e-6:"string"===r?o=i:"boolean"===r&&(a=i);var u=t._x,l=t._y,d=e.x,f=e.y,p={},y=[];if(s<0){var v=null,g=1/0;n.map.traverseRay(t,e,(function(i,n){if(v&&g<n)return y.push({obj:v,distance:g,x:u+g*d,y:l+g*f}),v=null,g=1/0,!0;if(i.map&&i.__c[o]&&!p[i[0]]){p[i[0]]=!0;var r=i.map.intersectRay(t,e);r<g&&(v=i,g=r)}})),v&&y.push({obj:v,distance:g,x:u+g*d,y:l+g*f})}else n.map.traverseRay(t,e,(function(i,n){if(n>s)return!0;if(i.map&&i.__c[o]&&!p[i[0]]){p[i[0]]=!0;var r=i.map.intersectRay(t,e);r<s&&y.push({obj:i,distance:r,x:u+r*d,y:l+r*f})}}));return a&&y.sort((function(t,e){return t.distance-e.distance})),y}}),n.c("Collision",{init:function(){this.requires("2D"),this._collisionData={},this.collision()},remove:function(){this._cbr=null,this.unbind("Resize",this._resizeMap),this.unbind("Resize",this._checkBounds)},collision:function(t){if(this.unbind("Resize",this._resizeMap),this.unbind("Resize",this._checkBounds),t){if(arguments.length>1){var e=Array.prototype.slice.call(arguments,0);t=new n.polygon(e)}else t=t.constructor===Array?new n.polygon(t.slice()):t.clone();this._findBounds(t.points)}else t=new n.polygon([0,0,this._w,0,this._w,this._h,0,this._h]),this.bind("Resize",this._resizeMap),this._cbr=null;return this.rotation&&t.rotate(this.rotation,this._origin.x,this._origin.y,Math.cos(-this.rotation*r),Math.sin(-this.rotation*r)),this.map=t,this.attach(this.map),this.map.shift(this._x,this._y),this.trigger("NewHitbox",t),this},cbr:function(t){return t=t||{},this._cbr?(t._x=this._cbr._x,t._y=this._cbr._y,t._w=this._cbr._w,t._h=this._cbr._h,t):this.mbr(t)},_findBounds:function(t){for(var e=1/0,i=-1/0,n=1/0,r=-1/0,o=t.length,s=0;s<o;s+=2)t[s]<e&&(e=t[s]),t[s]>i&&(i=t[s]),t[s+1]<n&&(n=t[s+1]),t[s+1]>r&&(r=t[s+1]);var a={cx:(e+i)/2,cy:(n+r)/2,r:Math.sqrt((i-e)*(i-e)+(r-n)*(r-n))/2};return e>=0&&n>=0&&(this._checkBounds=function(){null===this._cbr&&this._w<i||this._h<r?(this._cbr=a,this._calculateMBR()):this._cbr&&(this._cbr=null,this._calculateMBR())},this.bind("Resize",this._checkBounds)),e>=0&&n>=0&&i<=this._w&&r<=this._h?(this._cbr=null,!1):(this._cbr=a,this._calculateMBR(),!0)},_resizeMap:function(t){var e,i,n=this.rotation*r,o=this.map.points;"w"===t.axis?(n?(e=t.amount*Math.cos(n),i=t.amount*Math.sin(n)):(e=t.amount,i=0),o[2]+=e,o[3]+=i):(n?(i=t.amount*Math.cos(n),e=-t.amount*Math.sin(n)):(e=0,i=t.amount),o[6]+=e,o[7]+=i),o[4]+=e,o[5]+=i},_collisionHitDupes:[],_collisionHitResults:[],hit:function(t,e){var i=this._cbr||this._mbr||this,r=this._collisionHitResults;r.length=0;var o=(r=n.map.unfilteredSearch(i,r)).length;if(!o)return null;var s,a,h=0,c=this._collisionHitDupes;for(e=e||[],c.length=0;h<o;++h)if((a=r[h])&&!c[s=a[0]]&&this[0]!==s&&a.__c[t])if(c[s]=a,a.map){var u=this._SAT(this.map,a.map);u&&(e.push(u),u.obj=a,u.type="SAT")}else n.rectManager.overlap(i,a._cbr||a._mbr||a)&&e.push({obj:a,type:"MBR"});return e.length?e:null},onHit:function(t,e,i){var n=!1;return this.bind("UpdateFrame",(function(){var r=this.hit(t);r?(e.call(this,r,!n),n=!0):n&&("function"==typeof i&&i.call(this),n=!1)})),this},_createCollisionHandler:function(t,e){return function(){var i=this.hit(t);if(!0===e.occurring){if(null!==i)return;e.occurring=!1,this.trigger("HitOff",t)}else null!==i&&(e.occurring=!0,this.trigger("HitOn",i))}},checkHits:function(){var t=arguments,e=0;for(1===t.length&&(t=t[0].split(/\s*,\s*/));e<t.length;++e){var i=t[e],n=this._collisionData[i];void 0===n&&(this._collisionData[i]=n={occurring:!1,handler:null},n.handler=this._createCollisionHandler(i,n),this.bind("UpdateFrame",n.handler))}return this},ignoreHits:function(){var t,e=arguments,i=0;if(0===e.length){for(t in this._collisionData)this.unbind("UpdateFrame",t.handler);this._collisionData={}}for(1===e.length&&(e=e[0].split(/\s*,\s*/));i<e.length;++i){var n=e[i];void 0!==(t=this._collisionData[n])&&(this.unbind("UpdateFrame",t.handler),delete this._collisionData[n])}return this},resetHitChecks:function(){var t,e=arguments,i=0;if(0===e.length)for(t in this._collisionData)this._collisionData[t].occurring=!1;for(1===e.length&&(e=e[0].split(/\s*,\s*/));i<e.length;++i){var n=e[i];void 0!==(t=this._collisionData[n])&&(t.occurring=!1)}return this},_SAT:function(t,e){for(var i,n,r,o,s,a,h,c,u,l=0,d=t.points,f=e.points,p=d.length/2,y=f.length/2,v=0,g=0,_=-1/0,m=null,b=null;l<p;l++){for(u=l===p-1?0:l+1,v=-(d[2*l+1]-d[2*u+1]),g=d[2*l]-d[2*u],v/=n=Math.sqrt(v*v+g*g),g/=n,r=o=1/0,s=a=-1/0,i=0;i<p;++i)(c=d[2*i]*v+d[2*i+1]*g)>s&&(s=c),c<r&&(r=c);for(i=0;i<y;++i)(c=f[2*i]*v+f[2*i+1]*g)>a&&(a=c),c<o&&(o=c);if(r<o?(h=o-s,v=-v,g=-g):h=r-a,h>=0)return!1;h>_&&(_=h,m=v,b=g)}for(l=0;l<y;l++){for(u=l===y-1?0:l+1,v=-(f[2*l+1]-f[2*u+1]),g=f[2*l]-f[2*u],v/=n=Math.sqrt(v*v+g*g),g/=n,r=o=1/0,s=a=-1/0,i=0;i<p;++i)(c=d[2*i]*v+d[2*i+1]*g)>s&&(s=c),c<r&&(r=c);for(i=0;i<y;++i)(c=f[2*i]*v+f[2*i+1]*g)>a&&(a=c),c<o&&(o=c);if(r<o?(h=o-s,v=-v,g=-g):h=r-a,h>=0)return!1;h>_&&(_=h,m=v,b=g)}return{overlap:_,nx:m,ny:b}}})},{"../core/core.js":10}],57:[function(t,e,i){var n=t("../core/core.js");n.math={abs:function(t){return t<0?-t:t},amountOf:function(t,e,i){return e<i?(t-e)/(i-e):(t-i)/(e-i)},clamp:function(t,e,i){return t>i?i:t<e?e:t},degToRad:function(t){return t*Math.PI/180},distance:function(t,e,i,r){var o=n.math.squaredDistance(t,e,i,r);return Math.sqrt(parseFloat(o))},lerp:function(t,e,i){return t+(e-t)*i},negate:function(t){return Math.random()<t?-1:1},radToDeg:function(t){return 180*t/Math.PI},randomElementOfArray:function(t){return t[Math.floor(t.length*Math.random())]},randomInt:function(t,e){return t+Math.floor((1+e-t)*Math.random())},randomNumber:function(t,e){return t+(e-t)*Math.random()},squaredDistance:function(t,e,i,n){return(t-i)*(t-i)+(e-n)*(e-n)},withinRange:function(t,e,i){return t>=e&&t<=i}},n.math.Vector2D=function(){function t(e,i){if(e instanceof t)this.x=e.x,this.y=e.y;else if(2===arguments.length)this.x=e,this.y=i;else if(arguments.length>0)throw"Unexpected number of arguments for Vector2D()"}return t.prototype.x=0,t.prototype.y=0,t.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.angleBetween=function(t){return Math.atan2(this.x*t.y-this.y*t.x,this.x*t.x+this.y*t.y)},t.prototype.angleTo=function(t){return Math.atan2(t.y-this.y,t.x-this.x)},t.prototype.clone=function(){return new t(this)},t.prototype.distance=function(t){return Math.sqrt((t.x-this.x)*(t.x-this.x)+(t.y-this.y)*(t.y-this.y))},t.prototype.distanceSq=function(t){return(t.x-this.x)*(t.x-this.x)+(t.y-this.y)*(t.y-this.y)},t.prototype.divide=function(t){return this.x/=t.x,this.y/=t.y,this},t.prototype.dotProduct=function(t){return this.x*t.x+this.y*t.y},t.prototype.crossProduct=function(t){return this.x*t.y-this.y*t.x},t.prototype.equals=function(e){return e instanceof t&&this.x===e.x&&this.y===e.y},t.prototype.perpendicular=function(e){return(e=e||new t).setValues(-this.y,this.x)},t.prototype.getNormal=function(e,i){return(i=i||new t).setValues(e.y-this.y,this.x-e.x).normalize()},t.prototype.isZero=function(){return 0===this.x&&0===this.y},t.prototype.magnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.prototype.magnitudeSq=function(){return this.x*this.x+this.y*this.y},t.prototype.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},t.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},t.prototype.normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);return 0===t?(this.x=1,this.y=0):(this.x/=t,this.y/=t),this},t.prototype.scale=function(t,e){return void 0===e&&(e=t),this.x*=t,this.y*=e,this},t.prototype.scaleToMagnitude=function(t){var e=t/this.magnitude();return this.x*=e,this.y*=e,this},t.prototype.setValues=function(e,i){return e instanceof t?(this.x=e.x,this.y=e.y):(this.x=e,this.y=i),this},t.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},t.prototype.toString=function(){return"Vector2D("+this.x+", "+this.y+")"},t.prototype.translate=function(t,e){return void 0===e&&(e=t),this.x+=t,this.y+=e,this},t.tripleProduct=function(t,e,i,r){r=r||new n.math.Vector2D;var o=t.dotProduct(i),s=e.dotProduct(i);return r.setValues(e.x*o-t.x*s,e.y*o-t.y*s)},t}(),n.math.Matrix2D=function(){function t(e,i,n,r,o,s){if(e instanceof t)this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.e=e.e,this.f=e.f;else if(6===arguments.length)this.a=e,this.b=i,this.c=n,this.d=r,this.e=o,this.f=s;else if(arguments.length>0)throw"Unexpected number of arguments for Matrix2D()"}return t.prototype.a=1,t.prototype.b=0,t.prototype.c=0,t.prototype.d=1,t.prototype.e=0,t.prototype.f=0,t.prototype.apply=function(t){var e=t.x;return t.x=e*this.a+t.y*this.c+this.e,t.y=e*this.b+t.y*this.d+this.f,t},t.prototype.clone=function(){return new t(this)},t.prototype.combine=function(t){var e=this.a;return this.a=e*t.a+this.b*t.c,this.b=e*t.b+this.b*t.d,e=this.c,this.c=e*t.a+this.d*t.c,this.d=e*t.b+this.d*t.d,e=this.e,this.e=e*t.a+this.f*t.c+t.e,this.f=e*t.b+this.f*t.d+t.f,this},t.prototype.equals=function(e){return e instanceof t&&this.a===e.a&&this.b===e.b&&this.c===e.c&&this.d===e.d&&this.e===e.e&&this.f===e.f},t.prototype.determinant=function(){return this.a*this.d-this.b*this.c},t.prototype.invert=function(){var t=this.determinant();if(0!==t){var e={a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f};this.a=e.d/t,this.b=-e.b/t,this.c=-e.c/t,this.d=e.a/t,this.e=(e.c*e.f-e.e*e.d)/t,this.f=(e.e*e.b-e.a*e.f)/t}return this},t.prototype.isIdentity=function(){return 1===this.a&&0===this.b&&0===this.c&&1===this.d&&0===this.e&&0===this.f},t.prototype.isInvertible=function(){return 0!==this.determinant()},t.prototype.preRotate=function(t){var e=Math.cos(t),i=Math.sin(t),n=this.a;return this.a=e*n-i*this.b,this.b=i*n+e*this.b,n=this.c,this.c=e*n-i*this.d,this.d=i*n+e*this.d,this},t.prototype.preScale=function(t,e){return void 0===e&&(e=t),this.a*=t,this.b*=e,this.c*=t,this.d*=e,this},t.prototype.preTranslate=function(t,e){return"number"==typeof t?(this.e+=t,this.f+=e):(this.e+=t.x,this.f+=t.y),this},t.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),n=this.a;return this.a=e*n-i*this.b,this.b=i*n+e*this.b,n=this.c,this.c=e*n-i*this.d,this.d=i*n+e*this.d,n=this.e,this.e=e*n-i*this.f,this.f=i*n+e*this.f,this},t.prototype.scale=function(t,e){return void 0===e&&(e=t),this.a*=t,this.b*=e,this.c*=t,this.d*=e,this.e*=t,this.f*=e,this},t.prototype.setValues=function(e,i,n,r,o,s){return e instanceof t?(this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.e=e.e,this.f=e.f):(this.a=e,this.b=i,this.c=n,this.d=r,this.e=o,this.f=s),this},t.prototype.toString=function(){return"Matrix2D(["+this.a+", "+this.c+", "+this.e+"] ["+this.b+", "+this.d+", "+this.f+"] [0, 0, 1])"},t.prototype.translate=function(t,e){return"number"==typeof t?(this.e+=this.a*t+this.c*e,this.f+=this.b*t+this.d*e):(this.e+=this.a*t.x+this.c*t.y,this.f+=this.b*t.x+this.d*t.y),this},t}()},{"../core/core.js":10}],58:[function(t,e,i){var n=t("../core/core.js"),r=function(t,e,i,r){var o=e+i,s="_"+o,a={key:"",oldValue:0};r?n.defineField(t,o,(function(){return this[s]}),(function(t){var e=this[s];t!==e&&(this[s]=t,a.key=o,a.oldValue=e,this.trigger("MotionChange",a))})):n.defineField(t,o,(function(){return this[s]}),(function(t){})),Object.defineProperty(t,s,{value:0,writable:!0,enumerable:!1,configurable:!1})},o=function(t,e,i,r){var o=e+"x",s=e+"y",a="_"+o,h="_"+s;return i?(n.defineField(r,"x",(function(){return t[a]}),(function(e){t[o]=e})),n.defineField(r,"y",(function(){return t[h]}),(function(e){t[s]=e}))):(n.defineField(r,"x",(function(){return t[a]}),(function(t){})),n.defineField(r,"y",(function(){return t[h]}),(function(t){}))),Object.seal&&Object.seal(r),r};n.c("AngularMotion",{_vrotation:0,_arotation:0,_drotation:0,init:function(){this.requires("2D"),r(this,"v","rotation",!0),r(this,"a","rotation",!0),r(this,"d","rotation",!1),this.__oldRotationDirection=0,this.bind("UpdateFrame",this._angularMotionTick)},remove:function(t){this.unbind("UpdateFrame",this._angularMotionTick)},resetAngularMotion:function(){return this._drotation=0,this.vrotation=0,this.arotation=0,this},_angularMotionTick:function(t){var e=t.dt/1e3,i=this._rotation,n=this._vrotation,r=this._arotation,o=i+n*e+.5*r*e*e;this.vrotation=n+r*e;var s=this._vrotation,a=s?s<0?-1:1:0;this.__oldRotationDirection!==a&&(this.__oldRotationDirection=a,this.trigger("NewRotationDirection",a)),this._drotation=o-i,0!==this._drotation&&(this.rotation=o,this.trigger("Rotated",i))}}),n.c("Motion",{_vx:0,_vy:0,_ax:0,_ay:0,_dx:0,_dy:0,init:function(){this.requires("2D"),r(this,"v","x",!0),r(this,"v","y",!0),this._velocity=o(this,"v",!0,new n.math.Vector2D),r(this,"a","x",!0),r(this,"a","y",!0),this._acceleration=o(this,"a",!0,new n.math.Vector2D),r(this,"d","x",!1),r(this,"d","y",!1),this._motionDelta=o(this,"d",!1,new n.math.Vector2D),this.__oldDirection={x:0,y:0},this.bind("UpdateFrame",this._linearMotionTick)},remove:function(t){this.unbind("UpdateFrame",this._linearMotionTick)},resetMotion:function(){return this.vx=0,this.vy=0,this.ax=0,this.ay=0,this._dx=0,this._dy=0,this},motionDelta:function(){return this._motionDelta},velocity:function(){return this._velocity},acceleration:function(){return this._acceleration},ccdbr:function(t){var e=this._cbr||this._mbr||this,i=this._dx,n=this._dy,r=0,o=0,s=i>0?r=i:-i,a=n>0?o=n:-n;return(t=t||{})._x=e._x-r,t._y=e._y-o,t._w=e._w+s,t._h=e._h+a,t},_linearMotionTick:function(t){var e=t.dt/1e3,i=this._vx,n=this._ax,r=this._vy,o=this._ay,s=i*e+.5*n*e*e,a=r*e+.5*o*e*e;this.vx=i+n*e,this.vy=r+o*e;var h=this.__oldDirection,c=this._vx,u=c?c<0?-1:1:0,l=this._vy,d=l?l<0?-1:1:0;h.x===u&&h.y===d||(h.x=u,h.y=d,this.trigger("NewDirection",h)),this._dx=s,this._dy=a,this._setPosition(this._x+s,this._y+a)}})},{"../core/core.js":10}],59:[function(t,e,i){var n=t("../core/core.js");n.c("Supportable",{_ground:null,_groundComp:null,_preventGroundTunneling:!1,canLand:!0,init:function(){this.requires("2D"),this.__area={_x:0,_y:0,_w:0,_h:0},this.defineField("ground",(function(){return this._ground}),(function(t){}))},remove:function(t){this.unbind("UpdateFrame",this._detectGroundTick)},startGroundDetection:function(t){return t&&(this._groundComp=t),this.uniqueBind("UpdateFrame",this._detectGroundTick),this},stopGroundDetection:function(){return this.unbind("UpdateFrame",this._detectGroundTick),this},preventGroundTunneling:function(t){return void 0===t&&(t=!0),t&&this.requires("Motion"),this._preventGroundTunneling=t,this},_detectGroundTick:function(){var t,e=this._groundComp,i=this._ground,r=n.rectManager.overlap;if(this._preventGroundTunneling)t=this.ccdbr(this.__area);else{var o=this._cbr||this._mbr||this;(t=this.__area)._x=o._x,t._y=o._y,t._w=o._w,t._h=o._h}if(t._h++,i){var s=i._cbr||i._mbr||i;i.__c[e]&&n(i[0])===i&&r(s,t)||(this._ground=null,this.trigger("LiftedOffGround",i),i=null)}if(!i)for(var a,h,c=n.map.unfilteredSearch(t),u=0,l=c.length;u<l;++u)if(h=(a=c[u])._cbr||a._mbr||a,a!==this&&a.__c[e]&&r(h,t)&&(this.canLand=!0,this.trigger("CheckLanding",a),this.canLand)){this._ground=i=a,this.y=i._y-this._h,this._x>i._x+i._w?this.x=i._x+i._w-1:this._x+this._w<i._x&&(this.x=i._x-this._w+1),this.trigger("LandedOnGround",i);break}}}),n.c("GroundAttacher",{_groundAttach:function(t){t.attach(this)},_groundDetach:function(t){t.detach(this)},init:function(){this.requires("Supportable"),this.bind("LandedOnGround",this._groundAttach),this.bind("LiftedOffGround",this._groundDetach)},remove:function(t){this.unbind("LandedOnGround",this._groundAttach),this.unbind("LiftedOffGround",this._groundDetach)}}),n.c("Gravity",{_gravityConst:500,_gravityActive:!1,init:function(){this.requires("2D, Supportable, Motion"),this.bind("LiftedOffGround",this._startGravity),this.bind("LandedOnGround",this._stopGravity)},remove:function(t){this.unbind("LiftedOffGround",this._startGravity),this.unbind("LandedOnGround",this._stopGravity)},_gravityCheckLanding:function(t){this._dy<0&&(this.canLand=!1)},gravity:function(t){return this.uniqueBind("CheckLanding",this._gravityCheckLanding),this.startGroundDetection(t),this._startGravity(),this},antigravity:function(){return this._stopGravity(),this.stopGroundDetection(),this.unbind("CheckLanding",this._gravityCheckLanding),this},gravityConst:function(t){return this._gravityActive&&(this.ay-=this._gravityConst,this.ay+=t),this._gravityConst=t,this},_startGravity:function(){this._gravityActive||(this._gravityActive=!0,this.ay+=this._gravityConst)},_stopGravity:function(){this._gravityActive&&(this._gravityActive=!1,this.ay=0,this.vy=0)}})},{"../core/core.js":10}],60:[function(t,e,i){var n,r;t("../core/core.js").extend({rectManager:{merge:function(t,e,i){return void 0===i&&(i={}),i._h=Math.max(t._y+t._h,e._y+e._h),i._w=Math.max(t._x+t._w,e._x+e._w),i._x=Math.min(t._x,e._x),i._y=Math.min(t._y,e._y),i._w-=i._x,i._h-=i._y,i},overlap:function(t,e){return t._x<e._x+e._w&&t._x+t._w>e._x&&t._y<e._y+e._h&&t._y+t._h>e._y},integerBounds:function(t){return t._x=Math.floor(t._x),t._y=Math.floor(t._y),t._w=Math.ceil(t._w),t._h=Math.ceil(t._h),t},mergeSet:function(t){if(t.length<2)return t;for(var e=t.length-1;e--;)this.overlap(t[e],t[e+1])&&(this.merge(t[e],t[e+1],t[e]),t.splice(e+1,1));return t},boundingRect:function(t){if(t&&t.length){var e,i,n=1,r=t.length,o=t[0];for(o=[o._x,o._y,o._x+o._w,o._y+o._h];n<r;)(i=[(e=t[n])._x,e._y,e._x+e._w,e._y+e._h])[0]<o[0]&&(o[0]=i[0]),i[1]<o[1]&&(o[1]=i[1]),i[2]>o[2]&&(o[2]=i[2]),i[3]>o[3]&&(o[3]=i[3]),n++;return o={_x:(i=o)[0],_y:i[1],_w:i[2]-i[0],_h:i[3]-i[1]}}},_pool:(n=[],r=0,{get:function(t,e,i,o){n.length<=r&&n.push({});var s=n[r++];return s._x=t,s._y=e,s._w=i,s._h=o,s},copy:function(t){n.length<=r&&n.push({});var e=n[r++];return e._x=t._x,e._y=t._y,e._w=t._w,e._h=t._h,e},recycle:function(t){r--}})}})},{"../core/core.js":10}],61:[function(t,e,i){var n,r={},o=function(t){n=t||64,this.map={},this.boundsDirty=!1,this.coordBoundsDirty=!1,this.boundsHash={maxX:-1/0,maxY:-1/0,minX:1/0,minY:1/0},this.boundsCoords={maxX:-1/0,maxY:-1/0,minX:1/0,minY:1/0}};function s(t,e,i){this.keys=t,this.map=i,this.obj=e}o.key=function(t,e){return t=t._cbr||t._mbr||t,(e=e||{}).x1=Math.floor(t._x/n),e.y1=Math.floor(t._y/n),e.x2=Math.floor((t._w+t._x)/n),e.y2=Math.floor((t._h+t._y)/n),e},o.hash=function(t){return t.x1+" "+t.y1+" "+t.x2+" "+t.y2},o.cellsize=function(){return n},o.prototype={insert:function(t,e){var i,n,r,a=o.key(t,e&&e.keys);for(e=e||new s(a,t,this),i=a.x1;i<=a.x2;i++)for(n=a.y1;n<=a.y2;n++)r=i<<16^n,this.map[r]||(this.map[r]=[]),this.map[r].push(t);return this.boundsDirty=!0,e},_searchHolder:[],search:function(t,e){var i,n,s,a,h,c=o.key(t,r),u=this._searchHolder;for(e=e||[],u.length=0,i=c.x1;i<=c.x2;i++)for(n=c.y1;n<=c.y2;n++)if(a=this.map[i<<16^n])for(s=0;s<a.length;s++)u[a[s][0]]||(h=(h=u[a[s][0]]=a[s])._cbr||h._mbr||h)._x<t._x+t._w&&h._x+h._w>t._x&&h._y<t._y+t._h&&h._y+h._h>t._y&&e.push(a[s]);return e},unfilteredSearch:function(t,e){var i,n,s,a,h=o.key(t,r);for(e=e||[],i=h.x1;i<=h.x2;i++)for(n=h.y1;n<=h.y2;n++)if(a=this.map[i<<16^n])for(s=0;s<a.length;s++)e.push(a[s]);return e},remove:function(t){var e,i,n=t.keys,r=t.obj,o=0;for(o=n.x1;o<=n.x2;o++)for(e=n.y1;e<=n.y2;e++)if(i=o<<16^e,this.map[i]){var s,a=this.map[i],h=a.length;for(s=0;s<h;s++)a[s]&&a[s][0]===r[0]&&a.splice(s,1)}this.boundsDirty=!0},refresh:function(t){var e,i,n,r,s,a=t.keys,h=t.obj;for(i=a.x1;i<=a.x2;i++)for(n=a.y1;n<=a.y2;n++)if(e=this.map[i<<16^n])for(s=e.length,r=0;r<s;r++)e[r]&&e[r][0]===h[0]&&e.splice(r,1);for(o.key(h,a),i=a.x1;i<=a.x2;i++)for(n=a.y1;n<=a.y2;n++)(e=this.map[i<<16^n])||(e=this.map[i<<16^n]=[]),e.push(h);return this.boundsDirty=!0,t},boundaries:function(){this._updateBoundaries();var t=this.boundsCoords;return{min:{x:t.minX,y:t.minY},max:{x:t.maxX,y:t.maxY}}},_keyBoundaries:function(){return this._updateBoundaries(),this.boundsHash},_updateBoundaries:function(){if(this.boundsDirty||this.coordBoundsDirty){var t=this.boundsHash;this.boundsDirty&&(t.maxX=-1/0,t.maxY=-1/0,t.minX=1/0,t.minY=1/0);var e,i,n,r=this.boundsCoords;for(var o in r.maxX=-1/0,r.maxY=-1/0,r.minX=1/0,r.minY=1/0,this.map)if((n=this.map[o]).length){var s=o>>16,a=o<<16>>16;if(a<0&&(s=~s),s>=t.maxX)for(e in t.maxX=s,n)"object"==typeof(i=n[e])&&"requires"in i&&(r.maxX=Math.max(r.maxX,i.x+i.w));if(s<=t.minX)for(e in t.minX=s,n)"object"==typeof(i=n[e])&&"requires"in i&&(r.minX=Math.min(r.minX,i.x));if(a>=t.maxY)for(e in t.maxY=a,n)"object"==typeof(i=n[e])&&"requires"in i&&(r.maxY=Math.max(r.maxY,i.y+i.h));if(a<=t.minY)for(e in t.minY=a,n)"object"==typeof(i=n[e])&&"requires"in i&&(r.minY=Math.min(r.minY,i.y))}this.boundsDirty=!1,this.coordBoundsDirty=!1}},traverseRay:function(t,e,i){var s=e.x,a=e.y;t={_x:t._x,_y:t._y,_w:0,_h:0};var h,c,u=this._keyBoundaries(),l=o.key(t,r),d=l.x1,f=l.y1,p=u.minX,y=u.minY,v=u.maxX,g=u.maxY,_=s>0?1:s<0?-1:0,m=a>0?1:a<0?-1:0,b=a>=0?(f+1)*n:f*n,x=-1/0,w=0,C=0,S=1/0,D=1/0;for(0!==s&&(h=1/s,S=((s>=0?(d+1)*n:d*n)-t._x)*h,w=n*_*h),0!==a&&(h=1/a,D=(b-t._y)*h,C=n*m*h);1===_&&d<p&&p!==1/0||-1===_&&d>v&&v!==-1/0||1===m&&f<y&&y!==1/0||-1===m&&f>g&&g!==-1/0;)S<D?(x=S,d+=_,S+=w):(x=D,f+=m,D+=C);for(;p<=d&&d<=v&&y<=f&&f<=g;){if(c=this.map[d<<16^f])for(var k=0;k<c.length;k++)if(i(c[k],x))return;S<D?(x=S,d+=_,S+=w):(x=D,f+=m,D+=C)}}},s.prototype={update:function(t){o.hash(o.key(t,r))!==o.hash(this.keys)?this.map.refresh(this):this.map.coordBoundsDirty=!0}},e.exports=o},{}]},{},[22])},function(t,e,i){"use strict";var n=i(180),r=i(183),o=i(61),s=i(62);t.exports=i(186)(Array,"Array",(function(t,e){this._t=s(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,i=this._i++;return!t||i>=t.length?(this._t=void 0,r(1)):r(0,"keys"==e?i:"values"==e?t[i]:[i,t[i]])}),"values"),o.Arguments=o.Array,n("keys"),n("values"),n("entries")},function(t,e,i){var n=i(28)("unscopables"),r=Array.prototype;null==r[n]&&i(22)(r,n,{}),t.exports=function(t){r[n][t]=!0}},function(t,e,i){t.exports=!i(34)&&!i(96)((function(){return 7!=Object.defineProperty(i(97)("div"),"a",{get:function(){return 7}}).a}))},function(t,e,i){var n=i(60);t.exports=function(t,e){if(!n(t))return t;var i,r;if(e&&"function"==typeof(i=t.toString)&&!n(r=i.call(t)))return r;if("function"==typeof(i=t.valueOf)&&!n(r=i.call(t)))return r;if(!e&&"function"==typeof(i=t.toString)&&!n(r=i.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,i){var n=i(185);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},function(t,e){var i={}.toString;t.exports=function(t){return i.call(t).slice(8,-1)}},function(t,e,i){"use strict";var n=i(95),r=i(187),o=i(63),s=i(22),a=i(61),h=i(190),c=i(103),u=i(198),l=i(28)("iterator"),d=!([].keys&&"next"in[].keys()),f=function(){return this};t.exports=function(t,e,i,p,y,v,g){h(i,e,p);var _,m,b,x=function(t){if(!d&&t in D)return D[t];switch(t){case"keys":case"values":return function(){return new i(this,t)}}return function(){return new i(this,t)}},w=e+" Iterator",C="values"==y,S=!1,D=t.prototype,k=D[l]||D["@@iterator"]||y&&D[y],P=k||x(y),T=y?C?x("entries"):P:void 0,E="Array"==e&&D.entries||k;if(E&&(b=u(E.call(new t)))!==Object.prototype&&b.next&&(c(b,w,!0),n||"function"==typeof b[l]||s(b,l,f)),C&&k&&"values"!==k.name&&(S=!0,P=function(){return k.call(this)}),n&&!g||!d&&!S&&D[l]||s(D,l,P),a[e]=P,a[w]=f,y)if(_={values:C?P:x("values"),keys:v?P:x("keys"),entries:T},g)for(m in _)m in D||o(D,m,_[m]);else r(r.P+r.F*(d||S),e,_);return _}},function(t,e,i){var n=i(15),r=i(56),o=i(22),s=i(63),a=i(188),h=function(t,e,i){var c,u,l,d,f=t&h.F,p=t&h.G,y=t&h.S,v=t&h.P,g=t&h.B,_=p?n:y?n[e]||(n[e]={}):(n[e]||{}).prototype,m=p?r:r[e]||(r[e]={}),b=m.prototype||(m.prototype={});for(c in p&&(i=e),i)l=((u=!f&&_&&void 0!==_[c])?_:i)[c],d=g&&u?a(l,n):v&&"function"==typeof l?a(Function.call,l):l,_&&s(_,c,l,t&h.U),m[c]!=l&&o(m,c,d),v&&b[c]!=l&&(b[c]=l)};n.core=r,h.F=1,h.G=2,h.S=4,h.P=8,h.B=16,h.W=32,h.U=64,h.R=128,t.exports=h},function(t,e,i){var n=i(189);t.exports=function(t,e,i){if(n(t),void 0===e)return t;switch(i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,r){return t.call(e,i,n,r)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,i){"use strict";var n=i(191),r=i(98),o=i(103),s={};i(22)(s,i(28)("iterator"),(function(){return this})),t.exports=function(t,e,i){t.prototype=n(s,{next:r(1,i)}),o(t,e+" Iterator")}},function(t,e,i){var n=i(59),r=i(192),o=i(102),s=i(64)("IE_PROTO"),a=function(){},h=function(){var t,e=i(97)("iframe"),n=o.length;for(e.style.display="none",i(197).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),h=t.F;n--;)delete h.prototype[o[n]];return h()};t.exports=Object.create||function(t,e){var i;return null!==t?(a.prototype=n(t),i=new a,a.prototype=null,i[s]=t):i=h(),void 0===e?i:r(i,e)}},function(t,e,i){var n=i(58),r=i(59),o=i(100);t.exports=i(34)?Object.defineProperties:function(t,e){r(t);for(var i,s=o(e),a=s.length,h=0;a>h;)n.f(t,i=s[h++],e[i]);return t}},function(t,e,i){var n=i(35),r=i(62),o=i(194)(!1),s=i(64)("IE_PROTO");t.exports=function(t,e){var i,a=r(t),h=0,c=[];for(i in a)i!=s&&n(a,i)&&c.push(i);for(;e.length>h;)n(a,i=e[h++])&&(~o(c,i)||c.push(i));return c}},function(t,e,i){var n=i(62),r=i(195),o=i(196);t.exports=function(t){return function(e,i,s){var a,h=n(e),c=r(h.length),u=o(s,c);if(t&&i!=i){for(;c>u;)if((a=h[u++])!=a)return!0}else for(;c>u;u++)if((t||u in h)&&h[u]===i)return t||u||0;return!t&&-1}}},function(t,e,i){var n=i(101),r=Math.min;t.exports=function(t){return t>0?r(n(t),9007199254740991):0}},function(t,e,i){var n=i(101),r=Math.max,o=Math.min;t.exports=function(t,e){return(t=n(t))<0?r(t+e,0):o(t,e)}},function(t,e,i){var n=i(15).document;t.exports=n&&n.documentElement},function(t,e,i){var n=i(35),r=i(199),o=i(64)("IE_PROTO"),s=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=r(t),n(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?s:null}},function(t,e,i){var n=i(99);t.exports=function(t){return Object(n(t))}},function(t,e,i){var n;t.exports=(n=i(1),function(){if("function"==typeof ArrayBuffer){var t=n.lib.WordArray,e=t.init;(t.init=function(t){if(t instanceof ArrayBuffer&&(t=new Uint8Array(t)),(t instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array)&&(t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength)),t instanceof Uint8Array){for(var i=t.byteLength,n=[],r=0;r<i;r++)n[r>>>2]|=t[r]<<24-r%4*8;e.call(this,n,i)}else e.apply(this,arguments)}).prototype=t}}(),n.lib.WordArray)},function(t,e,i){var n;t.exports=(n=i(1),function(){var t=n,e=t.lib.WordArray,i=t.enc;function r(t){return t<<8&4278255360|t>>>8&16711935}i.Utf16=i.Utf16BE={stringify:function(t){for(var e=t.words,i=t.sigBytes,n=[],r=0;r<i;r+=2){var o=e[r>>>2]>>>16-r%4*8&65535;n.push(String.fromCharCode(o))}return n.join("")},parse:function(t){for(var i=t.length,n=[],r=0;r<i;r++)n[r>>>1]|=t.charCodeAt(r)<<16-r%2*16;return e.create(n,2*i)}},i.Utf16LE={stringify:function(t){for(var e=t.words,i=t.sigBytes,n=[],o=0;o<i;o+=2){var s=r(e[o>>>2]>>>16-o%4*8&65535);n.push(String.fromCharCode(s))}return n.join("")},parse:function(t){for(var i=t.length,n=[],o=0;o<i;o++)n[o>>>1]|=r(t.charCodeAt(o)<<16-o%2*16);return e.create(n,2*i)}}}(),n.enc.Utf16)},function(t,e,i){var n,r,o,s,a,h;t.exports=(h=i(1),i(104),r=(n=h).lib.WordArray,o=n.algo,s=o.SHA256,a=o.SHA224=s.extend({_doReset:function(){this._hash=new r.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var t=s._doFinalize.call(this);return t.sigBytes-=4,t}}),n.SHA224=s._createHelper(a),n.HmacSHA224=s._createHmacHelper(a),h.SHA224)},function(t,e,i){var n,r,o,s,a,h,c,u;t.exports=(u=i(1),i(36),i(105),r=(n=u).x64,o=r.Word,s=r.WordArray,a=n.algo,h=a.SHA512,c=a.SHA384=h.extend({_doReset:function(){this._hash=new s.init([new o.init(3418070365,3238371032),new o.init(1654270250,914150663),new o.init(2438529370,812702999),new o.init(355462360,4144912697),new o.init(1731405415,4290775857),new o.init(2394180231,1750603025),new o.init(3675008525,1694076839),new o.init(1203062813,3204075428)])},_doFinalize:function(){var t=h._doFinalize.call(this);return t.sigBytes-=16,t}}),n.SHA384=h._createHelper(c),n.HmacSHA384=h._createHmacHelper(c),u.SHA384)},function(t,e,i){var n;t.exports=(n=i(1),i(36),function(t){var e=n,i=e.lib,r=i.WordArray,o=i.Hasher,s=e.x64.Word,a=e.algo,h=[],c=[],u=[];!function(){for(var t=1,e=0,i=0;i<24;i++){h[t+5*e]=(i+1)*(i+2)/2%64;var n=(2*t+3*e)%5;t=e%5,e=n}for(t=0;t<5;t++)for(e=0;e<5;e++)c[t+5*e]=e+(2*t+3*e)%5*5;for(var r=1,o=0;o<24;o++){for(var a=0,l=0,d=0;d<7;d++){if(1&r){var f=(1<<d)-1;f<32?l^=1<<f:a^=1<<f-32}128&r?r=r<<1^113:r<<=1}u[o]=s.create(a,l)}}();var l=[];!function(){for(var t=0;t<25;t++)l[t]=s.create()}();var d=a.SHA3=o.extend({cfg:o.cfg.extend({outputLength:512}),_doReset:function(){for(var t=this._state=[],e=0;e<25;e++)t[e]=new s.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(t,e){for(var i=this._state,n=this.blockSize/2,r=0;r<n;r++){var o=t[e+2*r],s=t[e+2*r+1];o=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),s=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),(T=i[r]).high^=s,T.low^=o}for(var a=0;a<24;a++){for(var d=0;d<5;d++){for(var f=0,p=0,y=0;y<5;y++)f^=(T=i[d+5*y]).high,p^=T.low;var v=l[d];v.high=f,v.low=p}for(d=0;d<5;d++){var g=l[(d+4)%5],_=l[(d+1)%5],m=_.high,b=_.low;for(f=g.high^(m<<1|b>>>31),p=g.low^(b<<1|m>>>31),y=0;y<5;y++)(T=i[d+5*y]).high^=f,T.low^=p}for(var x=1;x<25;x++){var w=(T=i[x]).high,C=T.low,S=h[x];S<32?(f=w<<S|C>>>32-S,p=C<<S|w>>>32-S):(f=C<<S-32|w>>>64-S,p=w<<S-32|C>>>64-S);var D=l[c[x]];D.high=f,D.low=p}var k=l[0],P=i[0];for(k.high=P.high,k.low=P.low,d=0;d<5;d++)for(y=0;y<5;y++){var T=i[x=d+5*y],E=l[x],M=l[(d+1)%5+5*y],B=l[(d+2)%5+5*y];T.high=E.high^~M.high&B.high,T.low=E.low^~M.low&B.low}T=i[0];var O=u[a];T.high^=O.high,T.low^=O.low}},_doFinalize:function(){var e=this._data,i=e.words,n=(this._nDataBytes,8*e.sigBytes),o=32*this.blockSize;i[n>>>5]|=1<<24-n%32,i[(t.ceil((n+1)/o)*o>>>5)-1]|=128,e.sigBytes=4*i.length,this._process();for(var s=this._state,a=this.cfg.outputLength/8,h=a/8,c=[],u=0;u<h;u++){var l=s[u],d=l.high,f=l.low;d=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8),f=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),c.push(f),c.push(d)}return new r.init(c,a)},clone:function(){for(var t=o.clone.call(this),e=t._state=this._state.slice(0),i=0;i<25;i++)e[i]=e[i].clone();return t}});e.SHA3=o._createHelper(d),e.HmacSHA3=o._createHmacHelper(d)}(Math),n.SHA3)},function(t,e,i){var n;t.exports=(n=i(1),function(t){var e=n,i=e.lib,r=i.WordArray,o=i.Hasher,s=e.algo,a=r.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),h=r.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),c=r.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),u=r.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),l=r.create([0,1518500249,1859775393,2400959708,2840853838]),d=r.create([1352829926,1548603684,1836072691,2053994217,0]),f=s.RIPEMD160=o.extend({_doReset:function(){this._hash=r.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var i=0;i<16;i++){var n=e+i,r=t[n];t[n]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}var o,s,f,b,x,w,C,S,D,k,P,T=this._hash.words,E=l.words,M=d.words,B=a.words,O=h.words,z=c.words,A=u.words;for(w=o=T[0],C=s=T[1],S=f=T[2],D=b=T[3],k=x=T[4],i=0;i<80;i+=1)P=o+t[e+B[i]]|0,P+=i<16?p(s,f,b)+E[0]:i<32?y(s,f,b)+E[1]:i<48?v(s,f,b)+E[2]:i<64?g(s,f,b)+E[3]:_(s,f,b)+E[4],P=(P=m(P|=0,z[i]))+x|0,o=x,x=b,b=m(f,10),f=s,s=P,P=w+t[e+O[i]]|0,P+=i<16?_(C,S,D)+M[0]:i<32?g(C,S,D)+M[1]:i<48?v(C,S,D)+M[2]:i<64?y(C,S,D)+M[3]:p(C,S,D)+M[4],P=(P=m(P|=0,A[i]))+k|0,w=k,k=D,D=m(S,10),S=C,C=P;P=T[1]+f+D|0,T[1]=T[2]+b+k|0,T[2]=T[3]+x+w|0,T[3]=T[4]+o+C|0,T[4]=T[0]+s+S|0,T[0]=P},_doFinalize:function(){var t=this._data,e=t.words,i=8*this._nDataBytes,n=8*t.sigBytes;e[n>>>5]|=128<<24-n%32,e[14+(n+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),t.sigBytes=4*(e.length+1),this._process();for(var r=this._hash,o=r.words,s=0;s<5;s++){var a=o[s];o[s]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}return r},clone:function(){var t=o.clone.call(this);return t._hash=this._hash.clone(),t}});function p(t,e,i){return t^e^i}function y(t,e,i){return t&e|~t&i}function v(t,e,i){return(t|~e)^i}function g(t,e,i){return t&i|e&~i}function _(t,e,i){return t^(e|~i)}function m(t,e){return t<<e|t>>>32-e}e.RIPEMD160=o._createHelper(f),e.HmacRIPEMD160=o._createHmacHelper(f)}(Math),n.RIPEMD160)},function(t,e,i){var n,r,o,s,a,h,c,u,l;t.exports=(l=i(1),i(65),i(66),r=(n=l).lib,o=r.Base,s=r.WordArray,a=n.algo,h=a.SHA1,c=a.HMAC,u=a.PBKDF2=o.extend({cfg:o.extend({keySize:4,hasher:h,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var i=this.cfg,n=c.create(i.hasher,t),r=s.create(),o=s.create([1]),a=r.words,h=o.words,u=i.keySize,l=i.iterations;a.length<u;){var d=n.update(e).finalize(o);n.reset();for(var f=d.words,p=f.length,y=d,v=1;v<l;v++){y=n.finalize(y),n.reset();for(var g=y.words,_=0;_<p;_++)f[_]^=g[_]}r.concat(d),h[0]++}return r.sigBytes=4*u,r}}),n.PBKDF2=function(t,e,i){return u.create(i).compute(t,e)},l.PBKDF2)},function(t,e,i){var n;t.exports=(n=i(1),i(5),n.mode.CFB=function(){var t=n.lib.BlockCipherMode.extend();function e(t,e,i,n){var r=this._iv;if(r){var o=r.slice(0);this._iv=void 0}else o=this._prevBlock;n.encryptBlock(o,0);for(var s=0;s<i;s++)t[e+s]^=o[s]}return t.Encryptor=t.extend({processBlock:function(t,i){var n=this._cipher,r=n.blockSize;e.call(this,t,i,r,n),this._prevBlock=t.slice(i,i+r)}}),t.Decryptor=t.extend({processBlock:function(t,i){var n=this._cipher,r=n.blockSize,o=t.slice(i,i+r);e.call(this,t,i,r,n),this._prevBlock=o}}),t}(),n.mode.CFB)},function(t,e,i){var n,r,o;t.exports=(o=i(1),i(5),o.mode.CTR=(n=o.lib.BlockCipherMode.extend(),r=n.Encryptor=n.extend({processBlock:function(t,e){var i=this._cipher,n=i.blockSize,r=this._iv,o=this._counter;r&&(o=this._counter=r.slice(0),this._iv=void 0);var s=o.slice(0);i.encryptBlock(s,0),o[n-1]=o[n-1]+1|0;for(var a=0;a<n;a++)t[e+a]^=s[a]}}),n.Decryptor=r,n),o.mode.CTR)},function(t,e,i){var n;t.exports=(n=i(1),i(5),n.mode.CTRGladman=function(){var t=n.lib.BlockCipherMode.extend();function e(t){if(255==(t>>24&255)){var e=t>>16&255,i=t>>8&255,n=255&t;255===e?(e=0,255===i?(i=0,255===n?n=0:++n):++i):++e,t=0,t+=e<<16,t+=i<<8,t+=n}else t+=1<<24;return t}var i=t.Encryptor=t.extend({processBlock:function(t,i){var n=this._cipher,r=n.blockSize,o=this._iv,s=this._counter;o&&(s=this._counter=o.slice(0),this._iv=void 0),function(t){0===(t[0]=e(t[0]))&&(t[1]=e(t[1]))}(s);var a=s.slice(0);n.encryptBlock(a,0);for(var h=0;h<r;h++)t[i+h]^=a[h]}});return t.Decryptor=i,t}(),n.mode.CTRGladman)},function(t,e,i){var n,r,o;t.exports=(o=i(1),i(5),o.mode.OFB=(n=o.lib.BlockCipherMode.extend(),r=n.Encryptor=n.extend({processBlock:function(t,e){var i=this._cipher,n=i.blockSize,r=this._iv,o=this._keystream;r&&(o=this._keystream=r.slice(0),this._iv=void 0),i.encryptBlock(o,0);for(var s=0;s<n;s++)t[e+s]^=o[s]}}),n.Decryptor=r,n),o.mode.OFB)},function(t,e,i){var n,r;t.exports=(r=i(1),i(5),r.mode.ECB=((n=r.lib.BlockCipherMode.extend()).Encryptor=n.extend({processBlock:function(t,e){this._cipher.encryptBlock(t,e)}}),n.Decryptor=n.extend({processBlock:function(t,e){this._cipher.decryptBlock(t,e)}}),n),r.mode.ECB)},function(t,e,i){var n;t.exports=(n=i(1),i(5),n.pad.AnsiX923={pad:function(t,e){var i=t.sigBytes,n=4*e,r=n-i%n,o=i+r-1;t.clamp(),t.words[o>>>2]|=r<<24-o%4*8,t.sigBytes+=r},unpad:function(t){var e=255&t.words[t.sigBytes-1>>>2];t.sigBytes-=e}},n.pad.Ansix923)},function(t,e,i){var n;t.exports=(n=i(1),i(5),n.pad.Iso10126={pad:function(t,e){var i=4*e,r=i-t.sigBytes%i;t.concat(n.lib.WordArray.random(r-1)).concat(n.lib.WordArray.create([r<<24],1))},unpad:function(t){var e=255&t.words[t.sigBytes-1>>>2];t.sigBytes-=e}},n.pad.Iso10126)},function(t,e,i){var n;t.exports=(n=i(1),i(5),n.pad.Iso97971={pad:function(t,e){t.concat(n.lib.WordArray.create([2147483648],1)),n.pad.ZeroPadding.pad(t,e)},unpad:function(t){n.pad.ZeroPadding.unpad(t),t.sigBytes--}},n.pad.Iso97971)},function(t,e,i){var n;t.exports=(n=i(1),i(5),n.pad.ZeroPadding={pad:function(t,e){var i=4*e;t.clamp(),t.sigBytes+=i-(t.sigBytes%i||i)},unpad:function(t){for(var e=t.words,i=t.sigBytes-1;!(e[i>>>2]>>>24-i%4*8&255);)i--;t.sigBytes=i+1}},n.pad.ZeroPadding)},function(t,e,i){var n;t.exports=(n=i(1),i(5),n.pad.NoPadding={pad:function(){},unpad:function(){}},n.pad.NoPadding)},function(t,e,i){var n,r,o,s;t.exports=(s=i(1),i(5),r=(n=s).lib.CipherParams,o=n.enc.Hex,n.format.Hex={stringify:function(t){return t.ciphertext.toString(o)},parse:function(t){var e=o.parse(t);return r.create({ciphertext:e})}},s.format.Hex)},function(t,e,i){var n;t.exports=(n=i(1),i(23),i(24),i(16),i(5),function(){var t=n,e=t.lib.BlockCipher,i=t.algo,r=[],o=[],s=[],a=[],h=[],c=[],u=[],l=[],d=[],f=[];!function(){for(var t=[],e=0;e<256;e++)t[e]=e<128?e<<1:e<<1^283;var i=0,n=0;for(e=0;e<256;e++){var p=n^n<<1^n<<2^n<<3^n<<4;p=p>>>8^255&p^99,r[i]=p,o[p]=i;var y=t[i],v=t[y],g=t[v],_=257*t[p]^16843008*p;s[i]=_<<24|_>>>8,a[i]=_<<16|_>>>16,h[i]=_<<8|_>>>24,c[i]=_,_=16843009*g^65537*v^257*y^16843008*i,u[p]=_<<24|_>>>8,l[p]=_<<16|_>>>16,d[p]=_<<8|_>>>24,f[p]=_,i?(i=y^t[t[t[g^y]]],n^=t[t[n]]):i=n=1}}();var p=[0,1,2,4,8,16,32,64,128,27,54],y=i.AES=e.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var t=this._keyPriorReset=this._key,e=t.words,i=t.sigBytes/4,n=4*((this._nRounds=i+6)+1),o=this._keySchedule=[],s=0;s<n;s++)if(s<i)o[s]=e[s];else{var a=o[s-1];s%i?i>6&&s%i==4&&(a=r[a>>>24]<<24|r[a>>>16&255]<<16|r[a>>>8&255]<<8|r[255&a]):(a=r[(a=a<<8|a>>>24)>>>24]<<24|r[a>>>16&255]<<16|r[a>>>8&255]<<8|r[255&a],a^=p[s/i|0]<<24),o[s]=o[s-i]^a}for(var h=this._invKeySchedule=[],c=0;c<n;c++)s=n-c,a=c%4?o[s]:o[s-4],h[c]=c<4||s<=4?a:u[r[a>>>24]]^l[r[a>>>16&255]]^d[r[a>>>8&255]]^f[r[255&a]]}},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,s,a,h,c,r)},decryptBlock:function(t,e){var i=t[e+1];t[e+1]=t[e+3],t[e+3]=i,this._doCryptBlock(t,e,this._invKeySchedule,u,l,d,f,o),i=t[e+1],t[e+1]=t[e+3],t[e+3]=i},_doCryptBlock:function(t,e,i,n,r,o,s,a){for(var h=this._nRounds,c=t[e]^i[0],u=t[e+1]^i[1],l=t[e+2]^i[2],d=t[e+3]^i[3],f=4,p=1;p<h;p++){var y=n[c>>>24]^r[u>>>16&255]^o[l>>>8&255]^s[255&d]^i[f++],v=n[u>>>24]^r[l>>>16&255]^o[d>>>8&255]^s[255&c]^i[f++],g=n[l>>>24]^r[d>>>16&255]^o[c>>>8&255]^s[255&u]^i[f++],_=n[d>>>24]^r[c>>>16&255]^o[u>>>8&255]^s[255&l]^i[f++];c=y,u=v,l=g,d=_}y=(a[c>>>24]<<24|a[u>>>16&255]<<16|a[l>>>8&255]<<8|a[255&d])^i[f++],v=(a[u>>>24]<<24|a[l>>>16&255]<<16|a[d>>>8&255]<<8|a[255&c])^i[f++],g=(a[l>>>24]<<24|a[d>>>16&255]<<16|a[c>>>8&255]<<8|a[255&u])^i[f++],_=(a[d>>>24]<<24|a[c>>>16&255]<<16|a[u>>>8&255]<<8|a[255&l])^i[f++],t[e]=y,t[e+1]=v,t[e+2]=g,t[e+3]=_},keySize:8});t.AES=e._createHelper(y)}(),n.AES)},function(t,e,i){var n;t.exports=(n=i(1),i(23),i(24),i(16),i(5),function(){var t=n,e=t.lib,i=e.WordArray,r=e.BlockCipher,o=t.algo,s=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],a=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],h=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],c=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],u=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],l=o.DES=r.extend({_doReset:function(){for(var t=this._key.words,e=[],i=0;i<56;i++){var n=s[i]-1;e[i]=t[n>>>5]>>>31-n%32&1}for(var r=this._subKeys=[],o=0;o<16;o++){var c=r[o]=[],u=h[o];for(i=0;i<24;i++)c[i/6|0]|=e[(a[i]-1+u)%28]<<31-i%6,c[4+(i/6|0)]|=e[28+(a[i+24]-1+u)%28]<<31-i%6;for(c[0]=c[0]<<1|c[0]>>>31,i=1;i<7;i++)c[i]=c[i]>>>4*(i-1)+3;c[7]=c[7]<<5|c[7]>>>27}var l=this._invSubKeys=[];for(i=0;i<16;i++)l[i]=r[15-i]},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._subKeys)},decryptBlock:function(t,e){this._doCryptBlock(t,e,this._invSubKeys)},_doCryptBlock:function(t,e,i){this._lBlock=t[e],this._rBlock=t[e+1],d.call(this,4,252645135),d.call(this,16,65535),f.call(this,2,858993459),f.call(this,8,16711935),d.call(this,1,1431655765);for(var n=0;n<16;n++){for(var r=i[n],o=this._lBlock,s=this._rBlock,a=0,h=0;h<8;h++)a|=c[h][((s^r[h])&u[h])>>>0];this._lBlock=s,this._rBlock=o^a}var l=this._lBlock;this._lBlock=this._rBlock,this._rBlock=l,d.call(this,1,1431655765),f.call(this,8,16711935),f.call(this,2,858993459),d.call(this,16,65535),d.call(this,4,252645135),t[e]=this._lBlock,t[e+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function d(t,e){var i=(this._lBlock>>>t^this._rBlock)&e;this._rBlock^=i,this._lBlock^=i<<t}function f(t,e){var i=(this._rBlock>>>t^this._lBlock)&e;this._lBlock^=i,this._rBlock^=i<<t}t.DES=r._createHelper(l);var p=o.TripleDES=r.extend({_doReset:function(){var t=this._key.words;this._des1=l.createEncryptor(i.create(t.slice(0,2))),this._des2=l.createEncryptor(i.create(t.slice(2,4))),this._des3=l.createEncryptor(i.create(t.slice(4,6)))},encryptBlock:function(t,e){this._des1.encryptBlock(t,e),this._des2.decryptBlock(t,e),this._des3.encryptBlock(t,e)},decryptBlock:function(t,e){this._des3.decryptBlock(t,e),this._des2.encryptBlock(t,e),this._des1.decryptBlock(t,e)},keySize:6,ivSize:2,blockSize:2});t.TripleDES=r._createHelper(p)}(),n.TripleDES)},function(t,e,i){var n;t.exports=(n=i(1),i(23),i(24),i(16),i(5),function(){var t=n,e=t.lib.StreamCipher,i=t.algo,r=i.RC4=e.extend({_doReset:function(){for(var t=this._key,e=t.words,i=t.sigBytes,n=this._S=[],r=0;r<256;r++)n[r]=r;r=0;for(var o=0;r<256;r++){var s=r%i,a=e[s>>>2]>>>24-s%4*8&255;o=(o+n[r]+a)%256;var h=n[r];n[r]=n[o],n[o]=h}this._i=this._j=0},_doProcessBlock:function(t,e){t[e]^=o.call(this)},keySize:8,ivSize:0});function o(){for(var t=this._S,e=this._i,i=this._j,n=0,r=0;r<4;r++){i=(i+t[e=(e+1)%256])%256;var o=t[e];t[e]=t[i],t[i]=o,n|=t[(t[e]+t[i])%256]<<24-8*r}return this._i=e,this._j=i,n}t.RC4=e._createHelper(r);var s=i.RC4Drop=r.extend({cfg:r.cfg.extend({drop:192}),_doReset:function(){r._doReset.call(this);for(var t=this.cfg.drop;t>0;t--)o.call(this)}});t.RC4Drop=e._createHelper(s)}(),n.RC4)},function(t,e,i){var n;t.exports=(n=i(1),i(23),i(24),i(16),i(5),function(){var t=n,e=t.lib.StreamCipher,i=t.algo,r=[],o=[],s=[],a=i.Rabbit=e.extend({_doReset:function(){for(var t=this._key.words,e=this.cfg.iv,i=0;i<4;i++)t[i]=16711935&(t[i]<<8|t[i]>>>24)|4278255360&(t[i]<<24|t[i]>>>8);var n=this._X=[t[0],t[3]<<16|t[2]>>>16,t[1],t[0]<<16|t[3]>>>16,t[2],t[1]<<16|t[0]>>>16,t[3],t[2]<<16|t[1]>>>16],r=this._C=[t[2]<<16|t[2]>>>16,4294901760&t[0]|65535&t[1],t[3]<<16|t[3]>>>16,4294901760&t[1]|65535&t[2],t[0]<<16|t[0]>>>16,4294901760&t[2]|65535&t[3],t[1]<<16|t[1]>>>16,4294901760&t[3]|65535&t[0]];for(this._b=0,i=0;i<4;i++)h.call(this);for(i=0;i<8;i++)r[i]^=n[i+4&7];if(e){var o=e.words,s=o[0],a=o[1],c=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),u=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),l=c>>>16|4294901760&u,d=u<<16|65535&c;for(r[0]^=c,r[1]^=l,r[2]^=u,r[3]^=d,r[4]^=c,r[5]^=l,r[6]^=u,r[7]^=d,i=0;i<4;i++)h.call(this)}},_doProcessBlock:function(t,e){var i=this._X;h.call(this),r[0]=i[0]^i[5]>>>16^i[3]<<16,r[1]=i[2]^i[7]>>>16^i[5]<<16,r[2]=i[4]^i[1]>>>16^i[7]<<16,r[3]=i[6]^i[3]>>>16^i[1]<<16;for(var n=0;n<4;n++)r[n]=16711935&(r[n]<<8|r[n]>>>24)|4278255360&(r[n]<<24|r[n]>>>8),t[e+n]^=r[n]},blockSize:4,ivSize:2});function h(){for(var t=this._X,e=this._C,i=0;i<8;i++)o[i]=e[i];for(e[0]=e[0]+1295307597+this._b|0,e[1]=e[1]+3545052371+(e[0]>>>0<o[0]>>>0?1:0)|0,e[2]=e[2]+886263092+(e[1]>>>0<o[1]>>>0?1:0)|0,e[3]=e[3]+1295307597+(e[2]>>>0<o[2]>>>0?1:0)|0,e[4]=e[4]+3545052371+(e[3]>>>0<o[3]>>>0?1:0)|0,e[5]=e[5]+886263092+(e[4]>>>0<o[4]>>>0?1:0)|0,e[6]=e[6]+1295307597+(e[5]>>>0<o[5]>>>0?1:0)|0,e[7]=e[7]+3545052371+(e[6]>>>0<o[6]>>>0?1:0)|0,this._b=e[7]>>>0<o[7]>>>0?1:0,i=0;i<8;i++){var n=t[i]+e[i],r=65535&n,a=n>>>16,h=((r*r>>>17)+r*a>>>15)+a*a,c=((4294901760&n)*n|0)+((65535&n)*n|0);s[i]=h^c}t[0]=s[0]+(s[7]<<16|s[7]>>>16)+(s[6]<<16|s[6]>>>16)|0,t[1]=s[1]+(s[0]<<8|s[0]>>>24)+s[7]|0,t[2]=s[2]+(s[1]<<16|s[1]>>>16)+(s[0]<<16|s[0]>>>16)|0,t[3]=s[3]+(s[2]<<8|s[2]>>>24)+s[1]|0,t[4]=s[4]+(s[3]<<16|s[3]>>>16)+(s[2]<<16|s[2]>>>16)|0,t[5]=s[5]+(s[4]<<8|s[4]>>>24)+s[3]|0,t[6]=s[6]+(s[5]<<16|s[5]>>>16)+(s[4]<<16|s[4]>>>16)|0,t[7]=s[7]+(s[6]<<8|s[6]>>>24)+s[5]|0}t.Rabbit=e._createHelper(a)}(),n.Rabbit)},function(t,e,i){var n;t.exports=(n=i(1),i(23),i(24),i(16),i(5),function(){var t=n,e=t.lib.StreamCipher,i=t.algo,r=[],o=[],s=[],a=i.RabbitLegacy=e.extend({_doReset:function(){var t=this._key.words,e=this.cfg.iv,i=this._X=[t[0],t[3]<<16|t[2]>>>16,t[1],t[0]<<16|t[3]>>>16,t[2],t[1]<<16|t[0]>>>16,t[3],t[2]<<16|t[1]>>>16],n=this._C=[t[2]<<16|t[2]>>>16,4294901760&t[0]|65535&t[1],t[3]<<16|t[3]>>>16,4294901760&t[1]|65535&t[2],t[0]<<16|t[0]>>>16,4294901760&t[2]|65535&t[3],t[1]<<16|t[1]>>>16,4294901760&t[3]|65535&t[0]];this._b=0;for(var r=0;r<4;r++)h.call(this);for(r=0;r<8;r++)n[r]^=i[r+4&7];if(e){var o=e.words,s=o[0],a=o[1],c=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),u=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),l=c>>>16|4294901760&u,d=u<<16|65535&c;for(n[0]^=c,n[1]^=l,n[2]^=u,n[3]^=d,n[4]^=c,n[5]^=l,n[6]^=u,n[7]^=d,r=0;r<4;r++)h.call(this)}},_doProcessBlock:function(t,e){var i=this._X;h.call(this),r[0]=i[0]^i[5]>>>16^i[3]<<16,r[1]=i[2]^i[7]>>>16^i[5]<<16,r[2]=i[4]^i[1]>>>16^i[7]<<16,r[3]=i[6]^i[3]>>>16^i[1]<<16;for(var n=0;n<4;n++)r[n]=16711935&(r[n]<<8|r[n]>>>24)|4278255360&(r[n]<<24|r[n]>>>8),t[e+n]^=r[n]},blockSize:4,ivSize:2});function h(){for(var t=this._X,e=this._C,i=0;i<8;i++)o[i]=e[i];for(e[0]=e[0]+1295307597+this._b|0,e[1]=e[1]+3545052371+(e[0]>>>0<o[0]>>>0?1:0)|0,e[2]=e[2]+886263092+(e[1]>>>0<o[1]>>>0?1:0)|0,e[3]=e[3]+1295307597+(e[2]>>>0<o[2]>>>0?1:0)|0,e[4]=e[4]+3545052371+(e[3]>>>0<o[3]>>>0?1:0)|0,e[5]=e[5]+886263092+(e[4]>>>0<o[4]>>>0?1:0)|0,e[6]=e[6]+1295307597+(e[5]>>>0<o[5]>>>0?1:0)|0,e[7]=e[7]+3545052371+(e[6]>>>0<o[6]>>>0?1:0)|0,this._b=e[7]>>>0<o[7]>>>0?1:0,i=0;i<8;i++){var n=t[i]+e[i],r=65535&n,a=n>>>16,h=((r*r>>>17)+r*a>>>15)+a*a,c=((4294901760&n)*n|0)+((65535&n)*n|0);s[i]=h^c}t[0]=s[0]+(s[7]<<16|s[7]>>>16)+(s[6]<<16|s[6]>>>16)|0,t[1]=s[1]+(s[0]<<8|s[0]>>>24)+s[7]|0,t[2]=s[2]+(s[1]<<16|s[1]>>>16)+(s[0]<<16|s[0]>>>16)|0,t[3]=s[3]+(s[2]<<8|s[2]>>>24)+s[1]|0,t[4]=s[4]+(s[3]<<16|s[3]>>>16)+(s[2]<<16|s[2]>>>16)|0,t[5]=s[5]+(s[4]<<8|s[4]>>>24)+s[3]|0,t[6]=s[6]+(s[5]<<16|s[5]>>>16)+(s[4]<<16|s[4]>>>16)|0,t[7]=s[7]+(s[6]<<8|s[6]>>>24)+s[5]|0}t.RabbitLegacy=e._createHelper(a)}(),n.RabbitLegacy)},function(t,e,i){var n=i(67),r=i(224);t.exports=function t(e,i,o,s,a){var h=-1,c=e.length;for(o||(o=r),a||(a=[]);++h<c;){var u=e[h];i>0&&o(u)?i>1?t(u,i-1,o,s,a):n(a,u):s||(a[a.length]=u)}return a}},function(t,e,i){var n=i(25),r=i(37),o=i(8),s=n?n.isConcatSpreadable:void 0;t.exports=function(t){return o(t)||r(t)||!!(s&&t&&t[s])}},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){var n=i(29),r=i(14),o="[object Arguments]";t.exports=function(t){return r(t)&&n(t)==o}},function(t,e,i){var n=i(25),r=Object.prototype,o=r.hasOwnProperty,s=r.toString,a=n?n.toStringTag:void 0;t.exports=function(t){var e=o.call(t,a),i=t[a];try{t[a]=void 0;var n=!0}catch(t){}var r=s.call(t);return n&&(e?t[a]=i:delete t[a]),r}},function(t,e){var i=Object.prototype.toString;t.exports=function(t){return i.call(t)}},function(t,e,i){var n=i(38),r=i(230),o=i(290),s=i(296),a=i(31),h=i(297),c=i(47);t.exports=function(t,e,i){var u=-1;e=n(e.length?e:[c],a(r));var l=o(t,(function(t,i,r){return{criteria:n(e,(function(e){return e(t)})),index:++u,value:t}}));return s(l,(function(t,e){return h(t,e,i)}))}},function(t,e,i){var n=i(231),r=i(277),o=i(47),s=i(8),a=i(287);t.exports=function(t){return"function"==typeof t?t:null==t?o:"object"==typeof t?s(t)?r(t[0],t[1]):n(t):a(t)}},function(t,e,i){var n=i(232),r=i(276),o=i(120);t.exports=function(t){var e=r(t);return 1==e.length&&e[0][2]?o(e[0][0],e[0][1]):function(i){return i===t||n(i,t,e)}}},function(t,e,i){var n=i(68),r=i(108),o=1,s=2;t.exports=function(t,e,i,a){var h=i.length,c=h,u=!a;if(null==t)return!c;for(t=Object(t);h--;){var l=i[h];if(u&&l[2]?l[1]!==t[l[0]]:!(l[0]in t))return!1}for(;++h<c;){var d=(l=i[h])[0],f=t[d],p=l[1];if(u&&l[2]){if(void 0===f&&!(d in t))return!1}else{var y=new n;if(a)var v=a(f,p,d,t,e,y);if(!(void 0===v?r(p,f,o|s,a,y):v))return!1}}return!0}},function(t,e){t.exports=function(){this.__data__=[],this.size=0}},function(t,e,i){var n=i(40),r=Array.prototype.splice;t.exports=function(t){var e=this.__data__,i=n(e,t);return!(i<0)&&(i==e.length-1?e.pop():r.call(e,i,1),--this.size,!0)}},function(t,e,i){var n=i(40);t.exports=function(t){var e=this.__data__,i=n(e,t);return i<0?void 0:e[i][1]}},function(t,e,i){var n=i(40);t.exports=function(t){return n(this.__data__,t)>-1}},function(t,e,i){var n=i(40);t.exports=function(t,e){var i=this.__data__,r=n(i,t);return r<0?(++this.size,i.push([t,e])):i[r][1]=e,this}},function(t,e,i){var n=i(39);t.exports=function(){this.__data__=new n,this.size=0}},function(t,e){t.exports=function(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i}},function(t,e){t.exports=function(t){return this.__data__.get(t)}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e,i){var n=i(39),r=i(69),o=i(71),s=200;t.exports=function(t,e){var i=this.__data__;if(i instanceof n){var a=i.__data__;if(!r||a.length<s-1)return a.push([t,e]),this.size=++i.size,this;i=this.__data__=new o(a)}return i.set(t,e),this.size=i.size,this}},function(t,e,i){var n=i(70),r=i(244),o=i(13),s=i(107),a=/^\[object .+?Constructor\]$/,h=Function.prototype,c=Object.prototype,u=h.toString,l=c.hasOwnProperty,d=RegExp("^"+u.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!o(t)||r(t))&&(n(t)?d:a).test(s(t))}},function(t,e,i){var n,r=i(245),o=(n=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";t.exports=function(t){return!!o&&o in t}},function(t,e,i){var n=i(10)["__core-js_shared__"];t.exports=n},function(t,e){t.exports=function(t,e){return null==t?void 0:t[e]}},function(t,e,i){var n=i(248),r=i(39),o=i(69);t.exports=function(){this.size=0,this.__data__={hash:new n,map:new(o||r),string:new n}}},function(t,e,i){var n=i(249),r=i(250),o=i(251),s=i(252),a=i(253);function h(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}h.prototype.clear=n,h.prototype.delete=r,h.prototype.get=o,h.prototype.has=s,h.prototype.set=a,t.exports=h},function(t,e,i){var n=i(41);t.exports=function(){this.__data__=n?n(null):{},this.size=0}},function(t,e){t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},function(t,e,i){var n=i(41),r="__lodash_hash_undefined__",o=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(n){var i=e[t];return i===r?void 0:i}return o.call(e,t)?e[t]:void 0}},function(t,e,i){var n=i(41),r=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return n?void 0!==e[t]:r.call(e,t)}},function(t,e,i){var n=i(41),r="__lodash_hash_undefined__";t.exports=function(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=n&&void 0===e?r:e,this}},function(t,e,i){var n=i(42);t.exports=function(t){var e=n(this,t).delete(t);return this.size-=e?1:0,e}},function(t,e){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},function(t,e,i){var n=i(42);t.exports=function(t){return n(this,t).get(t)}},function(t,e,i){var n=i(42);t.exports=function(t){return n(this,t).has(t)}},function(t,e,i){var n=i(42);t.exports=function(t,e){var i=n(this,t),r=i.size;return i.set(t,e),this.size+=i.size==r?0:1,this}},function(t,e,i){var n=i(68),r=i(109),o=i(263),s=i(266),a=i(32),h=i(8),c=i(43),u=i(75),l=1,d="[object Arguments]",f="[object Array]",p="[object Object]",y=Object.prototype.hasOwnProperty;t.exports=function(t,e,i,v,g,_){var m=h(t),b=h(e),x=m?f:a(t),w=b?f:a(e),C=(x=x==d?p:x)==p,S=(w=w==d?p:w)==p,D=x==w;if(D&&c(t)){if(!c(e))return!1;m=!0,C=!1}if(D&&!C)return _||(_=new n),m||u(t)?r(t,e,i,v,g,_):o(t,e,x,i,v,g,_);if(!(i&l)){var k=C&&y.call(t,"__wrapped__"),P=S&&y.call(e,"__wrapped__");if(k||P){var T=k?t.value():t,E=P?e.value():e;return _||(_=new n),g(T,E,i,v,_)}}return!!D&&(_||(_=new n),s(t,e,i,v,g,_))}},function(t,e){var i="__lodash_hash_undefined__";t.exports=function(t){return this.__data__.set(t,i),this}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e){t.exports=function(t,e){for(var i=-1,n=null==t?0:t.length;++i<n;)if(e(t[i],i,t))return!0;return!1}},function(t,e,i){var n=i(25),r=i(112),o=i(30),s=i(109),a=i(264),h=i(265),c=1,u=2,l="[object Boolean]",d="[object Date]",f="[object Error]",p="[object Map]",y="[object Number]",v="[object RegExp]",g="[object Set]",_="[object String]",m="[object Symbol]",b="[object ArrayBuffer]",x="[object DataView]",w=n?n.prototype:void 0,C=w?w.valueOf:void 0;t.exports=function(t,e,i,n,w,S,D){switch(i){case x:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case b:return!(t.byteLength!=e.byteLength||!S(new r(t),new r(e)));case l:case d:case y:return o(+t,+e);case f:return t.name==e.name&&t.message==e.message;case v:case _:return t==e+"";case p:var k=a;case g:var P=n&c;if(k||(k=h),t.size!=e.size&&!P)return!1;var T=D.get(t);if(T)return T==e;n|=u,D.set(t,e);var E=s(k(t),k(e),n,w,S,D);return D.delete(t),E;case m:if(C)return C.call(t)==C.call(e)}return!1}},function(t,e){t.exports=function(t){var e=-1,i=Array(t.size);return t.forEach((function(t,n){i[++e]=[n,t]})),i}},function(t,e){t.exports=function(t){var e=-1,i=Array(t.size);return t.forEach((function(t){i[++e]=t})),i}},function(t,e,i){var n=i(113),r=1,o=Object.prototype.hasOwnProperty;t.exports=function(t,e,i,s,a,h){var c=i&r,u=n(t),l=u.length;if(l!=n(e).length&&!c)return!1;for(var d=l;d--;){var f=u[d];if(!(c?f in e:o.call(e,f)))return!1}var p=h.get(t);if(p&&h.get(e))return p==e;var y=!0;h.set(t,e),h.set(e,t);for(var v=c;++d<l;){var g=t[f=u[d]],_=e[f];if(s)var m=c?s(_,g,f,e,t,h):s(g,_,f,t,e,h);if(!(void 0===m?g===_||a(g,_,i,s,h):m)){y=!1;break}v||(v="constructor"==f)}if(y&&!v){var b=t.constructor,x=e.constructor;b!=x&&"constructor"in t&&"constructor"in e&&!("function"==typeof b&&b instanceof b&&"function"==typeof x&&x instanceof x)&&(y=!1)}return h.delete(t),h.delete(e),y}},function(t,e){t.exports=function(t,e){for(var i=-1,n=null==t?0:t.length,r=0,o=[];++i<n;){var s=t[i];e(s,i,t)&&(o[r++]=s)}return o}},function(t,e){t.exports=function(t,e){for(var i=-1,n=Array(t);++i<t;)n[i]=e(i);return n}},function(t,e){t.exports=function(){return!1}},function(t,e,i){var n=i(29),r=i(76),o=i(14),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,t.exports=function(t){return o(t)&&r(t.length)&&!!s[n(t)]}},function(t,e,i){var n=i(118)(Object.keys,Object);t.exports=n},function(t,e,i){var n=i(17)(i(10),"DataView");t.exports=n},function(t,e,i){var n=i(17)(i(10),"Promise");t.exports=n},function(t,e,i){var n=i(17)(i(10),"Set");t.exports=n},function(t,e,i){var n=i(17)(i(10),"WeakMap");t.exports=n},function(t,e,i){var n=i(119),r=i(26);t.exports=function(t){for(var e=r(t),i=e.length;i--;){var o=e[i],s=t[o];e[i]=[o,s,n(s)]}return e}},function(t,e,i){var n=i(108),r=i(278),o=i(284),s=i(78),a=i(119),h=i(120),c=i(46),u=1,l=2;t.exports=function(t,e){return s(t)&&a(e)?h(c(t),e):function(i){var s=r(i,t);return void 0===s&&s===e?o(i,t):n(e,s,u|l)}}},function(t,e,i){var n=i(121);t.exports=function(t,e,i){var r=null==t?void 0:n(t,e);return void 0===r?i:r}},function(t,e,i){var n=i(280),r=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,s=n((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(r,(function(t,i,n,r){e.push(n?r.replace(o,"$1"):i||t)})),e}));t.exports=s},function(t,e,i){var n=i(281),r=500;t.exports=function(t){var e=n(t,(function(t){return i.size===r&&i.clear(),t})),i=e.cache;return e}},function(t,e,i){var n=i(71),r="Expected a function";function o(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(r);var i=function(){var n=arguments,r=e?e.apply(this,n):n[0],o=i.cache;if(o.has(r))return o.get(r);var s=t.apply(this,n);return i.cache=o.set(r,s)||o,s};return i.cache=new(o.Cache||n),i}o.Cache=n,t.exports=o},function(t,e,i){var n=i(283);t.exports=function(t){return null==t?"":n(t)}},function(t,e,i){var n=i(25),r=i(38),o=i(8),s=i(45),a=1/0,h=n?n.prototype:void 0,c=h?h.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(o(e))return r(e,t)+"";if(s(e))return c?c.call(e):"";var i=e+"";return"0"==i&&1/e==-a?"-0":i}},function(t,e,i){var n=i(285),r=i(286);t.exports=function(t,e){return null!=t&&r(t,e,n)}},function(t,e){t.exports=function(t,e){return null!=t&&e in Object(t)}},function(t,e,i){var n=i(122),r=i(37),o=i(8),s=i(74),a=i(76),h=i(46);t.exports=function(t,e,i){for(var c=-1,u=(e=n(e,t)).length,l=!1;++c<u;){var d=h(e[c]);if(!(l=null!=t&&i(t,d)))break;t=t[d]}return l||++c!=u?l:!!(u=null==t?0:t.length)&&a(u)&&s(d,u)&&(o(t)||r(t))}},function(t,e,i){var n=i(288),r=i(289),o=i(78),s=i(46);t.exports=function(t){return o(t)?n(s(t)):r(t)}},function(t,e){t.exports=function(t){return function(e){return null==e?void 0:e[t]}}},function(t,e,i){var n=i(121);t.exports=function(t){return function(e){return n(e,t)}}},function(t,e,i){var n=i(291),r=i(18);t.exports=function(t,e){var i=-1,o=r(t)?Array(t.length):[];return n(t,(function(t,n,r){o[++i]=e(t,n,r)})),o}},function(t,e,i){var n=i(292),r=i(295)(n);t.exports=r},function(t,e,i){var n=i(293),r=i(26);t.exports=function(t,e){return t&&n(t,e,r)}},function(t,e,i){var n=i(294)();t.exports=n},function(t,e){t.exports=function(t){return function(e,i,n){for(var r=-1,o=Object(e),s=n(e),a=s.length;a--;){var h=s[t?a:++r];if(!1===i(o[h],h,o))break}return e}}},function(t,e,i){var n=i(18);t.exports=function(t,e){return function(i,r){if(null==i)return i;if(!n(i))return t(i,r);for(var o=i.length,s=e?o:-1,a=Object(i);(e?s--:++s<o)&&!1!==r(a[s],s,a););return i}}},function(t,e){t.exports=function(t,e){var i=t.length;for(t.sort(e);i--;)t[i]=t[i].value;return t}},function(t,e,i){var n=i(298);t.exports=function(t,e,i){for(var r=-1,o=t.criteria,s=e.criteria,a=o.length,h=i.length;++r<a;){var c=n(o[r],s[r]);if(c)return r>=h?c:c*("desc"==i[r]?-1:1)}return t.index-e.index}},function(t,e,i){var n=i(45);t.exports=function(t,e){if(t!==e){var i=void 0!==t,r=null===t,o=t==t,s=n(t),a=void 0!==e,h=null===e,c=e==e,u=n(e);if(!h&&!u&&!s&&t>e||s&&a&&c&&!h&&!u||r&&a&&c||!i&&c||!o)return 1;if(!r&&!s&&!u&&t<e||u&&i&&o&&!r&&!s||h&&i&&o||!a&&o||!c)return-1}return 0}},function(t,e,i){var n=i(300),r=Math.max;t.exports=function(t,e,i){return e=r(void 0===e?t.length-1:e,0),function(){for(var o=arguments,s=-1,a=r(o.length-e,0),h=Array(a);++s<a;)h[s]=o[e+s];s=-1;for(var c=Array(e+1);++s<e;)c[s]=o[s];return c[e]=i(h),n(t,this,c)}}},function(t,e){t.exports=function(t,e,i){switch(i.length){case 0:return t.call(e);case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2])}return t.apply(e,i)}},function(t,e,i){var n=i(302),r=i(304)(n);t.exports=r},function(t,e,i){var n=i(303),r=i(123),o=i(47),s=r?function(t,e){return r(t,"toString",{configurable:!0,enumerable:!1,value:n(e),writable:!0})}:o;t.exports=s},function(t,e){t.exports=function(t){return function(){return t}}},function(t,e){var i=800,n=16,r=Date.now;t.exports=function(t){var e=0,o=0;return function(){var s=r(),a=n-(s-o);if(o=s,a>0){if(++e>=i)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}},function(t,e,i){var n=i(306);"string"==typeof n&&(n=[[t.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};i(125)(n,r);n.locals&&(t.exports=n.locals)},function(t,e,i){(t.exports=i(124)(!1)).push([t.i,'@charset "UTF-8";\n/*! normalize.css v2.1.1 | MIT License | git.io/normalize */\n/* ==========================================================================\nHTML5 display definitions\n========================================================================== */\n/**\n* Correct `block` display not defined in IE 8/9.\n*/\narticle,\naside,\ndetails,\nfigcaption,\nfigure,\nfooter,\nheader,\nhgroup,\nmain,\nnav,\nsection,\nsummary {\n  display: block; }\n\n/**\n* Correct `inline-block` display not defined in IE 8/9.\n*/\naudio,\ncanvas,\nvideo {\n  display: inline-block; }\n\n/**\n* Prevent modern browsers from displaying `audio` without controls.\n* Remove excess height in iOS 5 devices.\n*/\naudio:not([controls]) {\n  display: none;\n  height: 0; }\n\n/**\n* Address styling not present in IE 8/9.\n*/\n[hidden] {\n  display: none; }\n\n/* ==========================================================================\nBase\n========================================================================== */\n/**\n* 1. Prevent system color scheme\'s background color being used in Firefox, IE,\n* and Opera.\n* 2. Prevent system color scheme\'s text color being used in Firefox, IE, and\n* Opera.\n* 3. Set default font family to sans-serif.\n* 4. Prevent iOS text size adjust after orientation change, without disabling\n* user zoom.\n*/\nhtml {\n  background: #fff;\n  /* 1 */\n  color: #000;\n  /* 2 */\n  font-family: sans-serif;\n  /* 3 */\n  -ms-text-size-adjust: 100%;\n  /* 4 */\n  -webkit-text-size-adjust: 100%;\n  /* 4 */ }\n\n/**\n* Remove default margin.\n*/\nbody {\n  margin: 0; }\n\n/* ==========================================================================\nLinks\n========================================================================== */\n/**\n* Address `outline` inconsistency between Chrome and other browsers.\n*/\na:focus {\n  outline: thin dotted; }\n\n/**\n* Improve readability when focused and also mouse hovered in all browsers.\n*/\na:active,\na:hover {\n  outline: 0; }\n\n/* ==========================================================================\nTypography\n========================================================================== */\n/**\n* Address variable `h1` font-size and margin within `section` and `article`\n* contexts in Firefox 4+, Safari 5, and Chrome.\n*/\nh1 {\n  font-size: 2em;\n  margin: 0.67em 0; }\n\n/**\n* Address styling not present in IE 8/9, Safari 5, and Chrome.\n*/\nabbr[title] {\n  border-bottom: 1px dotted; }\n\n/**\n* Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome.\n*/\nb,\nstrong {\n  font-weight: bold; }\n\n/**\n* Address styling not present in Safari 5 and Chrome.\n*/\ndfn {\n  font-style: italic; }\n\n/**\n* Address differences between Firefox and other browsers.\n*/\nhr {\n  box-sizing: content-box;\n  height: 0; }\n\n/**\n* Address styling not present in IE 8/9.\n*/\nmark {\n  background: #ff0;\n  color: #000; }\n\n/**\n* Correct font family set oddly in Safari 5 and Chrome.\n*/\ncode,\nkbd,\npre,\nsamp {\n  font-family: monospace, serif;\n  font-size: 1em; }\n\n/**\n* Improve readability of pre-formatted text in all browsers.\n*/\npre {\n  white-space: pre-wrap; }\n\n/**\n* Set consistent quote types.\n*/\nq {\n  quotes: "“" "”" "‘" "’"; }\n\n/**\n* Address inconsistent and variable font size in all browsers.\n*/\nsmall {\n  font-size: 80%; }\n\n/**\n* Prevent `sub` and `sup` affecting `line-height` in all browsers.\n*/\nsub,\nsup {\n  font-size: 75%;\n  line-height: 0;\n  position: relative;\n  vertical-align: baseline; }\n\nsup {\n  top: -0.5em; }\n\nsub {\n  bottom: -0.25em; }\n\n/* ==========================================================================\nEmbedded content\n========================================================================== */\n/**\n* Remove border when inside `a` element in IE 8/9.\n*/\nimg {\n  border: 0; }\n\n/**\n* Correct overflow displayed oddly in IE 9.\n*/\nsvg:not(:root) {\n  overflow: hidden; }\n\n/* ==========================================================================\nFigures\n========================================================================== */\n/**\n* Address margin not present in IE 8/9 and Safari 5.\n*/\nfigure {\n  margin: 0; }\n\n/* ==========================================================================\nForms\n========================================================================== */\n/**\n* Define consistent border, margin, and padding.\n*/\nfieldset {\n  border: 1px solid #c0c0c0;\n  margin: 0 2px;\n  padding: 0.35em 0.625em 0.75em; }\n\n/**\n* 1. Correct `color` not being inherited in IE 8/9.\n* 2. Remove padding so people aren\'t caught out if they zero out fieldsets.\n*/\nlegend {\n  border: 0;\n  /* 1 */\n  padding: 0;\n  /* 2 */ }\n\n/**\n* 1. Correct font family not being inherited in all browsers.\n* 2. Correct font size not being inherited in all browsers.\n* 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome.\n*/\nbutton,\ninput,\nselect,\ntextarea {\n  font-family: inherit;\n  /* 1 */\n  font-size: 100%;\n  /* 2 */\n  margin: 0;\n  /* 3 */ }\n\n/**\n* Address Firefox 4+ setting `line-height` on `input` using `!important` in\n* the UA stylesheet.\n*/\nbutton,\ninput {\n  line-height: normal; }\n\n/**\n* Address inconsistent `text-transform` inheritance for `button` and `select`.\n* All other form control elements do not inherit `text-transform` values.\n* Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+.\n* Correct `select` style inheritance in Firefox 4+ and Opera.\n*/\nbutton,\nselect {\n  text-transform: none; }\n\n/**\n* 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`\n* and `video` controls.\n* 2. Correct inability to style clickable `input` types in iOS.\n* 3. Improve usability and consistency of cursor style between image-type\n* `input` and others.\n*/\nbutton,\nhtml input[type="button"],\ninput[type="reset"],\ninput[type="submit"] {\n  -webkit-appearance: button;\n  /* 2 */\n  cursor: pointer;\n  /* 3 */ }\n\n/**\n* Re-set default cursor for disabled elements.\n*/\nbutton[disabled],\nhtml input[disabled] {\n  cursor: default; }\n\n/**\n* 1. Address box sizing set to `content-box` in IE 8/9.\n* 2. Remove excess padding in IE 8/9.\n*/\ninput[type="checkbox"],\ninput[type="radio"] {\n  box-sizing: border-box;\n  /* 1 */\n  padding: 0;\n  /* 2 */ }\n\n/**\n* 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.\n* 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome\n* (include `-moz` to future-proof).\n*/\ninput[type="search"] {\n  -webkit-appearance: textfield;\n  /* 1 */\n  /* 2 */\n  box-sizing: content-box; }\n\n/**\n* Remove inner padding and search cancel button in Safari 5 and Chrome\n* on OS X.\n*/\ninput[type="search"]::-webkit-search-cancel-button,\ninput[type="search"]::-webkit-search-decoration {\n  -webkit-appearance: none; }\n\n/**\n* Remove inner padding and border in Firefox 4+.\n*/\nbutton::-moz-focus-inner,\ninput::-moz-focus-inner {\n  border: 0;\n  padding: 0; }\n\n/**\n* 1. Remove default vertical scrollbar in IE 8/9.\n* 2. Improve readability and alignment in all browsers.\n*/\ntextarea {\n  overflow: auto;\n  /* 1 */\n  vertical-align: top;\n  /* 2 */ }\n\n/* ==========================================================================\nTables\n========================================================================== */\n/**\n* Remove most spacing between table cells.\n*/\ntable {\n  border-collapse: collapse;\n  border-spacing: 0; }\n',""])},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var i=e.protocol+"//"+e.host,n=i+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(t,e){var r,o=e.trim().replace(/^"(.*)"$/,(function(t,e){return e})).replace(/^'(.*)'$/,(function(t,e){return e}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(o)?t:(r=0===o.indexOf("//")?o:0===o.indexOf("/")?i+o:n+o.replace(/^\.\//,""),"url("+JSON.stringify(r)+")")}))}},function(t,e,i){var n=i(309);"string"==typeof n&&(n=[[t.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};i(125)(n,r);n.locals&&(t.exports=n.locals)},function(t,e,i){(t.exports=i(124)(!1)).push([t.i,'html,\nbody {\n  margin: 0 0;\n  background: #000; }\n\nhtml {\n  box-sizing: border-box; }\n\n*,\n*::before,\n*::after {\n  box-sizing: inherit; }\n\n#cr-stage {\n  image-rendering: -moz-crisp-edges;\n  /* Firefox */\n  image-rendering: -o-crisp-edges;\n  /* Opera */\n  image-rendering: -webkit-optimize-contrast;\n  /* Webkit (non-standard naming) */\n  image-rendering: crisp-edges;\n  -ms-interpolation-mode: nearest-neighbor;\n  /* IE (non-standard property) */\n  transform-origin: top left; }\n\nh1 {\n  font-size: 1.2em; }\n\nh2 {\n  font-size: 1.1em; }\n\nfooter {\n  color: #ddd;\n  padding: 1em;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  position: absolute;\n  top: 0;\n  left: 0;\n  font-family: "Press Start 2P";\n  font-size: 8px;\n  width: 100%; }\n\nfooter * {\n  margin-right: 1em; }\n\nfooter button {\n  padding: 0.6em;\n  border-radius: 0.2em;\n  background: #ddd; }\n\n#version::before {\n  content: "Ver: "; }\n\na {\n  color: #fff; }\n\n.fullscreen #theater {\n  position: absolute;\n  top: 0;\n  left: 0;\n  background: #000; }\n',""])},function(t,e,i){"use strict";(function(t){var e=i(2),n=i.n(e),r=i(11);t.c("BulletCircle",{bulletCircle(t){return this.shootConfig=n()(t,{burstAmount:10,angle:"random"}),this},shootRing(t={}){const e=n()(t,this.shootConfig);if(this.hidden&&!e.shootWhenHidden)return;this.lastShotAt=0,this.currentBurst+=1;const i=this.weaponOrigin||e.weaponOrigin||[this.w/2,this.h/2];i[0]*=null!=this.scale?this.scale:1,i[1]*=null!=this.scale?this.scale:1;const o=360/e.burstAmount,s=("random"===e.angle?Object(r.lookup)():e.angle)*o;for(let t=0;t<e.burstAmount;t++)e.projectile(i[0]+this.x,i[1]+this.y,s+t*o)}})}).call(this,i(0).default)},function(t,e,i){var n=i(13),r=i(44),o=i(312),s=Object.prototype.hasOwnProperty;t.exports=function(t){if(!n(t))return o(t);var e=r(t),i=[];for(var a in t)("constructor"!=a||!e&&s.call(t,a))&&i.push(a);return i}},function(t,e){t.exports=function(t){var e=[];if(null!=t)for(var i in Object(t))e.push(i);return e}},function(t,e,i){"use strict";(function(t){var e=i(2),n=i.n(e),r=i(11);t.c("BurstShot",{remove(){this.unbind("GameLoop",this._checkForShot)},burstShot(t){this.shootConfig=n()(t,{targetType:"PlayerControlledShip",burstCooldown:800,cooldown:200,burstAmount:10,aim:0,angle:0,angleDeviation:0}),this.currentBurst=0,this.bind("GameLoop",this._checkForShot)},_checkForShot(e){if(null!=this.lastShotAt)if(this.lastShotAt+=e.dt,this.shootConfig.burstAmount<=this.currentBurst){if(this.lastShotAt<this.shootConfig.burstCooldown)return;this.currentBurst=0}else if(this.lastShotAt<this.shootConfig.cooldown)return;const i=this;let n=0;t(this.shootConfig.targetType).each((function(){n=Math.atan2(i.y-this.y,i.x-this.x),n*=180/Math.PI}));const o=this.shootConfig.angle+this.shootConfig.aim+this.rotation,s=this.shootConfig.angle-this.shootConfig.aim+this.rotation;let a=n;if(a>o?a=o:a<s&&(a=s),a=((a=a-Math.floor(this.shootConfig.angleDeviation/2)+Object(r.lookup)()*this.shootConfig.angleDeviation)+360)%360,this.currentBurst<this.shootConfig.burstAmount)return this._shoot(a)},_shoot(t){if(this.hidden&&!this.shootConfig.shootWhenHidden)return;this.lastShotAt=0,this.currentBurst+=1;const e=null!=this.weaponOrigin?this.weaponOrigin:[0,0];e[0]*=null!=this.scale?this.scale:1,e[1]*=null!=this.scale?this.scale:1,this.shootConfig.projectile(e[0]+this.x,e[1]+this.y,t)}})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var e=i(2),n=i.n(e),r=i(150),o=i.n(r);t.c("ShootOnSight",{required:"Delay",remove(){this.unbind("GameLoop",this._checkForShot)},shootOnSight(e){this.shootConfig=n()(e,{targetType:"PlayerControlledShip",sightAngle:10,shootWhenHidden:!1,cooldown:800});const i=null!=this.weaponOrigin?this.weaponOrigin:[0,0];return i[0]*=null!=this.scale?this.scale:1,i[1]*=null!=this.scale?this.scale:1,null==this.muzzleFlash&&(this.muzzleFlash=t.e("Sphere").attr({x:this.x+i[0],y:this.y+i[1],alpha:0}).muzzle(),this.attach(this.muzzleFlash)),this.muzzleFlash.attr({alpha:0}),this.lastShotAt=0,this.bind("GameLoop",this._checkForShot),this.bind("Revealing",()=>{this.muzzleFlash.attr({alpha:0})}),this},_checkForShot(e){if(this.shooting)return;if(null!=this.lastShotAt&&(this.lastShotAt+=e.dt,this.lastShotAt<this.shootConfig.cooldown))return;const i=this,n=[];if(t(this.shootConfig.targetType).each((function(){const t=i._determineAngle(this);Math.abs(t-i.rotation)<i.shootConfig.sightAngle&&n.push(this)})),n.length>0){const t=o()(n);this._shoot(t)}},_determineAngle(t){let e=Math.atan2(this.y-t.y,this.x-t.x);return e*=180/Math.PI,this.xFlipped&&(e+=180),(e+360)%360},_shoot(t){this.hidden&&!this.shootConfig.shootWhenHidden||(this.shooting=!0,this.muzzleFlash.attr({alpha:1}),this.delay(()=>{this.lastShotAt=0;const e=null!=this.weaponOrigin?this.weaponOrigin:[0,0];e[0]*=null!=this.scale?this.scale:1,e[1]*=null!=this.scale?this.scale:1;let i=this._determineAngle(t);this.xFlipped&&(i+=180),i=(i+360)%360,this.shootConfig.projectile(e[0]+this.x,e[1]+this.y,i),this.muzzleFlash.attr({alpha:0}),this.shooting=!1},300))}})}).call(this,i(0).default)},function(t,e,i){var n=i(126),r=i(128);t.exports=function(t){return n(r(t))}},function(t,e,i){var n=i(38);t.exports=function(t,e){return n(e,(function(e){return t[e]}))}},function(t,e,i){(function(t){t.c("Gamepad",{_gpEnterFrame:function(){var t=this._getGamepad(this._gamepadIndex);t&&t.timestamp!==this._timestamp&&(this._timestamp=t.timestamp,this._emitGamepadEvents(t))},_emitGamepadEvents:function(t){for(var e=0;e<t.buttons.length;e++)(void 0!==this._buttonsState[e]&&this._buttonsState[e]!==t.buttons[e].value||void 0===this._buttonsState[e]&&0!==t.buttons[e].value)&&this.trigger("GamepadKeyChange",{button:e,value:t.buttons[e].value,pressed:t.buttons[e].pressed}),this._buttonsState[e]=t.buttons[e].value;for(var i=0;i<t.axes.length;i++)(void 0!==this._axesState[i]&&this._axesState[i]!==t.axes[i]||void 0===this._axesState[i]&&0!==t.axes[i])&&this.trigger("GamepadAxisChange",{axis:i,value:t.axes[i]})},_getGamepad:function(){var t=null,e=navigator.getGamepads||navigator.webkitGetGamepads;return e&&(t=e.apply(navigator)[this._gamepadIndex]),t},gamepad:function(t){return this._gamepadIndex=t||0,this._timestamp=0,this._buttonsState=[],this._axesState=[],this.bind("EnterFrame",this._gpEnterFrame),this}}),t.c("GamepadMultiway",{_AXIS_THRESHOLD:.75,_AXIS_ANALOG_THRESHOLD:.1,_BUTTONS_DIRECTION:{12:-90,13:90,14:180,15:0},_AXES_DIRECTION:{0:[180,0],1:[-90,90],2:[180,0],3:[-90,90]},init:function(){this.requires("Motion, Gamepad")},_gamepadKeyChange:function(t){this.disableControls||t.button in this._BUTTONS_DIRECTION&&(1===t.value&&-1===this._buttonsPressed.indexOf(t.button)?(this.vx=Math.round(1e3*(this.vx+this._buttons[t.button].x))/1e3,this.vy=Math.round(1e3*(this.vy+this._buttons[t.button].y))/1e3,this._buttonsPressed.push(t.button)):0===t.value&&-1!==this._buttonsPressed.indexOf(t.button)&&(this.vx=Math.round(1e3*(this.vx-this._buttons[t.button].x))/1e3,this.vy=Math.round(1e3*(this.vy-this._buttons[t.button].y))/1e3,this._buttonsPressed.splice(this._buttonsPressed.indexOf(t.button),1)))},_gamepadAxisChange:function(t){this.disableControls||t.axis in this._AXES_DIRECTION&&(this._analogControl?this._analogHandling(t):this._digitalHandling(t))},_digitalHandling:function(t){if(t.value<=-this._AXIS_THRESHOLD||t.value>=this._AXIS_THRESHOLD){var e=t.value<0?0:1,i=t.axis+":"+e;if(-1!==this._axesPressed.indexOf(i))return;this.vx=Math.round(1e3*(this.vx+this._axes[t.axis][e].x))/1e3,this.vy=Math.round(1e3*(this.vy+this._axes[t.axis][e].y))/1e3,this._axesPressed.push(i)}else for(var n=0;n<this._axesPressed.length;n++){var r=this._axesPressed[n];if(parseInt(r.substr(0,1),10)===t.axis){var o=r.split(":");this.vx=Math.round(1e3*(this.vx-this._axes[t.axis][parseInt(o[1],10)].x))/1e3,this.vy=Math.round(1e3*(this.vy-this._axes[t.axis][parseInt(o[1],10)].y))/1e3,this._axesPressed.splice(this._axesPressed.indexOf(r),1)}}},_analogHandling:function(t){t.value<=-this._AXIS_ANALOG_THRESHOLD||t.value>=this._AXIS_ANALOG_THRESHOLD?(0===t.axis&&(this.vx=t.value*this._speed.x),1===t.axis&&(this.vy=t.value*this._speed.y)):(0===t.axis&&(this.vx=0),1===t.axis&&(this.vy=0))},_calcSpeed:function(t){for(var e in this._BUTTONS_DIRECTION)this._buttons[e]={x:Math.round(1e3*Math.cos(this._BUTTONS_DIRECTION[e]*(Math.PI/180))*t.x)/1e3,y:Math.round(1e3*Math.sin(this._BUTTONS_DIRECTION[e]*(Math.PI/180))*t.y)/1e3};for(var i in this._AXES_DIRECTION)this._axes[i]=[],this._axes[i][0]={x:Math.round(1e3*Math.cos(this._AXES_DIRECTION[i][0]*(Math.PI/180))*t.x)/1e3,y:Math.round(1e3*Math.sin(this._AXES_DIRECTION[i][0]*(Math.PI/180))*t.y)/1e3},this._axes[i][1]={x:Math.round(1e3*Math.cos(this._AXES_DIRECTION[i][1]*(Math.PI/180))*t.x)/1e3,y:Math.round(1e3*Math.sin(this._AXES_DIRECTION[i][1]*(Math.PI/180))*t.y)/1e3}},gamepadMultiway:function(t){return t=t||{},this.requires("Gamepad"),this.gamepad(t.gamepadIndex||0),this._speed={x:150,y:150},this._buttons={},this._buttonsPressed=[],this._axes={},this._axesPressed=[],this._speedOnAxes={},this._analogControl=t.analog,t.speed&&(t.speed.x&&t.speed.y?(this._speed.x=t.speed.x,this._speed.y=t.speed.y):(this._speed.x=t.speed,this._speed.y=t.speed)),this._calcSpeed(this._speed),this.bind("GamepadKeyChange",this._gamepadKeyChange),this.bind("GamepadAxisChange",this._gamepadAxisChange),this},enableControl:function(){return this.disableControls=!1,void 0!==this.disabledVelocities&&(this.vx=this.disabledVelocities.x,this.vy=this.disabledVelocities.y),this.disabledVelocities=void 0,this},disableControl:function(){return this.disableControls=!0,this.disabledVelocities={x:this.vx,y:this.vy},this.vx=0,this.vy=0,this}})}).call(this,i(0).default)},function(t,e,i){(function(t){var e;e=i(4).togglePause,t.c("GamepadControls",{init:function(){return this.requires("Listener"),this.bind("RemoveComponent",(function(t){if("ControlScheme"===t)return this.removeComponent("GamepadControls")})),this.emits={}},remove:function(){return this.unbind("GamepadKeyChange",this._keyHandling)},setupControls:function(t){return t.addComponent("GamepadControls").controls(this.controlMap).addComponent("ControlScheme")},controls:function(t){if(this.controlMap=t,null!=t.gamepadIndex)return this.requires("Gamepad"),this.gamepad(t.gamepadIndex),this.bind("GamepadKeyChange",this._keyHandling),this.bind("GamepadAxisChange",this._stickHandling),this},_stickHandling:function(t){var e;if(1===t.axis&&(e="vertical",t.value<-.5?this._startEmit(e,"Up"):t.value>.5?this._startEmit(e,"Down"):this._stopEmit(e)),0===t.axis)return e="horizontal",t.value<-.5?this._startEmit(e,"Left"):t.value>.5?this._startEmit(e,"Right"):this._stopEmit(e)},_startEmit:function(t,e){var i,n;if((null!=(i=this.emits[t])?i.value:void 0)!==e)return this._stopEmit(t),this.trigger(e),this.emits[t]={interval:setInterval((n=this,function(){return n.trigger(e)}),200),value:e}},_stopEmit:function(t){var e;return clearInterval(null!=(e=this.emits[t])?e.interval:void 0),delete this.emits[t]},_keyHandling:function(t){if(!(this.lastPressed&&this.lastPressed.getTime()>(new Date).getTime()-200))return this.lastPressed=new Date,t.button===this.controlMap.fire&&t.pressed&&this.trigger("Fire",t),t.button===this.controlMap.up&&t.pressed&&this.trigger("Up",t),t.button===this.controlMap.down&&t.pressed&&this.trigger("Down",t),t.button===this.controlMap.left&&t.pressed&&this.trigger("Left",t),t.button===this.controlMap.right&&t.pressed?this.trigger("Right",t):void 0},assignControls:function(t){return t.addComponent("GamepadMultiway").gamepadMultiway({speed:{y:500,x:500},gamepadIndex:this.controlMap.gamepadIndex,analog:!0}),this.listenTo(t,"GamepadKeyChange",(i=this,function(n){if(n.button===i.controlMap.fire&&t.shoot(n.pressed),n.button===i.controlMap.switchWeapon&&t.switchWeapon(n.pressed),n.button===i.controlMap.super&&t.superWeapon(n.pressed),n.button===i.controlMap.pause&&n.pressed)return e()}));var i}})}).call(this,i(0).default)},function(t,e,i){(function(t){var e;e=i(4).togglePause,t.c("KeyboardControls",{init:function(){return this.requires("Listener"),this.bind("RemoveComponent",(function(t){if("ControlScheme"===t)return this.removeComponent("KeyboardControls")}))},remove:function(){return this.unbind("KeyDown",this._keyHandling)},setupControls:function(t){return t.addComponent("KeyboardControls").controls(this.controlMap).addComponent("ControlScheme")},controls:function(t){return this.controlMap=t,this.bind("KeyDown",this._keyHandling),this},_keyHandling:function(t){if(t.key===this.controlMap.fire&&this.trigger("Fire",t),t.key===this.controlMap.up&&this.trigger("Up",t),t.key===this.controlMap.down&&this.trigger("Down",t),t.key===this.controlMap.left&&this.trigger("Left",t),t.key===this.controlMap.right)return this.trigger("Right",t)},assignControls:function(i){var n,r,o,s,a,h,c,u;for(r in n=this.controlMap,h={},o={up:-90,down:90,left:180,right:0})for(s in u=o[r],a=n[r],c=t.keys)c[s]===a&&(h[s]=u);return i.addComponent("Multiway, Keyboard").multiway({y:500,x:500},h,{clamp:!0}).bind("GamePause",(function(t){return t?(this.disabledBeforePause=this.disableControls,this.disableControl()):this.disabledBeforePause?void 0:this.enableControl()})),this.listenTo(i,"KeyDown",(function(t){if(t.key===n.fire&&i.shoot(!0),t.key===n.switchWeapon&&i.switchWeapon(!0),t.key===n.super&&i.superWeapon(!0),t.key===n.pause)return e()})),this.listenTo(i,"KeyUp",(function(t){if(t.key===n.fire&&i.shoot(!1),t.key===n.switchWeapon&&i.switchWeapon(!1),t.key===n.super)return i.superWeapon(!1)}))}})}).call(this,i(0).default)},function(t,e,i){(function(t){var e;e=i(4).togglePause,t.c("AnalogKeyboardControls",{init:function(){return this.requires("Listener"),this.bind("RemoveComponent",(function(t){if("ControlScheme"===t)return this.removeComponent("AnalogKeyboardControls")}))},remove:function(){return this.unbind("KeyDown",this._keyHandling)},setupControls:function(t){return t.addComponent("AnalogKeyboardControls").controls(this.controlMap).addComponent("ControlScheme")},controls:function(t){return this.controlMap=t,this.bind("KeyDown",this._keyHandling),this},_keyHandling:function(t){if(t.key===this.controlMap.fire&&this.trigger("Fire",t),t.key===this.controlMap.up&&this.trigger("Up",t),t.key===this.controlMap.down&&this.trigger("Down",t),t.key===this.controlMap.left&&this.trigger("Left",t),t.key===this.controlMap.right)return this.trigger("Right",t)},assignControls:function(t){var i,n,r,o,s;return i=this.controlMap,500,500,2500,2500,s=0,o=0,n={up:!1,down:!1,left:!1,right:!1},t.addComponent("Keyboard, Motion").bind("GamePause",(function(t){return t?(this.disabledBeforePause=this.disableControls,this.disableControl()):this.disabledBeforePause?void 0:this.enableControl()})).bind("Move",(function(){var t,e;if(e=500*s,(this.vy<e&&e<=0&&this.ay<0||this.vy>e&&e>=0&&this.ay>0)&&(this.vy=e,this.ay=0),t=500*o,this.vx<t&&t<=0&&this.ax<0||this.vx>t&&t>=0&&this.ax>0)return this.vx=t,this.ax=0})),t.disableControls=!1,t.prevSets={ax:t.ax,ay:t.ay,vx:t.vx,vy:t.vy},t.disableControl=function(){if(!0!==this.disableControls)return this.disableControls=!0,this.prevSets={ax:this.ax,ay:this.ay,vx:this.vx,vy:this.vy},this.ax=0,this.ay=0,this.vx=0,this.vy=0,o=0,s=0},t.enableControl=function(){if(!1!==this.disableControls)return this.disableControls=!1,this.ax=this.prevSets.ax,this.ay=this.prevSets.ay,this.vx=this.prevSets.vx,this.vy=this.prevSets.vy},r=function(){if(s=0,n.up&&(s-=1),n.down&&(s+=1),s=Math.min(1,Math.max(-1,s)),t.ay+=2500*s,t.vy>0&&0===t.ay&&(t.ay-=5e3),t.vy<0&&0===t.ay&&(t.ay+=5e3),o=0,n.left&&(o-=1),n.right&&(o+=1),o=Math.min(1,Math.max(-1,o)),t.ax+=2500*o,t.vx>0&&0===t.ax&&(t.ax-=5e3),t.vx<0&&0===t.ax)return t.ax+=5e3},this.listenTo(t,"KeyDown",(function(o){if(o.key===i.pause&&(e(),n={up:!1,down:!1,left:!1,right:!1}),!t.disableControls)return o.key===i.fire&&t.shoot(!0),o.key===i.switchWeapon&&t.switchWeapon(!0),o.key===i.super&&t.superWeapon(!0),o.key===i.up&&(n.up=!0),o.key===i.down&&(n.down=!0),o.key===i.left&&(n.left=!0),o.key===i.right&&(n.right=!0),r()})),this.listenTo(t,"KeyUp",(function(e){if(!t.disableControls)return e.key===i.fire&&t.shoot(!1),e.key===i.switchWeapon&&t.switchWeapon(!1),e.key===i.super&&t.superWeapon(!1),e.key===i.up&&(n.up=!1),e.key===i.down&&(n.down=!1),e.key===i.left&&(n.left=!1),e.key===i.right&&(n.right=!1),r()}))}})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var e=i(20);t.c("OldBattleShip",{required:"2D, WebGL, Tween, Choreography, ShipSolid,Hideable, Flipable, Scalable, SunBlock, WaterSplashes,Sprite, Composable",init(){this.attr({z:-20,waterRadius:10,minSplashDuration:600,defaultWaterCooldown:400,waterSplashSpeed:700,minOffset:-20}),this.compose(e["battleship.deck"]),this.hatch=t.e("CarrierHatch, ShipHatch1").attr({x:this.x+320,y:this.y+29,floorOffset:75}),this.attach(this.hatch),this.hatch2=t.e("CarrierHatch, ShipHatch2").attr({x:this.x+512,y:this.y+29,floorOffset:75}),this.attach(this.hatch2),this.hatch3=t.e("CarrierHatch, ShipHatch3").attr({x:this.x+704,y:this.y+29,floorOffset:75}),this.attach(this.hatch3),this.hideBelow(540),this.bind("Revealing",()=>this.hideBelow(540)),this.bind("Hiding",()=>this.hideBelow(540))},ship(){return this.hatch.hatch("HatchFloor1"),this.hatch2.hatch("HatchFloor2"),this.hatch3.hatch("HatchFloor3"),this},open(t){t.includes(0)&&this.hatch.open(),t.includes(1)&&this.hatch2.open(),t.includes(2)&&this.hatch3.open()},close(t){t.includes(0)&&this.hatch.close(),t.includes(1)&&this.hatch2.close(),t.includes(2)&&this.hatch3.close()},execute(e,i="all"){switch(e){case"open":return"all"===i?this.open([0,1,2]):this.open([i]);case"close":return"all"===i?this.close([0,1,2]):this.close([i]);case"activateCannon":return t(`Turret${i+1}`).trigger("Activate");case"deactivateCannon":return t(`Turret${i+1}`).trigger("Deactivate")}}}),t.c("FirstShipCabin",{required:"Enemy, Composable",init(){this.attr({w:10,h:10,z:-8,health:2e3}),this.compose(e.firstCabin),this.bind("HitFlash",this.applyCabinHitFlash)},shipCabin(){return this.onHit("Bullet",t=>this.trigger("HitOn",t),t=>this.trigger("HitOff",t)),this.onHit("Explosion",t=>this.trigger("HitOn",t),t=>this.trigger("HitOff",t)),this.enemy({pointsLocation:{x:96,y:-160}}),this},applyCabinHitFlash(t){this.forEachPart(e=>{t?e.attr({hitFlash:{_red:255,_green:255,_blue:255}}):e.attr({hitFlash:!1})})}}),t.c("SecondShipCabin",{required:"Enemy, Composable",init(){this.attr({z:-8,health:4e3})},shipCabin(){return this.bind("HitFlash",this.applyCabinHitFlash),this.onHit("Bullet",t=>this.trigger("HitOn",t),t=>this.trigger("HitOff",t)),this.onHit("Explosion",t=>this.trigger("HitOn",t),t=>this.trigger("HitOff",t)),this.enemy({pointsLocation:{x:96,y:-160}}),this},displayState(t){return this.attr({z:-8}),this.compose(t?e.secondCabinOpen:e.secondCabin),this},applyCabinHitFlash(t){this.forEachPart(e=>{t?e.attr({hitFlash:{_red:255,_green:255,_blue:255}}):e.attr({hitFlash:!1})})}})}).call(this,i(0).default)},function(t,e,i){(function(t){t.c("Blast",{init:function(){return this.requires("2D, WebGL, explosionStart, SpriteAnimation, Horizon, Collision"),this.cleanup=(t=this,function(){return t.destroy()});var t},remove:function(){return this.unbind("GameLoop")},setCleanup:function(t){return this.cleanup=t,this},explode:function(t,e){var i,n,r,o;return null!=(n=t.radius)?n:20,i=(null!=(r=t.duration)?r:160)/1e3,this.attr(t),this.attr({w:4*t.radius,h:4*t.radius}),this.attr({x:this.x-this.w/2,y:this.y-this.h/2}),this.collision([.2*this.w,.2*this.h,.8*this.w,.2*this.h,.8*this.w,.8*this.h,.2*this.w,.8*this.h]),this.reel("explode",3e3*i,[[0,0],[1,0],[2,0],[3,0],[4,0],[0,1],[1,1],[2,1],[3,1],[4,1],[0,2],[1,2],[2,2],[3,2],[4,2],[0,3],[1,3]]),e&&(this.blastProps={x:this.x,y:this.y,w:this.w,h:this.h},this.bind("GameLoop",(o=this,function(t){var i;return i=e.call(o,o.blastProps,t),o.shift(i.x-o.blastProps.x,i.y-o.blastProps.y,i.w-o.blastProps.w,i.h-o.blastProps.h),o.blastProps=i}))),this.one("AnimationEnd",function(t){return function(){return t.unbind("GameLoop"),t.cleanup(t)}}(this)),this.animate("explode"),this}})}).call(this,i(0).default)},function(t,e,i){(function(t,e){var n;n=i(2),t.c("BulletCannon",{init:function(){return this.requires("Enemy, turretFoot"),this.attr({w:32,h:32}),this.bind("HitFlash",this.applyBarrelHitFlash)},bulletCannon:function(e){var i,r;return null==e&&(e={}),1750,this.attr(n(e,{health:1750,maxHealth:null!=(i=e.health)?i:1750,pointsOnHit:5,pointsOnDestroy:100,aimSpeed:90})),this.barrel=t.e("2D, WebGL, mineCannon, TweenPromise, Collision"),this.barrel.attr({x:this.x-64,y:this.y-32,z:20,w:96,h:32}),this.barrel.origin(this.barrel.w-16,20),this.enemy(),this.barrel.onHit("Bullet",(r=this,function(t){return r.trigger("HitOn",t)}),function(t){return function(e){return t.trigger("HitOff",e)}}(this)),this.barrel.onHit("Explosion",function(t){return function(e){return t.trigger("HitOn",e)}}(this),function(t){return function(e){return t.trigger("HitOff",e)}}(this)),this.tip=t.e("2D"),this.tip.attr({x:this.x-64,y:this.y-27,w:1,h:1}),this.barrel.attach(this.tip),this.attach(this.barrel),this},applyBarrelHitFlash:function(t){return t?this.barrel.attr({hitFlash:{_red:255,_green:255,_blue:255}}):this.barrel.attr({hitFlash:!1})},updatedHealth:function(){return this.health/this.maxHealth<.01?this.barrel.attr({alpha:0}):this.barrel.attr({alpha:1})},execute:function(e,i,n){var r;switch(e){case"aim":return this.aimAt(n.player("anyActive"));case"reset-aim":return r=1e3*Math.abs(this.barrel.rotation)/(3*this.aimSpeed),this.barrel.tweenPromise({rotation:0},r);case"start-shooting":return this.tip.addComponent("BurstShot").burstShot({burstCooldown:1500,burstAmount:6,angleDeviation:5,aim:0,cooldown:100,projectile:function(e,i,n){return t.e("Projectile, sphere1, Hostile, Collision").crop(6,21,18,7).collision(0,0,20,0,20,5,0,5).flip().attr({w:20,h:8,speed:380,damage:1}).shoot(e-5,i+10,n)}});case"stop-shooting":return this.tip.removeComponent("BurstShot")}},aimAt:function(t){var i,n,r;return null===(i=this.aimAngle(t))?e().delay(1e3).then((r=this,function(){return r.aimAt(t)})):(i<-80&&(i=(i+360)%360),n=1e3*Math.abs(this.barrel.rotation-i)/this.aimSpeed,this.barrel.tweenPromise({rotation:i},n))},aimAngle:function(t){var e,i,n;return null===(n=t.ship())?null:(e=[this.barrel.x+this.barrel._origin.x,this.barrel.y+this.barrel._origin.y],i=[n.x+n.w/2,n.y+n.h/2],180*Math.atan2(e[1]-i[1],e[0]-i[0])/Math.PI)},getProperty:function(t){return{xStart:this.x,yStart:this.y-24,angle:this.barrel.rotation}}})}).call(this,i(0).default,i(12).default)},function(t,e,i){var n;!function(r){"use strict";void 0===(n=function(t){var e=i(80),n=i(129);function r(t,i,n,r){return e.setTimer((function(){t(n,r,i)}),i)}return function(t){function i(t,e,i){r(o,t,e,i)}function o(t,e){e.resolve(t)}function s(t,e,i){var r=void 0===t?new n("timed out after "+i+"ms"):t;e.reject(r)}return t.prototype.delay=function(t){var e=this._beget();return this._handler.fold(i,t,void 0,e._handler),e},t.prototype.timeout=function(t,i){var n=this._beget(),o=n._handler,a=r(s,t,i,n._handler);return this._handler.visit(o,(function(t){e.clearTimer(a),this.resolve(t)}),(function(t){e.clearTimer(a),this.reject(t)}),o.notify),n},t}}.call(e,i,e,t))||(t.exports=n)}(i(3))},function(t,e){},function(t,e,i){var n;!function(r){"use strict";void 0===(n=function(t){var e=i(130),n=i(131);return function(t){var i=n(t),r=t.resolve,o=t.all,s=Array.prototype.reduce,a=Array.prototype.reduceRight,h=Array.prototype.slice;return t.any=function(e){for(var i,n,r=t._defer(),o=r._handler,s=e.length>>>0,a=s,h=[],c=0;c<s;++c)if(void 0!==(n=e[c])||c in e){if((i=t._handler(n)).state()>0){o.become(i),t._visitRemaining(e,c,i);break}i.visit(o,u,l)}else--a;0===a&&o.reject(new RangeError("any(): array must not be empty"));return r;function u(t){h=null,this.resolve(t)}function l(t){this.resolved||(h.push(t),0==--a&&this.reject(h))}},t.some=function(e,i){var n,r,o,s=t._defer(),a=s._handler,h=[],c=[],u=e.length>>>0,l=0;for(o=0;o<u;++o)(void 0!==(r=e[o])||o in e)&&++l;i=Math.max(i,0),n=l-i+1,l=Math.min(i,l),i>l?a.reject(new RangeError("some(): array must contain at least "+i+" item(s), but had "+l)):0===l&&a.resolve(h);for(o=0;o<u;++o)(void 0!==(r=e[o])||o in e)&&t._handler(r).visit(a,d,f,a.notify);return s;function d(t){this.resolved||(h.push(t),0==--l&&(c=null,this.resolve(h)))}function f(t){this.resolved||(c.push(t),0==--n&&(h=null,this.reject(c)))}},t.settle=function(t){return o(t.map(c))},t.map=function(e,i){return t._traverse(i,e)},t.filter=function(e,i){var n=h.call(e);return t._traverse(i,n).then((function(e){return function(e,i){for(var n=i.length,r=new Array(n),o=0,s=0;o<n;++o)i[o]&&(r[s++]=t._handler(e[o]).value);return r.length=s,r}(n,e)}))},t.reduce=function(t,e){return arguments.length>2?s.call(t,u(e),arguments[2]):s.call(t,u(e))},t.reduceRight=function(t,e){return arguments.length>2?a.call(t,u(e),arguments[2]):a.call(t,u(e))},t.prototype.spread=function(t){return this.then(o).then((function(e){return t.apply(this,e)}))},t;function c(i){var n;return i instanceof t&&(n=i._handler.join()),n&&0===n.state()||!n?r(i).then(e.fulfilled,e.rejected):(n._unreport(),e.inspect(n))}function u(t){return function(e,n,r){return i(t,void 0,[e,n,r])}}}}.call(e,i,e,t))||(t.exports=n)}(i(3))},function(t,e,i){var n;!function(r){"use strict";void 0===(n=function(){return function(i){var n=i.resolve,r=i.reject,o=i.prototype.catch;function s(t,e){return function(i){return function(t,e){return function(t){return t===Error||null!=t&&t.prototype instanceof Error}(e)?t instanceof e:e(t)}(i,e)?t.call(this,i):r(i)}}function a(t,e,i,r){var o=t.call(e);return function(t){return("object"==typeof t||"function"==typeof t)&&null!==t}(o)?function(t,e,i){return n(t).then((function(){return e(i)}))}(o,i,r):i(r)}return i.prototype.done=function(t,e){this._handler.visit(this._handler.receiver,t,e)},i.prototype.catch=i.prototype.otherwise=function(e){return arguments.length<2?o.call(this,e):"function"!=typeof e?this.ensure(t):o.call(this,s(arguments[1],e))},i.prototype.finally=i.prototype.ensure=function(t){return"function"!=typeof t?this:this.then((function(i){return a(t,this,e,i)}),(function(e){return a(t,this,r,e)}))},i.prototype.else=i.prototype.orElse=function(t){return this.then(void 0,(function(){return t}))},i.prototype.yield=function(t){return this.then((function(){return t}))},i.prototype.tap=function(t){return this.then(t).yield(this)},i};function t(){throw new TypeError("catch predicate must be a function")}function e(t){return t}}.call(e,i,e,t))||(t.exports=n)}(i(3))},function(t,e,i){var n;!function(r){"use strict";void 0===(n=function(){return function(t){return t.prototype.fold=function(e,i){var n=this._beget();return this._handler.fold((function(i,n,r){t._handler(i).fold((function(t,i,n){n.resolve(e.call(this,i,t))}),n,this,r)}),i,n._handler.receiver,n._handler),n},t}}.call(e,i,e,t))||(t.exports=n)}(i(3))},function(t,e,i){var n;!function(r){"use strict";void 0===(n=function(t){var e=i(130).inspect;return function(t){return t.prototype.inspect=function(){return e(t._handler(this))},t}}.call(e,i,e,t))||(t.exports=n)}(i(3))},function(t,e,i){var n;!function(r){"use strict";void 0===(n=function(){return function(t){var e=t.resolve;return t.iterate=function(t,e,n,r){return i((function(e){return[e,t(e)]}),e,n,r)},t.unfold=i,t;function i(t,n,r,o){return e(o).then((function(i){return e(n(i)).then((function(n){return n?i:e(t(i)).spread(s)}))}));function s(o,s){return e(r(o)).then((function(){return i(t,n,r,s)}))}}}}.call(e,i,e,t))||(t.exports=n)}(i(3))},function(t,e,i){var n;!function(r){"use strict";void 0===(n=function(){return function(t){return t.prototype.progress=function(t){return this.then(void 0,void 0,t)},t}}.call(e,i,e,t))||(t.exports=n)}(i(3))},function(t,e,i){var n;!function(r){"use strict";void 0===(n=function(){return function(t){return t.prototype.with=t.prototype.withThis=function(t){var e=this._beget(),i=e._handler;return i.receiver=t,this._handler.chain(i,t),e},t}}.call(e,i,e,t))||(t.exports=n)}(i(3))},function(t,e,i){var n;!function(r){"use strict";void 0===(n=function(t){var e=i(80).setTimer,n=i(334);return function(t){var i,s=o,a=o;"undefined"!=typeof console&&(i=console,s=void 0!==i.error?function(t){i.error(t)}:function(t){i.log(t)},a=void 0!==i.info?function(t){i.info(t)}:function(t){i.log(t)}),t.onPotentiallyUnhandledRejection=function(t){f(l,t)},t.onPotentiallyUnhandledRejectionHandled=function(t){f(d,t)},t.onFatalRejection=function(t){f(r,t.value)};var h=[],c=[],u=null;function l(t){t.handled||(c.push(t),s("Potentially unhandled rejection ["+t.id+"] "+n.formatError(t.value)))}function d(t){var e=c.indexOf(t);e>=0&&(c.splice(e,1),a("Handled previous rejection ["+t.id+"] "+n.formatObject(t.value)))}function f(t,i){h.push(t,i),null===u&&(u=e(p,0))}function p(){for(u=null;h.length>0;)h.shift()(h.shift())}return t};function r(t){throw t}function o(){}}.call(e,i,e,t))||(t.exports=n)}(i(3))},function(t,e,i){var n;!function(r){"use strict";void 0===(n=function(){return{formatError:function(e){var i="object"==typeof e&&null!==e&&(e.stack||e.message)?e.stack||e.message:t(e);return e instanceof Error?i:i+" (WARNING: non-Error used)"},formatObject:t,tryStringify:e};function t(t){var i=String(t);return"[object Object]"===i&&"undefined"!=typeof JSON&&(i=e(t,i)),i}function e(t,e){try{return JSON.stringify(t)}catch(t){return e}}}.call(e,i,e,t))||(t.exports=n)}(i(3))},function(t,e,i){var n;!function(r){"use strict";void 0===(n=function(t){return i(336)({scheduler:new(i(337))(i(80).asap)})}.call(e,i,e,t))||(t.exports=n)}(i(3))},function(t,e,i){(function(n){var r;!function(o){"use strict";void 0===(r=function(){return function(t){var e=t.scheduler,i=function(){if(null!=n&&"function"==typeof n.emit)return function(t,e){return"unhandledRejection"===t?n.emit(t,e.value,e):n.emit(t,e)};if("undefined"!=typeof self&&function(){if("function"==typeof CustomEvent)try{return new CustomEvent("unhandledRejection")instanceof CustomEvent}catch(t){}return!1}())return function(t,e){return function(i,n){var r=new e(i,{detail:{reason:n.value,key:n},bubbles:!1,cancelable:!0});return!t.dispatchEvent(r)}}(self,CustomEvent);if("undefined"!=typeof self&&function(){if("undefined"!=typeof document&&"function"==typeof document.createEvent)try{return document.createEvent("CustomEvent").initCustomEvent("eventType",!1,!0,{}),!0}catch(t){}return!1}())return function(t,e){return function(i,n){var r=e.createEvent("CustomEvent");return r.initCustomEvent(i,!1,!0,{reason:n.value,key:n}),!t.dispatchEvent(r)}}(self,document);return H}(),r=Object.create||function(t){function e(){}return e.prototype=t,new e};function o(t,e){this._handler=t===y?e:function(t){var e=new _;try{t((function(t){e.resolve(t)}),i,(function(t){e.notify(t)}))}catch(t){i(t)}return e;function i(t){e.reject(t)}}(t)}function s(t){return O(t)?t:new o(y,new m(f(t)))}function a(t){return new o(y,new m(new C(t)))}function h(){return P}function c(t,e,i){for(var n,r="function"==typeof e?function(n,r,o){o.resolved||u(i,l,n,t(e,r,n),o)}:l,s=new _,a=i.length>>>0,h=new Array(a),c=0;c<i.length&&!s.resolved;++c)void 0!==(n=i[c])||c in i?u(i,r,c,n,s):--a;return 0===a&&s.become(new x(h)),new o(y,s);function l(t,e,i){h[t]=e,0==--a&&i.become(new x(h))}}function u(t,e,i,n,r){if(z(n)){var o=function(t){return O(t)?t._handler.join():p(t)}(n),s=o.state();0===s?o.fold(e,i,void 0,r):s>0?e(i,o.value,r):(r.become(o),l(t,i+1,o))}else e(i,n,r)}function l(t,e,i){for(var n=e;n<t.length;++n)d(f(t[n]),i)}function d(t,e){if(t!==e){var i=t.state();0===i?t.visit(t,void 0,t._unreport):i<0&&t._unreport()}}function f(t){return O(t)?t._handler.join():z(t)?p(t):new x(t)}function p(t){try{var e=t.then;return"function"==typeof e?new b(e,t):new x(t)}catch(t){return new C(t)}}function y(){}function v(){}o.resolve=s,o.reject=a,o.never=h,o._defer=function(){return new o(y,new _)},o._handler=f,o.prototype.then=function(t,e,i){var n=this._handler,r=n.join().state();if("function"!=typeof t&&r>0||"function"!=typeof e&&r<0)return new this.constructor(y,n);var o=this._beget(),s=o._handler;return n.chain(s,n.receiver,t,e,i),o},o.prototype.catch=function(t){return this.then(void 0,t)},o.prototype._beget=function(){return function(t,e){var i=new _(t.receiver,t.join().context);return new e(y,i)}(this._handler,this.constructor)},o.all=function(t){return c(R,null,t)},o.race=function(t){if("object"!=typeof t||null===t)return a(new TypeError("non-iterable passed to race()"));return 0===t.length?h():1===t.length?s(t[0]):function(t){var e,i,n,r=new _;for(e=0;e<t.length;++e)if(void 0!==(i=t[e])||e in t){if(0!==(n=f(i)).state()){r.become(n),l(t,e+1,n);break}n.visit(r,r.resolve,r.reject)}return new o(y,r)}(t)},o._traverse=function(t,e){return c(L,t,e)},o._visitRemaining=l,y.prototype.when=y.prototype.become=y.prototype.notify=y.prototype.fail=y.prototype._unreport=y.prototype._report=H,y.prototype._state=0,y.prototype.state=function(){return this._state},y.prototype.join=function(){for(var t=this;void 0!==t.handler;)t=t.handler;return t},y.prototype.chain=function(t,e,i,n,r){this.when({resolver:t,receiver:e,fulfilled:i,rejected:n,progress:r})},y.prototype.visit=function(t,e,i,n){this.chain(g,t,e,i,n)},y.prototype.fold=function(t,e,i,n){this.when(new B(t,e,i,n))},F(y,v),v.prototype.become=function(t){t.fail()};var g=new v;function _(t,e){o.createContext(this,e),this.consumers=void 0,this.receiver=t,this.handler=void 0,this.resolved=!1}function m(t){this.handler=t}function b(t,i){_.call(this),e.enqueue(new M(t,i,this))}function x(t){o.createContext(this),this.value=t}F(y,_),_.prototype._state=0,_.prototype.resolve=function(t){this.become(f(t))},_.prototype.reject=function(t){this.resolved||this.become(new C(t))},_.prototype.join=function(){if(!this.resolved)return this;for(var t=this;void 0!==t.handler;)if((t=t.handler)===this)return this.handler=new C(new TypeError("Promise cycle"));return t},_.prototype.run=function(){var t=this.consumers,e=this.handler;this.handler=this.handler.join(),this.consumers=void 0;for(var i=0;i<t.length;++i)e.when(t[i])},_.prototype.become=function(t){this.resolved||(this.resolved=!0,this.handler=t,void 0!==this.consumers&&e.enqueue(this),void 0!==this.context&&t._report(this.context))},_.prototype.when=function(t){this.resolved?e.enqueue(new T(t,this.handler)):void 0===this.consumers?this.consumers=[t]:this.consumers.push(t)},_.prototype.notify=function(t){this.resolved||e.enqueue(new E(t,this))},_.prototype.fail=function(t){var e=void 0===t?this.context:t;this.resolved&&this.handler.join().fail(e)},_.prototype._report=function(t){this.resolved&&this.handler.join()._report(t)},_.prototype._unreport=function(){this.resolved&&this.handler.join()._unreport()},F(y,m),m.prototype.when=function(t){e.enqueue(new T(t,this))},m.prototype._report=function(t){this.join()._report(t)},m.prototype._unreport=function(){this.join()._unreport()},F(_,b),F(y,x),x.prototype._state=1,x.prototype.fold=function(t,e,i,n){!function(t,e,i,n,r){if("function"!=typeof t)return r.become(i);o.enterContext(i),function(t,e,i,n,r){try{t.call(n,e,i,r)}catch(t){r.become(new C(t))}}(t,e,i.value,n,r),o.exitContext()}(t,e,this,i,n)},x.prototype.when=function(t){A(t.fulfilled,this,t.receiver,t.resolver)};var w=0;function C(t){o.createContext(this),this.id=++w,this.value=t,this.handled=!1,this.reported=!1,this._report()}function S(t,e){this.rejection=t,this.context=e}function D(t){this.rejection=t}F(y,C),C.prototype._state=-1,C.prototype.fold=function(t,e,i,n){n.become(this)},C.prototype.when=function(t){"function"==typeof t.rejected&&this._unreport(),A(t.rejected,this,t.receiver,t.resolver)},C.prototype._report=function(t){e.afterQueue(new S(this,t))},C.prototype._unreport=function(){this.handled||(this.handled=!0,e.afterQueue(new D(this)))},C.prototype.fail=function(t){this.reported=!0,i("unhandledRejection",this),o.onFatalRejection(this,void 0===t?this.context:t)},S.prototype.run=function(){this.rejection.handled||this.rejection.reported||(this.rejection.reported=!0,i("unhandledRejection",this.rejection)||o.onPotentiallyUnhandledRejection(this.rejection,this.context))},D.prototype.run=function(){this.rejection.reported&&(i("rejectionHandled",this.rejection)||o.onPotentiallyUnhandledRejectionHandled(this.rejection))},o.createContext=o.enterContext=o.exitContext=o.onPotentiallyUnhandledRejection=o.onPotentiallyUnhandledRejectionHandled=o.onFatalRejection=H;var k=new y,P=new o(y,k);function T(t,e){this.continuation=t,this.handler=e}function E(t,e){this.handler=e,this.value=t}function M(t,e,i){this._then=t,this.thenable=e,this.resolver=i}function B(t,e,i,n){this.f=t,this.z=e,this.c=i,this.to=n,this.resolver=g,this.receiver=this}function O(t){return t instanceof o}function z(t){return("object"==typeof t||"function"==typeof t)&&null!==t}function A(t,e,i,n){if("function"!=typeof t)return n.become(e);o.enterContext(e),function(t,e,i,n){try{n.become(f(t.call(i,e)))}catch(t){n.become(new C(t))}}(t,e.value,i,n),o.exitContext()}function j(t,e,i,n,r){if("function"!=typeof t)return r.notify(e);o.enterContext(i),function(t,e,i,n){try{n.notify(t.call(i,e))}catch(t){n.notify(t)}}(t,e,n,r),o.exitContext()}function L(t,e,i){try{return t(e,i)}catch(t){return a(t)}}function F(t,e){e.prototype=r(t.prototype),e.prototype.constructor=e}function R(t,e){return e}function H(){}return T.prototype.run=function(){this.handler.join().when(this.continuation)},E.prototype.run=function(){var t=this.handler.consumers;if(void 0!==t)for(var e,i=0;i<t.length;++i)j((e=t[i]).progress,this.value,this.handler,e.receiver,e.resolver)},M.prototype.run=function(){var t=this.resolver;!function(t,e,i,n,r){try{t.call(e,i,n,r)}catch(t){n(t)}}(this._then,this.thenable,(function(e){t.resolve(e)}),(function(e){t.reject(e)}),(function(e){t.notify(e)}))},B.prototype.fulfilled=function(t){this.f.call(this.c,this.z,t,this.to)},B.prototype.rejected=function(t){this.to.reject(t)},B.prototype.progress=function(t){this.to.notify(t)},o}}.call(e,i,e,t))||(t.exports=r)}(i(3))}).call(this,i(49))},function(t,e,i){var n;!function(r){"use strict";void 0===(n=function(){function t(t){this._async=t,this._running=!1,this._queue=this,this._queueLen=0,this._afterQueue={},this._afterQueueLen=0;var e=this;this.drain=function(){e._drain()}}return t.prototype.enqueue=function(t){this._queue[this._queueLen++]=t,this.run()},t.prototype.afterQueue=function(t){this._afterQueue[this._afterQueueLen++]=t,this.run()},t.prototype.run=function(){this._running||(this._running=!0,this._async(this.drain))},t.prototype._drain=function(){for(var t=0;t<this._queueLen;++t)this._queue[t].run(),this._queue[t]=void 0;for(this._queueLen=0,this._running=!1,t=0;t<this._afterQueueLen;++t)this._afterQueue[t].run(),this._afterQueue[t]=void 0;this._afterQueueLen=0},t}.call(e,i,e,t))||(t.exports=n)}(i(3))},function(t,e,i){(function(t){var e;e=i(4).isPaused,t.c("CameraCrew",{init:function(){return this.requires("2D, WebGL, Choreography, Unconverted, Collision, Hideable, helicopter, SpriteAnimation, Flipable, Scalable, Tween"),this.reel("fly",200,[[0,6,4,2],[4,6,4,2]]),this.crop(0,9,128,55),this.attr({w:128,h:55}),this.origin("center")},cameraCrew:function(){return this.animate("fly",-1),this.onHit("BackgroundBullet",(function(t){var i;if(!e())return this.removeComponent("Unconverted"),i=t[0].obj,this.trigger("Hit",this),i.destroy()})),this}})}).call(this,i(0).default)},function(t,e,i){(function(t){t.c("OnHatch",{required:"Hideable",events:{Move:"_updateHatchHiding"},onAttach(t){this.hideBelow(t._parent.y+30)},_updateHatchHiding(t){t._y!==this._y&&this.hideBelow(this._parent._parent.y+30)}}),t.c("CarrierHatch",{init(){this.requires("2D, WebGL, aircraftCarrierOpenHatch"),this.attr({z:-10}),this.crop(0,2,160,32),this.wire=t.e("2D, WebGL, aircraftCarrierWires"),this.wire.attr({z:-14,x:this.x+80,y:this.y-20}),this.attach(this.wire),this.lid=t.e("2D, WebGL, aircraftCarrierHatchLid, Hideable, TweenPromise, Delta2D"),this.lid.crop(0,2,160,32),this.attach(this.lid),this.dust=t.e("2D, WebGL, Explode, ColorEffects"),this.dust.colorOverride("#808080"),this.dust.attr({w:150,alpha:0,h:30,x:this.x,y:this.y}),this.attach(this.dust)},hitFlashParts(){return[this.lid,this.wire]},hatch(e){return this.lid.attr({z:-4,x:this.x,y:this.y}),this.floorOffset&&(this.floor=t.e("2D, WebGL, aircraftCarrierHatchLid, Hideable, TweenPromise, Delta2D"),this.floor.addComponent(e),this.floor.crop(0,2,160,32),this.floor.attr({z:-5,x:this.x-4,y:this.y+3,dy:this.floorOffset}),this.floor.hideBelow(this.y+30),this.attach(this.floor)),this},async open(){this.dust.alpha=.2,this.lid.attr({dy:0,dx:0}),this.dust.one("TweenEnd",()=>{this.dust.alpha=0}),this.dust.playExplode(800),await this.lid.tweenPromise({dx:-32,dy:16},600,"easeInOutQuad"),this.floor&&await this.rise()},async close(){this.floor&&await this.lower(),this.lid.attr({dx:-32,dy:16}),await this.lid.tweenPromise({dy:0,dx:0},600,"easeInOutQuad"),this.dust.alpha=.2,this.dust.one("AnimationEnd",()=>{this.dust.alpha=0}),this.dust.playExplode(800)},async rise(){this.floor.attr({dy:this.floorOffset}),await this.floor.tweenPromise({dy:0},500,"easeInOutQuad")},async lower(){this.floor.attr({dy:0}),await this.floor.tweenPromise({dy:this.floorOffset},500,"easeInOutQuad")}})}).call(this,i(0).default)},function(t,e,i){(function(t){var e;e=i(2),t.c("Debris",{init:function(){return this.requires("Enemy, WebGL, debris1"),this.bind("GameLoop",(function(t){var e;return e=.09*t.dt,this.attr({rotation:this.rotation+e})}))},debris:function(t){return null==t&&(t={}),this.crop(1,1,126,126),this.attr(e(t,{w:100,h:100,health:800,defaultSpeed:100})),this.origin("center"),this.enemy(),this},updateMovementVisuals:function(t,e,i,n){return this.vx=e*(1e3/n),this.vy=i*(1e3/n)}})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var e=i(2),n=i.n(e);t.c("Drone",{required:"Enemy, standardDrone",events:{Hit:"_handleHit"},drone(t={}){return this.attr(n()(t,{w:40,h:40,health:100,rotation:0,defaultSpeed:100,pointsOnHit:10,pointsOnDestroy:15,invincible:!1,countAsEnemy:!0})),this.origin("center"),this.collision([2,25,8,18,20,13,30,15,33,28,14,34,4,30]),this.attr({weaponOrigin:[2,25]}),this.enemy(),this},_handleHit(e){if(!1!==this.juice&&(this.shiftedX+=5),!1!==this.juice&&t.audio.play("hit",1,.5),e.projectile.has("Bullet")&&!1!==this.juice)return t.e("Blast, LaserHit").explode({x:e.projectile.x,y:e.projectile.y,radius:4,duration:50})},updatedHealth(){if(!1!==this.juice)return this.health<100?this.sprite(2,4,2,2):void this.sprite(0,4,2,2)},updateMovementVisuals(t,e,i,n){this.deathDecoy||(this.vx=e*(1e3/n),this.vy=i*(1e3/n),e>0?this.flipX():this.unflipX())}})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var e=i(53);t.c("DroneShip",{init(){return this.requires("2D, WebGL, Tween, Choreography, ShipSolid, Collision,Hideable, Flipable, Scalable, SunBlock, WaterSplashes, Composable"),this.attr({w:640,h:160,z:6,waterRadius:10,minSplashDuration:600,defaultWaterCooldown:400,waterSplashSpeed:700,minOffset:-20}),this.collision([20,50,608,50,608,128,20,128]),this.compose(e.droneShip),this.hatch=t.e("CarrierHatch, ShipHatch1").attr({x:this.x+96,y:this.y+29}),this.attach(this.hatch),this.hideBelow(560),this.attach(t.e("2D, TurretPlace").attr({x:this.x+370,y:this.y+74,z:15,w:15,h:2}))},open(){return this.hatch.open()},close(){return this.hatch.close()},execute(t){switch(t){case"open":return this.open();case"close":return this.close()}}})}).call(this,i(0).default)},function(t,e,i){(function(t){var e;e=i(2),t.c("Helicopter",{init:function(){return this.requires("Enemy, helicopter, SpriteAnimation"),this.reel("fly",200,[[0,6,4,2],[4,6,4,2]]),this.crop(0,9,128,55),this.origin("center"),this.collision([8,5,120,5,112,35,12,47])},helicopter:function(i){var n,r;return null==i&&(i={}),1750,this.attr(e(i,{w:128,h:55,health:1750,rotors:!0,maxHealth:null!=(n=i.health)?n:1750,weaponOrigin:[5,46]})),this.origin("center"),!0===this.rotors?this.animate("fly",-1):this.sprite(12,8),this.enemy(),this.bind("Hit",(r=this,function(e){if(e.projectile.has("Bullet"))return r.shiftedX+=2,t.audio.play("hit",1,.5),t.e("Blast, LaserHit").explode({x:e.projectile.x,y:e.projectile.y,radius:4,duration:50})})),this},execute:function(t){switch(t){case"start-rotors":return this.animate("fly",-1);case"stop-rotors":return this.pauseAnimation(),this.sprite(12,8)}},updatedHealth:function(){return this.health/this.maxHealth<.01?(this.pauseAnimation(),this.sprite(8,6)):!0!==this.rotors?(this.pauseAnimation(),this.sprite(12,8)):this.isPlaying("fly")?void 0:this.animate("fly",-1)},updateMovementVisuals:function(t,e,i,n){return this.vx=e*(1e3/n),this.vy=i*(1e3/n)}})}).call(this,i(0).default)},function(t,e,i){(function(t){var e,n;e=i(2),n=i(4).isPaused,t.c("LargeDrone",{init:function(){return this.requires("Enemy, standardLargeDrone, SpriteAnimation")},drone:function(i){var r,o;return null==i&&(i={}),36e4,this.crop(0,0,90,70),this.attr(e(i,{health:36e4,maxHealth:null!=(r=i.health)?r:36e4,z:-1})),this.origin("center"),this.collision([2,36,16,15,86,2,88,4,62,15,57,46,46,66,18,66,3,47]),this.eye=t.e("2D, WebGL, eyeStart, SpriteAnimation"),this.eye.crop(0,0,20,26),this.attach(this.eye),this.eye.attr({x:2+this.x,y:18+this.y,z:1}),this.eye.reel("slow",1500,[[6,0],[7,0],[8,0],[9,0],[6,1],[7,1],[8,1],[9,1]]),this.eye.reel("medium",500,[[6,0],[7,0],[8,0],[9,0],[6,1],[7,1],[8,1],[9,1]]),this.eye.reel("fast",250,[[6,0],[7,0],[8,0],[9,0],[6,1],[7,1],[8,1],[9,1]]),this.wing=t.e("2D, WebGL, wingLoaded, SpriteAnimation"),this.wing.crop(0,0,46,21),this.attach(this.wing),this.wing.attr({x:19+this.x,y:28+this.y,z:1,h:21,w:46}),this.wing.reel("emptyWing",30,[[14,2,2,1]]),this.wing.reel("reload",500,[[6,2,2,1],[8,2,2,1],[10,2,2,1],[12,2,2,1]]),this.enemy(),this.onHit("Mine",(function(t){var e,i,r;if(!n()&&!this.hidden)for(e=0,i=t.length;e<i;e++){if((r=t[e].obj).hidden)return;if(r.z<0)return;r.absorbDamage(300)}})),this.updatedHealth(),this.bind("Hit",(o=this,function(e){if(e.projectile.has("Bullet"))return t.audio.play("hit",1,.5),t.e("Blast, LaserHit").explode({x:e.projectile.x,y:e.projectile.y,z:o.z+2,radius:4,duration:50})})),this},healthBelow:function(t){return this.health/this.maxHealth<t},updatedHealth:function(){var t;return(t=this.health/this.maxHealth)<.3?this.sprite(9,8,3,3):t<.6?this.sprite(6,8,3,3):t<.9?this.sprite(3,8,3,3):this.sprite(0,8,3,3)},updateMovementVisuals:function(t,e,i,n){if(this.vx=e*(1e3/n),this.vy=i*(1e3/n),this.turnOnPath)return e>0?this.flipX():this.unflipX()}})}).call(this,i(0).default)},function(t,e,i){(function(t){var e;e=i(2),t.c("Mine",{init:function(){return this.requires("Enemy, standardMine, SpriteAnimation"),this.reel("open",200,[[4,3],[5,3]]),this.reel("close",200,[[4,3],[3,3]]),this.reel("blink",100,[[5,3],[6,3]]),this.bind("GameLoop",(function(t){var e;return e=.09*t.dt,this.attr({rotation:this.rotation+e})}))},mine:function(t){return null==t&&(t={}),this.crop(4,4,25,25),this.attr(e(t,{h:25,w:25,health:100,weaponOrigin:[12,12]})),this.origin("center"),this.enemy(),this},updateMovementVisuals:function(t,e,i,n){return this.vx=e*(1e3/n),this.vy=i*(1e3/n)}})}).call(this,i(0).default)},function(t,e,i){(function(t,e){var n;n=i(2),t.c("MineCannon",{init:function(){return this.requires("Enemy, turretFoot"),this.attr({w:32,h:32}),this.bind("HitFlash",this.applyBarrelHitFlash)},mineCannon:function(e){var i,r;return null==e&&(e={}),1750,this.attr(n(e,{health:1750,maxHealth:null!=(i=e.health)?i:1750,aimSpeed:45})),this.barrel=t.e("2D, WebGL, mineCannon, TweenPromise, Collision"),this.barrel.attr({x:this.x-64,y:this.y-32,z:20,w:96,h:32}),this.barrel.origin(this.barrel.w-16,16),this.barrel.onHit("Bullet",(r=this,function(t){return r.onProjectileHit(t)}),function(t){return function(){return t.onProjectileHitEnd()}}(this)),this.barrel.onHit("Explosion",function(t){return function(e){return t.onExplosionHit(e)}}(this),function(t){return function(){return t.onProjectileHitEnd()}}(this)),this.attach(this.barrel),this.enemy(),this},applyBarrelHitFlash:function(t){return t?this.barrel.attr({hitFlash:{_red:255,_green:255,_blue:255}}):this.barrel.attr({hitFlash:!1})},updatedHealth:function(){return this.health/this.maxHealth<.01?this.barrel.attr({alpha:0}):this.barrel.attr({alpha:1})},execute:function(t,e,i){switch(t){case"aim":return this.aimAt(i.player("anyActive"))}},aimAt:function(t){var i,n,r;return null===(i=this.aimAngle(t))?e().delay(1e3).then((r=this,function(){return r.aimAt(t)})):(i<-80&&(i=(i+360)%360),n=1e3*Math.abs(this.barrel.rotation-i)/this.aimSpeed,this.barrel.tweenPromise({rotation:i},n))},aimAngle:function(t){var e,i,n;return null===(n=t.ship())?null:(e=[this.barrel.x+this.barrel._origin.x,this.barrel.y+this.barrel._origin.y],i=[n.x+n.w/2,n.y+n.h/2],180*Math.atan2(e[1]-i[1],e[0]-i[0])/Math.PI)},getProperty:function(t){return{xStart:this.x,yStart:this.y-24,angle:this.barrel.rotation}}})}).call(this,i(0).default,i(12).default)},function(t,e,i){(function(t){var e;e=i(2),t.c("OldDrone",{init:function(){return this.requires("Enemy, Color")},drone:function(t){return null==t&&(t={}),this.color("#0000FF"),this.attr(e(t,{w:40,h:40,health:200})),this.origin("center"),this.attr({weaponOrigin:[2,25]}),this.enemy(),this}})}).call(this,i(0).default)},function(t,e,i){(function(t){t.c("OldExplosion",{init:function(){if(this.requires("2D,Tween,Delay"),this.explosionMode=window.Game.explosionMode,"block"===this.explosionMode)return this.requires("WebGL,Color")},explode:function(e){var i,n,r,o,s,a;return o=null!=(s=e.radius)?s:20,n=(null!=(a=e.duration)?a:160)/1e3,this.attr(e),r={maxParticles:13*e.radius,size:2*e.radius,sizeRandom:8,speed:e.radius/13,speedRandom:.5,lifeSpan:19,lifeSpanRandom:7,angle:0,angleRandom:360,startColour:[235,135,5,1],startColourRandom:[28,150,45,.2],endColour:[135,135,135,0],endColourRandom:[60,60,60,.1],sharpness:10,sharpnessRandom:10,spread:e.radius/2,duration:n*t.timer.FPS(),fastMode:!1,gravity:{x:0,y:0},jitter:0},this.attr({w:1,h:1}),"block"===this.explosionMode&&this.color("#FF0000"),this.tween({x:this.x-o,y:this.y-o,w:this.w+2*o,h:this.h+2*o,alpha:.2},500),this.bind("TweenEnd",(function(){return this.destroy()})),"particles"===this.explosionMode&&(r.fastMode=!0,r.maxParticles=3*e.radius,r.size=e.radius),"particles"!==this.explosionMode&&null!==this.explosionMode||(i=(r.lifeSpan+r.lifeSpanRandom)*t.timer.FPS(),t.e("2D,Particles,Delay").attr({x:this.x-e.radius/2,y:this.y-e.radius/2}).particles(r).bind("ParticleEnd",(function(){return this.delay((function(){return this.destroy()}),i)}))),this}})}).call(this,i(0).default)},function(t,e,i){(function(t){var e;e=i(2),t.c("PlayerClone",{init:function(){return this.requires("Enemy, playerShip")},playerClone:function(i){var n,r;return null==i&&(i={}),300,this.attr(e(i,{h:45,w:71,health:300,maxHealth:null!=(n=i.health)?n:300,weaponOrigin:[5,30]})),this.origin("center"),this.colorOverride("#808080","partial"),this.enemy(),this.bind("Hit",(r=this,function(e){if(e.projectile.has("Bullet"))return r.shiftedX+=2,t.audio.play("hit",1,.5),t.e("Blast, LaserHit").explode({x:e.projectile.x,y:e.projectile.y,radius:4,duration:50})})),this},updatedHealth:function(){var t;return t=0,this.health/this.maxHealth<.3&&(t=2),this.sprite(0,t)},updateMovementVisuals:function(t,e,i,n){return this.vx=e*(1e3/n),this.vy=i*(1e3/n)}})}).call(this,i(0).default)},function(t,e,i){(function(t){t.c("PowerUp",{init:function(){return this.requires("2D, WebGL, ColorEffects, powerUpBox, SpriteAnimation, TweenPromise, Scalable, ViewportRelativeMotion"),this.reel("blink",600,[[10,1],[11,1],[12,1],[11,1]]),this.attr({w:32,h:32}),this.pickedUp=!1},remove:function(){},powerUp:function(e){var i,n,r,o;return this.settings=e,this.animate("blink",-1),i="#802020",this.settings.type&&(i={weapon:"#202080",weaponBoost:"#D06000",weaponUpgrade:"#30B030",ship:"#802020",shipUpgrade:"#30B030",shipBoost:"#D06000"}[this.settings.type]),this.colorOverride(i,"partial"),this.settings.icon?(n=t.e("2D,WebGL,ColorEffects").addComponent(this.settings.icon).colorOverride("white","partial").attr({w:22,h:22,x:this.x+5,y:this.y+5}),this.attach(n)):this.settings.marking&&(o="16px",r={x:this.x+8,y:this.y+8},2===this.settings.marking.length&&(o="9px",r={x:this.x+3,y:this.y+8}),n=t.e("2D,DOM,Text").textColor("#FFF").textFont({size:o,family:"Press Start 2P"}).text(this.settings.marking).attr(r),this.attach(n)),this.viewportRelativeMotion({speed:1}),this},pickup:function(){return this.pickedUp=!0,this.tweenPromise({scale:1.5,x:this.x-12,y:this.y-12},120).then((t=this,function(){return t.tweenPromise({alpha:0,scale:.3,z:20,x:t.x+15,y:t.y+15},120).then((function(){return t.destroy()}))}));var t}})}).call(this,i(0).default)},function(t,e,i){(function(t){t.c("Projectile",{init:function(){return this.requires("2D, WebGL")},shoot:function(e,i,n){return this.attr({x:e,y:i,rotation:n}),this.bind("GameLoop",(function(e){var i;if(i=e.dt*(this.speed/1e3),this.x-=Math.cos(this.rotation/180*Math.PI)*i,this.y-=Math.sin(this.rotation/180*Math.PI)*i,(this.x+this.w<-t.viewport.x||this.x>-t.viewport.x+t.viewport.width)&&this.destroy(),this.y+this.h<-t.viewport.y||this.y>-t.viewport.y+t.viewport.height)return this.destroy()})),this}})}).call(this,i(0).default)},function(t,e,i){(function(t){var e;e=i(2),t.c("Rocket",{init:function(){return this.requires("Enemy, standardRocket")},rocket:function(i){return null==i&&(i={}),this.crop(0,0,47,17),this.attr(e(i,{health:300})),this.origin("center"),this.enemy(),this.backFire=t.e("2D, WebGL, shipEngineFire, SpriteAnimation"),this.backFire.reel("burn",300,[[4,5,3,1],[3,0,3,1]]),this.backFire.timing=0,this.backFire.animate("burn",-1),this.backFire.flip("X"),30,this.backFire.attr({x:this.x+this.w,y:this.y,w:30,h:this.h,alpha:.7,z:this.z-1}),this.attach(this.backFire),this},updateMovementVisuals:function(t,e,i,n){var r;if(this.vx=e*(1e3/n),this.vy=i*(1e3/n),r=Math.sqrt(e*e+i*i),this.backFire.w=10*r,null!=t)return this.rotation=t}})}).call(this,i(0).default)},function(t,e,i){(function(t){t.c("Sun",{init:function(){var e,i,n,r;return this.requires("2D, WebGL, Collision, Choreography, sun"),this.crop(1,0,96,96),this.attr({w:22,h:22,z:-1e3}),this.origin("center"),this.glare=[],n=t.e("2D, WebGL, Glare, directGlare").crop(2,2,175,175).attr({w:3*this.w,h:3*this.h,z:90,alpha:.8,originalAlpha:.8}).origin("center"),this.attach(n),this.glare.push(n),i=t.e("2D, WebGL, Glare, bigGlare, Horizon").crop(0,0,200,200).attr({mirrored:!0,w:80,h:80,z:91,res:.9,alpha:.4,originalAlpha:.4,blur:2}).origin("center").saturationGradient(1,1),this.attach(i),this.glare.push(i),r=t.e("2D, WebGL, Glare, bigGlare, ColorEffects").crop(0,0,200,200).colorOverride("#fd6565").attr({mirrored:!0,w:10,h:10,z:92,res:.8,alpha:.6,originalAlpha:.6}).origin("center"),this.attach(r),this.glare.push(r),e=t.e("2D, WebGL, Glare, bigGlare").crop(0,0,200,200).attr({mirrored:!0,w:200,h:200,z:93,alpha:.2,res:1.1,originalAlpha:.2}).origin("center"),this.attach(e),this.glare.push(e)},sun:function(t){return this.attr(t),this.uniqueBind("GameLoop",this._updateGlare),this},remove:function(){return this.unbind("GameLoop",this._updateGlare)},_updateGlare:function(){var e,i,n,r,o,s,a,h,c,u,l,d,f,p,y,v,g,_,m,b,x,w,C,S;if(n=[0],x=this.area(),i=this.hit("SunBlock"))for(l=0,p=i.length;l<p;l++)s=(g=i[l]).obj,"SAT"===g.type?n.push(-1*g.overlap/50*x):(C=Math.max(this.x,s.x),w=Math.min(this.x+this.w,s.x+s.w)-C,S=Math.max(this.y,s.y),a=Math.min(this.y+this.h,s.y+s.h)-S,n.push(w*a));for(_=(v=1.7*Math.max.apply(Math,n))/x,v>x&&(_=1),u=t.viewport.width/2,h=t.viewport.height/2,(r=this.x+this.w/2-(-1*t.viewport.x+u))/u,(o=this.y+this.h/2-(-1*t.viewport.y+h))/h,d=0,y=(m=this.glare).length;d<y;d++)(s=m[d]).attr({alpha:s.originalAlpha*(1-_)}),s.mirrored?s.attr({x:this.x+this.w/2-s.w/2-2*r*s.res,y:this.y+this.h/2-s.h/2-2*o*s.res}):s.attr({w:5*this.w,h:5*this.h,x:this.x-2*this.w,y:this.y-2*this.h});return c=t.viewport.height-225-this.y,b=85-Math.min(Math.max(c,0),200)/200*40,this.w=b,this.h=b,f=.4+Math.max(c-150,0)/200,e=Math.min(Math.max(.4,f),1),t("cloud").each((function(){return this.attr({lightness:e})})),t("GoldenStripe").each((function(){return c<=0?this.attr({alpha:1-Math.min(Math.abs(c),20)/20,h:5}):0<c&&c<1?this.attr({alpha:1,h:5}):c<60?this.attr({alpha:1,h:Math.abs(Math.max(Math.min(c/2,40),5))}):c<120?this.attr({alpha:1-Math.min(Math.abs(c-60),60)/60,h:Math.abs(Math.max(Math.min(c/2,40),1))}):this.attr({alpha:0,h:10})}))}})}).call(this,i(0).default)},function(t,e,i){(function(t,e){var n;n=i(2),t.c("Tank",{init:function(){return this.requires("Enemy, laserTank, Delay"),this.crop(6,5,179,103)},tank:function(e){var i;return null==e&&(e={}),2750,this.attr(n(e,{w:179,h:103,health:2750,maxHealth:null!=(i=e.health)?i:2750,aimSpeed:45})),this.barrel=t.e("2D, WebGL, laserTankBarrel, TweenPromise"),this.barrel.crop(5,4,109,38),this.barrel.attr({x:this.x+54,y:this.y,z:this.z-1,w:109,h:38}),this.barrel.origin(this.barrel.w-32,32),this.charge=t.e("2D, Color, WebGL, TweenPromise"),this.charge.color("#F0F"),this.charge.attr({x:this.barrel.x-10,y:this.barrel.y+5,w:10,h:28,alpha:0}),this.charge.origin(this.charge.w-32,32),this.laser=t.e("2D, Color, WebGL, TweenPromise, Collision"),this.laser.color("#F0F"),1e3,this.laser.attr({x:this.barrel.x-1e3,y:this.barrel.y+5,w:1e3,h:28,alpha:0}),this.laser.origin(this.laser.w-10,10),this.attach(this.barrel),this.barrel.attach(this.charge),this.barrel.attach(this.laser),this.enemy(),this},updatedHealth:function(){},execute:function(t,e,i){switch(t){case"searchAim":return this.aimAt(i.player("anyActive"));case"shoot":return this.shoot()}},aimAt:function(t){var i,n,r;return null===(i=this.aimAngle(t))?e().delay(1e3).then((r=this,function(){return r.aimAt(t)})):(i<-80&&(i=(i+360)%360),n=1e3*Math.abs(this.barrel.rotation-i)/this.aimSpeed,this.barrel.tweenPromise({rotation:i},n).then(function(e){return function(){if(Math.abs(e.aimAngle(t)-e.barrel.rotation)>10)return e.aimAt(t)}}(this)))},aimAngle:function(t){var e,i,n;return null===(n=t.ship())?null:(e=[this.barrel.x+this.barrel._origin.x,this.barrel.y+this.barrel._origin.y],i=[n.x+n.w/2,n.y+n.h/2],180*Math.atan2(e[1]-i[1],e[0]-i[0])/Math.PI)},shoot:function(){var t;return 500,100,this.charge.tweenPromise({alpha:1},500).then((t=this,function(){return t.charge.attr({alpha:0}),t.laser.addComponent("Hostile"),t.laser.attr({alpha:1}),e().delay(100).then((function(){return t.laser.removeComponent("Hostile"),t.laser.attr({alpha:0})}))}))}})}).call(this,i(0).default,i(12).default)},function(t,e,i){(function(t){t.c("WaterSplash",{init:function(){if(this.requires("2D,Particles,Delay"),this.explosionMode=window.Game.explosionMode,"block"===this.explosionMode)return this.requires("WebGL, Color, Tween")},waterSplash:function(e){var i,n;return n={maxParticles:2*e.size,size:e.size/1.5,sizeRandom:4,speed:e.size/20,speedRandom:.2,lifeSpan:e.size/3,lifeSpanRandom:7,angle:350,angleRandom:20,startColour:[40,40,170,1],startColourRandom:[0,0,0,0],endColour:[205,205,205,.1],endColourRandom:[30,30,30,.1],sharpness:10,sharpnessRandom:5,spread:e.size/3,duration:900/t.timer.FPS(),fastMode:!1,gravity:{x:0,y:.25},jitter:0},i=(n.lifeSpan+n.lifeSpanRandom)*t.timer.FPS(),"particles"===this.explosionMode&&(n.fastMode=!0),"block"!==this.explosionMode?this.attr({x:e.x,y:e.y}).particles(n).bind("ParticleEnd",(function(){return this.delay((function(){return this.destroy()}),i)})):(60,this.attr({x:e.x,y:e.y,w:30,h:0}),this.color("#FFFFFF"),this.tween({y:this.y-60,h:this.h+60,alpha:.2},500),this.bind("TweenEnd",(function(){return this.destroy()}))),this}})}).call(this,i(0).default)},function(t,e,i){(function(t){var e;e=i(2),t.c("Acceleration",{init:function(){return this._currentSpeed={x:0,y:0},this._targetSpeed={x:0,y:0},this._accelerate={x:.01,y:.01},this._currentAcceleration={x:0,y:0}},updateAcceleration:function(){return this._handleAcceleration("x"),this._handleAcceleration("y")},targetSpeed:function(t,i){return null==i&&(i={}),(i=e(i,{accellerate:!0})).accellerate?this._accelerate={x:.01,y:.01}:this._accelerate={x:Infinity,y:Infinity},null!=t.x&&null!=t.y?(this._targetSpeed.x=t.x,this._targetSpeed.y=t.y):(this._targetSpeed.x=t,this._targetSpeed.y=0),this},_handleAcceleration:function(t){var e;if(this._currentSpeed[t]!==this._targetSpeed[t]&&(e=1,this._currentSpeed[t]>this._targetSpeed[t]&&(e=-1),this._currentAcceleration[t]+=this._accelerate[t]*e,this._currentSpeed[t]+=this._currentAcceleration[t],!(this._currentAcceleration[t]>0&&this._currentSpeed[t]<this._targetSpeed[t]||this._currentAcceleration[t]<0&&this._currentSpeed[t]>this._targetSpeed[t])))return this._currentSpeed[t]=this._targetSpeed[t],this._currentAcceleration[t]=0}})}).call(this,i(0).default)},function(t,e,i){(function(t){var e,n,r;n=i(2),e=i(81),r=i(138),t.c("Choreography",{init:function(){return this._ctypes={delay:this._executeDelay,linear:this._executeLinear,viewport:this._executeMoveIntoViewport}},remove:function(){if(this.unbind("GameLoop",this._choreographyTick),null!=this._currentPart)return this._currentPart=null,this._choreography=[],this.trigger("ChoreographyEnd")},choreography:function(t,e){var i,r;if(null==e&&(e={}),this.uniqueBind("GameLoop",this._choreographyTick),this._options=n(e,{repeat:0,skip:0}),this._choreography=t,this._repeated=0,i=0,this._setupCPart(i),r=e.skip,this._toSkip=0,r>0){for(;i<this._choreography.length-1&&r>this._currentPart.duration;)r-=this._currentPart.duration,i+=1,this._setupCPart(i);this._toSkip=r}return this},synchChoreography:function(t){return this._choreography=e(t._choreography),this._options=t._options,this._repeated=t._repeated,this._toSkip=t._toSkip,this._currentPart=e(t._currentPart),this._currentPart.easing=e(t._currentPart.easing),this.uniqueBind("GameLoop",this._choreographyTick)},_setupCPart:function(t){var e;if(this._currentPart=null,!(t<this._choreography.length)){if(!(this._repeated<this._options.repeat||-1===this._options.repeats))return null!=this.updateMovementVisuals&&this.updateMovementVisuals(void 0,0,0,1),this._choreography=[],this.unbind("GameLoop",this._choreographyTick),this.trigger("ChoreographyEnd"),this._px=this.x,void(this._py=this.y);this._repeated+=1,t=0}return null!=(e=this._choreography[t]).event&&this.trigger(e.event,{entity:this,data:e.data}),this._setupPart(e,t)},choreographyDelta:function(){return{x:this.x-this._px,y:this.y-this._py}},_choreographyTick:function(t){var e,i,n;if(this._px=this.x,this._py=this.y,null!=this._currentPart)return i=this._currentPart.easing.value(),e=t.dt+this._toSkip,this._currentPart.easing.tick(e),this._toSkip=0,n=this._currentPart.easing.value(),this._ctypes[this._currentPart.type].apply(this,[n,i,e]),this._currentPart.easing.complete?this._setupCPart(this._currentPart.part+1):void 0},_setupPart:function(i,n){var o,s,a,h,c;if(s=null!=(h=i.easingFn)?h:"linear",this._currentPart=r(e(i),{part:n,x:this.x,y:this.y,dx:i.x,dy:i.y,rotation:i.rotation,easing:new t.easing(null!=(c=i.duration)?c:0,s)}),i.properties){for(a in o={},i.properties)o[a]=this[a];return this._currentPart.currentProperties=o}},_executeLinear:function(t,e){var i,n,r,o,s,a;return i=t*(null!=(r=this._currentPart.dx)?r:0)-e*(null!=(o=this._currentPart.dx)?o:0),n=t*(null!=(s=this._currentPart.dy)?s:0)-e*(null!=(a=this._currentPart.dy)?a:0),this.shift(i,n)},_executeDelay:function(t){},_executeMoveIntoViewport:function(t,e,i){var n,r,o,s,a,h,c,u,l;return u=0,(s=this._currentPart.dx)&&(null==(r=this._currentPart).moveOriginX&&(r.moveOriginX=this._currentPart.x),u=(h=s-this._currentPart.moveOriginX)*t-h*e),l=0,(a=this._currentPart.dy)&&(null==(o=this._currentPart).moveOriginY&&(o.moveOriginY=this._currentPart.y),l=(c=a-this._currentPart.moveOriginY)*t-c*e),null!=this.updateMovementVisuals&&(this._currentPart.rotation?(n=Math.atan2(l,u),n=((n*=180/Math.PI)+360+180)%360):n=void 0,this.updateMovementVisuals(n,u,l,i)),this.shift(u,l)}})}).call(this,i(0).default)},function(t,e,i){var n=i(68),r=i(359),o=i(133),s=i(360),a=i(361),h=i(362),c=i(135),u=i(363),l=i(364),d=i(113),f=i(365),p=i(32),y=i(366),v=i(367),g=i(372),_=i(8),m=i(43),b=i(374),x=i(13),w=i(376),C=i(26),S=1,D=2,k=4,P="[object Arguments]",T="[object Function]",E="[object GeneratorFunction]",M="[object Object]",B={};B[P]=B["[object Array]"]=B["[object ArrayBuffer]"]=B["[object DataView]"]=B["[object Boolean]"]=B["[object Date]"]=B["[object Float32Array]"]=B["[object Float64Array]"]=B["[object Int8Array]"]=B["[object Int16Array]"]=B["[object Int32Array]"]=B["[object Map]"]=B["[object Number]"]=B[M]=B["[object RegExp]"]=B["[object Set]"]=B["[object String]"]=B["[object Symbol]"]=B["[object Uint8Array]"]=B["[object Uint8ClampedArray]"]=B["[object Uint16Array]"]=B["[object Uint32Array]"]=!0,B["[object Error]"]=B[T]=B["[object WeakMap]"]=!1,t.exports=function t(e,i,O,z,A,j){var L,F=i&S,R=i&D,H=i&k;if(O&&(L=A?O(e,z,A,j):O(e)),void 0!==L)return L;if(!x(e))return e;var I=_(e);if(I){if(L=y(e),!F)return c(e,L)}else{var G=p(e),W=G==T||G==E;if(m(e))return h(e,F);if(G==M||G==P||W&&!A){if(L=R||W?{}:g(e),!F)return R?l(e,a(L,e)):u(e,s(L,e))}else{if(!B[G])return A?e:{};L=v(e,G,F)}}j||(j=new n);var U=j.get(e);if(U)return U;j.set(e,L),w(e)?e.forEach((function(n){L.add(t(n,i,O,n,e,j))})):b(e)&&e.forEach((function(n,r){L.set(r,t(n,i,O,r,e,j))}));var N=H?R?f:d:R?keysIn:C,q=I?void 0:N(e);return r(q||e,(function(n,r){q&&(n=e[r=n]),o(L,r,t(n,i,O,r,e,j))})),L}},function(t,e){t.exports=function(t,e){for(var i=-1,n=null==t?0:t.length;++i<n&&!1!==e(t[i],i,t););return t}},function(t,e,i){var n=i(33),r=i(26);t.exports=function(t,e){return t&&n(e,r(e),t)}},function(t,e,i){var n=i(33),r=i(50);t.exports=function(t,e){return t&&n(e,r(e),t)}},function(t,e,i){(function(t){var n=i(10),r=e&&!e.nodeType&&e,o=r&&"object"==typeof t&&t&&!t.nodeType&&t,s=o&&o.exports===r?n.Buffer:void 0,a=s?s.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var i=t.length,n=a?a(i):new t.constructor(i);return t.copy(n),n}}).call(this,i(73)(t))},function(t,e,i){var n=i(33),r=i(72);t.exports=function(t,e){return n(t,r(t),e)}},function(t,e,i){var n=i(33),r=i(136);t.exports=function(t,e){return n(t,r(t),e)}},function(t,e,i){var n=i(114),r=i(136),o=i(50);t.exports=function(t){return n(t,o,r)}},function(t,e){var i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&i.call(t,"index")&&(n.index=t.index,n.input=t.input),n}},function(t,e,i){var n=i(82),r=i(368),o=i(369),s=i(370),a=i(371),h="[object Boolean]",c="[object Date]",u="[object Map]",l="[object Number]",d="[object RegExp]",f="[object Set]",p="[object String]",y="[object Symbol]",v="[object ArrayBuffer]",g="[object DataView]",_="[object Float32Array]",m="[object Float64Array]",b="[object Int8Array]",x="[object Int16Array]",w="[object Int32Array]",C="[object Uint8Array]",S="[object Uint8ClampedArray]",D="[object Uint16Array]",k="[object Uint32Array]";t.exports=function(t,e,i){var P=t.constructor;switch(e){case v:return n(t);case h:case c:return new P(+t);case g:return r(t,i);case _:case m:case b:case x:case w:case C:case S:case D:case k:return a(t,i);case u:return new P;case l:case p:return new P(t);case d:return o(t);case f:return new P;case y:return s(t)}}},function(t,e,i){var n=i(82);t.exports=function(t,e){var i=e?n(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}},function(t,e){var i=/\w*$/;t.exports=function(t){var e=new t.constructor(t.source,i.exec(t));return e.lastIndex=t.lastIndex,e}},function(t,e,i){var n=i(25),r=n?n.prototype:void 0,o=r?r.valueOf:void 0;t.exports=function(t){return o?Object(o.call(t)):{}}},function(t,e,i){var n=i(82);t.exports=function(t,e){var i=e?n(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}},function(t,e,i){var n=i(373),r=i(137),o=i(44);t.exports=function(t){return"function"!=typeof t.constructor||o(t)?{}:n(r(t))}},function(t,e,i){var n=i(13),r=Object.create,o=function(){function t(){}return function(e){if(!n(e))return{};if(r)return r(e);t.prototype=e;var i=new t;return t.prototype=void 0,i}}();t.exports=o},function(t,e,i){var n=i(375),r=i(31),o=i(77),s=o&&o.isMap,a=s?r(s):n;t.exports=a},function(t,e,i){var n=i(32),r=i(14),o="[object Map]";t.exports=function(t){return r(t)&&n(t)==o}},function(t,e,i){var n=i(377),r=i(31),o=i(77),s=o&&o.isSet,a=s?r(s):n;t.exports=a},function(t,e,i){var n=i(32),r=i(14),o="[object Set]";t.exports=function(t){return r(t)&&n(t)==o}},function(t,e,i){var n=i(33),r=i(379),o=i(50),s=r((function(t,e){n(e,o(e),t)}));t.exports=s},function(t,e,i){var n=i(48),r=i(79);t.exports=function(t){return n((function(e,i){var n=-1,o=i.length,s=o>1?i[o-1]:void 0,a=o>2?i[2]:void 0;for(s=t.length>3&&"function"==typeof s?(o--,s):void 0,a&&r(i[0],i[1],a)&&(s=o<3?void 0:s,o=1),e=Object(e);++n<o;){var h=i[n];h&&t(e,h,n,s)}return e}))}},function(t,e,i){(function(t){t.c("Listener",{init:function(){return this.listeners=[]},remove:function(){var t,e,i,n,r,o,s,a;for(a=[],i=0,n=(o=this.listeners).length;i<n;i++)r=(s=o[i]).object,e=s.event,t=s.callback,a.push(r.unbind(e,t));return a},listenTo:function(t,e,i,n){var r;return null==n&&(n=this),r=function(){return i.apply(n,arguments)},this.listeners.push({object:t,event:e,callback:r}),t.bind(e,r)}})}).call(this,i(0).default)},function(t,e,i){(function(t){var e;e=function(t,e){return t*(e-(.225-.225*e))},t.c("ViewportRelativeMotion",{viewportRelativeMotion:function(i){var n,r,o,s,a,h,c,u,l,d;return h=i.x,u=i.y,o=i.offsetY,s=i.speed,c=i.xspeed,l=i.yspeed,this._speed={x:c||s,y:l||s},null!=h&&null!=u&&(this._startLocation={x:h,y:u},a=t.viewport.width/4,n=h+(h-a)*(this._speed.x-1)-a*(this._speed.x-1)+(this.dx||0),r=u+e(o,this._speed.y)-(this.dy||0),this.attr({x:Math.floor(n),y:Math.floor(r)})),this.motion=this.bind("CameraMove",(d=this,function(t){var i,n;return i=t.dx,n=t.dy,h=-i*d._speed.x,u=-e(n,d._speed.y),d.shift(h,u)})),this},remove:function(){return this.unbind("CameraMove",this.motion)}})}).call(this,i(0).default)},function(t,e,i){(function(t){t.c("ControlScheme",{init:function(){return this.has("Cheats")||this.addComponent("Cheats"),this.trigger("Activated"),t.trigger("PlayerActivated")},remove:function(){return this.has("Cheats")&&this.removeComponent("Cheats"),this.trigger("Deactivated"),t.trigger("PlayerDeactivated")}})}).call(this,i(0).default)},function(t,e,i){(function(t){t.c("InventoryWeapons",{init:function(){},stats:function(t){var e,i,n,r,o,s,a;return null==t&&(t={}),null!=t.primary&&(this.primaryWeapon.stats=t.primary.stats,this.primaryWeapon._determineWeaponSettings()),(a={}).primary={stats:null!=(e=null!=(i=this.primaryWeapon)?i.stats:void 0)?e:{},boosts:null!=(n=null!=(r=this.primaryWeapon)?r.boosts:void 0)?n:{},boostTimings:null!=(o=null!=(s=this.primaryWeapon)?s.boostTimings:void 0)?o:{}},a},installItem:function(t){var e,i;if(null!=t){if("weapon"===t.type){if(this.hasItem(t.contains))return;if(this.items.push(t),"lasers"===t.contains)return this._installPrimary("RapidWeaponLaser"),!0;if("oldlasers"===t.contains)return this._installPrimary("OldWeaponLaser"),!0;if("diagonals"===t.contains)return this._installPrimary("RapidDiagonalLaser"),!0}if("ship"===(i=t.type)||"shipBoost"===i||"shipUpgrade"===i){if("life"===t.contains)return this.scoreText("Extra life!"),!0;if("healthb"===t.contains)return this.scoreText("Full health!"),!0;if("healthu"===t.contains)return this.scoreText("Health upgrade!"),!0;if("points"===t.contains)return this.scoreText("+500 points!"),!0;if("xp"===t.contains)return"function"==typeof(e=this.primaryWeapon).addXP&&e.addXP(1e3),!0}return"weaponUpgrade"===t.type?(this.primaryWeapon.upgrade(t.contains),!0):"weaponBoost"===t.type?(this.primaryWeapon.boost(t.contains),!0):void 0}}})}).call(this,i(0).default)},function(t,e,i){(function(t){var e,n,r;r=i(142),e=r.determineLevel,n=r.levelInfo,t.c("Player",{events:{EntityEndState:"_processEnemyState"},init:function(){return this.reset()},reset:function(){if(this.softReset(),this.has("ControlScheme"))return this.removeComponent("ControlScheme")},softReset:function(){return this.stats={shotsFired:0,shotsHit:0,enemiesKilled:0,bonus:0},this.attr({lives:3,health:5,maxHealth:5,points:0,chain:0})},loseHealth:function(t){return this.health-=t,this.trigger("UpdateHealth",{health:this.health})},loseLife:function(){if(this.lives>0)return this.lives-=1,this.health=this.maxHealth,this.chain=0,this.trigger("UpdateLives",{lives:this.lives}),this.lives<=0?t.trigger("PlayerDied",this):void 0},gainLife:function(){return this.lives+=1,this.trigger("UpdateLives",{lives:this.lives})},healthUpgrade:function(){return this.maxHealth+=1,this.health=this.maxHealth,this.trigger("UpdateHealth",{maxHealth:this.maxHealth,health:this.health})},healthBoost:function(){return this.health=this.maxHealth,this.trigger("UpdateHealth",{health:this.health})},eligibleForExtraLife:function(){if(this.lastExtraLifeThreshold||(this.lastExtraLifeThreshold=0),this.points-this.lastExtraLifeThreshold>=15e3)return!0},rewardExtraLife:function(){return this.lastExtraLifeThreshold=this.points},addPoints:function(t,e){if(this.lives>0)return e&&t>0&&this.ship.scoreText("+"+t,{location:e,attach:!1,duration:200,distance:30,delay:10}),this.points+=t,this.trigger("UpdatePoints",{points:this.points})},addChainXP:function(t){var i,r,o;if(i=e(this.chain),this.chain+=t,(o=e(this.chain))>i)return r=n(o),this.points+=r.reward,this.trigger("UpdatePoints",{points:this.points}),this.ship.scoreText(r.name+"! +"+r.reward,{attach:!1,duration:2e3,distance:30,delay:40})},_processEnemyState:function(t){var i;if(t.alive&&t.chainable&&(i=e(this.chain),this.chain=0,i>0))return this.ship.scoreText("Chain lost!",{attach:!1,positive:!1,duration:2e3,distance:30,delay:40})}})}).call(this,i(0).default)},function(t,e,i){(function(t){t.c("PlayerAssignable",{init:function(){return this._attachControllerAssignTrigger(),this.preferredPlayer=null},_assignControls:function(){var t,e;if(null!=(t=this._preferredplayer()||this._firstUnassignedPlayer()))return this.preferredPlayer=t.getId(),this.setupControls(t),t.one("Deactivated",(e=this,function(){return e._attachControllerAssignTrigger()}));this._attachControllerAssignTrigger()},_attachControllerAssignTrigger:function(){return this.one("Fire",this._assignControls)},_preferredplayer:function(e){var i;if(null!==this.preferredPlayer&&!(i=t(this.preferredPlayer)).has("ControlScheme"))return i},_firstUnassignedPlayer:function(){var e,i,n,r,o;for(e=0,i=(o=t("Player")).length;e<i;e++)if(r=o[e],!(n=t(r)).has("ControlScheme"))return n}})}).call(this,i(0).default)},function(t,e,i){(function(t){var e;e=i(4).isPaused,t.c("PlayerControlledCube",{init:function(){return this.requires("2D, WebGL, Color, Listener, Collision, SunBlock, PlayerControlledShip, Acceleration, InventoryWeapons"),this.attr({w:40,h:40}),this.bind("Move",(function(t){var e;if(this.hit("Edge")||this.hit("Solid"))return e=this.motionDelta(),this.shift(-e.x,-e.y)})),this.primaryWeapon=void 0,this.primaryWeapons=[],this.secondaryWeapon=void 0,this.superUsed=0,this.weaponsEnabled=!0,this.currentRenderedSpeed=0},start:function(){return this.addComponent("Invincible").invincibleDuration(2e3),this.onHit("Enemy",(function(t){var i,n,r;if(!e()&&!this.has("Invincible")){for(i=!1,n=0,r=t.length;n<r;n++)t[n].obj.hidden||(i=!0);return i?this.trigger("Hit"):void 0}})),this.onHit("PowerUp",(function(t){var i,n,r,o;if(!e()){for(o=[],i=0,n=t.length;i<n;i++)r=t[i],this.pickUp(r.obj),o.push(this.trigger("PowerUp",r.obj));return o}})),this.bind("Hit",(function(){return this.trigger("Destroyed",this)})),this.bind("CameraPan",(function(t){var e,i;return e=t.dx,i=t.dy,this.shift(-e,-i)})),this.bind("GameLoop",(function(t){var e,i;if(e=this._currentSpeed.x/1e3*t.dt,i=this._currentSpeed.y/1e3*t.dt,this.updateAcceleration(),(this.hit("Edge")||this.hit("Solid"))&&(this.x-=e,this.y-=i),this.hit("Edge")||this.hit("Solid"))return this.trigger("Hit")})),this},forcedSpeed:function(t,e){return this.targetSpeed(t,e)},shoot:function(t){if(this.weaponsEnabled)return null!=this.primaryWeapon&&this.primaryWeapon.shoot(t),null!=this.secondaryWeapon?this.secondaryWeapon.shoot(t):void 0},switchWeapon:function(t){var e,i;if(t)return e=(this.currentPrimary+1)%this.primaryWeapons.length,null!=(i=this.primaryWeapon)&&i.uninstall(),this.primaryWeapon=this.primaryWeapons[e],this.primaryWeapon.install(this),this.currentPrimary=e},superWeapon:function(t){if(t)return this.superUsed+=1},pickUp:function(t){if(t.settings.contains,this.installItem(t.settings))return this.trigger("PowerUp",t.settings),t.pickup()},clearItems:function(){var t,e,i,n;for(null!=(i=this.primaryWeapon)&&i.uninstall(),this.primaryWeapon=null,t=0,e=(n=this.primaryWeapons).length;t<e;t++)n[t].destroy();return this.primaryWeapons=[],this.items=[]},_installPrimary:function(e){var i,n,r;return(n=t.e(e)).install(this),null!=(i=this.primaryWeapon)&&i.uninstall(),this.primaryWeapon=n,this.listenTo(n,"levelUp",(r=this,function(t){return r.scoreText("L +"+t)})),this.primaryWeapons.push(n),this.currentPrimary=this.primaryWeapons.length-1},hasItem:function(t){return null==this.items&&(this.items=[]),~this.items.indexOf(t)},scoreText:function(e){return t.e("Text, DOM, 2D, Tween").textColor("#FFFFFF").text(e).attr({x:this.x,y:this.y-10,z:990,w:100}).textFont({size:"10px",weight:"bold",family:"Press Start 2P"}).tween({y:this.y-40,alpha:.5},1e3).one("TweenEnd",(function(){return this.destroy()}))}})}).call(this,i(0).default)},function(t,e,i){(function(t){var e,n,r,o;o=i(142),r=o.levelProgress,n=o.levelInfo,e=o.determineLevel,t.c("PlayerInfo",{init:function(){return this.requires("2D, Listener"),this.boosts={},this.visible=!0},playerInfo:function(e,i){var n;return this.player=i,this.displayedScore=i.points,this.displayedChain=i.chain,this.score=t.e("2D, Text, UILayerDOM").attr({w:220,h:20,x:e+200,y:10,z:200}).textFont({size:"10px",family:"Press Start 2P"}),this.player.has("Color")&&this.score.textColor(this.player.color()),this.lives=t.e("2D, Text, UILayerDOM").attr({w:220,h:20,x:e,y:10,z:200}).textFont({size:"10px",family:"Press Start 2P"}),this.health=t.e("2D, Text, UILayerDOM").attr({w:220,h:20,x:e+70,y:8,z:200}).textFont({size:"10px",family:"Press Start 2P"}),this.heart=t.e("2D, ColorEffects, heart, UILayerWebGL").attr({w:16,h:16,x:e-2,y:6,z:200}).colorOverride(i.color(),"partial"),this.chain=t.e("2D, Color, UILayerWebGL").attr({w:190,h:2,x:e,y:28,z:200,alpha:.2}).color("#000000"),this.chainName=t.e("2D, Text, UILayerDOM").attr({w:220,h:20,x:e,y:34,z:200}).textFont({size:"8px",family:"Press Start 2P"}),this.player.has("Color")&&this.chainName.textColor(this.player.color()),this.chainProgress=t.e("2D, Color, UILayerWebGL").attr({w:0,h:2,x:e,y:28,z:200}).color(this.player.color()),this.player.has("Color")&&(this.lives.textColor(i.color()),this.health.textColor(i.color())),this.updatePlayerInfo(),this.createBoostsVisuals(e),this.listenTo(i,"GameLoop",(n=this,function(t){return n.updatePlayerInfo(),n.updateBoostInfo(),n.updateHealthInfo(t)})),this},setVisibility:function(t){return this.visible=t},createBoostsVisuals:function(e){var i;return i=this.player.color(),this.boosts.speedb=t.e("2D, UILayerWebGL, speedBoost, ColorEffects").attr({w:16,h:16}).attr({x:e,y:25,z:200}).colorOverride(i,"partial"),this.boosts.rapidb=t.e("2D, UILayerWebGL, rapidFireBoost, ColorEffects").attr({w:16,h:16}).attr({x:e+20,y:24,z:200}).colorOverride(i,"partial"),this.boosts.aimb=t.e("2D, UILayerWebGL, aimBoost, ColorEffects").attr({w:16,h:16}).attr({x:e+40,y:24,z:200}).colorOverride(i,"partial"),this.boosts.damageb=t.e("2D, UILayerWebGL, damageBoost, ColorEffects").attr({w:16,h:16}).attr({x:e+50,y:24,z:200}).colorOverride(i,"partial")},updateBoostInfo:function(){var t,e,i,n,r,o,s;for(i in n=this.boosts)n[i].attr({alpha:0});if(this.player.has("ControlScheme")&&!1!==this.visibile&&null!=this.player.ship){for(e in o=[],r=this.player.ship.stats().primary.boostTimings)t=1,(s=r[e])<2e3&&Math.floor(s/200)%2==0&&(t=0),o.push(this.boosts[e].attr({alpha:t}));return o}},updateHealthInfo:function(t){var e;if(this.health.attr({alpha:0}),this.player.has("ControlScheme")&&!1!==this.visibile)return null!=this.player.ship?(e=1,this.player.health<1&&Math.floor(t.inGameTime/200)%2==0&&(e=0),this.health.attr({alpha:e})):void 0},updatePlayerInfo:function(){var t,i,o,s,a,h,c,u;if(this.displayedScore<this.player.points&&(this.player.points-this.displayedScore>1e3&&(this.displayedScore+=24),this.player.points-this.displayedScore>100&&(this.displayedScore+=8),this.player.points-this.displayedScore>50&&(this.displayedScore+=4),this.displayedScore+=1),this.displayedChain!==this.player.chain&&(s=e(this.player.chain),this.chainProgress.attr({w:190*r(this.player.chain)}),0===s?this.chainName.text(""):(o=n(s),this.chainName.text(o.name)),this.displayedChain=this.player.chain),this.player.has("ControlScheme")?this.score.text("Score: "+this.displayedScore):this.score.text(this.player.name),this.player.has("ControlScheme"))return 0===this.player.lives?(this.lives.text("Game Over"),this.heart.attr({alpha:0,visible:!1}),this.health.attr({alpha:0,visible:!1})):(!0===this.visibile&&this.heart.attr({alpha:1}),this.heart.attr({visible:!0}),Infinity===(u=this.player.lives-1)&&(u="Demo mode"),this.lives.text("&nbsp;  "+u),i=Array(Math.max(1,this.player.health)).fill("▩").join(""),!0===this.visibile&&this.health.attr({alpha:1}),this.health.text(i));for(a in this.lives.text("Press fire to start!"),this.heart.attr({alpha:0,visible:!1}),this.health.attr({alpha:0,visible:!1}),c=[],h=this.boosts)t=h[a],c.push(t.attr({alpha:0}));return c}})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){i(7);var e=i(2),n=i.n(e),r=i(51),o=i(4),s=i(11);t.c("PlayerSpaceship",{required:"2D, WebGL, playerShip, ColorEffects, Listener, Collision, SunBlock, PlayerControlledShip, Acceleration, InventoryWeapons",init(){this.attr({w:71,h:45}),this.collision([21,13,56,13,66,32,35,32]),this.onHit("ShipSolid",t=>{const e=this.motionDelta();let i=0,n=0,r=0,o=0;t.map(t=>{let s=0,a=0;if("SAT"===t.type)s-=t.overlap*t.nx,a-=t.overlap*t.ny;else{const{obj:i}=t,n="function"==typeof i.choreographyDelta?i.choreographyDelta():{x:0,y:0};i.intersect(this.x-e.x+n.x,this.y+n.y,this.w,this.h)&&(a-=e.y-n.y),i.intersect(this.x+n.y,this.y-e.y+n.y,this.w,this.h)&&(s-=e.x-n.x)}if(0!==s&&(s>0?(r<0&&this._squashShip(),r=1,i=Math.max(i,s)):(r>0&&this._squashShip(),r=-1,i=Math.min(i,s))),0!==a)return a<0?(o>0&&this._squashShip(),o=-1,n=Math.min(n,a)):(o<0&&this._squashShip(),o=1,n=Math.max(n,a))}),this.shift(i,n)}),this.primaryWeapon=void 0,this.primaryWeapons=[],this.secondaryWeapon=void 0,this.superUsed=0,this.weaponsEnabled=!0,this.currentRenderedSpeed=0,this.flip("X"),this.emitCooldown=0},_squashShip(){this.trigger("Hit",{damage:1e3})},updateMovementVisuals(t,e,i,n){null==t&&(t=0);const r=Math.max(e*(1e3/n),0);i>0?this.healthPerc<.3?this.sprite(13,5):this.sprite(7,4):i<0?this.healthPerc<.3?this.sprite(13,3):this.sprite(10,4):this.healthPerc<.3?this.sprite(0,2):this.sprite(0,0),this.rotation=0,this._updateFlyingSpeed(r,n),this.rotation=t},_updateFlyingSpeed(t,e){const i=t<30?t/2:15+t/400*100;this.currentRenderedSpeed>i?this.currentRenderedSpeed-=12:this.currentRenderedSpeed<i&&(this.currentRenderedSpeed+=12),this.currentRenderedSpeed<0&&(this.currentRenderedSpeed=0);const n=10+this.currentRenderedSpeed,r=Math.min(n/3,15);this.backFire.attr({x:this.x-n+9,y:this.y+20-Math.floor(r/2),w:n,h:r}),this._emitTrail(e)},_emitTrail(t){if(this.emitCooldown-=t,this.emitCooldown<0){const t=this.backFire.w/4,e=4;this.trailEntPool.get().attr({x:this.x-t+8,dy:0,y:Math.floor(this.y+21-4*Object(s.lookup)()),w:t,h:e,z:-4,alpha:.3+.4*Object(s.lookup)()}).tweenPromise({alpha:0,h:2,dy:2},750,"easeOutQuad").then(t=>{this.trailEntPool.recycle(t)}),this.emitCooldown=30}},start(){this.backFire=t.e("2D, WebGL, shipEngineFire, ColorEffects, SpriteAnimation"),this.backFire.reel("burn",300,[[4,5,3,1],[3,0,3,1]]),this.backFire.timing=0,this.backFire.animate("burn",-1);this.backFire.attr({x:this.x-68,y:this.y+20-Math.floor(5),w:68,h:10,alpha:.8,z:this.z-1}),this.attach(this.backFire);const e={},i={_red:255,_green:255,_blue:255};return t.assignColor(this.playerColor,e),["_red","_green","_blue"].forEach(t=>{const n=(e[t]+i[t]+i[t])/3;e[t]=n}),this.trailColor=e,this.backFire.colorOverride(e),this.trailEntPool=Object(r.default)(()=>t.e("2D, WebGL, shipEngineFire, Delta2D, TweenPromise, ViewportRelativeMotion, ColorEffects").colorOverride(this.trailColor).viewportRelativeMotion({speed:1}),2),this.addComponent("Invincible").invincibleDuration(1500),this.onHit("Hostile",t=>{if(Object(o.isPaused)()||this.has("Invincible"))return;let e=!1,i=0;t.forEach(t=>{t.obj.damage&&t.obj.damage>i&&!t.obj.hidden&&(i=t.obj.damage,e=!0)}),e&&this.trigger("Hit",{damage:i})}),this.onHit("PowerUp",t=>{Object(o.isPaused)()||t.filter(t=>!t.obj.pickedUp).forEach(t=>this.pickUp(t.obj))}),this.bind("Hit",()=>{this.addComponent("Invincible").invincibleDuration(2e3),t.e("Blast, Explosion").explode({x:this.x+this.w/2,y:this.y+this.h/2,radius:this.w/3}),t.audio.play("explosion"),t("ScrollWall").get(0).addTrauma(.3)}),this.bind("Die",()=>{t.e("Blast, Explosion").explode({x:this.x+this.w/2,y:this.y+this.h/2,radius:this.w}),t.audio.play("explosion"),t("ScrollWall").get(0).addTrauma(.3),this.trigger("Destroyed",this)}),this.bind("CameraPan",({dx:t,dy:e})=>this.shift(-t,-e)),this.bind("GameLoop",(function(t){const e=(this.vx+this._currentSpeed.x)/1e3*t.dt,i=(this.vy+this._currentSpeed.y)/1e3*t.dt;if(this.has("AnimationMode"))return void(this._choreography&&0===this._choreography.length&&this.updateMovementVisuals(this.rotation,e,i,t.dt));this.updateAcceleration();const n=this.rotation;let r=n;n<i?r+=1:n>i&&(r-=1),this.rotation=r,this.updateMovementVisuals(this.rotation,e,i,t.dt)})),this},forcedSpeed(t,e={}){this.targetSpeed(t,e)},shoot(t){this.weaponsEnabled&&(null!=this.primaryWeapon&&this.primaryWeapon.shoot(t),null!=this.secondaryWeapon&&this.secondaryWeapon.shoot(t))},switchWeapon(t){if(!t)return;const e=(this.currentPrimary+1)%this.primaryWeapons.length;null!=this.primaryWeapon&&this.primaryWeapon.uninstall(),this.primaryWeapon=this.primaryWeapons[e],this.primaryWeapon.install(this),this.currentPrimary=e},superWeapon(t){t&&(this.superUsed+=1)},pickUp(e){this.installItem(e.settings)&&(t.audio.play("powerup"),this.trigger("PowerUp",e.settings),e.pickup())},clearItems(){null!=this.primaryWeapon&&this.primaryWeapon.uninstall(),this.primaryWeapons.forEach(t=>t.destroy()),this.primaryWeapons=[],this.items=[]},_installPrimary(e){const i={damage:"Damage",rapid:"RapidFire",aim:"AimAssist",speed:"BulletSpeed",damageb:"Damage",rapidb:"RapidFire",aimb:"AimAssist",speedb:"BulletSpeed"},n=t.e(e);n.install(this),null!=this.primaryWeapon&&this.primaryWeapon.uninstall(),this.primaryWeapon=n,this.listenTo(n,"levelUp",t=>this.scoreText(`${i[t.aspect]} +${t.level}`)),this.listenTo(n,"boost",t=>this.scoreText(`${i[t.aspect]} Boost!`)),this.listenTo(n,"boostExpired",t=>this.scoreText(`${i[t.aspect]} Boost expired`,{positive:!1})),this.primaryWeapons.push(n),this.currentPrimary=this.primaryWeapons.length-1},hasItem(t){return null!=this.items&&this.items.find(e=>e.contains===t)},scoreText(e,i={}){let r="function"==typeof(i=n()(i,{positive:!0,location:{x:this.x,y:this.y},attach:!0,duration:1e3,distance:70,delay:400})).location?i.location():void 0;r&&(r={x:r.x,y:r.y}),null==r&&({location:r}=i);const o=t.e("Text, DOM, 2D, Tween, Delay").textColor(i.positive?"#DDD":"#F00").text(e).attr({x:r.x,y:r.y-10,z:990,w:250,alpha:.75}).textFont({size:"10px",weight:"bold",family:"Press Start 2P"});i.attach&&this.attach(o),o.delay(()=>{i.attach&&this.detach(o),o.tween({rotation:0,y:o.y-i.distance,alpha:.5},i.duration,"easeInQuad"),o.one("TweenEnd",()=>o.destroy())},i.delay)},remove(){this.trailEntPool.clean()}})}).call(this,i(0).default)},function(t,e,i){(function(t){t.c("Poolable",{init(){this.attr({hasPool:!0})},setupPool(t){return this.pool=t,this},recycle(){this.pool.recycle(this)}})}).call(this,i(0).default)},function(t,e,i){(function(t){t.c("Flipable",{flipX:function(){var t,e,i,n,r,o;if(!this.xFlipped){this.xFlipped=!0;try{for("function"==typeof this.flip&&this.flip("X"),r=this._children,i=0,n=r.length;i<n;i++)o=(t=r[i]).x-this.x,"function"==typeof t.attr&&t.attr({x:this.x+this.w-t.w-o}),"function"==typeof t.flip&&t.flip("X")}catch(t){e=t,console.log(e)}return this._mirrorCollision(),this._mirrorRotationPoints(),this._mirrorWeaponOrigin(),this}},unflipX:function(){var t,e,i,n,r,o;if(this.xFlipped){this.xFlipped=!1;try{for("function"==typeof this.unflip&&this.unflip("X"),r=this._children,i=0,n=r.length;i<n;i++)t=r[i],o=this.x+this.w-(t.x+t.w),"function"==typeof t.attr&&t.attr({x:this.x+o}),"function"==typeof t.unflip&&t.unflip("X")}catch(t){e=t,console.log(e)}return this._mirrorCollision(),this._mirrorRotationPoints(),this._mirrorWeaponOrigin(),this}},_mirrorCollision:function(){var t,e,i,n,r,o,s;if(this.map.points){for(s=[],e=i=0,n=(o=this.map.points).length;i<n;e=++i)r=o[e],e%2==0?(t=r-this.x,s.push(this.map.points[e]=this.x+(this.w-t))):s.push(void 0);return s}},_mirrorRotationPoints:function(){var t,e,i,n,r;for(this._origin.x=this.w-this._origin.x,r=[],e=0,i=(n=this._children).length;e<i;e++)null!=(t=n[e]).origin&&(t._origin.x=t.w-t._origin.x),r.push(t.rotation=(360-t.rotation+360)%360);return r},_mirrorWeaponOrigin:function(){if(null!=this.weaponOrigin)return this.weaponOrigin=[this.w-this.weaponOrigin[0],this.weaponOrigin[1]]}})}).call(this,i(0).default)},function(t,e,i){(function(t){t.c("Hideable",{_hidden:!1,properties:{hidden:{set:function(t){return this._updateHidden(t)},get:function(){return this._hidden},configurable:!0,enumerable:!0},_hidden:{enumerable:!1}},init:function(){return this.requires("ColorEffects")},sendToBackground:function(t,e){var i,n,r,o,s;for(this._originalZ=this.z,this.attr({scale:t,z:e}),n=0,r=(o=this._children).length;n<r;n++)null!=(i=o[n]).attr&&(s=i.z-this._originalZ,i.attr({z:e+s}));return this.hidden=!0,this},_updateHidden:function(t){if(this._hidden!==t)return this._hidden=t,t?this.trigger("Hiding",this):this.trigger("Revealing",this)},hide:function(t,e){var i,n,r,o,s,a,h;if(this.hideMarker=t,e.below&&this.has("Sprite")&&0===this.rotation)for(this.hideAt=e.below,n=0,o=(a=this._children).length;n<o;n++)"function"==typeof(i=a[n]).attr&&i.attr({hideAt:e.below});else for(this.attr({alpha:0}),r=0,s=(h=this._children).length;r<s;r++)"function"==typeof(i=h[r]).attr&&i.attr({alpha:0});return this.hidden=!0,this},hideBelow:function(t){var e,i,n,r,o;for(this.hideAt=t,o=[],i=0,n=(r=this._children).length;i<n;i++)e=r[i],o.push("function"==typeof e.attr?e.attr({hideAt:t}):void 0);return o},reveal:function(){var t,e,i,n,r,o,s,a,h,c;for(null!=(o=this.hideMarker)&&o.destroy(),null!=(s=this.scale)?s:1,1,e=0,n=(a=this._children).length;e<n;e++)null!=(t=a[e]).attr&&(c=t.z-this.z,t.attr({z:this._originalZ+c}));for(this.attr({scale:1,alpha:1,z:this._originalZ,hideAt:null}),i=0,r=(h=this._children).length;i<r;i++)"function"==typeof(t=h[i]).attr&&t.attr({alpha:1,hideAt:null});return this.hidden=!1,this},remove:function(){if(this.hideMarker)return this.hideMarker.hasPool?this.hideMarker.recycle():this.hideMarker.destroy()}})}).call(this,i(0).default)},function(t,e,i){(function(t,e){var n,r,o;n=i(51).default,r=i(11).lookup,t.c("GameParticle",{events:{CameraPan:function(t){var e,i;return e=t.dx,i=t.dy,this.shift(-e,-i)}},particle:function(t){var e;return this.duration=null!=(e=t.duration)?e:100,this.running=0,this.uniqueBind("GameLoop",this._onGameLoop),this},_onGameLoop:function(t){if(this.running+=t.dt,this.running>this.duration)return this.unbind("GameLoop",this._onGameLoop),this.trigger("ParticleEnded",this)}}),t.c("Explode",{required:"explosionStart, SpriteAnimation",init:function(){return this.reel("explodeReset",20,[[0,0]])},playExplode:function(t){var e;return(e=this.getReel("explode"))&&e.duration===t?(this.animate("explode"),this):(this.animate("explodeReset"),this.reel("explode",t,[[0,0],[1,0],[2,0],[3,0],[4,0],[0,1],[1,1],[2,1],[3,1],[4,1],[0,2],[1,2],[2,2],[3,2],[4,2],[0,3],[1,3]]),this.animate("explode"),this)}}),t.c("PausableMotion",{required:"Motion",events:{GamePause:"_handlePause"},init:function(){return this._pausingProps={}},_handlePause:function(t){var e,i;return e=["_vx","_vy","_ax","_ay"],t?(this._pausingProps={},e.forEach((i=this,function(t){return i._pausingProps[t]=i[t]})),this.resetMotion()):e.forEach(function(t){return function(e){return t[e]=t._pausingProps[e]||0}}(this))}}),o=n((function(){return t.e("2D, WebGL, Explode, ColorEffects, GameParticle, PausableMotion, Tween").colorOverride("#FFFFFF")}),200),t.c("WaterSplashes",{events:{GameLoop:"_waterSplashes"},init:function(){return this.cooldown=0,null==this.defaultWaterCooldown&&(this.defaultWaterCooldown=70),null==this.waterRadius&&(this.waterRadius=5),null==this.minSplashDuration&&(this.minSplashDuration=210),this.detectionOffset=0,this.minOffset=-10,null==this.waterAlpha&&(this.waterAlpha=.6),this.splashUpwards=!1},setDetectionOffset:function(t,e){return this.detectionOffset=t,this.minOffset=null!=e?e:-10,this},_waterSplashes:function(i){var n,s,a,h,c,u,l,d,f,p,y,v,g,_,m,b,x,w;if(null==e.explosionMode){if(this.cooldown-=i.dt,m=t.s("SeaLevel").getSeaLevel(this.scale),a=t("ScrollWall")._currentSpeed.x,this.y+this.h+this.detectionOffset>m&&this.y<m&&this.cooldown<=0)for(b=null!=(y=this.waterSplashSpeed)?y:this.defaultSpeed,this.cooldown=this.defaultWaterCooldown,x=1,this._lastWaterY!==this.y&&this.splashUpwards&&(x=(b-20)/30),x*=null!=(v=this.scale)?v:1,45,f=this.w/45,0,w=Math.min(Math.abs((this.vy||0)/3),100),h=c=0,g=f;0<=g?c<g:c>g;h=0<=g?++c:--c)for(u=0,_=Math.min(x,3);0<=_?u<_:u>_;0<=_?++u:--u)1,p=r(),n=3*(this.minSplashDuration+4*w+100*p),s=210/this.minSplashDuration,l=this.x+45*h+45*p-2*this.waterRadius,d=m+this.minOffset-2*this.waterRadius,100,l+100<t.viewport.x||l-100>t.viewport.x+t.viewport.width||d+100<t.viewport.y||d-100>t.viewport.y+t.viewport.height||o.get().attr({x:l,y:d,z:3,w:4*this.waterRadius,h:4*this.waterRadius,alpha:this.waterAlpha*(.5+.5*p),topDesaturation:this.topDesaturation,bottomDesaturation:this.bottomDesaturation,vy:(-10-w-w)*s*p,ay:(30+w+w)*(.5+.5*s)*p,vx:-a}).one("ParticleEnded",(function(t){return o.recycle(t)})).playExplode(n).tween({alpha:.2,w:4*this.waterRadius+2*this.waterRadius*p,h:4*this.waterRadius+2*this.waterRadius*p},5*n*p).particle({duration:n});return this._lastWaterY=this.y}}})}).call(this,i(0).default,i(9).default)},function(t,e,i){(function(t){var e;e=i(4).isPaused,t.c("Bullet",{required:"2D, WebGL, sphere1, Collision, ColorEffects",events:{HitOn:"_onWallHit",Freeze:"_onFreeze"},init:function(){return this.crop(4,19,24,11),this.collision([0,0,18,0,18,7,0,7])},_onWallHit:function(){if(!e())return this.trigger("BulletWall",this)},_onFreeze:function(){return this.unbind("GameLoop",this._onGameLoop)},updateCollision:function(t,e){return this.collision([0,0,t,0,t,e,0,e]),this},bullet:function(e){var i,n,r,o,s,a,h;for(n={},i={_red:255,_green:255,_blue:255},t.assignColor(e.ship.playerColor,n),o=0,s=(h=["_red","_green","_blue"]).length;o<s;o++)a=(n[r=h[o]]+i[r]+i[r])/3,n[r]=a;return this.colorOverride(n),this.attr({ship:e.ship}),this.checkHits("BulletSolid"),this},fire:function(t){return this.xDir=Math.cos(t.direction/180*Math.PI),this.yDir=Math.sin(t.direction/180*Math.PI),this.attr({damage:t.damage,speed:t.speed,rotation:t.direction}),this.uniqueBind("GameLoop",this._onGameLoop),this},_onGameLoop:function(t){var e;if(e=t.dt*(this.speed/1e3),this.shift(this.xDir*e,this.yDir*e),this.x>this._maxXforViewPort()||this._minXforViewPort()>this.x||this._minYforViewPort()>this.y||this.y>this._maxYforViewPort())return this.trigger("BulletMiss",this)},_maxXforViewPort:function(){return-t.viewport._x+t.viewport._width/t.viewport._scale+10},_minXforViewPort:function(){return-t.viewport._x-10},_maxYforViewPort:function(){return-t.viewport._y+t.viewport._height/t.viewport._scale+10},_minYforViewPort:function(){return-t.viewport._y-10}})}).call(this,i(0).default)},function(t,e,i){(function(t){var e,n=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};e=i(4).isPaused,t.c("Cheats",{init:function(){var e;return this.addCheat("Freddie",["Up","Up","Down","Down","Left","Right","Left","Right","Fire"],(e=this,function(){var i,n;if(i=!1,n=e.ship,t("Freddy").each((function(){if(this.ship===n)return i=!0})),!i)return t.e("Freddy").freddy({protect:e.ship})})),this._listenInput()},remove:function(){var t,e,i,n,r;for(r=[],i=0,n=(e=["Up","Down","Left","Right","Fire"]).length;i<n;i++)t=e[i],r.push(this.unbind(t));return r},addCheat:function(t,e,i){return null==this.cheats&&(this.cheats=[]),this.cheats.push({name:t,sequence:e,method:i,index:0})},_listenInput:function(){var t,e,i,n,r;for(r=[],i=0,n=(e=["Up","Down","Left","Right","Fire"]).length;i<n;i++)t=e[i],r.push(function(t){return function(e){return t.bind(e,(function(){var i,n,r,o,s;for(s=[],n=0,r=(o=t.cheats).length;n<r;n++)(i=o[n]).sequence[i.index]===e?(i.index+=1,i.index===i.sequence.length?s.push(i.method()):s.push(void 0)):s.push(i.index=0);return s}))}}(this)(t));return r}}),t.c("Freddy",{init:function(){return this.requires("2D, WebGL, freddie, Scalable, ColorEffects, Collision")},remove:function(){return this.unbind("GameLoop",this._move)},freddy:function(i){var r,o,s;return this.ship=i.protect,this.ship.scoreText("Help me Freddie!"),"function"==typeof this.colorOverride&&this.colorOverride(this.ship.playerColor,"partial"),this.attr({scale:.5,z:this.ship.z+5}),r=Math.floor(this.w/2),o=Math.floor(this.h/2),15,15,this.collision([-15,-15,r,-30,this.w+15,-15,this.w+30,o,this.w+15,this.h+15,r,this.h+30,-15,this.h+15,-30,o]),this.ship.addComponent("Invincible").invincibleDuration(-1),this.attr({x:-100,y:.5*t.viewport.height}),this.circlePos=180,this.eaten=0,this.hFlash=0,this.shooting=0,this.ship.bind("Remove",(s=this,function(){return s.destroy()})),this.bind("GameLoop",this._move),this.onHit("Hostile",function(t){return function(i){var r,o,s,a,h,c,u,l,d;if(!e()){for(a=function(){var t,e,n;for(n=[],t=0,e=i.length;t<e;t++)r=i[t],n.push(r.obj[0]);return n}(),null==t.previousCols&&(t.previousCols=[]),u=function(){var t,e,i;for(i=[],t=0,e=a.length;t<e;t++)s=a[t],n.call(this.previousCols,s)<0&&i.push(s);return i}.call(t),t.previousCols=a,d=[],h=0,c=i.length;h<c;h++)l=(r=i[h]).obj[0],n.call(u,l)>=0&&((o=r.obj).hidden||o.invincible||(t.attr({hitFlash:{_red:255,_green:255,_blue:0}}),t.hFlash=5,null!=o.absorbDamage&&o.absorbDamage(500),o.has("Projectile")&&o.destroy(),t.eaten+=1,d.push(t.scale=Math.min(.5+.01*t.eaten,1))));return d}}}(this),function(t){return function(){return t.previousCols=[]}}(this))},_move:function(e){var i,n,r,o,s,a,h,c,u;if(n=8e3,h=this.ship._targetSpeed.x+300,80,55,a=360/(n-=Math.min(800*t("Enemy").length,n-1e3))*e.dt,this.circlePos=(this.circlePos+a+360)%360,s=.0174532925*this.circlePos,c=this.ship.x+10+Math.floor(this.ship.w/2)-Math.floor(this.w/2)+80*Math.cos(s),u=this.ship.y+Math.floor(this.ship.h/2)-Math.floor(this.h/2)+55*Math.sin(s),r=h*(e.dt/1e3),this.hFlash>0&&(this.hFlash-=1,0===this.hFlash&&this.attr({hitFlash:!1})),this.eaten>50&&t("Enemy").length>0){if(this.shooting+=1,this.shooting%5==0)for(i=o=0;o<360;i=o+=30)t.e("Bullet").attr({w:8,h:8,x:this.x+Math.floor(this.w/2),y:this.y+Math.floor(this.h/2),z:1,rotation:i}).fire({origin:this,speed:this.ship._currentSpeed.x+400,damage:400,direction:i});this.shooting>200&&(this.eaten=0,this.scale=.5,this.shooting=0)}return this.x>c?this.x-=Math.min(r,this.x-c):this.x+=Math.min(r,c-this.x),this.y>u?this.y-=Math.min(r,this.y-u):this.y+=Math.min(r,u-this.y)}})}).call(this,i(0).default)},function(t,e,i){(function(t){t.c("OldWeaponLaser",{init:function(){return this.requires("2D,WebGL,Color"),this.color("#808080"),this.attr({w:30,h:5})},remove:function(){},install:function(t){return this.ship=t,this.xp=0,this.level=this.determineLevel(this.xp),this.attr({x:this.ship.x+10,y:this.ship.y+15,z:this.ship.z+1,alpha:0}),this.ship.attach(this)},uninstall:function(){return this.attr({alpha:0})},addXP:function(t){var e;if(this.xp+=t,e=this.level,this.level=this.determineLevel(this.xp),e!==this.level)return this.trigger("levelUp",this.level)},determineLevel:function(t){var e,i,n,r,o,s;for(o=0,n=0,e=0,i=(r=[1e3,3e3,12e3,96e3]).length;e<i;e++)t>=(o+=r[e])&&(n+=1);return(t-(null!=(s=r[n-1])?s:0))/r[n],n},shoot:function(e){var i,n;if(e)return i=function(){switch(this.level){case 0:return{w:4,speed:270,h:4};case 1:case 2:case 3:return{w:8,speed:320,h:6};case 4:return{w:10,speed:320,h:6}}}.call(this),t.e("Bullet").attr({x:this.x+this.w,y:this.y+this.h/2-i.h/2,w:i.w,h:i.h}).fire({origin:this,damage:100,speed:this.ship._currentSpeed.x+i.speed,direction:0}).bind("HitTarget",(n=this,function(t){return n.addXP(1),n.ship.trigger("BulletHit",t)})).bind("DestroyTarget",function(t){return function(e){return t.addXP(5),t.ship.trigger("BulletDestroyedTarget",e)}}(this))},_determineWeaponSettings:function(){}})}).call(this,i(0).default)},function(t,e,i){(function(t){t.c("RapidDiagonalLaser",{init:function(){return this.requires("2D,WebGL,Color"),this.color("#d08080"),this.attr({w:30,h:5}),this.xp=0,this.lastShot=0,this.shotsFired=0,this.burstCount=Infinity,this.frontFire=!0},remove:function(){return this.unbind("GameLoop",this._autoFire)},install:function(t){return this.ship=t,this.level=this.determineLevel(this.xp),this.attr({x:this.ship.x+20,y:this.ship.y+30,z:this.ship.z+1,alpha:0}),this.ship.attach(this),this.shooting=!1,this._determineCooldown(),this.bind("GameLoop",this._autoFire)},uninstall:function(){return this.attr({alpha:0}),this.unbind("GameLoop",this._autoFire)},addXP:function(t){var e;if(this.xp+=t,e=this.level,this.level=this.determineLevel(this.xp),e!==this.level)return this._determineCooldown(),this.trigger("levelUp",this.level)},_determineCooldown:function(){return this.cooldown=function(){switch(this.level){case 0:return 200;case 1:return 150;case 2:case 3:return 75}}.call(this)},determineLevel:function(t){var e,i,n,r,o,s;for(o=0,n=0,e=0,i=(r=[1500,6e3,24e3,96e3]).length;e<i;e++)t>=(o+=r[e])&&(n+=1);return(t-(null!=(s=r[n-1])?s:0))/r[n],n},shoot:function(t){return t?this.shooting=!0:(this.shooting=!1,this.shotsFired=0,this.lastShot=500)},_autoFire:function(e){var i,n,r,o;if(this.lastShot+=e.dt,this.shooting&&(i=this.shotsFired<this.burstCount,this.ship.weaponsEnabled&&i))return this.lastShot>this.cooldown?(n=function(){switch(this.level){case 0:return 5;case 1:return 7;case 2:case 3:return 12}}.call(this),o=this.shotsFired%2==0?1:-1,r=1.5*Math.random(),this._createAngleBullet(0+r*o),r=1.5*Math.random(),this._createAngleBullet(n+r*o),r=1.5*Math.random(),this._createAngleBullet(r*o-n),t.audio.play("shoot",1,.1),this.frontFire=!this.frontFire,this.lastShot=0,this.shotsFired+=1):void 0},_createAngleBullet:function(e){var i,n;return i=function(){switch(this.level){case 0:return{w:5,speed:550,h:5};case 1:return{w:6,speed:555,h:5};case 2:return{w:8,speed:560,h:5};case 3:return{w:10,speed:565,h:5}}}.call(this),t.e("Bullet").attr({x:this.x+this.w,y:this.y+this.h/2-i.h/2+1,w:i.w,h:i.h,rotation:e}).fire({origin:this,damage:100,speed:this.ship._currentSpeed.x+i.speed,direction:e}).bind("HitTarget",(n=this,function(t){return n.addXP(1),n.ship.trigger("BulletHit",t)})).bind("DestroyTarget",function(t){return function(e){return t.addXP(5),t.ship.trigger("BulletDestroyedTarget",e)}}(this))}})}).call(this,i(0).default)},function(t,e,i){(function(t){var e;e=i(51).default,t.c("RapidWeaponLaser",{init:function(){return this.requires("2D,WebGL,muzzleFlash,ColorEffects"),this.attr({w:40,h:24}),this.stats={rapid:5,damage:0,aim:0,speed:5},this.boosts={},this.boostTimings={},this.lastShot=0,this.shotsFired=0,this.burstCount=Infinity,this.frontFire=!0},remove:function(){return this.bulletPool.clean(),this.unbind("GameLoop",this._autoFire)},install:function(i){var n,r,o,s,a,h,c,u;for(this.ship=i,r={},n={_red:255,_green:255,_blue:255},t.assignColor(this.ship.playerColor,r),s=0,a=(c=["_red","_green","_blue"]).length;s<a;s++)h=(r[o=c[s]]+n[o]+n[o])/3,r[o]=h;return this.colorOverride(r),this.attr({x:this.ship.x+38,y:this.ship.y+19,z:this.ship.z+1,alpha:0}),this.ship.attach(this),this.shooting=!1,this._determineWeaponSettings(),this.bulletPool=e((u=this,function(){return t.e("Bullet").bullet({ship:u.ship}).bind("BulletWall",(function(t){return u.bulletPool.recycle(t)})).bind("BulletMiss",(function(t){return u.bulletPool.recycle(t)})).bind("BulletHit",(function(t){return u.bulletPool.recycle(t)}))}),20),this.bind("GameLoop",this._autoFire)},uninstall:function(){return this.attr({alpha:0}),this.unbind("GameLoop",this._autoFire)},upgrade:function(t){return this.stats[t]+=1,this._determineWeaponSettings(),this.trigger("levelUp",{aspect:t,level:this.stats[t]})},boost:function(t){return this.boosts[t]=10,this.boostTimings[t]=15e3,this._determineWeaponSettings(),this.trigger("boost",{aspect:t})},_determineWeaponSettings:function(){var t,e,i;return this.cooldown=135-7*(this.boosts.rapidb||this.stats.rapid),this.damage=100+50*(this.boosts.damageb||this.stats.damage),this.aimAngle=0+6*(this.boosts.aimb||this.stats.aim),this.aimDistance=Math.min(40+50*(this.boosts.aimb||this.stats.aim),500),this.speed=750+70*(this.boosts.speedb||this.stats.speed),e=function(){var e,n;for(t in n=[],e=this.stats)i=e[t],"damage"!==t&&n.push(i);return n}.call(this),this.overallLevel=Math.min.apply(Math,e)},shoot:function(t){return t?this.shooting=!0:(this.shooting=!1,this._clearPicked(),this.shotsFired=0,this.lastShot=500)},_autoFire:function(e){var i,n,r,o;for(n in this.lastShot+=e.dt,r=this.boostTimings)o=r[n],this.boostTimings[n]-=e.dt,o<0&&(delete this.boostTimings[n],delete this.boosts[n],this._determineWeaponSettings(),this.trigger("boostExpired",{aspect:n}));if(this.lastShot>=20&&this.attr({alpha:.8}),this.lastShot>=50&&this.attr({alpha:.6}),this.lastShot>=80&&this.attr({alpha:0}),this.shooting&&(i=this.shotsFired<this.burstCount,this.ship.weaponsEnabled&&i))return this.lastShot>this.cooldown?(this.frontFire?(this._createFrontBullet(),this.attr({alpha:1})):this._createBackBullet(),t.audio.play("shoot",1,.05),this.frontFire=!this.frontFire,this.lastShot=0,this.shotsFired+=1):void 0},_createFrontBullet:function(){var t,e;return t={w:Math.floor(this.speed/30),speed:this.speed,h:6+this.overallLevel,o:this.overallLevel},e={x:this.x+this.w,y:this.y+this.h/2-t.h/2+5+t.o},this.bulletPool.get().attr({w:t.w,h:t.h,x:e.x,y:e.y,z:1}).updateCollision(t.w,t.h).fire({damage:this.damage,speed:this.ship._currentSpeed.x+t.speed,direction:this._bulletDirection(e)})},_createBackBullet:function(){var t,e;return t={w:Math.floor(this.speed/40),speed:this.speed,h:4+this.overallLevel,o:this.overallLevel},e={x:this.x+this.w,y:this.y+this.h/2-t.h/2-5-t.o},this.bulletPool.get().attr({w:t.w,h:t.h,x:e.x,y:e.y,z:-1}).updateCollision(t.w,t.h).fire({damage:this.damage,speed:this.ship._currentSpeed.x+t.speed,direction:this._bulletDirection(e)})},_bulletDirection:function(t){var e,i,n,r,o,s;return(o=this._targetEnemy(t))?(s=Math.sqrt(Math.pow(Math.abs(t.x-o.x),2)+Math.pow(Math.abs(t.y-o.y),2))/(this.speed+this.ship._currentSpeed.x),r={x:o.x+Math.floor(o.w/2)+o.vx*s,y:o.y+Math.floor(o.h/2)+o.vy*s},i=Math.atan2(r.y-t.y,r.x-t.x),i*=180/Math.PI,-this.aimAngle<i&&i<this.aimAngle?(null==this.currentShot&&(this.currentShot=0),e=2,(n=Math.abs(this.currentShot-i))>10&&(e=4),n>15&&(e=8),n>40&&(e=25),n>90&&(e=50),this.currentShot<i?this.currentShot+=e:this.currentShot-=e,this.currentShot):(this._clearPicked(),this.currentShot=0,0)):(this._clearPicked(),this.currentShot=0,0)},_targetEnemy:function(e){var i,n,r,o,s,a,h,c;if(this.pickedEntity)return this.pickedEntity;for(a=[],t("Enemy").each((function(){if(!this.hidden)return a.push({x:this.x,y:this.y+this.h/2,e:this})})),this.pickedEntity=null,h=Infinity,r=0,s=a.length;r<s;r++)o=a[r],i=Math.atan2(o.y-e.y,o.x-e.x),i*=180/Math.PI,n=Math.abs(e.x-o.x)+Math.abs(e.y-o.y),-this.aimAngle<i&&i<this.aimAngle&&n<h&&(h=n,this.pickedEntity=o.e);return this.pickedEntity&&(this.pickedEntity.one("Remove",(c=this,function(){return c._clearPicked()})),this.pickedEntity.one("Hiding",function(t){return function(){return t._clearPicked()}}(this))),this.pickedEntity},_clearPicked:function(){return this.pickedEntity&&(this.pickedEntity.unbind("Remove",this._clearPicked),this.pickedEntity.unbind("Hiding",this._clearPicked)),this.pickedEntity=null}})}).call(this,i(0).default)},function(t,e,i){(function(t){t.c("Sphere",{init:function(){return this.requires("2D, WebGL, sphere1, SpriteAnimation, Collision"),this.crop(0,0,17,17),this.collision([5,5,12,5,12,12,5,12]),this.attr({w:18,h:18,speed:300}),this.reel("blink",150,[[7,3,1,1],[8,3,1,1]])},blink:function(){return this.animate("blink",-1),this},muzzle:function(){return this.sprite(8,3),this}})}).call(this,i(0).default)},function(t,e,i){(function(t){t.c("WeaponLaser",{init:function(){return this.requires("2D,WebGL,Color"),this.color("#808080"),this.attr({w:30,h:5})},remove:function(){},install:function(t){return this.ship=t,this.xp=0,this.level=this.determineLevel(this.xp),this.attr({x:this.ship.x+10,y:this.ship.y+15,z:this.ship.z+1}),this.ship.attach(this)},addXP:function(t){var e;if(this.xp+=t,e=this.level,this.level=this.determineLevel(this.xp),e!==this.level)return this.trigger("levelUp",this.level)},determineLevel:function(t){var e,i,n,r,o,s;for(o=0,n=0,e=0,i=(r=[150,600,2400,9600]).length;e<i;e++)t>=(o+=r[e])&&(n+=1);return(t-(null!=(s=r[n-1])?s:0))/r[n],n},shoot:function(e){var i,n;if(e)return i=function(){switch(this.level){case 0:return{w:6,speed:350,h:3};case 1:return{w:10,speed:355,h:4};case 2:return{w:14,speed:360,h:5};case 3:return{w:18,speed:365,h:5}}}.call(this),t.e("Bullet").attr({x:this.x+this.w,y:this.y+this.h/2-i.h/2,w:i.w,h:i.h}).fire({origin:this,damage:100,speed:this.ship._currentSpeed.x+i.speed,direction:0}).bind("HitTarget",(n=this,function(){return n.addXP(1),n.ship.trigger("BulletHit")})).bind("DestroyTarget",function(t){return function(){return t.addXP(5),t.ship.trigger("BulletDestroyedTarget")}}(this))}})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){i(7);var e=i(6);t.c("Aimable",{init(){this.aim=this.aim.bind(this),this.resetAim=this.resetAim.bind(this)},async aim({target:t,speed:i=100,easing:n=e.a}){if(!t)return;const r=[],o=this.aimParts||[];this.forEachPart((e,s)=>{const a=this.spriteOptions(s);if(o.includes(a.key)){const o=e._parent,s=[o.x+a.ro[0],o.y+a.ro[1]],h=[t.x+t.w/2,t.y+t.h/2],c=s[0]-h[0],u=s[1]-h[1],l=180*Math.atan2(u,c)/Math.PI;e.addComponent("TweenPromise");const d=Math.abs(e.rotation-l),f=1e3/i*d;r.push(e.tweenPromise({rotation:l},f,n))}}),await Promise.all(r)},async resetAim({speed:t=100,easing:i=e.a}={}){const n=[],r=this.aimParts||[];this.forEachPart((e,o)=>{const s=this.spriteOptions(o);if(r.includes(s.key)){e.addComponent("TweenPromise");const r=Math.abs(e.rotation),o=1e3/t*r;n.push(e.tweenPromise({rotation:0},o,i))}}),await Promise.all(n)}})}).call(this,i(0).default)},function(t,e,i){(function(t){t.c("BezierMove",{events:{GameLoop:"_moveBezierTick",Freeze:"remove"},remove(){this.bezierTimer.complete||this.trigger("BezierMoveEnd")},bezierMove(e,i){const n=i.speed||this.defaultSpeed,r=e.length/n*1e3;this.bezierTimer=new t.easing(r,i.easing||"linear"),this.bezierPath=e},_moveBezierTick(t){this.bezierTimer.complete||(this.bezierTimer.tick(t.dt),this._doMove(this.bezierTimer.value(),t),this.bezierTimer.complete&&this.trigger("BezierMoveEnd"))},_doMove(t,e){const i=this.bezierPath.get(t),n=i.x-this.x,r=i.y-this.y;if(this.updateMovementVisuals){const i=this.bezierPath.rotationAt(t);this.updateMovementVisuals(i,n,r,e.dt)}this.shift(n,r)}})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){i(7);t.c("BigText",{init(){this.requires("2D, Text, Tween, Delay, UILayerDOM")},bigText(e,i={}){i={color:"#EEEEEE",mode:"fadeIn",super:null,blink_amount:3,blink_speed:1e3,...i};const n={fadeIn:{enter:t=>new Promise(e=>{t[0].one("TweenEnd",e),t.forEach(t=>t.tween({alpha:1},3e3))}),wait:t=>new Promise(e=>t[0].delay(e,3e3,0)),leave:t=>new Promise(e=>{t[0].one("TweenEnd",e),t.forEach(t=>t.tween({viewportY:t.viewportY+100,alpha:0},1500))})},blink:{enter:t=>(t.forEach(t=>t.attr({alpha:1})),Promise.resolve()),wait:t=>new Promise(e=>t[0].delay(()=>t.forEach(t=>t.attr({alpha:(t.alpha+1)%2})),i.blink_speed,2*(i.blink_amount-1)+1,e)),leave:t=>(t.forEach(t=>t.attr({alpha:0})),Promise.resolve())}},r=[this];if(null!=i.super){const e=t.e("2D, Text, Tween, UILayerDOM").attr({w:t.viewport.width,z:1,alpha:0}).textAlign("center").text(i.super).attr({x:this.x,y:200,z:-1}).textColor(i.color).textFont({size:"16px",weight:"bold",family:"Press Start 2P"});r.push(e)}this.attr({w:t.viewport.width,z:1,alpha:0}).textAlign("center").text(e).attr({x:this.x,y:240,z:-1}).textColor(i.color).textFont({size:"30px",weight:"bold",family:"Press Start 2P"});const o=n[i.mode];return o.enter(r).then(()=>o.wait(r).then(()=>o.leave(r).then(()=>r.forEach(t=>t.destroy()))))}})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var e=i(153),n=i.n(e),r=i(154),o=i.n(r);t.defaultShader("Color",new t.WebGLShader(n.a,o.a,[{name:"aPosition",width:2},{name:"aOrientation",width:3},{name:"aLayer",width:2},{name:"aColor",width:4},{name:"aDesaturation",width:4},{name:"aGradient",width:2}],(function(t,e){const i=null!=e.desaturationColor?e.desaturationColor:{_red:0,_green:0,_blue:0};t.program.writeVector("aColor",e._red/255,e._green/255,e._blue/255,e._strength),t.program.writeVector("aDesaturation",i._red/255,i._green/255,i._blue/255,1);const n=null!=e.scale?e.scale:1,r=null!=e.topDesaturation?e.topDesaturation:0,o=null!=e.bottomDesaturation?e.bottomDesaturation:0;return t.program.writeVector("aGradient",r+1.15*(1-n),o+1.15*(1-n))})))}).call(this,i(0).default)},function(t,e,i){(function(t){t.c("HideBelow",{properties:{hideBelow:{set(t){this._hideBelow=t,this.trigger("Invalidate")},get(){return this._hideBelow},configurable:!0,enumerable:!0},_hideBelow:{writable:!0,enumerable:!1,configurable:!1}}})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){i(7);var e=i(4);const n=(t,e)=>t.forEachPart(t=>t.attr({hitFlash:!!e&&{_red:255,_green:255,_blue:255}})),r=["Bullet","Explosion"];t.c("DamageSupport",{init(){this.attr({health:0,vulnerable:!1}),this.allowDamage=this.allowDamage.bind(this),this.hasHealth=this.hasHealth.bind(this),this._onCollisonHit=this._onCollisonHit.bind(this),this._onCollisonHitOff=this._onCollisonHitOff.bind(this)},allowDamage({health:t}){this.attr({vulnerable:!0,health:t}),this.has("Composable")?(this.has("Collision")&&(this.bind("HitOn",this._onCollisonHit),this.bind("HitOff",this._onCollisonHitOff),this.checkHits(...r)),this.forEachPart(t=>{t.has("Collision")&&(t.bind("HitOn",this._onCollisonHit),t.bind("HitOff",this._onCollisonHitOff),t.checkHits(...r))})):(this.addComponent("Collision"),this.bind("HitOn",this._onCollisonHit),this.bind("HitOff",this._onCollisonHitOff),this.checkHits(...r))},stopDamage(){this.attr({vulnerable:!1}),n(this,!1),this.has("Composable")?(this.has("Collision")&&(this.unbind("HitOn",this._onCollisonHit),this.unbind("HitOff",this._onCollisonHitOff),this.ignoreHits(...r)),this.forEachPart(t=>{t.has("Collision")&&(t.unbind("HitOn",this._onCollisonHit),t.unbind("HitOff",this._onCollisonHitOff),t.ignoreHits(...r))})):this.ignoreHits(...r)},hasHealth(){return this.attr("health")>0},_onCollisonHit(t){Object(e.isPaused)()||this.hidden||t.forEach(t=>{const e=t.obj;this.vulnerable&&e.damage>0&&(n(this,!0),this.absorbDamage(e),e.damage=0,this.trigger("Hit",{entity:this,projectile:e})),e.has("Bullet")&&e.trigger("BulletHit",e)})},_onCollisonHitOff(){n(this,!1)},absorbDamage(t){this.health-=t.damage,this.health<=0&&this.stopDamage()}})}).call(this,i(0).default)},function(t,e,i){(function(t,e){t.c("DebugInfo",{init(){let i=0,n=0,r=0,o=0,s=0,a=0;this.requires("2D, Text, Tween, Delay, UILayerDOM"),this.attr({x:0,y:20,w:t.viewport.width-30,z:1}).textAlign("right").textColor("#FFFFFF").textFont({size:"6px",family:"Press Start 2P"}),this.bind("MeasureFrameTime",t=>{t>r&&(r=t),t>5&&s++,i=t}),this.bind("MeasureRenderTime",t=>{t>o&&(o=t),t>5&&a++,n=t});let h=0;this.bind("EnterFrame",c=>{let u=Math.floor(e.gameTime/1e3);u%10==0&&u>h&&(h=u,console.log(`T: ${u}s `+`RT: ${n}ms `+`SRT: ${o}ms (${a}) `+`FT: ${i}ms `+`SFT: ${r}ms (${s}) `+`E: ${t("*").length} `+`FPS: ${Math.round(1e3/c.dt)}`)),this.text(`T: ${u}s `+`RT: ${n}ms `+`SRT: ${o}ms (${a}) `+`FT: ${i}ms `+`SFT: ${r}ms (${s}) `+`E: ${t("*").length} `+`FPS: ${Math.round(1e3/c.dt)}`)})},capture(e){t.log(e,this.text())}})}).call(this,i(0).default,i(9).default)},function(t,e,i){"use strict";(function(t){i(7);var e=i(4);t.c("Enemy",{required:"2D, WebGL, Collision, Tween, Choreography, Hideable, Flipable, Scalable, SunBlock, Hostile",events:{HitOn:"_onCollisonHit",HitOff:"_onCollisonHitOff",HitFlash:"applyHitFlash"},init(){return this.attr({pointsOnHit:0,pointsOnDestroy:0,damage:2}),this.invincible=!1},_onCollisonHit(t){Object(e.isPaused)()||this.hidden||t.forEach(t=>{const e=t.obj;this.invincible||e.damage>0&&(!1!==this.juice&&this.trigger("HitFlash",!0),this.absorbDamage(e),e.damage=0,this.trigger("Hit",{entity:this,projectile:e})),e.has("Bullet")&&e.trigger("BulletHit",e)})},_onCollisonHitOff(){this.trigger("HitFlash",!1)},onExplosionHit(t){Object(e.isPaused)()||this.hidden||this.invincible||t.forEach(t=>{const e=t.obj;e.damage>0&&(this.trigger("Hit",{entity:this,projectile:e}),!1!==this.juice&&this.trigger("HitFlash",!0),this.absorbDamage(e),e.damage=0)})},applyHitFlash(t){t?this.attr({hitFlash:{_red:255,_green:255,_blue:255}}):this.attr({hitFlash:!1})},enemy(e={}){const i={projectile:"Bullet",pointsLocation:{x:this.w/2,y:this.h/2},...e};return this.reveal(),this.pointsLocation=i.pointsLocation,t.trigger("EnemySpawned",this),this.checkHits(i.projectile,"Explosion"),"function"==typeof this.updatedHealth&&this.updatedHealth(),this},absorbDamage(e){if(null===e)return;const i=this.x+this.pointsLocation.x,n=this.y+this.pointsLocation.y,r={pointsOnHit:this.pointsOnHit,pointsOnDestroy:this.pointsOnDestroy,location:{x:i,y:n}};this.health-=e.damage,"function"==typeof this.updatedHealth&&this.updatedHealth(),this.health<=0?(t.trigger("EnemyDestroyed",this),this.trigger("Destroyed",this),this.trigger("Cleanup",this),this.__frozen||this.destroy(),r.chainable=this.chainable,null!=e.ship&&e.ship.trigger("DestroyTarget",r),this.deathCause=e.ship):e.ship&&e.ship.trigger("HitTarget",r)}})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){i(7);t.c("GravitySupport",{init(){this.activateGravity=this.activateGravity.bind(this),this._onGravityCollisonHit=this._onGravityCollisonHit.bind(this)},activateGravity(){this.addComponent("Motion","Collision"),this.ay=900,this.bind("HitOn",this._onGravityCollisonHit),this.checkHits("GravitySolid","GravityLiquid")},_onGravityCollisonHit(t){let e="none",i=null;t.forEach(t=>{const n=t.obj;n.has("GravitySolid")&&(e="solid",i=n.y),n.has("GravityLiquid")&&(e="liquid",i=n.y)}),"solid"===e&&(this.vy>400?this.attr({vy:-this.vy/4}):this.attr({ay:0,ax:0,vx:0,vy:0})),"liquid"===e&&this.attr({ax:0,ay:0,vx:0,vy:this.vy/8,hideBelow:i+30})}})}).call(this,i(0).default)},function(t,e,i){(function(t){t.c("Invincible",{init(){this.requires("Delay"),this.blinkOn=!0},_blink(){this.blinkOn=!this.blinkOn,this.alpha=this.blinkOn?.5:1},remove(){this.cancelDelay(this._blink),this.alpha=1},invincibleDuration(t){return this.delay(this._blink,250,-1),-1!==t&&this.delay(()=>this.removeComponent("Invincible"),t,0),this}})}).call(this,i(0).default)},function(t,e,i){(function(t){var e,n,r;e=i(411).Noise,n=i(11).lookup,r=new e(n()),t.c("ScrollWall",{init:function(){return this.requires("2D, ShipSolid, Collision, Acceleration"),this.trauma=0,this.time=0,this.attr({x:0,y:0,w:2,h:t.viewport.height,speed:{x:0,y:0},viewHeight:0}),this.wallEnd=t.e("2D, ScrollFront, ShipSolid").attr({x:-(t.viewport.x-t.viewport.width)-3,y:0,h:t.viewport.height,w:12}),this.attach(this.wallEnd),this.wallTop=t.e("2D, ShipSolid, Collision").attr({x:0,y:40,h:2,w:t.viewport.width}),this.attach(this.wallTop),this.wallBottom=t.e("2D, ShipSolid, Collision").attr({x:0,y:t.viewport.height-2,h:2,w:t.viewport.width}),this.attach(this.wallBottom),this.bind("GameLoop",(function(e){var i,n,o,s,a,h,c,u,l;return s=this._currentSpeed.x,a=this._currentSpeed.y,this.updateAcceleration(),o=Math.pow(this.trauma,2),this.trauma=Math.max(0,this.trauma-.001*e.dt),h=0,u=0,o>0&&(50,40,this.time+=e.dt,c=r.perlin2(.1,this.time/(360*(3-this.trauma))),l=r.perlin2(this.time/(360*(3-this.trauma)),.3),h=0+Math.round(50*o*c),u=0+Math.round(40*o*l)),t.viewport.x=h,t.viewport.y=u,i=s/1e3*e.dt,n=a/1e3*e.dt,this.viewHeight+=n,t.trigger("CameraMove",{dx:i,dy:n})}))},addTrauma:function(t){return this.trauma=Math.min(1,this.trauma+t)},scrollWall:function(t,e){return null==e&&(e={}),this.targetSpeed(t,e)},setAllowPushing:function(t){this.allowPushing=t},off:function(){return this.wallEnd.removeComponent("ShipSolid"),this.unbind("GameLoop")},remove:function(){return this.unbind("GameLoop")}})}).call(this,i(0).default)},function(t,e,i){!function(t){function e(t){function e(t,e,i){this.x=t,this.y=e,this.z=i}e.prototype.dot2=function(t,e){return this.x*t+this.y*e},e.prototype.dot3=function(t,e,i){return this.x*t+this.y*e+this.z*i},this.grad3=[new e(1,1,0),new e(-1,1,0),new e(1,-1,0),new e(-1,-1,0),new e(1,0,1),new e(-1,0,1),new e(1,0,-1),new e(-1,0,-1),new e(0,1,1),new e(0,-1,1),new e(0,1,-1),new e(0,-1,-1)],this.p=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],this.perm=new Array(512),this.gradP=new Array(512),this.seed(t||0)}e.prototype.seed=function(t){t>0&&t<1&&(t*=65536),(t=Math.floor(t))<256&&(t|=t<<8);for(var e=this.p,i=0;i<256;i++){var n;n=1&i?e[i]^255&t:e[i]^t>>8&255;var r=this.perm,o=this.gradP;r[i]=r[i+256]=n,o[i]=o[i+256]=this.grad3[n%12]}};var i=.5*(Math.sqrt(3)-1),n=(3-Math.sqrt(3))/6,r=1/6;function o(t){return t*t*t*(t*(6*t-15)+10)}function s(t,e,i){return(1-i)*t+i*e}e.prototype.simplex2=function(t,e){var r,o,s=(t+e)*i,a=Math.floor(t+s),h=Math.floor(e+s),c=(a+h)*n,u=t-a+c,l=e-h+c;u>l?(r=1,o=0):(r=0,o=1);var d=u-r+n,f=l-o+n,p=u-1+2*n,y=l-1+2*n;a&=255,h&=255;var v=this.perm,g=this.gradP,_=g[a+v[h]],m=g[a+r+v[h+o]],b=g[a+1+v[h+1]],x=.5-u*u-l*l,w=.5-d*d-f*f,C=.5-p*p-y*y;return 70*((x<0?0:(x*=x)*x*_.dot2(u,l))+(w<0?0:(w*=w)*w*m.dot2(d,f))+(C<0?0:(C*=C)*C*b.dot2(p,y)))},e.prototype.simplex3=function(t,e,i){var n,o,s,a,h,c,u=(t+e+i)*(1/3),l=Math.floor(t+u),d=Math.floor(e+u),f=Math.floor(i+u),p=(l+d+f)*r,y=t-l+p,v=e-d+p,g=i-f+p;y>=v?v>=g?(n=1,o=0,s=0,a=1,h=1,c=0):y>=g?(n=1,o=0,s=0,a=1,h=0,c=1):(n=0,o=0,s=1,a=1,h=0,c=1):v<g?(n=0,o=0,s=1,a=0,h=1,c=1):y<g?(n=0,o=1,s=0,a=0,h=1,c=1):(n=0,o=1,s=0,a=1,h=1,c=0);var _=y-n+r,m=v-o+r,b=g-s+r,x=y-a+2*r,w=v-h+2*r,C=g-c+2*r,S=y-1+.5,D=v-1+.5,k=g-1+.5;l&=255,d&=255,f&=255;var P=this.perm,T=this.gradP,E=T[l+P[d+P[f]]],M=T[l+n+P[d+o+P[f+s]]],B=T[l+a+P[d+h+P[f+c]]],O=T[l+1+P[d+1+P[f+1]]],z=.5-y*y-v*v-g*g,A=.5-_*_-m*m-b*b,j=.5-x*x-w*w-C*C,L=.5-S*S-D*D-k*k;return 32*((z<0?0:(z*=z)*z*E.dot3(y,v,g))+(A<0?0:(A*=A)*A*M.dot3(_,m,b))+(j<0?0:(j*=j)*j*B.dot3(x,w,C))+(L<0?0:(L*=L)*L*O.dot3(S,D,k)))},e.prototype.perlin2=function(t,e){var i=Math.floor(t),n=Math.floor(e);t-=i,e-=n,i&=255,n&=255;var r=this.perm,a=this.gradP,h=a[i+r[n]].dot2(t,e),c=a[i+r[n+1]].dot2(t,e-1),u=a[i+1+r[n]].dot2(t-1,e),l=a[i+1+r[n+1]].dot2(t-1,e-1),d=o(t);return s(s(h,u,d),s(c,l,d),o(e))},e.prototype.perlin3=function(t,e,i){var n=Math.floor(t),r=Math.floor(e),a=Math.floor(i);t-=n,e-=r,i-=a,n&=255,r&=255,a&=255;var h=this.perm,c=this.gradP,u=c[n+h[r+h[a]]].dot3(t,e,i),l=c[n+h[r+h[a+1]]].dot3(t,e,i-1),d=c[n+h[r+1+h[a]]].dot3(t,e-1,i),f=c[n+h[r+1+h[a+1]]].dot3(t,e-1,i-1),p=c[n+1+h[r+h[a]]].dot3(t-1,e,i),y=c[n+1+h[r+h[a+1]]].dot3(t-1,e,i-1),v=c[n+1+h[r+1+h[a]]].dot3(t-1,e-1,i),g=c[n+1+h[r+1+h[a+1]]].dot3(t-1,e-1,i-1),_=o(t),m=o(e),b=o(i);return s(s(s(u,p,_),s(l,y,_),b),s(s(d,v,_),s(f,g,_),b),m)},t.Noise=e}(t.exports)},function(t,e,i){(function(t){var e;e=i(19).setGameSpeed,t.c("ShipSpawnable",{init:function(){return this.requires("Listener"),this.bind("Activated",this.spawnShip)},remove:function(){return this.unbind("Activated",this.spawnShip)},spawnPosition:function(t){return this.spawnPosition=t,null==this.spawnPosition&&(this.spawnPosition=function(){return{x:x,y:y}}),this},spawnShip:function(i){var n,r,o,s;if(null==i&&(i={}),this.has("ControlScheme")&&this.lives>0)return(o=this.spawnPosition()).x<10&&(o.x=10),null!=this.ship&&(o={x:this.ship.x,y:this.ship.y},this.ship.destroy(),this.ship=null),s=this.shipType,this.ship=t.e(s).attr({x:o.x,y:o.y,z:this.z,playerNumber:this.playerNumber}),this.ship.playerColor=this.color(),"function"==typeof(n=this.ship).colorOverride&&n.colorOverride(this.color(),"partial"),this.has("Color")&&"function"==typeof(r=this.ship).color&&r.color(this.color()),this.ship.attr({healthPerc:this.health/this.maxHealth}),this.has("ControlScheme")&&this.assignControls(this.ship),this.listenTo(this.ship,"HitTarget",(function(t){var e,i;if(this.stats.shotsHit+=1,e=null!=(i=t.pointsOnHit)?i:0,null!=t)return this.addPoints(e,t.location)})),this.listenTo(this.ship,"DestroyTarget",(function(t){var e,i,n;if(this.stats.enemiesKilled+=1,e=(null!=(i=t.pointsOnDestroy)?i:0)+(null!=(n=t.pointsOnHit)?n:0),null!=t&&this.addPoints(e,t.location),t.chainable)return this.addChainXP(e)})),this.listenTo(this.ship,"BonusPoints",(function(t){return this.addPoints(t.points,t.location)})),this.listenTo(this.ship,"PowerUp",(function(t){var e;return"ship"!==(e=t.type)&&"shipBoost"!==e&&"shipUpgrade"!==e||("life"===t.contains&&this.gainLife(),"healthu"===t.contains&&this.healthUpgrade(),"healthb"===t.contains&&this.healthBoost(),"points"===t.contains&&this.addPoints(500)),this.addPoints(20),this.ship.attr({healthPerc:this.health/this.maxHealth})})),this.listenTo(this.ship,"Shoot",(function(){return this.stats.shotsFired+=1})),this.trigger("ShipSpawned",this.ship),t.trigger("ShipSpawned",this.ship),this.ship.stats(i),this.ship.start(),this.listenTo(this.ship,"Hit",(function(t){if(this.loseHealth(t.damage),this.ship.attr({healthPerc:this.health/this.maxHealth}),this.health<0)return this.ship.trigger("Die")})),this.listenTo(this.ship,"Destroyed",(function(){return this.ship.destroy(),i=this.ship.stats(),this.ship=null,e(.3),t.e("Delay, TimeManager").delay((function(){return e(.2)}),500,0).delay((function(){return e(.4)}),1e3,0).delay((function(){return e(.7)}),1400,0).delay((n=this,function(){return n.loseLife(),e(1),n.spawnShip(i)}),1800,0,(function(){return this.destroy()}));var n})),this}})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t,e){var n=i(157),r=i.n(n),o=i(158),s=i.n(o);const a=t=>{if(t._parent){const e=[];if(t.hideBelow){const i=t._parent.y+t.hideBelow;e.push(i)}return e.concat(a(t._parent))}return t.hideBelow?[t.hideBelow]:[]};t.defaultShader("Sprite",new t.WebGLShader(r.a,s.a,[{name:"aPosition",width:2},{name:"aOrientation",width:3},{name:"aLayer",width:2},{name:"aTextureCoord",width:2},{name:"aColor",width:4},{name:"aOverrideColor",width:4},{name:"aGradient",width:4},{name:"aSpriteDimensions",width:4}],(function(t,i){let n;const{co:r}=t;t.program.writeVector("aTextureCoord",r.x,r.y,r.x,r.y+r.h,r.x+r.w,r.y,r.x+r.w,r.y+r.h),t.program.writeVector("aSpriteDimensions",r.x,r.y,r.w,r.h);const o=null!=i.desaturationColor?i.desaturationColor:{_red:0,_green:0,_blue:0};let s=null!=i.overrideColor?i.overrideColor:{_red:0,_green:0,_blue:0},h=null!=i.lightness?i.lightness:1;n=i.hidden&&null!=i.scale?i.scale:1;const c=null!=i.blur?i.blur:0;let u=(null!=i.topDesaturation?i.topDesaturation:0)+1.15*(1-n),l=(null!=i.bottomDesaturation?i.bottomDesaturation:0)+1.15*(1-n);i.hitFlash&&(s=i.hitFlash,u=0,l=0),!1===e.webGLMode&&(u=0,l=0,i.has("cloud")&&(h=1)),t.program.writeVector("aColor",o._red/255,o._green/255,o._blue/255,h);let d=0;null!=i.overrideColor&&(d=1),"partial"===i.overrideColorMode&&(d=2),i.hitFlash&&(d=3),t.program.writeVector("aOverrideColor",s._red/255,s._green/255,s._blue/255,d);let f=-1;i.hideAt&&(f=Math.max(0,r.y+(i.hideAt-i.y)/i.h*r.h));const p=(t=>{const e=a(t);return 0===e.length?null:Math.min(...e)})(i);null!==p&&(f=Math.max(0,r.y+(p-i.y)/i.h*r.h)),t.program.writeVector("aGradient",u,l,c,f)})))}).call(this,i(0).default,i(9).default)},function(t,e,i){(function(t,e){t.c("TextInput",{init:function(){return this.requires("2D, DOM, Text")},remove:function(){},textInput:function(i,n){var r,o,s;return this.defer=e.defer(),o="A  ",r=0,this.text(o),i.bind("Up",(s=this,function(){return o=s._updateText(o,r,1),s.text(o)})),i.bind("Down",function(t){return function(){return o=t._updateText(o,r,-1),t.text(o)}}(this)),i.bind("Left",function(t){return function(){return r=Math.max(r-1,0),t._updateCursor(r)}}(this)),i.bind("Right",function(t){return function(){return r=Math.min(r+1,n-1),t._updateCursor(r)}}(this)),i.bind("Fire",function(t){return function(){var e;if(e=r,r=Math.min(r+1,n-1),t._updateCursor(r),r===e&&r===n-1)return i.unbind("Up"),i.unbind("Down"),i.unbind("Left"),i.unbind("Right"),i.unbind("Fire"),t.defer.resolve(o)}}(this)),this.cursor=t.e("2D, DOM, Text").attr({x:this.x,y:this.y,w:this.w}).text("_  ").textColor("#0000FF").textAlign("left").textFont({size:"20px",weight:"bold",family:"Press Start 2P"}),this.attach(this.cursor),this.defer.promise},_updateCursor:function(t){var e;return e=Array(t+1).join("&nbsp;")+"_",this.cursor.text(e)},_updateText:function(t,e,i){var n,r,o,s;return n="ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890-_.=!$& ",r=t[e],o=n.indexOf(r)+n.length,s=n[(o+i)%n.length],t.slice(0,e)+s+t.slice(e+1)}})}).call(this,i(0).default,i(12).default)},function(t,e,i){"use strict";i(416),i(428),i(436)},function(t,e,i){(function(t,e,n){var r,o,s,a,h,c,u,l,d=function(t,e){for(var i in e)f.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},f={}.hasOwnProperty;o=i(148).default,s=i(85),a=i(86),h=i(138),c=i(87),u=i(83),l=i(11).lookup,u.defineElement("cloud",(function(){var e,i,n,r,o,s,a;if(o=l(),4*l(),o>.2&&(a=20*l()+30,s=20*l()+125,n=10*l()+50,e=t.e("2D, WebGL, cloud, Hideable, Horizon").attr({z:-300,w:s,h:n,topDesaturation:.6,bottomDesaturation:.6,alpha:.8*l()+.2,lightness:.4}),l()<.7&&(e=e.flip("X")),this.addBackground(300+300*l(),a,e,.375)),o<.6)return a=230-150*(r=.2*l()+.15),s=10*l()+70-20*r,n=5*l()+20-10*r,i=t.e("2D, WebGL, cloud, Hideable, Horizon").attr({z:-570,w:s,h:n,topDesaturation:1-r,bottomDesaturation:1-r,alpha:.8*l()+.2,lightness:.4}),l()<.2&&(i=i.flip("X")),this.addBackground(360+300*l(),a,i,r)})),u.defineElement("waterHorizon",(function(){var i,n;return n=t.e("2D, WebGL, waterHorizon, SunBlock, Horizon, ColorEffects").attr({z:-600,w:257}).colorDesaturation(e.backgroundColor).saturationGradient(1,.2),!1===e.webGLMode&&n.attr({lightness:.6}),this.addBackground(0,this.level.visibleHeight-225,n,.25),i=t.e("2D, WebGL, Gradient, GoldenStripe").topColor("#DDDD00").bottomColor("#DDDD00",!1!==e.webGLMode?0:1).attr({z:-599,w:.25*this.delta.x,h:1,alpha:0}),this.addBackground(0,this.level.visibleHeight-225,i,.25)})),u.defineElement("water",(function(){var i;return i=t.e("2D, WebGL, waterMiddle, Horizon").crop(1,0,511,192).attr({z:-500,w:513}).colorDesaturation(e.backgroundColor).saturationGradient(.7,-.4),!1===e.webGLMode&&i.attr({lightness:.8}),this.addBackground(0,this.level.visibleHeight-150,i,.5),this.level.registerWaveTween("OceanWavesMiddle",5500,"easeInOutQuad",(function(e,i){return 5,20,192,t("waterMiddle").each((function(){return i?(this.dy=5*e,this.h=192-20*e):(this.dy=5-5*e,this.h=172+20*e)}))}))})),u.defineElement("waterFront",(function(){var e,i,n;return e=65,this.add(0,this.level.visibleHeight-45,t.e("2D, ShipSolid, BulletSolid, GravityLiquid").attr({w:this.delta.x,h:45})),i=t.e("2D, Delta2D, WebGL, waterFront1, Wave1").attr({z:-20}).crop(0,1,512,95),this.add(0,this.level.visibleHeight-e,i),n=t.e("2D, Delta2D, WebGL, waterFront2, Wave2"),i.attach(n),n.attr({z:-20,x:i.x+i.w,y:i.y}).crop(0,1,512,95),this.level.registerWaveTween("OceanWaves",6e3,"easeInOutQuad",(function(i,n){var r,o,s;return r=50,o=40,8,s=513,e=125,t("Wave1").each((function(){var t,a,h;return a=s+i*r,h=8*i,t=e-i*o,n||(a=s+r-i*r,h=8-8*i,t=e-o+i*o),a-this.w,this.attr({dy:h,w:a,h:t})})),t("Wave2").each((function(){var t,a,h;return n?(a=s-i*r,t=e-i*o):(a=s-r+i*r,t=e-o+i*o),h=s-a,this.attr({dx:h,w:a,h:t})})),t("WaveFront").each((function(){var t,a,h;return s=1200,r=120,e=200,o=80,n?(a=s+i*r,h=8*i,t=e-i*o):(a=s+r-i*r,h=8-8*i,t=e-o+i*o),this.shift(0,h-this.waveY,a-this.w,t-this.h),this.waveY=h}))}))})),u.defineElement("cityHorizon",(function(i){var n;return this.addElement("waterHorizon"),(n="start"===i?t.e("2D, WebGL, coastStart, SunBlock, Horizon"):t.e("2D, WebGL, coast, SunBlock, Horizon")).colorDesaturation(e.backgroundColor).saturationGradient(.9,.8).crop(1,0,255,32).attr({z:-598,w:256}),this.addBackground(0,this.level.visibleHeight-225-16,n,.25)})),u.defineElement("cityDistance",(function(i){var n;return n=t.e("2D, WebGL, cityDistance, SunBlock, Horizon").colorDesaturation(e.backgroundColor).saturationGradient(.9,.6).crop(1,1,255,223).attr({z:-598,w:256}),this.addBackground(0,this.level.visibleHeight-225-16,n,.25)})),u.defineElement("cityNoCollision",(function(){var i,n;return i=t.e("2D, WebGL, cityLayer2, Horizon, Flipable").attr({z:-505}).colorDesaturation(e.backgroundColor).saturationGradient(.6,.6),this.addBackground(0,this.level.visibleHeight-350,i,.375),n=t.e("2D, WebGL, city, Horizon").colorDesaturation(e.backgroundColor).saturationGradient(.4,.4).crop(0,0,511,288).attr({z:-305,w:513}),this.addBackground(0,this.level.visibleHeight-310,n,.5)})),u.defineElement("city",(function(){var i,n,r,o;return i=t.e("2D, WebGL, cityLayer2, Collision, SunBlock, Horizon, Flipable").attr({z:-505}).collision([4,29,72,29,72,118,4,118]).colorDesaturation(e.backgroundColor).saturationGradient(.6,.6),this.addBackground(0,this.level.visibleHeight-350,i,.375),(o=t.e("2D, WebGL, city, Collision, SunBlock, Horizon").colorDesaturation(e.backgroundColor).saturationGradient(.4,.4).crop(0,0,511,288).attr({z:-305,w:513})).collision([35,155,35,10,130,10,160,155]),(n=t.e("2D, Collision, SunBlock")).attr({w:o.w,h:o.h}),n.collision([190,155,170,80,210,10,280,10,280,155]),(r=t.e("2D, Collision, SunBlock")).attr({w:o.w,h:o.h}),r.collision([370,155,370,40,505,40,505,155]),this.addBackground(0,this.level.visibleHeight-310,o,.5),this.addBackground(0,this.level.visibleHeight-310,n,.5),this.addBackground(0,this.level.visibleHeight-310,r,.5)})),u.defineElement("cityFrontTop",(function(){var e,i,n,r,o;for(e=t.e("2D, WebGL, bigBuildingTop, RiggedExplosion").attr({z:-20}).crop(1,1,446,192),this.add(0,this.level.visibleHeight-1200,e),i=t.e("2D, SunBlock").attr({x:e.x+10,y:e.y+20,z:-10,h:650,w:e.w-45}),e.attach(i),r=o=0;o<3;r=++o)(n=t.e("2D, WebGL, bigBuildingLayer").attr({z:-20}).crop(1,0,446,128)).attr({x:e.x,y:e.y+e.h+r*n.h}),e.attach(n);return e.bind("BigExplosion",(function(){var e,i,n,r;if(!this.buildingExploded&&this.x+this.w>-t.viewport.x&&this.x<-t.viewport.x+t.viewport.width){for(t.e("2D, WebGL, glass, Tween").attr({x:this.x,y:this.y+40,z:this.z+5}).bind("TweenEnd",(function(){return this.destroy()})).tween({y:this.y+500},3e3,"easeInQuad"),t.e("2D, WebGL, glass, Tween").attr({x:this.x+200,y:this.y+60,z:this.z+5}).bind("TweenEnd",(function(){return this.destroy()})).tween({y:this.y+500},3e3,"easeInQuad"),t.e("2D, WebGL, glass, Tween").attr({x:this.x,y:this.y+180,z:this.z+5}).bind("TweenEnd",(function(){return this.destroy()})).tween({y:this.y+500},3e3,"easeInQuad"),t.e("2D, WebGL, glass, Tween").attr({x:this.x+180,y:this.y+200,z:this.z+5}).bind("TweenEnd",(function(){return this.destroy()})).tween({y:this.y+500},3e3,"easeInQuad"),this.sprite(30,13),i=0,n=(r=this._children).length;i<n;i++)(e=r[i]).has("bigBuildingLayer")&&e.sprite(30,19);return this.buildingExploded=!0}}))})),u.defineElement("cityFront",(function(e,i,n){var r,o,s,a,h,c,u;for(null==e&&(e=6),null==i&&(i=0),null==n&&(n="bigBuildingBottom"),(r=t.e("2D, WebGL, bigBuildingTop, Collision, SunBlock, ColorEffects").attr({z:-20}).crop(1,1,446,192)).colorOverride("#001fff","partial"),s=128*(e+2.5),r.collision([32,80,160,16,416,16,416,s,32,s]),this.add(i,this.level.visibleHeight-s-16,r),h=c=0,u=e;0<=u?c<u:c>u;h=0<=u?++c:--c)(a=t.e("2D, WebGL, bigBuildingLayer, ColorEffects").attr({z:-20}).crop(1,0,446,128)).attr({x:r.x,y:r.y+r.h+h*a.h}),r.attach(a);return(o=t.e("2D, WebGL, "+n+", ColorEffects").attr({z:-20}).crop(1,1,446,184)).attr({x:r.x,y:r.y+r.h+128*e}),r.attach(o)})),u.defineElement("cityFrontBlur",(function(){return this.addBackground(200,this.level.visibleHeight-1350,t.e("2D, WebGL, bigBuildingTop").crop(1,1,446,192).attr({w:768,h:288,z:50,lightness:.4}),1.5)})),u.defineElement("city-bridge",(function(){var i,n;return i=t.e("2D, WebGL, cityLayer2, Collision, SunBlock, Horizon").collision([4,29,72,29,72,118,4,118]).colorDesaturation(e.backgroundColor).saturationGradient(.6,.6).attr({z:-505}),this.addBackground(0,this.level.visibleHeight-350,i,.375),(n=t.e("2D, WebGL, cityBridge, Collision, Horizon").colorDesaturation(e.backgroundColor).saturationGradient(.4,.4).crop(0,0,511,160).attr({z:-305,w:513})).collision([35,155,35,0,130,0,130,155]),this.addBackground(0,this.level.visibleHeight-182,n,.5)})),u.defineElement("cityStart",(function(){var i;return(i=t.e("2D, WebGL, cityStart, Collision, SunBlock, Horizon").attr({z:-305}).colorDesaturation(e.backgroundColor).saturationGradient(.4,.4)).collision([215,155,215,60,300,60,300,10,500,10,500,155]),this.addBackground(0,this.level.visibleHeight-310,i,.5)})),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.assets=function(){var t;return{sprites:(t={},t[""+s]=a,t)}},e}(o),u.defineBlock(function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return d(i,e),i.prototype.name="City.Intro",i.prototype.delta={x:1024,y:0},i.prototype.autoNext="City.Ocean",i.prototype.generate=function(){var e,n,r,o;return i.__super__.generate.apply(this,arguments),this.addElement("waterFront"),o=t.e("2D, WebGL, WaterSplashes").attr({z:30,w:800,h:160,alpha:.3}).attr({waterRadius:8,minSplashDuration:1700,defaultWaterCooldown:800,waterSplashSpeed:700,minOffset:2,splashUpwards:!1}),this.add(0,this.level.visibleHeight-330+160,o),n=t.e("CarrierHatch"),this.add(260,this.level.visibleHeight-329+192,n),r=t.e("CarrierHatch"),this.add(60,this.level.visibleHeight-329+192,r),this.ship=t.e("2D, Composable").attr({z:-13}).compose(c.introShip),this.add(0,this.level.visibleHeight-116,this.ship),this.addElement("water"),this.addElement("waterHorizon"),e=t.e("2D, WebGL, waterFront1, WaveFront").attr({z:30,w:this.delta.x+.5*t.viewport.width+1,h:200,lightness:.5}).crop(0,1,512,95),this.addBackground(0,this.level.visibleHeight-18,e,1.25),e.waveY=0,this.addElement("cloud")},i.prototype.enter=function(){var e,n,r,o;return i.__super__.enter.apply(this,arguments),this.speed=this.level._forcedSpeed,this.level.panCamera({y:120},0),this.level.setForcedSpeed(0),n=[{type:"delay",duration:1e3},{type:"delay",duration:600,event:"openHatch"},{type:"linear",y:-80,duration:800,easingFn:"easeInOutQuad"},{event:"lift",type:"linear",x:70,y:-10,easingFn:"easeInQuad",duration:600},{type:"delay",duration:1,event:"unlock"},{type:"delay",duration:1,event:"go"}],e=this,o=null,r=function(t){if(o&&o.has("Choreography"))return t.attr({x:o.x-200,y:o.y,z:-8}),o.disableControls&&t.disableControl(),t.addComponent("Choreography"),t.synchChoreography(o),t.one("ChoreographyEnd",(function(){return this.removeComponent("Choreography",!1)})),t.one("unlock",(function(){return this.enableControl(),this.weaponsEnabled=!0})),t.weaponsEnabled=o.weaponsEnabled},this.bind("ShipSpawned",r),t("PlayerControlledShip").each((function(i){return 0!==i?r(this):(o=this,this.addComponent("Choreography"),this.attr({x:300-200*i,y:t.viewport.height-50-this.h,z:-8}),this.disableControl(),this.weaponsEnabled=!1,this.choreography(n),this.one("ChoreographyEnd",(s=this,function(){return s.removeComponent("Choreography","no"),e.unbind("ShipSpawned")})),this.one("unlock",(function(){return this.enableControl(),this.weaponsEnabled=!0})),this.one("openHatch",(function(){return t("CarrierHatch").each((function(){return this.open()}))})),this.one("lift",(function(){return e.ship.addComponent("ShipSolid","BulletSolid"),t("CarrierHatch").each((function(){return this.close()})),t("PlayerControlledShip").each((function(){return this.z=10*(this.playerNumber-1)})),e.level.panCamera({y:-120},2500)})),this.one("go",(function(){return e.level.setForcedSpeed(e.speed,{accelerate:!1})})));var s}))},i}(r)),u.defineBlock(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.name="City.Ocean",e.prototype.delta={x:1024,y:0},e.prototype.generate=function(){return e.__super__.generate.apply(this,arguments),this.addElement("cloud"),this.addElement("cloud"),this.addElement("waterHorizon"),this.addElement("water"),this.addElement("waterFront")},e}(r)),u.defineBlock(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.name="City.CoastStart",e.prototype.delta={x:1024,y:0},e.prototype.autoNext="City.Coast",e.prototype.autoPrevious="City.Ocean",e.prototype.generate=function(){return e.__super__.generate.apply(this,arguments),this.addElement("cloud"),this.addElement("cityHorizon","start"),this.addElement("water"),this.addElement("waterFront")},e}(r)),u.defineBlock(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.name="City.Coast",e.prototype.delta={x:1024,y:0},e.prototype.generate=function(){return e.__super__.generate.apply(this,arguments),this.addElement("waterFront"),this.addElement("cityHorizon"),this.addElement("water"),this.addElement("cloud")},e}(r)),u.defineBlock(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.name="City.BayStart",e.prototype.delta={x:1024,y:0},e.prototype.autoNext="City.Bay",e.prototype.autoPrevious="City.Coast",e.prototype.generate=function(){return e.__super__.generate.apply(this,arguments),this.addElement("cloud"),this.addElement("cityHorizon"),this.addElement("water"),this.addElement("waterFront"),this.addElement("cityStart")},e}(r)),u.defineBlock(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.name="City.Bay",e.prototype.delta={x:1024,y:0},e.prototype.generate=function(){return e.__super__.generate.apply(this,arguments),this.addElement("cloud"),this.addElement("waterFront"),this.addElement("water"),this.addElement("cityHorizon"),this.addElement("city")},e}(r)),u.defineBlock(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.name="City.BayFull",e.prototype.delta={x:1024,y:0},e.prototype.generate=function(){return e.__super__.generate.apply(this,arguments),this.addElement("cloud"),this.addElement("waterFront"),this.addElement("water"),this.addElement("cityDistance"),this.addElement("city")},e}(r)),u.defineBlock(function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return d(i,e),i.prototype.name="City.UnderBridge",i.prototype.delta={x:1024,y:0},i.prototype.autoNext="City.BayFull",i.prototype.generate=function(){var e,r,o,s;return i.__super__.generate.apply(this,arguments),this.notifyOffsetX=-100,this.addElement("waterFront",{lightness:.8}),this.addElement("water"),this.addElement("cityDistance"),this.addElement("city-bridge"),t.viewport.width,1.1*t.viewport.height,this.addBackground(0,335,this.deck(.55,!1,{w:550,z:-280}),.55),this.addBackground(0,295,this.deck(.45,!0,{w:600,z:-270}),.6),this.addBackground(0,255,this.deck(.35,!1,{w:650,z:-260}),.65),this.addBackground(40,290,this.pillar(.35,{h:200,z:-261}),.65),this.addBackground(870,290,this.pillarX(.35,{h:200,z:-261}),.65),this.addBackground(0,205,this.deck(.25,!0,{w:700,z:-50}),.7),this.addBackground(0,155,this.deck(.15,!1,{w:750,z:-40}),.75),this.addBackground(10,180,this.pillar(0,{h:350,z:-31}),.8),this.addBackground(830,180,this.pillarX(0,{h:350,z:-31}),.8),this.addBackground(0,95,this.deck(.05,!0,{w:800,z:-30}),.8),this.addBackground(0,20,this.deck(0,!1,{w:900,z:-20}).addComponent("BackDeck"),.9),r=t.e("2D, BulletSolid, ShipSolid, Collision, BridgeCeiling").attr({w:1e3,h:30}).origin("middle middle"),this.addBackground(0,-60,r,1),e=this.deck(0,!0,{w:1e3,z:-10}).addComponent("MainDeck"),this.addBackground(0,-60,e,1),this.addBackground(0,-180,this.deck(0,!1,{w:1200,z:100,lightness:.6,blur:0}).addComponent("FrontDeck"),1.2),o=this.pillar(0,{h:750,z:80,lightness:.6,blur:0}).addComponent("TiltPillarLeft"),s=this.pillarX(0,{h:750,z:80,lightness:.6,blur:0}).addComponent("TiltPillarRight"),this.addBackground(-20,-60,o,1.2),this.addBackground(834,-60,s,1.2),this.bind("BridgeDamage",{once:!0},(function(i){var n,a,h;return n=(h=function(e){var i;return(i=t(e)).get(i.length-1)})("FrontDeck").addComponent("TweenPromise","Delta2D").sprite(16,32),e=h("MainDeck").addComponent("TweenPromise","Delta2D").sprite(16,32),a=h("BackDeck").addComponent("TweenPromise","Delta2D").sprite(16,32),n.half.sprite(16,32),e.half.sprite(16,32),a.half.sprite(16,32),o=h("TiltPillarLeft").addComponent("TweenPromise","Delta2D").sprite(42,29),s=h("TiltPillarRight").addComponent("TweenPromise","Delta2D").sprite(42,29),r=h("BridgeCeiling").addComponent("TweenPromise","Delta2D")})),this.bind("BridgeCollapse",{once:!0},(function(i){var a,h,c;return a=(c=function(e){var i;return(i=t(e)).get(i.length-1)})("FrontDeck").addComponent("TweenPromise","Delta2D").sprite(16,32),e=c("MainDeck").addComponent("TweenPromise","Delta2D").sprite(16,32),h=c("BackDeck").addComponent("TweenPromise","Delta2D").sprite(16,32),a.half.sprite(16,32),e.half.sprite(16,32),h.half.sprite(16,32),o=c("TiltPillarLeft").addComponent("TweenPromise","Delta2D").sprite(42,29),s=c("TiltPillarRight").addComponent("TweenPromise","Delta2D").sprite(42,29),r=c("BridgeCeiling").addComponent("TweenPromise","Delta2D"),n.sequence([function(){return n.parallel([function(){return i.setForcedSpeed(75,{accelerate:!0})},function(){return a.tweenPromise({rotation:-12,dy:a.dy+100},4e3,"easeInQuad")},function(){return e.tweenPromise({rotation:-10,dy:e.dy+100},4e3,"easeInQuad")},function(){return r.tweenPromise({rotation:-10,dy:r.dy+100},4e3,"easeInQuad")},function(){return h.tweenPromise({rotation:-7,dy:h.dy+100},4e3,"easeInQuad")},function(){return o.tweenPromise({rotation:-7,dy:o.dy+100},3e3,"easeInQuad")},function(){return s.tweenPromise({rotation:7},3e3,"easeInQuad")}])},function(){return n.parallel([function(){return i.setForcedSpeed(300,{accelerate:!0})},function(){return a.tweenPromise({dy:a.dy+400},4e3,"easeInQuad")},function(){return e.tweenPromise({dy:e.dy+430},4e3,"easeInQuad")},function(){return r.tweenPromise({dy:r.dy+430},4e3,"easeInQuad")},function(){return h.tweenPromise({dy:h.dy+400},4e3,"easeInQuad")},function(){return o.tweenPromise({rotation:-27,dy:o.dy+300},3e3,"easeInQuad")},function(){return s.tweenPromise({rotation:27,dy:s.dy+200},3e3,"easeInQuad")}])}])}))},i.prototype.leave=function(){return i.__super__.leave.apply(this,arguments),this.unbind("BridgeDamage"),this.unbind("BridgeCollapse")},i.prototype.deck=function(e,i,n){var r,o,s;return 1024/180,n.h=n.w/(1024/180),r=i?"#2ba04c":"#b15a5a",s=t.e("2D, WebGL, bridgeDeck, Horizon, SunBlock, SpriteAnimation").crop(0,2,511,180).attr(h(n,{w:n.w/2})).saturationGradient(e,e).colorOverride(r,"partial"),(o=t.e("2D, WebGL, bridgeDeck, Horizon, SunBlock, SpriteAnimation").crop(0,2,511,180).saturationGradient(e,e).flip("X").colorOverride(r,"partial")).attr(h(n,{x:s.x+s.w,y:s.y,z:s.z,w:s.w,h:s.h})),s.half=o,s.attach(o),s.origin(s.h/2,2*s.w),s},i.prototype.pillar=function(e,i){return 180/534,i.w=i.h*(180/534),i.h=i.h,t.e("2D, WebGL, bridgePillar, Horizon, SunBlock").crop(2,0,180,534).attr(i).saturationGradient(e,e)},i.prototype.pillarX=function(t,e){return this.pillar(t,e).flip("X")},i}(r)),u.defineBlock(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.name="City.Skyline",e.prototype.delta={x:1024,y:0},e.prototype.generate=function(){return e.__super__.generate.apply(this,arguments),this.addElement("cityFrontTop"),this.addElement("cityFrontBlur"),this.addElement("cityDistance"),this.addElement("cityNoCollision")},e}(r)),u.defineBlock(function(i){function n(){return n.__super__.constructor.apply(this,arguments)}return d(n,i),n.prototype.name="City.SkylineBase",n.prototype.delta={x:1024,y:0},n.prototype.autoNext="City.Skyline2",n.prototype.generate=function(){var i,r,o;return n.__super__.generate.apply(this,arguments),this.addElement("cityFront"),o=600,i=t.e("2D, WebGL, cityDistanceBaseTop, SunBlock, Horizon").colorDesaturation(e.backgroundColor).saturationGradient(.9,.6).crop(1,1,255,223).attr({z:-598,w:256}),this.addBackground(0,this.level.visibleHeight-225-16-127,i,.25),r=t.e("2D, WebGL, cityDistanceBaseBottom, MiliBase, SunBlock, Horizon").colorDesaturation(e.backgroundColor).saturationGradient(.9,.6).crop(1,1,255,127).attr({z:-598,w:256}),this.addBackground(0,this.level.visibleHeight-225-16+96,r,.25),this.addElement("city"),o=700,this.add(0,this.level.visibleHeight-100,t.e("2D, WebGL, Color, SunBlock").attr({w:this.delta.x,h:o,z:-10}).color("#505050"))},n}(r)),u.defineBlock(function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return d(i,e),i.prototype.name="City.Skyline2",i.prototype.delta={x:1024,y:0},i.prototype.generate=function(){var e,n,r;return i.__super__.generate.apply(this,arguments),this.addElement("cityFront"),this.addElement("cityFront",4,512,"bigBuildingBottom2"),this.addElement("water"),this.addElement("cityDistance"),this.addElement("city"),e=160,this.add(0,this.level.visibleHeight-100,t.e("2D, WebGL, Color, SunBlock").attr({w:this.delta.x,h:e,z:-25}).color("#555")),n=10,this.add(0,this.level.visibleHeight-100+e,t.e("2D, WebGL, Color, SunBlock").attr({w:this.delta.x,h:n,z:-25}).color("#777")),r=400,this.add(0,this.level.visibleHeight-100+e+n,t.e("2D, WebGL, Color, SunBlock").attr({w:this.delta.x,h:r,z:-25}).color("#333")),r=40,this.add(0,this.level.visibleHeight+170-r,t.e("2D, ShipSolid, BulletSolid").attr({w:this.delta.x,h:r,z:2}))},i}(r)),u.defineBlock(function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return d(i,e),i.prototype.name="City.TrainTunnel",i.prototype.delta={x:1024,y:0},i.prototype.generate=function(){var e,n;return i.__super__.generate.apply(this,arguments),e=150,this.add(0,this.level.visibleHeight-100,t.e("2D, WebGL, Color, SunBlock, ShipSolid, BulletSolid").attr({w:this.delta.x,h:e,z:-10}).color("#505050")),n=400,this.add(0,this.level.visibleHeight-100+e,t.e("2D, WebGL, Color, SunBlock").attr({w:this.delta.x,h:n,z:-10}).color("#202020")),e=150,this.add(0,this.level.visibleHeight-100+e+n,t.e("2D, WebGL, Color, ShipSolid, BulletSolid, SunBlock").attr({w:this.delta.x,h:e+n,z:-10}).color("#505050"))},i}(o)),u.defineBlock(function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return d(i,e),i.prototype.name="City.SmallerTrainTunnel",i.prototype.delta={x:1024,y:0},i.prototype.generate=function(){var e,n,r;return i.__super__.generate.apply(this,arguments),e=250,this.add(0,this.level.visibleHeight-100,t.e("2D, WebGL, Color, SunBlock, ShipSolid, BulletSolid").attr({w:this.delta.x,h:e,z:-10}).color("#505050")),n=300,this.add(0,this.level.visibleHeight-100+e,t.e("2D, WebGL, Color, SunBlock").attr({w:this.delta.x,h:n,z:-10}).color("#202020")),r=350,this.add(0,this.level.visibleHeight-100+e+n,t.e("2D, WebGL, Color, ShipSolid, BulletSolid, SunBlock").attr({w:this.delta.x,h:r,z:-10}).color("#505050"))},i}(o))}).call(this,i(0).default,i(9).default,i(12).default)},function(t,e,i){var n=i(418),r=i(48),o=i(425),s=r((function(t,e){return o(t)?n(t,e):[]}));t.exports=s},function(t,e,i){var n=i(110),r=i(419),o=i(424),s=i(38),a=i(31),h=i(111),c=200;t.exports=function(t,e,i,u){var l=-1,d=r,f=!0,p=t.length,y=[],v=e.length;if(!p)return y;i&&(e=s(e,a(i))),u?(d=o,f=!1):e.length>=c&&(d=h,f=!1,e=new n(e));t:for(;++l<p;){var g=t[l],_=null==i?g:i(g);if(g=u||0!==g?g:0,f&&_==_){for(var m=v;m--;)if(e[m]===_)continue t;y.push(g)}else d(e,_,u)||y.push(g)}return y}},function(t,e,i){var n=i(420);t.exports=function(t,e){return!!(null==t?0:t.length)&&n(t,e,0)>-1}},function(t,e,i){var n=i(421),r=i(422),o=i(423);t.exports=function(t,e,i){return e==e?o(t,e,i):n(t,r,i)}},function(t,e){t.exports=function(t,e,i,n){for(var r=t.length,o=i+(n?1:-1);n?o--:++o<r;)if(e(t[o],o,t))return o;return-1}},function(t,e){t.exports=function(t){return t!=t}},function(t,e){t.exports=function(t,e,i){for(var n=i-1,r=t.length;++n<r;)if(t[n]===e)return n;return-1}},function(t,e){t.exports=function(t,e,i){for(var n=-1,r=null==t?0:t.length;++n<r;)if(i(e,t[n]))return!0;return!1}},function(t,e,i){var n=i(18),r=i(14);t.exports=function(t){return r(t)&&n(t)}},function(t,e,i){(function(e,n){var r,o,s,a,h=function(t,e){return function(){return t.apply(e,arguments)}},c=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};s=i(2),a=i(427),o=i(81),r=function(){function t(t,i){this.generator=t,this.data=null!=i?i:{},this._waveTicks=h(this._waveTicks,this),this.blocks=[],this.bufferLength=3*e.viewport.width,this.generationPosition={x:0,y:40},this.sceneryEvents=[],this.visibleHeight=e.viewport.height-this.generationPosition.y,this.shipType="PlayerSpaceship",this.currentScenery=this.data.startScenery}return t.prototype.setScenery=function(t){return this._loadAssetsForScenery(t).then((e=this,function(){return e.currentScenery=t,e._setupLevelScenery()}));var e},t.prototype._loadAssetsForScenery=function(t){var e,i,r;return i=t,(e=this.generator.buildingBlocks[i]).prototype.loadAssets().then((r=this,function(){var t,i,o;if(i=[],(o=e.prototype.autoPrevious)&&i.push((function(){return r._loadAssetsForScenery(o)})),(t=e.prototype.autoNext)&&i.push((function(){return r._loadAssetsForScenery(t)})),i.length>0)return n.sequence(i)}))},t.prototype.start=function(){var t;return this.active=!0,e.viewport.x=0,e.viewport.y=0,this._controlsEnabled=!0,this.setForcedSpeed(1),this.setWeaponsEnabled(!0),this._scrollWall=e.e("ScrollWall").attr({x:0,y:0}),this._playersActive=!1,e.bind("EnemySpawned",(t=this,function(){var e;return null==(e=t.data).enemiesSpawned&&(e.enemiesSpawned=0),t.data.enemiesSpawned+=1})),e.e("2D, UILayerDOM, Text, LevelTitle").attr({w:250,h:20}).attr({x:e.viewport.width-250,y:10,z:2}).textFont({size:"10px",family:"Press Start 2P"}).textColor("#A0A0A0").text(""),this._setupLevelScenery(),e.bind("PlayerDied",function(t){return function(){var i;if(i=!1,e("Player ControlScheme").each((function(){if(this.lives>0)return i=!0})),!i)return t.stop(),e.trigger("GameOver")}}(this)),e.bind("GameLoop",this._waveTicks)},t.prototype._waveTicks=function(t){var e,i,n,r;for(e in null==this._registeredWaveTweens&&(this._registeredWaveTweens={}),n=[],i=this._registeredWaveTweens)r=i[e],n.push(r.tick(t.dt));return n},t.prototype.registerWaveTween=function(t,i,n,r){var o;return null==this._registeredWaveTweens&&(this._registeredWaveTweens={}),null!=(o=this._registeredWaveTweens)[t]?o[t]:o[t]=new(function(){function t(t){var i,n;this.name=t.name,i=t.duration,n=t.easing,this.callback=t.callback,this.ease=new e.easing(i,n),this.ease.repeat(3)}return t.prototype.tick=function(t){var e,i;return this.ease.tick(t),i=this.ease.value(),1===this.ease.loops&&this.ease.repeat(3),e=this.ease.loops%2==1,this.callback(i,e)},t}())({name:t,duration:i,easing:n,callback:r})},t.prototype._setupLevelScenery=function(){var t,i,n,r;if(null!=this.currentScenery&&0===this.blocks.length){for(this._placePlayerShips(),this._seedPreceedingGeometry(),this._update(),i=0,n=(r=this.blocks).length;i<n;i++)(t=r[i]).x<640&&t.enter();var o;return e.bind("CameraMove",(o=this,function(t){var e,i;if(e=t.dx,i=t.dy,o.generationPosition.x-=e,o.generationPosition.y-=i,o.generationPosition.x<o.bufferLength)return o._update()})),e.uniqueBind("LeaveBlock",function(t){return function(e){var i;return(i=t.blocks.indexOf(e))>0&&t._handleSceneryEvents(t.blocks[i-1],"leave"),t._handleSceneryEvents(e,"inScreen"),t._cleanupBuildBlocks()}}(this)),e.uniqueBind("EnterBlock",function(t){return function(e){var i;return(i=t.blocks.indexOf(e))>0&&t._handleSceneryEvents(t.blocks[i-1],"outScreen"),t._handleSceneryEvents(e,"enter")}}(this)),e.uniqueBind("PlayerEnterBlock",function(t){return function(e){var i;return(i=t.blocks.indexOf(e))>0&&t._handleSceneryEvents(t.blocks[i-1],"playerLeave"),t._handleSceneryEvents(e,"playerEnter")}}(this))}},t.prototype._handleSceneryEvents=function(t,e){var i,n,r,o,s;if(null!=t){for(t[e](),s=[],r=n=(o=this.sceneryEvents).length-1;n>=0;r=n+=-1)i=o[r],t.name===i.sceneryType&&e===i.eventType?(i.callback.apply(this),s.push(this.sceneryEvents.splice(r,1))):s.push(void 0);return s}},t.prototype.notifyScenery=function(t,e,i){return this.sceneryEvents.push({eventType:t,sceneryType:e,callback:i})},t.prototype._placePlayerShips=function(){var t,i,n;return t={spawnPosition:{x:100,y:200},spawnOffset:{x:-50,y:0},title:""},i=s(this.data,t),e.one("ShipSpawned",(n=this,function(){return n._playersActive=!0,n._scrollWall.scrollWall(n._forcedSpeed)})),e("Player").each((function(t){var n;return n=function(){var t;return t=o(i.spawnPosition),e("PlayerControlledShip").each((function(){return t.x=this.x+i.spawnOffset.x+e.viewport.x,t.y=this.y+i.spawnOffset.y+e.viewport.y})),t},this.addComponent("ShipSpawnable").spawnPosition(n),e.e("PlayerInfo").playerInfo(30+t*(.3*e.viewport.width),this)})),e.bind("ShipSpawned",function(t){return function(e){var i,n,r,o,s,a;if(e.forcedSpeed(t._forcedSpeed,{accellerate:!1}),e.weaponsEnabled=t._weaponsEnabled[e.playerNumber],t._controlsEnabled||e.disableControl(),null!=t.playerStartWeapons){for(e.clearItems(),a=[],i=0,o=(s=t.playerStartWeapons).length;i<o;i++)n=s[i],r=t.inventory(n),a.push(e.installItem(r));return a}}}(this)),e("Player ControlScheme").each((function(){return this.spawnShip()}))},t.prototype.inventory=function(t){return this.invItems||(this.invItems={}),this.invItems[t]},t.prototype.inventoryAdd=function(t,e,i){var n;return this.invItems||(this.invItems={}),(n=this.invItems)[e]||(n[e]=s(i,{type:t,contains:e}))},t.prototype.getShipType=function(){return this.shipType},t.prototype.setShipType=function(t){return this.shipType=t,e("Player ControlScheme").each((function(){if(null!=this.ship)return this.spawnShip()}))},t.prototype.setForcedSpeed=function(t,i){var n,r;return i=s(i,{accellerate:!0}),this._forcedSpeed?(null!=(n=t.x)?n:t)-(null!=(r=this._forcedSpeed.x)?r:this._forcedSpeed):0,this._forcedSpeed=t,this._playersActive&&this._scrollWall.scrollWall(this._forcedSpeed,i),e("PlayerControlledShip").each((function(){return this.forcedSpeed(t,i)}))},t.prototype.addTrauma=function(t){return this._scrollWall.addTrauma(t)},t.prototype.setHeight=function(t){return 0===this.blocks.length?(this.generationPosition.y-=t,this._scrollWall.viewHeight+=t):(this._scrollWall.viewHeight+=t,e.trigger("CameraMove",{dx:0,dy:t}))},t.prototype.panCamera=function(t,i){var n,r,o;return r=0,(n=e.e("TweenPromise").attr({y:0})).bind("GameLoop",(o=this,function(){var t;return t=n.y-r,r=n.y,o._scrollWall.viewHeight+=t,e.trigger("CameraMove",{dx:0,dy:t}),e.trigger("CameraPan",{dx:0,dy:t})})),n.tweenPromise({y:t.y},i,"easeInOutQuad").then((function(){return n.destroy()}))},t.prototype.setWeaponsEnabled=function(t,i){var n,r,o;for((null==i||a(i))&&(i=[1,2]),null==this._weaponsEnabled&&(this._weaponsEnabled={}),n=0,r=i.length;n<r;n++)o=i[n],this._weaponsEnabled[o]=t;return e("PlayerControlledShip").each((function(){var e;if(e=this.playerNumber,c.call(i,e)>=0)return this.weaponsEnabled=t}))},t.prototype.getComponentOffset=function(){return{x:this._scrollWall.x,y:this._scrollWall.y}},t.prototype.addComponent=function(t,e,i){var n,r,o;if(null==i&&(i=null),null!=(n=this.blocks[null!=(o=this.currentBlockIndex)?o:0]))return null==i&&(i=this.getComponentOffset()),r={x:e.x+i.x-n.x,y:e.y+i.y-n.y},n.add(r.x,r.y,t)},t.prototype.stop=function(){var t,i,n,r,o;for(this.active=!1,e.unbind("LeaveBlock"),e.unbind("EnterBlock"),e.unbind("ShipSpawned"),e.unbind("CameraMove"),e.unbind("GameLoop",this._waveTicks),o=[],i=0,n=(r=this.blocks).length;i<n;i++)t=r[i],o.push(null!=t?t.clean():void 0);return o},t.prototype.verify=function(){if(!this.active)throw new Error("sequence mismatch")},t.prototype._update=function(){var t,e,i;for(e=this.bufferLength,t=0,10,i=[];this.generationPosition.x<e&&t<10;)this._generateLevel(),i.push(t+=1);return i},t.prototype._generateLevel=function(){var t,e;if(t=this.currentScenery,this._addBlockToLevel(t,{}),e=this.generator.buildingBlocks[t].prototype.autoNext)return this.currentScenery=e},t.prototype._addBlockToLevel=function(t,e){var i;return i=new(0,this.generator.buildingBlocks[t])(this,this.generator,e),this.blocks.push(i),i.build(this.generationPosition),this.generationPosition={x:i.x+i.delta.x,y:i.y+i.delta.y}},t.prototype._insertBlockToLevel=function(t,e){var i,n;if(null==(n=this.generator.buildingBlocks[t]))throw new Error(t+" not found");return i=new n(this,this.generator,e),this.blocks.unshift(i),this.generationPosition={x:this.generationPosition.x-i.delta.x,y:this.generationPosition.y-i.delta.y},i.build(this.generationPosition)},t.prototype._cleanupBuildBlocks=function(){var t,e;for(t=this.blocks[0],e=[];t&&t.canCleanup();)this.blocks.shift().clean(),e.push(t=this.blocks[0]);return e},t.prototype._seedPreceedingGeometry=function(){var t,e,i,n,r;return e=this.currentScenery,(i=(t=this.generator.buildingBlocks[e]).prototype.autoNext)&&(e=i),(r=t.prototype.autoPrevious)&&(e=r),n=o(this.generationPosition),this._insertBlockToLevel(e,{}),this._insertBlockToLevel(e,{}),this._insertBlockToLevel(e,{}),this.generationPosition=n},t.prototype.loadAssets=function(t){return this.generator.loadAssets(t)},t.prototype.setStartWeapons=function(t){this.playerStartWeapons=t},t}(),t.exports={default:r}}).call(this,i(0).default,i(12).default)},function(t,e,i){var n=i(117),r=i(32),o=i(37),s=i(8),a=i(18),h=i(43),c=i(44),u=i(75),l="[object Map]",d="[object Set]",f=Object.prototype.hasOwnProperty;t.exports=function(t){if(null==t)return!0;if(a(t)&&(s(t)||"string"==typeof t||"function"==typeof t.splice||h(t)||u(t)||o(t)))return!t.length;var e=r(t);if(e==l||e==d)return!t.size;if(c(t))return!n(t).length;for(var i in t)if(f.call(t,i))return!1;return!0}},function(t,e,i){var n,r,o,s,a,h,c,u,l,d;u=i(83),n=i(88),r=i(89),o=i(429),l=i(430),s=i(431),a=i(432),h=i(433),c=i(434),d=i(435),u.defineAssets("explosion",{contents:["explosion"],spriteMap:o,sprites:{all:{tile:96,tileh:96,map:{explosionStart:[0,0]}}},audio:{explosion:[s],shoot:[h],hit:[a],powerup:[d],laugh:[c]}}),u.defineAssets("player",{contents:["playerShip","shipEngineFire","mine","drone","rocket","helicopter","largeDrone","laserTank"],spriteMap:n,sprites:{all:r}}),u.defineAssets("portraits",{contents:["general"],spriteMap:l,sprites:{all:{tile:32,tileh:32,map:{pGeneral:[0,0,4,4],pPilot:[0,4,4,4]}}}})},function(t,e,i){t.exports=i.p+"assets/5b2a46fcdad11e3e731e2df7648fd86c.png"},function(t,e,i){t.exports=i.p+"assets/d2ad577067ef844ef5b25a2b6be10e6c.png"},function(t,e,i){t.exports=i.p+"assets/22054d72913c004361c11214587ba79e.ogg"},function(t,e,i){t.exports=i.p+"assets/e39e0c1ad8aa61b66e600f5c44285872.ogg"},function(t,e,i){t.exports=i.p+"assets/98b6ce0c6192392dec84a82a8abac4e2.ogg"},function(t,e,i){t.exports=i.p+"assets/b5690998e5965f0dc01faa0bd41ca470.ogg"},function(t,e,i){t.exports=i.p+"assets/c0e68d85304d657458eca6483ad9993a.ogg"},function(t,e,i){(function(t,e){var n,r,o,s,a=function(t,e){for(var i in e)h.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},h={}.hasOwnProperty;r=i(83),o=i(90),s=i(91),n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.assets=function(){var t;return{sprites:(t={},t[""+o]=s,t)}},e}(i(148).default),r.defineElement("jurassicGrass",(function(){var i;return i=64,this.add(0,this.level.visibleHeight-i,t.e("2D, WebGL, SunBlock, ShipSolid, BulletSolid, Color").color("#1fb93c").attr({w:1024,h:i})),i=160,this.add(0,this.level.visibleHeight-i,t.e("2D, WebGL, Color, SunBlock").color("#1fb93c").attr({w:1024,h:i,z:-10})),64,this.addBackground(0,this.level.visibleHeight-i-64,t.e("2D, WebGL, Color, ColorEffects, Horizon").color("#1fb93c").colorDesaturation(e.backgroundColor).saturationGradient(1,.2).attr({w:512,h:64,z:-100}),.5),this.addBackground(0,this.level.visibleHeight-i-64-64,t.e("2D, WebGL, Color, ColorEffects, Horizon").color("#1fb93c").colorDesaturation(e.backgroundColor).saturationGradient(.2,.2).attr({w:256,h:64,z:-200}),.25)})),r.defineBlock(function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return a(i,e),i.prototype.name="Trailer.Dino",i.prototype.autoNext="Trailer.DinoWoods",i.prototype.delta={x:10,y:0},i.prototype.generate=function(){return i.__super__.generate.apply(this,arguments),this.addBackground(0,this.level.visibleHeight-500,t.e("2D, WebGL, backgroundPlanet").attr({w:256,h:256,z:-400,alpha:.3}),.01)},i}(n)),r.defineBlock(function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return a(i,e),i.prototype.name="Trailer.DinoWoods",i.prototype.delta={x:1024,y:0},i.prototype.generate=function(){var e;return i.__super__.generate.apply(this,arguments),this.addElement("jurassicGrass"),e=576,this.add(50,this.level.visibleHeight-e,t.e("2D, WebGL, Color, SunBlock").color("#8e5605").attr({w:196,h:e-128,z:-10})),e=576,this.add(550,this.level.visibleHeight-e,t.e("2D, WebGL, Color, SunBlock").color("#8e5605").attr({w:196,h:e-128,z:-10}))},i}(n)),r.defineBlock(function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return a(i,e),i.prototype.name="Trailer.DinoVulcano",i.prototype.autoNext="Trailer.DinoPlains",i.prototype.delta={x:1024,y:0},i.prototype.generate=function(){var e;return i.__super__.generate.apply(this,arguments),this.addElement("jurassicGrass"),e=352,this.addBackground(250,this.level.visibleHeight-e,t.e("2D, WebGL, Color").color("#8e5605").attr({w:196,h:e-256,z:-50}),.25)},i}(n)),r.defineBlock(function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.name="Trailer.DinoPlains",e.prototype.delta={x:1024,y:0},e.prototype.generate=function(){return e.__super__.generate.apply(this,arguments),this.addElement("jurassicGrass")},e}(n))}).call(this,i(0).default,i(9).default)},function(t,e,i){"use strict";i(438),i(441),i(442),i(443),i(444)},function(t,e,i){"use strict";(function(t,e){var n=i(175),r=i(176),o=i(174),s=i.n(o);t.defineScene("Game",async()=>{e.backgroundColor=null,t.createLayer("UILayerDOM","DOM",{scaleResponse:0,yResponse:0,xResponse:0,z:40}),t.createLayer("UILayerWebGL","WebGL",{scaleResponse:0,yResponse:0,xResponse:0,z:35}),t.createLayer("StaticBackground","WebGL",{scaleResponse:0,yResponse:0,xResponse:0,z:0}),t.e("BigText, LoadingText").bigText("Loading"),new s.a;{t.viewport.x=0,t.viewport.y=0;const e=Object(n.a)();await Object(r.a)(e)}},()=>{t("Player").each((function(){this.removeComponent("ShipSpawnable")})),t.unbind("GameOver"),t.unbind("ScriptFinished"),t.unbind("GamePause")})}).call(this,i(0).default,i(9).default)},function(t,e,i){var n=i(135),r=i(149);t.exports=function(t){return r(n(t))}},function(t,e,i){var n=i(149),r=i(128);t.exports=function(t){return n(r(t))}},function(t,e,i){(function(t,e,n){var r,o,s;o=i(81),s=i(84),r=i(52),t.defineScene("GameOver",(function(i){var a,h,c,u,l,d;return t.background("#000"),t.viewport.x=0,t.viewport.y=0,d=t.viewport.width,h=t.viewport.height,l="Game Over",i.gameCompleted&&(l="Congratulations"),t.e("2D, DOM, Text").attr({x:0,y:.2*h,w:d}).text(l).textColor("#FF0000").textAlign("center").textFont({size:"50px",weight:"bold",family:"Press Start 2P"}),u=function(e){return function(){var i,n,o,s,a,u,l;for(i=null,n=o=0,a=c.length;o<a;n=++o)c[n].player===e.player&&(i=n);if(l=e.name+": "+e.points,i<10&&(l+=" - "+function(){switch(i){case 0:return"ACE";case 1:return"2nd";case 2:return"3rd";default:return i+1+"th"}}()),t.e("2D, DOM, Text").attr({x:0,y:.45*h+45*e.index,w:d}).text(l).textColor(e.color).textAlign("center").textFont({size:"20px",weight:"bold",family:"Press Start 2P"}),i<10)return u=t.e("2D, DOM, Text").attr({x:.25*d,y:.45*h+45*(e.index+1),w:d}).text("Enter name: ").textColor(e.color).textAlign("left").textFont({size:"20px",weight:"bold",family:"Press Start 2P"}),(s=t.e("TextInput").attr({x:.6*d,y:.45*h+45*(e.index+1),w:d}).textColor(e.color).textAlign("left").textFont({size:"20px",weight:"bold",family:"Press Start 2P"})).textInput(e.player,3).then((function(t){var i,n,o,a;return(a=function(){var t,e,i,n;return(e=localStorage.getItem("SPDLZR"))?(i=e.slice(0,20),t=e.slice(20),(n=r.AES.decrypt(t,i).toString(r.enc.Utf8)).length>1?JSON.parse(n):[]):[]}()).push({initials:t,score:e.points,time:(new Date).getTime()}),i=JSON.stringify(a),o=r.AES.encrypt(i,"secret").toString().slice(8,28),n=r.AES.encrypt(i,o).toString(),localStorage.setItem("SPDLZR",o+n),u.destroy(),s.destroy()}))}},a=[],c=o(e.highscores()),t("Player ControlScheme").each((function(t){return null,c.push({initials:null,player:this,score:this.points}),a.push(u({index:t,name:this.name,points:this.points,player:this,color:this.color()}))})),c=s(c,"score").reverse(),n.sequence(a).then((function(){return t.e("Delay").delay((function(){var n,r,o;return e.credits>0&&!i.gameCompleted?(o=10,l=1===e.credits?"1 Credit left":e.credits+" Credits left",t.e("2D, DOM, Text").attr({x:0,y:.8*h,w:d}).textColor("#FF0000").textAlign("center").textFont({size:"15px",weight:"bold",family:"Press Start 2P"}).text(l),n=t.e("2D, DOM, Text").attr({x:0,y:.8*h+30,w:d}).textColor("#FF0000").textAlign("center").textFont({size:"15px",weight:"bold",family:"Press Start 2P"}),r="Press fire to continue",n.text(r+" "+("00"+o).slice(-2)),this.delay((function(){return o-=1,n.text(r+" "+("00"+o).slice(-2))}),1e3,o,(function(){return t.enterScene("Scores")})),t("Player").each((function(){return this.reset(),this.one("Activated",(function(){return e.credits-=1,t.enterScene("Game",i)}))}))):this.delay((function(){return t.enterScene("Scores")}),5e3)}),2e3,0)}))}),(function(){return t("Delay").each((function(){return this.destroy()})),t("Player").each((function(){return this.unbind("Activated")}))}))}).call(this,i(0).default,i(9).default,i(12).default)},function(t,e,i){(function(t,e){t.defineScene("Intro",()=>{e.resetCredits(),t.background("#000000"),t.viewport.x=0,t.viewport.y=0;const i=t.viewport.width,n=t.viewport.height;t.e("2D, DOM, Text, Tween, Delay").attr({x:.35*i,y:.4*n,w:400}).text("Speedlazer").textColor("#0000ff").textFont({size:"40px",weight:"bold",family:"Press Start 2P"}).delay((function(){this.tween({x:.65*i-400},2e3),this.one("TweenEnd",(function(){this.tween({x:.35*i},2e3)}))}),4e3,-1),t.e("2D, DOM, Text, Tween, Delay").attr({x:.5*i-150,y:.6*n,w:300}).text("Press fire to start!").textColor("#FF0000").textFont({size:"15px",weight:"bold",family:"Press Start 2P"}).delay((function(){this.tween({alpha:.5},1e3),this.one("TweenEnd",(function(){this.tween({alpha:1},1e3)}))}),2e3,-1);const r=e.highscores()[0];t.e("2D, DOM, Text").attr({x:0,y:.85*n,w:i}).text(`HI SCORE: ${r.score} ${r.initials}`).textColor("#FFFF00").textAlign("center").textFont({size:"10px",weight:"bold",family:"Press Start 2P"}),t("Player").each((function(){this.reset(),this.one("Activated",()=>t.enterScene("Game",{}))})),t.e("Delay").delay(()=>t.enterScene("Scores"),2e4)},()=>{t("Delay").each((function(){this.destroy()})),t("Player").each((function(){this.unbind("Activated")}))})}).call(this,i(0).default,i(9).default)},function(t,e,i){(function(t){t.defineScene("New",(function(){}))}).call(this,i(0).default)},function(t,e,i){(function(t,e){t.defineScene("Scores",(function(){var i,n,r,o;return e.resetCredits(),t.background("#000000"),t.viewport.x=0,t.viewport.y=0,o=t.viewport.width,i=t.viewport.height,t.e("2D, DOM, Text").attr({x:0,y:.1*i,w:o}).text("Highscores").textColor("#FFFF00").textAlign("center").textFont({size:"40px",weight:"bold",family:"Press Start 2P"}),r=e.highscores(),n=0,t.e("Delay").delay((function(){var e,s,a;if(e=r[n])return s=function(){switch(n){case 0:return"ACE";case 1:return"2nd";case 2:return"3rd";default:return n+1+"th"}}(),a=function(){switch(n){case 0:return"20px";case 1:case 2:return"18px";default:return"15px"}}(),t.e("2D, DOM, Text").attr({x:0,y:.25*i+36*n,w:o}).text(s+"  "+e.score+" "+e.initials).textColor("#FFFF00").textAlign("center").textFont({size:a,weight:"bold",family:"Press Start 2P"}),n+=1}),500,9),t("Player").each((function(){return this.reset(),this.one("Activated",(function(){return t.enterScene("Game")}))})),t.e("Delay").delay((function(){return t.enterScene("Intro")}),2e4)}),(function(){return t("Delay").each((function(){return this.destroy()})),t("Player").each((function(){return this.unbind("Activated")}))}))}).call(this,i(0).default,i(9).default)},function(t,e,i){(function(t){t.s("SeaLevel",{init(){this.offset=0},getSeaLevel(e=1){const i=t("ScrollWall").get(0).viewHeight,n=(1-e)*(200-2.5*i);return t.viewport.height-20-i-this.offset-n},setOffset(t){this.offset=t}})}).call(this,i(0).default)},function(t,e,i){"use strict";i(310),i(313),i(314),i(317),i(318),i(319),i(320),i(321),i(322),i(323),i(338),i(339),i(340),i(341),i(342),i(343),i(344),i(345),i(346),i(347),i(348),i(349),i(350),i(351),i(352),i(353),i(354),i(355),i(356),i(357),i(139),i(140),i(380),i(141),i(381),i(382),i(383),i(384),i(385),i(386),i(387),i(388),i(390),i(391),i(143),i(392),i(393),i(394),i(395),i(396),i(397),i(398),i(399),i(400),i(401),i(402),i(144),i(403),i(145),i(405),i(406),i(407),i(147),i(408),i(146),i(409),i(410),i(412),i(413),i(414)}]);
//# sourceMappingURL=game.667212a4751ba4d16c9e.js.map