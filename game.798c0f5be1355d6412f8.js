/*! For license information please see game.798c0f5be1355d6412f8.js.LICENSE.txt */
!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=175)}([function(t,e,i){"use strict";i.r(e);i(176);const n=window.Crafty;delete window.Crafty,n.fn.forEach=function(t){this.each((function(e){t(this,e)}))},e.default=n},function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"a",(function(){return r})),i.d(e,"c",(function(){return a})),i.d(e,"d",(function(){return o})),i.d(e,"e",(function(){return s}));const n="easeInOutQuad",r="easeInQuad",a="easeOutQuad",o="linear",s={linear:t=>t,smoothStep:t=>(3-2*t)*t*t,smootherStep:t=>(6*t*t-15*t+10)*t*t*t,easeInQuad:t=>t*t,easeOutQuad:t=>t*(2-t),easeInOutQuad:t=>t<.5?2*t*t:(4-2*t)*t-1}},function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var n=i(4);const r=(t,e,{points:i=10,delay:r=500,yOffset:a=0,speed:o=null}={})=>async({exec:s,wait:l})=>{const c=Array(t).fill().map(async(t,c)=>{await l(c*r),await s(((t,e=0,i=0,r=null)=>async({spawn:a,showState:o,waitForEvent:s,allowDamage:l,awardPoints:c,moveWithPattern:h})=>{const u=Object(n.e)(t).path,d=a("WarDrone",{location:{rx:u[0].x,ry:u[0].y+e},defaultVelocity:r||400});await l(d,{health:30});const p=h(d,t);s(d,"Dead",async()=>{p.abort(),i>0&&c(i,d.x,d.y),await o(d,"dead"),d.destroy()}),await p.process,p.wasCompleted()&&d.destroy()})(e,a,i,o))});await Promise.all(c)}},function(t,e,i){"use strict";const n=(()=>{const t={},e=new AudioContext,i={music:null,effectsGain:e.createGain(),musicGain:e.createGain()};i.effectsGain.connect(e.destination),i.musicGain.connect(e.destination);let n=!1;const r=()=>{null!==i.music&&(i.music.source.stop(),i.music.source.disconnect(),i.music=null)};let a=1,o=1;const s={pauseAudio:()=>{n=!0,e.suspend()},resumeAudio:()=>{n=!1,e.resume()},setEffectVolume:t=>{i.effectsGain.gain.setValueAtTime(t,e.currentTime),a=t},setMusicVolume:t=>{i.musicGain.gain.setValueAtTime(t,e.currentTime),o=t},getEffectsVolume:()=>a,getMusicVolume:()=>o,loadAudio:async i=>{const n=i.name;if(t[n])return t[n];const r=await window.fetch(i.file),a=await r.arrayBuffer();return((e,i)=>{var n;t[e.name]={audioData:i,map:(n=e.map,n.reduce((t,e,i,n)=>{const r=i>0&&t[n[i-1].name],a=0===i?0:r.end;return{...t,[e.name]:{type:e.type,start:a,end:a+e.duration,duration:e.duration,loopStart:e.loopStart,loopEnd:e.loopEnd,volume:e.volume,loop:e.loop}}},{}))}})(i,await e.decodeAudioData(a)),t[n]},stopMusic:r,fadeMusicVolume:(t=0,e=1e3)=>{if(null!==i.music)return i.music.setVolume(t,e)},playAudio:(n,{volume:a=1}={})=>{const o=Object.values(t).find(t=>t.map[n]),s=o.map[n];if("music"===s.type){if((()=>{if(null!==i.music)return i.music.sampleName})()===n)return;r();const t=void 0===s.volume?1:s.volume,l=a*t,c=e.createBufferSource();c.buffer=o.audioData;const h=e.createGain();h.connect(i.musicGain),h.gain.setValueAtTime(0===l?.01:l,e.currentTime),c.connect(h),s.loop&&(c.loop=!0,s.loopStart&&(c.loopStart=s.loopStart),s.loopEnd&&(c.loopEnd=s.loopEnd)),c.start();const u=new Promise(t=>c.onended=t),d=async(i,n=0)=>{const r=i*t;h.gain.exponentialRampToValueAtTime(0===r?.01:r,e.currentTime+n/1e3)};return i.music={source:c,sampleName:n,setVolume:d},{stop:()=>c.stop(),setVolume:d,process:u}}{const t=e.createBufferSource();t.buffer=o.audioData;const n=void 0===s.volume?1:s.volume,r=a*n;s.loop&&(t.loop=!0,t.loopStart=s.start/1e3,t.loopEnd=s.end/1e3);const l=e.createGain();return l.connect(i.effectsGain),l.gain.setValueAtTime(0===r?.01:r,e.currentTime),t.connect(l),t.start(e.currentTime,s.start/1e3,t.loop?void 0:s.duration/1e3),{stop:()=>t.stop(),setVolume:async(t,i=0)=>{const r=t*n;l.gain.exponentialRampToValueAtTime(0===r?.01:r,e.currentTime+i/1e3)},process:new Promise(e=>t.onended=e)}}}};return document.addEventListener("visibilitychange",()=>{n||(document.hidden?e.suspend():e.resume())},!1),s})();e.a=n},function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return s})),i.d(e,"c",(function(){return c})),i.d(e,"d",(function(){return u})),i.d(e,"e",(function(){return p})),i.d(e,"f",(function(){return m})),i.d(e,"g",(function(){return g}));const n=JSON.parse('{"animations":{"City.Intro":{"checkpoints":[{"entities":[["IntroShip",{"key":"ship","relativeX":-0.3,"relativeY":0.8}]],"timeline":{"defaultDuration":3000,"transitions":[{"key":"ship","start":0,"end":1,"path":{"data":[{"x":-0.3,"y":0.8},{"x":-0.2,"y":0.8}]}},{"start":0.4,"end":0.6,"key":"ship","targetState":"t2o"},{"start":0.6,"end":1,"key":"ship","targetState":"t2r"}]}},{"entities":[["IntroShip",{"key":"ship","relativeX":-0.2,"relativeY":0.8}]],"timeline":{"defaultDuration":500,"transitions":[{"key":"ship","start":0.8,"targetState":"heliStart"}]}},{"entities":[["IntroShip",{"key":"ship","state":"heliStart","relativeX":-0.2,"relativeY":0.8}],["IntroHeli",{"key":"heli","detach":true}]],"timeline":{"defaultDuration":500,"transitions":[{"start":0.2,"end":1,"key":"heli","targetState":"flying"},{"start":0,"end":0.8,"key":"ship","targetState":"shipStart"},{"start":0.8,"end":1,"key":"ship","targetState":"shipLiftOff"}]}},{"entities":[["IntroShip",{"key":"ship","state":"shipLiftOff","relativeX":-0.2,"relativeY":0.8}],["IntroHeli",{"key":"heli","state":"flying","detach":true}],["PlayerShip",{"key":"player","detach":true,"state":"flying"}]],"timeline":{"defaultDuration":1500,"transitions":[{"start":0,"end":0.5,"key":"player","path":{"name":"playerLiftOff","start":0,"end":1},"attributes":{"z":10}},{"start":0,"end":1,"key":"heli","path":{"name":"intro.HeliLiftOff","start":0,"end":0.2},"attributes":{"z":14}},{"start":0,"end":1,"key":"ship","targetState":"closed","path":{"data":[{"x":-0.2,"y":0.8},{"x":-0.1,"y":0.8}]}}]}},{"entities":[["IntroShip",{"key":"ship","relativeX":-0.1,"relativeY":0.8}],["IntroHeli",{"key":"heli","state":"flying","relativeX":0.466,"relativeY":0.458,"z":10,"detach":true}]],"timeline":{"defaultDuration":8000,"transitions":[{"start":0,"end":0.35,"key":"heli","path":{"name":"intro.HeliLiftOff","start":0.2,"end":1}},{"key":"ship","start":0.1,"end":1,"path":{"data":[{"x":-0.1,"y":0.8},{"x":-1,"y":0.8}]}},{"key":"ship","start":1,"end":1,"remove":true},{"key":"heli","start":1,"end":1,"remove":true}]}}],"habitat":{"scenery":"City.Ocean","scrollSpeed":{"vx":-100,"vy":0},"background":["City.Sunrise",0]},"diskFolder":"intro"},"City.Bridge":{"checkpoints":[{"particles":[["dust.bridge",{"key":"dust"}]],"timeline":{"defaultDuration":1000,"transitions":[{"key":"dust","start":0.9,"end":1,"remove":true}]}},{"entities":[["BridgeCeiling",{"key":"ceiling"}],["BridgeFrontDeck",{"key":"front"}],["BridgeCeilingBackground",{"key":"back"}],["PillarRight",{"key":"pillarRight"}],["PillarLeft",{"key":"pillarLeft"}]],"timeline":{"defaultDuration":500,"transitions":[{"key":"back","start":0.3,"end":1,"targetFrame":"damaged","path":{"data":[{"x":-0.1,"y":0.3},{"x":-0.1,"y":0.29}]}},{"key":"pillarRight","start":0.2,"end":1,"targetFrame":"rotateSmall"},{"key":"pillarLeft","start":0.2,"end":1,"targetFrame":"rotateSmall"},{"key":"front","start":0.7,"end":1,"targetFrame":"rotateSmall","path":{"data":[{"x":-0.1,"y":0.29},{"x":-0.1,"y":0.3}]}},{"key":"ceiling","start":0,"end":1,"targetFrame":"rotateSmall","path":{"data":[{"x":-0.1,"y":0.3},{"x":-0.1,"y":0.28}]}}]}},{"entities":[["BridgeCeiling",{"key":"ceiling"}],["BridgeFrontDeck",{"key":"front"}],["BridgeCeilingBackground",{"key":"back"}],["PillarRight",{"key":"pillarRight"}],["PillarLeft",{"key":"pillarLeft"}]],"timeline":{"defaultDuration":500,"transitions":[{"key":"back","start":0.3,"end":1,"targetFrame":"damaged","path":{"data":[{"x":-0.1,"y":0.3},{"x":-0.1,"y":0.29}]}},{"key":"pillarRight","start":0.2,"end":1,"targetFrame":"rotateMedium"},{"key":"pillarLeft","start":0.2,"end":1,"targetFrame":"rotateMedium"},{"key":"front","start":0.7,"end":1,"targetFrame":"rotateMedium","path":{"data":[{"x":-0.1,"y":0.29},{"x":-0.1,"y":0.3}]}},{"key":"ceiling","start":0,"end":1,"components":["PlayerEnemy"],"targetFrame":"rotateMedium","path":{"data":[{"x":-0.1,"y":0.3},{"x":-0.1,"y":0.28}]}}]}},{"particles":[["dust.bridge",{"key":"dust"}]],"entities":[["BridgeCeiling",{"key":"ceiling"}],["BridgeCeilingBackground",{"key":"back"}],["BridgeFrontDeck",{"key":"front"}],["PillarRight",{"key":"pillarRight"}],["PillarLeft",{"key":"pillarLeft"}]],"timeline":{"defaultDuration":6000,"transitions":[{"key":"dust","start":0.7,"end":1,"remove":true},{"key":"ceiling","start":0.2,"end":0.6,"targetFrame":"rotateDown","path":{"data":[{"x":-0.1,"y":0.28},{"x":-0.1,"y":1.2}]}},{"key":"front","start":0.7,"end":1,"path":{"data":[{"x":-0.1,"y":0.1},{"x":-0.1,"y":1.3}]}},{"key":"back","start":0,"end":0.5,"targetFrame":"rotateDown","path":{"data":[{"x":-0.1,"y":0.28},{"x":-0.1,"y":0.9}]}},{"key":"pillarLeft","start":0.7,"end":1,"targetFrame":"rotateDown"},{"key":"pillarRight","start":0.4,"end":1,"targetFrame":"rotateDown"}]}}],"habitat":{"scenery":"City.Bridge","scrollSpeed":{"vx":0,"vy":0},"background":["City.Sunrise",3]},"diskFolder":"scenery"},"City.Sunrise":{"checkpoints":[{"composables":[["background.night",{"key":"night"}],["background.sky",{"key":"sky","frame":"default","relativeX":-0.1}]],"backgroundColor":"#000010","timeline":{"defaultDuration":45000,"transitions":[{"key":"night","start":0,"end":1,"targetFrame":"middle"},{"key":"sky","start":0,"end":0.5,"targetFrame":"dawn"},{"key":"sky","start":0.5,"end":1,"targetFrame":"dawn2"},{"start":0,"end":0.5,"targetBackgroundColor":"#030820"},{"start":0.5,"end":1,"targetBackgroundColor":"#0f1630"}]}},{"composables":[["background.night",{"key":"night","frame":"middle"}],["background.sky",{"key":"sky","frame":"dawn2","relativeX":-0.1}],["background.horizon",{"key":"stripe","frame":"default","relativeY":0.49,"relativeX":-0.1}]],"entities":[["Sun",{"key":"sun","state":"large","relativeX":0.9,"relativeY":0.7}]],"backgroundColor":"#0f1630","timeline":{"defaultDuration":60000,"transitions":[{"key":"night","start":0,"end":1,"targetFrame":"end"},{"key":"sky","start":0,"end":0.3,"targetFrame":"dawn3"},{"key":"sky","start":0.3,"end":0.7,"targetFrame":"dawn4"},{"key":"sky","start":0.7,"end":1,"targetFrame":"dawn5"},{"start":0,"end":0.3,"targetBackgroundColor":"#191f3d"},{"start":0.3,"end":0.85,"targetBackgroundColor":"#27273d"},{"start":0.85,"end":1,"targetBackgroundColor":"#fd7321"},{"key":"stripe","start":0.1,"end":0.6,"path":{"data":[{"x":0,"y":0.49},{"x":0,"y":0.46}]}},{"key":"sun","start":0.5,"end":1,"path":{"name":"sunrise","start":0,"end":0.2}}]}},{"composables":[["background.night",{"key":"night","frame":"end"}],["background.sky",{"key":"sky","frame":"dawn5","relativeX":-0.1}],["background.horizon",{"key":"stripe","frame":"default","relativeY":0.46,"relativeX":-0.1}]],"entities":[["Sun",{"key":"sun","state":"large","relativeX":0.848,"relativeY":0.42}]],"backgroundColor":"#fd7321","timeline":{"defaultDuration":150000,"transitions":[{"key":"sky","start":0,"end":0.5,"targetFrame":"dawn6"},{"key":"sky","start":0.5,"end":1,"targetFrame":"dawn7"},{"start":0,"end":0.5,"targetBackgroundColor":"#fdab3a"},{"start":0.5,"end":1,"targetBackgroundColor":"#fcc67b"},{"start":0,"end":1,"key":"sun","targetState":"full"},{"key":"sun","start":0,"end":1,"path":{"name":"sunrise","start":0.2,"end":0.4}},{"key":"stripe","targetFrame":"dawn","start":0,"end":0.2,"path":{"data":[{"x":0,"y":0.46},{"x":0,"y":0.43}]}},{"key":"stripe","start":0.7,"end":1,"path":{"data":[{"x":0,"y":0.43},{"x":0,"y":0.8}]}},{"key":"night","start":1,"remove":true},{"key":"stripe","start":1,"remove":true}]}},{"composables":[["background.sky",{"key":"sky","frame":"dawn7","relativeX":-0.1}]],"entities":[["Sun",{"key":"sun","state":"full","relativeX":0.8,"relativeY":0.3}]],"backgroundColor":"#fcc67b","timeline":{"defaultDuration":120000,"transitions":[{"key":"sky","start":0,"end":0.5,"targetFrame":"dawn8"},{"key":"sky","start":0.5,"end":1,"targetFrame":"dawn9"},{"start":0,"end":0.5,"targetBackgroundColor":"#f3d7b1"},{"start":0.5,"end":1,"targetBackgroundColor":"#babcd9"},{"start":0,"end":1,"key":"sun","targetState":"default"},{"key":"sun","start":0,"end":1,"path":{"name":"sunrise","start":0.4,"end":1}}]}},{"composables":[["background.sky",{"key":"sky","frame":"dawn9","relativeX":-0.1}]],"entities":[["Sun",{"key":"sun","state":"default","relativeX":0.4,"relativeY":0.1}]],"backgroundColor":"#babcd9","timeline":{"defaultDuration":1000,"transitions":[]}}],"habitat":{"isBackground":true,"scenery":"City.Bay","scrollSpeed":{"vx":-100,"vy":0}},"diskFolder":"scenery"}},"compositions":{"player.ship":{"attributes":{"width":80,"height":38},"sprites":[["playerShip",{"flipX":true,"key":"main","accentColor":"#ff0000","w":80,"h":50}]],"hitbox":[10,14,64,18,75,38,20,38],"attachHooks":[["explosion",{"x":26,"y":18,"z":2,"attachAlign":["center","center"],"attachTo":"main"}],["mainWeapon",{"x":48,"y":36,"z":4,"attachAlign":["center","right"],"attachTo":"main"}],["laserWeapon",{"x":48,"y":36,"z":4,"attachAlign":["center","right"],"attachTo":"main"}],["laserCharge",{"x":48,"y":36,"z":4,"attachAlign":["center","right"],"attachTo":"main"}],["trail",{"x":0,"y":22,"z":4,"attachAlign":["center","left"],"attachTo":"main"}],["reverseTrail",{"x":38,"y":42,"z":1,"attachAlign":["center","right"],"attachTo":"main"}],["reverseTrail2",{"x":38,"y":32,"z":-3,"attachAlign":["center","right"],"attachTo":"main"}]],"frames":{"normal":{"main":{"sprite":"playerShip"}},"turn":{"main":{"sprite":"playerShipTurning"}},"front":{"main":{"sprite":"playerShipFront"}},"damaged":{"main":{"sprite":"playerShipDamaged"}},"turnDamaged":{"main":{"sprite":"playerShipDamagedTurning"}},"hidden":{"main":{"hidden":true,"alpha":0}},"turned":{"flipX":true}},"animations":{"turnAround":{"easing":"linear","duration":500,"timeline":[{"start":0,"end":0.33,"startFrame":"normal","endFrame":"turn"},{"start":0.33,"end":0.6,"startFrame":"front","endFrame":"front"},{"start":0.6,"end":0.66,"startFrame":"front","endFrame":"turned"},{"start":0.66,"end":0.95,"startFrame":"turn","endFrame":"turn"},{"start":0.95,"end":1,"startFrame":"turn","endFrame":"normal"}]},"turnAroundDamaged":{"easing":"linear","duration":500,"timeline":[{"start":0,"end":0.33,"startFrame":"damaged","endFrame":"turnDamaged"},{"start":0.33,"end":0.6,"startFrame":"front","endFrame":"front"},{"start":0.6,"end":0.66,"startFrame":"front","endFrame":"turned"},{"start":0.66,"end":0.95,"startFrame":"turnDamaged","endFrame":"turnDamaged"},{"start":0.95,"end":1,"startFrame":"turnDamaged","endFrame":"damaged"}]}},"diskFolder":"PlayerShip"},"portraits.pilot":{"attributes":{"width":128,"height":128},"sprites":[["pilot1",{"key":"pilot"}]],"frames":{"idle":{"pilot":{"sprite":"pilot1"}},"talk":{"pilot":{"sprite":"pilot2"}}},"animations":{"talking":{"repeat":true,"easing":"linear","duration":500,"timeline":[{"start":0,"end":0.5,"startFrame":"idle","endFrame":"talk"},{"start":0.5,"end":1,"startFrame":"talk","endFrame":"idle"}]}},"diskFolder":"PlayerShip"},"portraits.general":{"attributes":{"width":128,"height":128},"sprites":[["general2",{"key":"main"}]],"frames":{"idle":{"main":{"sprite":"general2"}},"talk":{"main":{"sprite":"general1"}}},"animations":{"talking":{"repeat":true,"easing":"linear","duration":500,"timeline":[{"start":0,"end":0.5,"startFrame":"idle","endFrame":"talk"},{"start":0.5,"end":1,"startFrame":"talk","endFrame":"idle"}]}},"diskFolder":"PlayerShip"},"portraits.drone":{"attributes":{"width":90,"height":68},"sprites":[["standardLargeDrone",{"key":"portrait","w":90,"h":58,"crop":[20,60,50,0]}],["sphere2",{"z":1,"x":5,"y":25,"w":20,"h":20,"crop":[0,0,17,21],"key":"eye"}]],"frames":{"idle":{"eye":{"x":0,"y":0,"alpha":1}},"eyeMove":{"eye":{"x":24,"y":-16,"alpha":0.6}},"eyeDisappear":{"eye":{"x":24,"y":-16,"alpha":0}},"eyeReset":{"eye":{"x":0,"y":0,"alpha":0}},"eyeAppear":{"eye":{"x":0,"y":0,"alpha":1}}},"animations":{"talking":{"repeat":true,"easing":"linear","duration":800,"timeline":[{"start":0,"end":0.7,"startFrame":"eyeAppear","endFrame":"eyeMove"},{"start":0.7,"end":0.8,"startFrame":"eyeMove","endFrame":"eyeDisappear"},{"start":0.8,"end":0.9,"startFrame":"eyeDisappear","endFrame":"eyeReset"},{"start":0.9,"end":1,"startFrame":"eyeReset","endFrame":"eyeAppear"}]}},"diskFolder":"PlayerShip"},"cloth":{"attributes":{"width":128,"height":96},"sprites":[["clothBottom",{"x":0,"y":69}],["cloth",{"x":0,"y":0,"z":4,"hideBelow":88,"key":"cloth"}]],"frames":{"up":{"cloth":{"y":0}},"medium":{"cloth":{"y":10}},"down":{"cloth":{"y":100}}},"diskFolder":"common"},"shipHatch":{"attributes":{"width":128,"height":32},"sprites":[["aircraftCarrierOpenHatch",{"y":-4,"x":0}],["aircraftCarrierHatchLid",{"y":-2,"x":0,"key":"lid","crop":[2,0,0,0],"z":1}],["aircraftCarrierWires",{"x":68,"y":-20,"z":-1}],["aircraftCarrierHatchLid",{"x":3,"y":80,"z":1,"key":"floor","crop":[18,3,0,0],"hideBelow":28}]],"attachHooks":[["payload",{"x":64,"y":86,"z":6,"attachAlign":["bottom","center"],"attachTo":"floor"}]],"frames":{"open":{"lid":{"x":-30,"y":16},"floor":{"x":0,"y":0}},"closed":{"lid":{"x":0,"y":0},"floor":{"x":0,"y":0}},"risen":{"lid":{"x":-30,"y":16},"floor":{"y":-65}}},"diskFolder":"common"},"powerups.life":{"attributes":{"width":32,"height":32},"sprites":[["powerUpBox",{"key":"main","accentColor":"#900000"}],["heart",{"z":1,"scale":0.7,"accentColor":"#ff9999","key":"symbol"}],["bigGlare",{"z":-1,"scale":0.15,"x":-84,"y":-84,"crop":[0,24,24,0],"overrideColor":"#ff9999","alpha":0.4,"key":"glow"}]],"hitbox":[3,3,29,3,29,29,3,29],"attachHooks":[["explosion",{"x":16,"y":16,"z":-2,"attachAlign":["center","center"]}]],"frames":{"startGlow":{"glow":{"alpha":0.4,"scale":0.15}},"endGlow":{"glow":{"alpha":0,"scale":0.4}},"pickedUp":{"glow":{"alpha":0,"scale":0.4},"main":{"alpha":0},"symbol":{"alpha":0,"scale":1.2}},"disappear":{"glow":{"alpha":0},"main":{"alpha":0,"scale":0.2},"symbol":{"alpha":0,"scale":0.2}}},"animations":{"default":{"duration":2000,"repeat":true,"timeline":[{"start":0,"end":1,"spriteAnimation":{"key":"main","sprites":["powerUpBox","powerUpBox2","powerUpBox3","powerUpBox2"]}},{"start":0,"end":1,"startFrame":"startGlow","endFrame":"endGlow"}]}},"diskFolder":"common"},"powerups.bonus":{"attributes":{"width":32,"height":32},"sprites":[["powerUpBox",{"key":"main","accentColor":"#a67c00"}],["star",{"z":1,"scale":0.7,"accentColor":"#ffdc73","key":"symbol"}],["bigGlare",{"z":-1,"scale":0.15,"x":-84,"y":-84,"crop":[0,24,24,0],"overrideColor":"#ffdc73","alpha":0.4,"key":"glow"}]],"hitbox":[3,3,29,3,29,29,3,29],"attachHooks":[["explosion",{"x":16,"y":16,"z":-2,"attachAlign":["center","center"]}]],"frames":{"startGlow":{"glow":{"alpha":0.4,"scale":0.15}},"endGlow":{"glow":{"alpha":0,"scale":0.4}},"pickedUp":{"glow":{"alpha":0,"scale":0.4},"main":{"alpha":0},"symbol":{"alpha":0,"scale":1.2}},"disappear":{"glow":{"alpha":0},"main":{"alpha":0,"scale":0.2},"symbol":{"alpha":0,"scale":0.2}}},"animations":{"default":{"duration":2000,"repeat":true,"timeline":[{"start":0,"end":1,"spriteAnimation":{"key":"main","sprites":["powerUpBox","powerUpBox2","powerUpBox3","powerUpBox2"]}},{"start":0,"end":1,"startFrame":"startGlow","endFrame":"endGlow"}]}},"diskFolder":"common"},"powerups.upgrade":{"attributes":{"width":32,"height":32},"sprites":[["powerUpBox",{"key":"main","accentColor":"#009000"}],["upgrade",{"z":1,"scale":0.7,"accentColor":"#99ff99","key":"symbol"}],["bigGlare",{"z":-1,"scale":0.15,"x":-84,"y":-84,"crop":[0,24,24,0],"overrideColor":"#99ff99","alpha":0.4,"key":"glow"}]],"hitbox":[3,3,29,3,29,29,3,29],"attachHooks":[["explosion",{"x":16,"y":16,"z":-2,"attachAlign":["center","center"]}]],"frames":{"startGlow":{"glow":{"alpha":0.4,"scale":0.15}},"endGlow":{"glow":{"alpha":0,"scale":0.4}},"pickedUp":{"glow":{"alpha":0,"scale":0.4},"main":{"alpha":0},"symbol":{"alpha":0,"scale":1.2}},"disappear":{"glow":{"alpha":0},"main":{"alpha":0,"scale":0.2},"symbol":{"alpha":0,"scale":0.2}}},"animations":{"default":{"duration":2000,"repeat":true,"timeline":[{"start":0,"end":1,"spriteAnimation":{"key":"main","sprites":["powerUpBox","powerUpBox2","powerUpBox3","powerUpBox2"]}},{"start":0,"end":1,"startFrame":"startGlow","endFrame":"endGlow"}]}},"diskFolder":"common"},"weapons.bullet":{"attributes":{"width":26,"height":16,"ro":[4,8]},"hitbox":[2,3,14,3,14,12,2,12],"sprites":[["sphere1",{"z":-2,"crop":[17,6,0,0],"flipX":true}]],"diskFolder":"common"},"weapons.lightBullet":{"attributes":{"width":32,"height":32,"ro":[4,14]},"hitbox":[2,12,28,12,28,18,2,18],"sprites":[["lightBullet",{"z":-2}]],"diskFolder":"common"},"weapons.laser":{"attributes":{"width":20,"height":5,"ro":[2,3]},"sprites":[["lightBullet",{"alpha":1,"x":0,"y":-7,"h":20,"w":5,"z":-2,"stretch":[0,0,0,0],"crop":[0,15,0,0],"key":"beam1"}],["lightBullet",{"alpha":1,"x":5,"y":-7,"h":20,"w":10,"z":-2,"stretch":[0,1,0,0],"crop":[0,15,0,15],"key":"beam2"}],["lightBullet",{"alpha":1,"x":15,"y":-7,"h":20,"w":5,"z":-2,"stretch":[0,1,0,1],"crop":[0,0,0,15],"key":"beam3"}]],"frames":{"short":{"attributes":{"w":200}},"reset":{"beam1":{"alpha":1},"beam2":{"alpha":1},"beam3":{"alpha":1}},"disappear":{"beam1":{"alpha":0},"beam2":{"alpha":0},"beam3":{"alpha":0}},"long":{"attributes":{"w":500}},"rotate":{"attributes":{"rotation":10}},"rotate2":{"attributes":{"rotation":-50}},"flipped":{"flipX":true}},"diskFolder":"common"},"player.bullet":{"attributes":{"width":52,"height":8,"ro":[4,4]},"hitbox":[2,3,14,3,14,12,2,12],"sprites":[["sphere1",{"z":-2,"crop":[17,6,0,0],"flipX":true,"w":52,"h":8,"overrideColor":"#ff8080"}]],"diskFolder":"common"},"weapons.sphere":{"attributes":{"width":16,"height":16,"ro":[8,8]},"sprites":[["sphere1",{"z":-2,"crop":[0,17,17,0],"key":"main"}]],"animations":{"default":{"repeat":true,"duration":300,"timeline":[{"start":0,"end":1,"spriteAnimation":{"key":"main","sprites":["sphere1","sphere2"]}}]}},"diskFolder":"common"},"weapons.rocket":{"attributes":{"width":47,"height":16,"ro":[4,8],"scale":1},"hitbox":[2,3,45,3,45,12,2,12],"sprites":[["standardRocket",{"z":1,"key":"main"}]],"attachHooks":[["trail",{"x":47,"y":8,"z":-1,"attachAlign":["center","left"]}],["tip",{"x":0,"y":8,"z":1,"attachAlign":["center","left"]}]],"frames":{"hidden":{"main":{"hidden":true,"alpha":0}},"small":{"attributes":{"scale":0.8}}},"diskFolder":"common"},"weapons.explosion":{"attributes":{"width":96,"height":96,"ro":[48,48]},"sprites":[["explosion1",{"scale":1,"x":0,"y":0,"key":"main"}]],"animations":{"default":{"duration":350,"timeline":[{"start":0,"end":1,"spriteAnimation":{"key":"main","sprites":["explosion1","explosion2","explosion3","explosion4","explosion5","explosion6","explosion7","explosion8","explosion9","explosion10","explosion11","explosion12","explosion13","explosion14","explosion15","explosion16","explosion17","explosion18","explosion19","explosion20"]}}]}},"diskFolder":"common"},"weapons.largeExplosion":{"attributes":{"width":96,"height":96,"scale":1.75,"ro":[84,84]},"sprites":[["explosion1",{"scale":1,"x":0,"y":0,"key":"main"}]],"animations":{"default":{"duration":350,"timeline":[{"start":0,"end":1,"spriteAnimation":{"key":"main","sprites":["explosion1","explosion2","explosion3","explosion4","explosion5","explosion6","explosion7","explosion8","explosion9","explosion10","explosion11","explosion12","explosion13","explosion14","explosion15","explosion16","explosion17","explosion18","explosion19","explosion20"]}}]}},"diskFolder":"common"},"weapons.solidHit":{"attributes":{"width":8,"height":8},"sprites":[["explosion1",{"scale":0.25,"x":-45,"y":-45,"key":"main"}]],"animations":{"default":{"duration":100,"timeline":[{"start":0,"end":1,"spriteAnimation":{"key":"main","sprites":["explosion1","explosion3","explosion5","explosion7","explosion9","explosion11","explosion13","explosion15","explosion17"]}}]}},"diskFolder":"common"},"weapons.waterHit":{"attributes":{"width":8,"height":8},"sprites":[["explosion5",{"scaleX":0.25,"scaleY":0.25,"x":-45,"y":-45,"overrideColor":"#ffffff","key":"main"}]],"frames":{"high":{"main":{"scaleX":0.25,"scaleY":0.75,"y":-27}},"end":{"main":{"scaleX":0.25,"scaleY":0.25,"y":-45,"alpha":0}}},"animations":{"default":{"duration":300,"timeline":[{"start":0,"end":0.3,"startFrame":"default","endFrame":"high"},{"start":0.6,"end":1,"startFrame":"high","endFrame":"end"}]}},"diskFolder":"common"},"weapons.muzzleFlash":{"attributes":{"width":32,"height":32,"ro":[28,16]},"sprites":[["muzzleFlash",{"z":20,"flipX":true,"key":"flash"}]],"frames":{"normal":{"flash":{"alpha":1}},"end":{"flash":{"alpha":0}}},"animations":{"default":{"repeat":false,"easing":"linear","duration":300,"timeline":[{"start":0,"end":0.3,"startFrame":"end","endFrame":"normal"},{"start":0.7,"end":1,"startFrame":"normal","endFrame":"end"}]}},"diskFolder":"common"},"battleship.deck":{"attributes":{"width":1390,"height":170},"hitbox":[20,60,1280,60,1280,188,20,188],"sprites":[["aircraftCarrierStart",{"x":0}],["aircraftCarrierTopFlat",{"x":192}],["aircraftCarrierTopFlat",{"x":320}],["aircraftCarrierTopFlat",{"x":448}],["aircraftCarrierTopFlat",{"x":576}],["aircraftCarrierTopFlat",{"x":704}],["aircraftCarrierTopFlat",{"x":832}],["aircraftCarrierTopFlat",{"x":960}],["aircraftCarrierTopFlat",{"x":1088}],["aircraftCarrierEnd",{"x":1216}],["aircraftCarrierBottomFlat",{"x":192,"y":64}],["aircraftCarrierBottomSpace",{"x":320,"y":64}],["aircraftCarrierBottomFlat",{"x":448,"y":64}],["aircraftCarrierBottomFlat",{"x":576,"y":64}],["aircraftCarrierBottomFlat",{"x":704,"y":64}],["aircraftCarrierBottomSpace",{"x":832,"y":64}],["aircraftCarrierBottomFlat",{"x":960,"y":64}],["aircraftCarrierBottomFlat",{"x":1088,"y":64}],["aircraftCarrierWires",{"x":1052,"y":20,"z":1}],["aircraftCarrierHole",{"x":220,"y":120,"z":1}],["aircraftCarrierHole",{"x":310,"y":120,"z":1}],["aircraftCarrierHole",{"x":450,"y":120,"z":1}],["aircraftCarrierHole",{"x":540,"y":120,"z":1}],["aircraftCarrierHole",{"x":630,"y":120,"z":1}],["aircraftCarrierHole",{"x":720,"y":120,"z":1}],["aircraftCarrierHole",{"x":810,"y":120,"z":1}],["aircraftCarrierHole",{"x":960,"y":120,"z":1}],["aircraftCarrierHole",{"x":1050,"y":120,"z":1}]],"attachHooks":[["mineCannon",{"x":120,"y":48,"z":8,"attachAlign":["bottom","center"]}],["deckGun1",{"x":356,"y":90,"z":20,"attachAlign":["bottom","center"]}],["deckGun2",{"x":866,"y":90,"z":20,"attachAlign":["bottom","center"]}],["deckGun3",{"x":1120,"y":70,"z":7,"attachAlign":["bottom","center"]}],["package",{"x":1100,"y":86,"z":3,"attachAlign":["bottom","center"]}],["laserField",{"x":1120,"y":86,"z":8,"attachAlign":["bottom","center"]}],["boxLocation1",{"x":1020,"y":73,"z":8,"attachAlign":["bottom","center"]}],["boxLocation2",{"x":1230,"y":80,"z":8,"attachAlign":["bottom","center"]}],["boxLocation3",{"x":1133,"y":37,"z":1,"attachAlign":["bottom","center"]}],["cabin1",{"x":294,"y":24,"z":6,"attachAlign":["bottom","left"]}],["heliPlace1",{"x":540,"y":24,"z":2,"attachAlign":["bottom","left"]}],["heliPlace2",{"x":700,"y":24,"z":1,"attachAlign":["bottom","left"]}],["cabin2",{"x":832,"y":24,"z":3,"attachAlign":["bottom","left"]}],["engineCore",{"x":960,"y":-62,"z":4.5,"attachAlign":["top","left"]}],["hatch1",{"x":420,"y":32,"z":2,"attachAlign":["top","left"]}],["hatch2",{"x":612,"y":32,"z":2,"attachAlign":["top","left"]}],["hatch3",{"x":804,"y":32,"z":0.5,"attachAlign":["top","left"]}],["bottom",{"x":10,"y":135,"z":21,"attachAlign":["top","left"]}],["cabin1burn",{"x":314,"y":-16,"z":2,"attachAlign":["top","left"]}],["cabin2burn",{"x":850,"y":-16,"z":2,"attachAlign":["top","left"]}],["cabin1explode",{"x":360,"y":-56,"z":10,"attachAlign":["bottom","center"]}],["cabin2explode",{"x":950,"y":-56,"z":14,"attachAlign":["bottom","center"]}]],"frames":{"risen":{"bottom":{"y":25}},"lowered":{"bottom":{"y":0}},"sinking":{"bottom":{"y":-100}}},"diskFolder":"enemies.BattleShip"},"battleship.firstCabin":{"attributes":{"width":192,"height":130},"hitbox":[0,128,0,50,32,32,32,0,193,0,193,128],"sprites":[["aircraftCarrierCabinEnd",{"x":-12,"y":-15,"flipX":true,"crop":[0,4,0,0]}],["aircraftCarrierCabinRadar",{"x":48,"y":-15,"flipX":true}],["aircraftCarrierCabin",{"x":112,"y":-15}],["aircraftCarrierCabinStart",{"x":176,"y":-15,"flipX":true}],["aircraftCarrierAntenna",{"x":128,"y":-65,"z":1,"flipX":true}],["aircraftCarrier5",{"x":128,"y":55,"z":1}]],"attachHooks":[["radar",{"x":72,"y":11,"z":1,"attachAlign":["bottom","center"]}]],"diskFolder":"enemies.BattleShip"},"battleship.firstCabinDestroyed":{"attributes":{"width":192,"height":66},"sprites":[["aircraftCarrierCabinEndBroken",{"x":-16,"y":-15,"flipX":true}],["aircraftCarrierCabinRadarBroken",{"x":48,"y":-15,"flipX":true}],["aircraftCarrierCabinBroken",{"x":112,"y":-15}],["aircraftCarrierCabinStartBroken",{"x":176,"y":-15,"flipX":true}]],"diskFolder":"enemies.BattleShip"},"battleship.secondCabin":{"attributes":{"width":256,"height":130},"hitbox":[0,55,32,40,32,0,260,0,260,128,0,128],"sprites":[["aircraftCarrierCabinEnd",{"x":-12,"y":-15,"flipX":true,"crop":[0,4,0,0]}],["aircraftCarrierCabinRadar",{"x":48,"y":-15,"flipX":true}],["aircraftCarrierCabin",{"x":112,"y":-15}],["aircraftCarrierCabin",{"x":176,"y":-15}],["aircraftCarrierCabinStart",{"x":240,"y":-15,"flipX":true}],["aircraftCarrierAntenna",{"x":64,"y":-63,"z":0.5,"flipX":true}],["aircraftCarrierAntenna",{"x":160,"y":-63,"z":0.5,"flipX":true}],["aircraftCarrierClosed",{"x":128,"y":50,"z":0.1}],["aircraftCarrierDoor",{"x":134,"y":56,"w":84,"z":2.5,"key":"door","hideAbove":56}],["aircraftCarrier5",{"x":76,"y":40,"z":0.5}]],"frames":{"open":{"door":{"y":-68}}},"diskFolder":"enemies.BattleShip"},"battleship.secondCabinDestroyed":{"attributes":{"width":256,"height":66},"sprites":[["aircraftCarrierCabinEndBroken",{"x":-16,"y":-15,"flipX":true}],["aircraftCarrierCabinRadarBroken",{"x":48,"y":-15,"flipX":true}],["aircraftCarrierCabinBroken",{"x":112,"y":-15}],["aircraftCarrierCabinBroken",{"x":176,"y":-15}],["aircraftCarrierCabinStartBroken",{"x":240,"y":-15,"flipX":true}]],"diskFolder":"enemies.BattleShip"},"battleship.engine":{"attributes":{"width":96,"height":96},"hitbox":[16,16,80,16,80,80,16,80],"sprites":[["aircraftCarrierEngine",{"x":0,"y":0,"key":"cabin"}],["aircraftCarrierEngineMeter",{"x":32,"y":26,"ro":[16,22],"key":"meter","attachTo":"cabin"}]],"attachHooks":[["smoke",{"x":36,"y":52,"z":-1}],["explosion",{"x":36,"y":52,"z":2,"attachAlign":["center","center"]}]],"frames":{"perc0":{"meter":{"rotation":-90}},"perc25":{"meter":{"rotation":-45}},"perc50":{"meter":{"rotation":0}},"perc75":{"meter":{"rotation":45}},"perc100":{"meter":{"rotation":90}},"shake1":{"cabin":{"x":2,"y":-1},"meter":{"rotation":90}},"shake2":{"cabin":{"x":-2,"y":1},"meter":{"rotation":85}},"shake3":{"cabin":{"x":1}},"shake4":{"cabin":{"x":-1}},"destroyed":{"meter":{"alpha":0},"cabin":{"sprite":"aircraftCarrierEngineDestroyed"}}},"animations":{"shake":{"repeat":true,"duration":500,"timeline":[{"start":0,"end":0.5,"startFrame":"shake3","endFrame":"shake4"},{"start":0.5,"end":1,"startFrame":"shake4","endFrame":"shake3"}]},"heavyShake":{"repeat":true,"duration":100,"timeline":[{"start":0,"end":0.5,"startFrame":"shake1","endFrame":"shake2"},{"start":0,"end":1,"startFrame":"shake1","endFrame":"shake2"}]}},"diskFolder":"enemies.BattleShip"},"bulletCannon":{"attributes":{"width":100,"height":42},"hitbox":[64,24,96,24,96,45,64,45],"sprites":[["turretFoot",{"x":64,"y":24,"key":"foot"}],["bulletCannon",{"x":0,"y":0,"key":"barrel","ro":[82,24],"hitbox":[5,10,94,10,94,28,5,28]}]],"attachHooks":[["gun",{"x":0,"y":18,"z":2,"attachAlign":["center","left"],"attachTo":"barrel"}],["smoke",{"x":80,"y":32,"z":-1,"attachAlign":["center","center"]}],["explosion",{"x":80,"y":16,"z":2,"attachAlign":["center","center"],"attachTo":"main"}]],"frames":{"dead":{"barrel":{"alpha":0}},"up":{"barrel":{"rotation":90}},"dead1":{"barrel":{"rotation":-90,"y":-100,"x":0}},"dead2":{"barrel":{"rotation":-180,"y":-5,"x":-40,"z":-2}},"dead3":{"barrel":{"rotation":-180,"y":-15,"x":-40,"z":-2}},"mirrored":{"flipX":true}},"animations":{"dead":{"duration":1000,"startEase":{"duration":250,"easing":"easeOutQuad"},"easing":"easeInQuad","timeline":[{"start":0,"end":0.5,"startFrame":"dead1","endFrame":"dead2"},{"start":0.5,"end":0.75,"startFrame":"dead2","endFrame":"dead3"},{"start":0.75,"end":1,"startFrame":"dead3","endFrame":"dead2"}]}},"diskFolder":"enemies.BulletCannon"},"drone":{"attributes":{"width":60,"height":50,"scale":0.7},"hitbox":[0,20,50,0,60,40,0,50],"sprites":[["standardDrone",{"x":-2,"y":-11,"key":"main"}]],"attachHooks":[["trail",{"x":42,"y":12,"z":-2,"attachAlign":["center","right"],"attachTo":"main"}],["explosion",{"x":22,"y":18,"z":2,"attachAlign":["center","center"],"attachTo":"main"}],["smoke",{"x":22,"y":18,"z":-5,"attachAlign":["center","center"],"attachTo":"main"}]],"frames":{"damaged":{"main":{"sprite":"standardDroneDamage"}},"turned":{"flipX":true},"hidden":{"main":{"hidden":true,"alpha":0}}},"diskFolder":"enemies.Drone"},"droneShip.main":{"attributes":{"width":600,"height":160},"hitbox":[10,60,525,60,525,188,10,188],"sprites":[["aircraftCarrierStart",{"x":0}],["aircraftCarrierTopFlat",{"x":192}],["aircraftCarrierTopFlat",{"x":320}],["aircraftCarrierBottomFlat",{"x":192,"y":64}],["aircraftCarrierBottomSpace",{"x":320,"y":64}],["aircraftCarrierEnd",{"x":448,"y":0}],["aircraftCarrierLowCabinStart",{"x":168,"y":-28,"flipX":true}],["aircraftCarrierLowCabin",{"x":200,"y":-28}],["aircraftCarrierLowCabin",{"x":232,"y":-28}],["aircraftCarrierLowCabinStart",{"x":264,"y":-28}]],"attachHooks":[["boxLocation1",{"x":420,"y":30,"z":13}],["radar",{"x":228,"y":-6,"z":1,"attachAlign":["bottom","center"]}],["hatch1",{"x":220,"y":32,"z":2,"attachAlign":["top","left"]}],["bottom",{"x":10,"y":130,"z":2,"attachAlign":["top","left"]}],["gun",{"x":360,"y":90,"z":22,"attachAlign":["bottom","center"]}]],"diskFolder":"enemies.DroneShip"},"droneShip.radar":{"attributes":{"width":64,"height":28},"hitbox":[4,24,32,0,60,24,32,42],"sprites":[["aircraftCarrierRadar",{"x":0,"y":-6,"key":"main"}],["aircraftCarrierRadarEmit",{"x":0,"y":0,"z":-1,"key":"emit","scale":0.9}]],"attachHooks":[["smoke",{"x":32,"y":28,"z":1,"attachAlign":["center","left"]}],["explosion",{"x":32,"y":28,"z":1,"attachAlign":["center","center"]}]],"frames":{"emitStart":{"emit":{"x":0,"y":0,"alpha":1,"scale":0.9}},"emitEnd":{"emit":{"x":0,"y":-32,"alpha":0,"scale":3}},"broken":{"emit":{"x":0,"y":-32,"alpha":0,"scale":3},"main":{"hidden":true,"sprite":"aircraftCarrierRadarBroken"}}},"animations":{"pulse":{"repeat":true,"easing":"linear","duration":1500,"timeline":[{"start":0,"end":1,"startFrame":"emitStart","endFrame":"emitEnd"}]}},"diskFolder":"enemies.DroneShip"},"helicopter":{"attributes":{"width":128,"height":64,"scale":1},"hitbox":[10,45,50,10,125,20,110,50,13,57],"sprites":[["helicopterLanded",{"x":0,"y":0,"key":"heli","w":128,"h":64,"horizon":[0,0]}],["helicopterGun",{"x":-5,"y":43,"z":-1,"key":"barrel","w":32,"h":32,"ro":[20,10],"horizon":[0,0]}]],"attachHooks":[["gun",{"x":2,"y":62,"z":1,"attachAlign":["center","left"],"attachTo":"barrel"}],["rockets",{"x":60,"y":42,"z":1,"attachAlign":["center","center"]}],["sparks",{"x":60,"y":42,"z":2,"attachAlign":["center","center"]}],["smoke",{"x":60,"y":52,"z":-1,"attachAlign":["center","center"]}]],"frames":{"landed":{"attributes":{"scale":0.8,"z":-100}},"foreground":{"attributes":{"scale":1,"z":100}},"background":{"flipX":true,"attributes":{"scale":0.7,"z":-300},"heli":{"horizon":[0.7,0.7]},"barrel":{"horizon":[0.7,0.7]}},"flyBackground1":{"attributes":{"scale":0.7},"heli":{"sprite":"helicopter","horizon":[0.7,0.7]},"barrel":{"alpha":1,"horizon":[0.7,0.7]}},"flyBackground2":{"attributes":{"scale":0.7},"heli":{"sprite":"helicopter2","horizon":[0.7,0.7]},"barrel":{"alpha":1,"horizon":[0.7,0.7]}},"fly1":{"heli":{"sprite":"helicopter"},"barrel":{"alpha":1}},"fly2":{"heli":{"sprite":"helicopter2"},"barrel":{"alpha":1}},"damaged":{"heli":{"sprite":"heliDamaged"},"barrel":{"alpha":1}},"gunRotate1":{"barrel":{"rotation":10}},"gunRotate2":{"barrel":{"rotation":-50}},"turn1":{"heli":{"sprite":"helicopterTurning1","scaleX":0.5},"barrel":{"alpha":0}},"turn2":{"heli":{"sprite":"helicopterTurning2","scaleX":0.5},"barrel":{"alpha":0}},"turned":{"flipX":true},"tilted":{"attributes":{"rotation":-10}},"leveled":{"attributes":{"rotation":0}}},"animations":{"flying":{"repeat":true,"easing":"linear","startEase":{"easing":"linear","duration":250},"duration":500,"timeline":[{"start":0,"end":0.5,"startFrame":"fly1","endFrame":"fly2"},{"start":0.5,"end":1,"startFrame":"fly2","endFrame":"fly1"}]},"flyingBackground":{"repeat":true,"easing":"linear","startEase":{"easing":"linear","duration":250},"duration":500,"timeline":[{"start":0,"end":0.5,"startFrame":"flyBackground1","endFrame":"flyBackground2"},{"start":0.5,"end":1,"startFrame":"flyBackground2","endFrame":"flyBackground1"}]},"turning":{"repeat":true,"easing":"linear","startEase":{"easing":"linear","duration":250},"duration":500,"timeline":[{"start":0,"end":0.5,"startFrame":"turn1","endFrame":"turn2"},{"start":0.5,"end":1,"startFrame":"turn2","endFrame":"turn1"}]},"turnAround":{"easing":"linear","duration":500,"after":{"animation":"flying"},"timeline":[{"start":0,"end":0.05,"startFrame":"fly1","endFrame":"turn2"},{"start":0.25,"end":0.5,"startFrame":"turn2","endFrame":"turn1"},{"start":0.52,"end":0.55,"startFrame":"turn1","endFrame":"turned"},{"start":0.75,"end":0.9,"startFrame":"turn1","endFrame":"turn2"},{"start":0.95,"end":1,"startFrame":"turn2","endFrame":"fly1"}]}},"diskFolder":"enemies.Helicopter"},"largeDrone":{"attributes":{"width":90,"height":70,"scale":1,"ro":[45,35]},"hitbox":[0,20,80,0,50,60,20,67,0,50],"sprites":[["standardLargeDrone",{"x":0,"y":0,"key":"main","horizon":[0,0]}],["standardRocket",{"x":22,"y":33,"z":1,"key":"rocket","horizon":[0,0]}],["standardLargeDrone",{"x":36,"y":10,"z":3,"key":"wing","horizon":[0,0],"crop":[10,10,47,36]}],["sphere2",{"z":1,"x":1,"y":27,"crop":[0,0,17,21],"key":"eye"}]],"attachHooks":[["trail",{"x":40,"y":18,"z":-2,"attachAlign":["center","right"],"attachTo":"main"}],["explosion",{"x":22,"y":18,"z":2,"attachAlign":["center","center"],"attachTo":"main"}],["smoke",{"x":22,"y":18,"z":-5,"attachAlign":["center","center"],"attachTo":"main"}],["gun",{"x":2,"y":38,"z":2,"attachAlign":["center","left"],"attachTo":"main"}],["rockets",{"x":45,"y":40,"z":2,"attachAlign":["center","center"],"attachTo":"main"}],["rockets2",{"x":45,"y":40,"z":1,"attachAlign":["center","center"],"attachTo":"main"}]],"frames":{"background":{"attributes":{"scale":0.7},"main":{"horizon":[0.7,0.7]},"wing":{"horizon":[0.7,0.7]},"rocket":{"horizon":[0.7,0.7]}},"rocketShow":{"rocket":{"y":-10,"scale":0.6,"alpha":1}},"rocketReset":{"rocket":{"y":-10,"scale":0.6,"alpha":0}},"rocketLoaded":{"rocket":{"y":0,"scale":1,"alpha":1}},"rocketShot":{"rocket":{"y":0,"scale":1,"alpha":0}},"eyeMove":{"eye":{"x":10,"y":-6,"alpha":0.6}},"eyeDisappear":{"eye":{"x":10,"y":-6,"alpha":0}},"eyeReset":{"eye":{"alpha":0}},"eyeAppear":{"eye":{"alpha":1}},"damaged1":{"main":{"sprite":"standardLargeDroneDamage1"}},"damaged2":{"main":{"sprite":"standardLargeDroneDamage2"}},"damaged3":{"main":{"sprite":"standardLargeDroneDamage3"}},"turned":{"flipX":true},"laugh1":{"attributes":{"rotation":15}},"laugh2":{"attributes":{"rotation":0}},"hidden":{"main":{"hidden":true,"alpha":0},"eye":{"hidden":true,"alpha":0}}},"animations":{"eye":{"repeat":true,"easing":"linear","duration":1000,"timeline":[{"start":0,"end":0.7,"startFrame":"eyeAppear","endFrame":"eyeMove"},{"start":0.7,"end":0.8,"startFrame":"eyeMove","endFrame":"eyeDisappear"},{"start":0.8,"end":0.9,"startFrame":"eyeDisappear","endFrame":"eyeReset"},{"start":0.9,"end":1,"startFrame":"eyeReset","endFrame":"eyeAppear"}]},"laugh":{"easing":"linear","duration":1800,"after":{"animation":"eye"},"startEase":{"duration":10,"easing":"linear"},"timeline":[{"start":0,"end":0.05,"startFrame":"eyeAppear","endFrame":"laugh2"},{"start":0.05,"end":0.25,"startFrame":"laugh2","endFrame":"laugh1"},{"start":0.25,"end":0.5,"startFrame":"laugh1","endFrame":"laugh2"},{"start":0.5,"end":0.75,"startFrame":"laugh2","endFrame":"laugh1"},{"start":0.75,"end":1,"startFrame":"laugh1","endFrame":"laugh2"}]},"rocketShot":{"easing":"linear","duration":200,"timeline":[{"start":0,"end":0.2,"startFrame":"rocketLoaded","endFrame":"rocketShot"},{"start":0.2,"end":0.5,"startFrame":"rocketShot","endFrame":"rocketReset"},{"start":0.5,"end":1,"startFrame":"rocketReset","endFrame":"rocketShow"}]},"rocketReload":{"easing":"linear","duration":300,"after":{"animation":"eye"},"timeline":[{"start":0,"end":1,"startFrame":"rocketShow","endFrame":"rocketLoaded"}]}},"diskFolder":"enemies.LargeDrone"},"laserCannon":{"attributes":{"width":100,"height":42},"hitbox":[64,24,96,24,96,45,64,45],"sprites":[["turretFoot",{"x":64,"y":24,"key":"foot"}],["laserGunCore",{"x":35,"y":0,"z":0,"crop":[0,13,0,0],"key":"core1","attachTo":"barrel"}],["laserGunCore",{"x":6,"y":0,"z":0,"crop":[0,13,0,0],"key":"core2","attachTo":"core1"}],["laserGunHandle",{"x":54,"y":0,"key":"barrel","ro":[23,15],"hitbox":[-49,10,40,0,40,28,-49,28],"crop":[0,0,0,22]}],["laserGunBarrel",{"x":0,"y":0,"key":"top","attachTo":"barrel","ro":[30,8],"crop":[0,0,16,0]}],["laserGunBarrel",{"x":0,"y":15,"key":"bottom","attachTo":"barrel","ro":[30,8],"crop":[14,0,0,0]}]],"attachHooks":[["gun",{"x":5,"y":15,"z":-1,"attachAlign":["center","left"],"attachTo":"barrel"}],["charge",{"x":62,"y":15,"z":2,"attachAlign":["center","left"],"attachTo":"barrel"}],["discharge",{"x":62,"y":15,"z":-10,"attachAlign":["center","left"],"attachTo":"barrel"}],["smoke",{"x":80,"y":32,"z":4,"attachAlign":["center","center"]}],["explosion",{"x":80,"y":16,"z":2,"attachAlign":["center","center"],"attachTo":"main"}]],"frames":{"down":{"barrel":{"rotation":0}},"half":{"barrel":{"rotation":45}},"up":{"barrel":{"rotation":90}},"open":{"top":{"rotation":-2,"ry":-5},"bottom":{"rotation":2,"ry":5},"core1":{"rx":-6},"core2":{"overrideColor":null}},"charge":{"core1":{"rx":-6,"overrideColor":"#ff8040"},"core2":{"overrideColor":"#ff8040"}},"done":{"core1":{"overrideColor":null},"core2":{"overrideColor":null}},"close":{"top":{"rotation":0,"ry":0},"bottom":{"rotation":0,"ry":0},"core1":{"rx":0}},"dead1":{"foot":{"z":5},"barrel":{"rotation":-90,"y":-100,"x":0,"overrideColor":"#606060"},"core1":{"x":-3,"overrideColor":"#505050"},"core2":{"overrideColor":"#505050"},"top":{"overrideColor":"#606060"},"bottom":{"overrideColor":"#606060"}},"dead2":{"foot":{"z":5},"core1":{"x":-3,"overrideColor":"#505050"},"core2":{"overrideColor":"#505050"},"barrel":{"rotation":-180,"y":-5,"x":-40,"overrideColor":"#606060"}},"dead3":{"foot":{"z":5},"core1":{"x":-3,"overrideColor":"#505050"},"core2":{"overrideColor":"#505050"},"barrel":{"rotation":-180,"y":-9,"x":-40,"overrideColor":"#606060"}},"mirrored":{"flipX":true}},"animations":{"dead":{"duration":1000,"startEase":{"duration":250,"easing":"easeOutQuad"},"easing":"easeInQuad","timeline":[{"start":0,"end":0.5,"startFrame":"dead1","endFrame":"dead2"},{"start":0.5,"end":0.75,"startFrame":"dead2","endFrame":"dead3"},{"start":0.75,"end":1,"startFrame":"dead3","endFrame":"dead2"}]}},"diskFolder":"enemies.LaserCannon"},"mine":{"attributes":{"width":32,"height":32,"ro":[16,16]},"hitbox":[4,16,16,4,28,16,16,28],"sprites":[["standardMine",{"key":"main"}]],"frames":{"opening":{"main":{"sprite":"mineOpening1"}},"open":{"main":{"sprite":"mineOpening2"}},"blink":{"main":{"sprite":"mineBlink"}},"hidden":{"main":{"hidden":true,"alpha":0}}},"animations":{"opening":{"easing":"linear","duration":200,"timeline":[{"start":0,"end":0.5,"startFrame":"default","endFrame":"opening"},{"start":0.5,"end":1,"startFrame":"opening","endFrame":"open"}]},"blinking":{"repeat":true,"easing":"linear","duration":400,"timeline":[{"start":0,"end":0.5,"startFrame":"open","endFrame":"blink"},{"start":0.5,"end":1,"startFrame":"blink","endFrame":"open"}]}},"attachHooks":[["explosion",{"x":16,"y":16,"z":2,"attachAlign":["center","center"],"attachTo":"main"}],["smoke",{"x":16,"y":16,"z":-5,"attachAlign":["center","center"],"attachTo":"main"}]],"diskFolder":"enemies.Mine"},"mineCannon":{"attributes":{"width":64,"height":42},"hitbox":[32,24,64,24,64,45,32,45],"sprites":[["turretFoot",{"x":32,"y":24,"key":"foot"}],["mineCannon",{"x":0,"y":0,"key":"barrel","ro":[52,24],"hitbox":[5,10,64,10,64,28,5,28]}],["muzzleFlash",{"x":-20,"y":5,"z":-1,"alpha":0,"scaleY":1.5,"key":"flash","flipX":true,"attachTo":"barrel"}]],"attachHooks":[["gun",{"x":0,"y":8,"z":-20,"attachAlign":["center","left"],"attachTo":"barrel"}],["smoke",{"x":48,"y":32,"z":-1,"attachAlign":["center","center"]}],["explosion",{"x":48,"y":16,"z":2,"attachAlign":["center","center"],"attachTo":"main"}]],"frames":{"dead":{"flash":{"alpha":0},"barrel":{"alpha":0}},"aimHigh":{"barrel":{"rotation":50}},"aimLow":{"barrel":{"rotation":10}},"shotVis":{"flash":{"alpha":1}},"shotHid":{"flash":{"alpha":0}}},"animations":{"blinking":{"repeat":false,"easing":"linear","duration":450,"timeline":[{"start":0,"end":0.1,"startFrame":"shotHid","endFrame":"shotVis"},{"start":0.3,"end":1,"startFrame":"shotVis","endFrame":"shotHid"}]}},"diskFolder":"enemies.MineCannon"},"intro.ship":{"attributes":{"width":800,"height":108},"sprites":[["aircraftCarrierBottomFlat",{"x":-64,"y":10}],["aircraftCarrierBottomSpace",{"x":64,"y":10}],["aircraftCarrierBottomFlat",{"x":192,"y":10}],["aircraftCarrierBottomFlat",{"x":320,"y":10}],["aircraftCarrierBottomFlat",{"x":448,"y":10}],["aircraftCarrierBottomFlat",{"x":576,"y":10}],["aircraftCarrierEnd",{"x":704,"y":-54}],["aircraftCarrierTopFlat",{"x":-64,"y":-54}],["aircraftCarrierTopFlat",{"x":64,"y":-54}],["aircraftCarrierTopFlat",{"x":192,"y":-54}],["aircraftCarrierTopFlat",{"x":320,"y":-54}],["aircraftCarrierTopFlat",{"x":448,"y":-54}],["aircraftCarrierTopFlat",{"x":576,"y":-54}],["boxes",{"x":622,"y":-64,"z":5}],["aircraftCarrierCabinStart",{"x":96,"y":-178,"z":6}],["aircraftCarrierCabinRadar",{"x":128,"y":-178,"z":6}],["aircraftCarrierCabin",{"x":192,"y":-178,"z":6}],["aircraftCarrierCabinRadar",{"x":256,"y":-178,"z":6}],["aircraftCarrierCabin",{"x":320,"y":-178,"z":6}],["aircraftCarrierCabinEnd",{"x":384,"y":-178,"z":6}],["aircraftCarrierRadar",{"x":232,"y":-185,"z":6}],["aircraftCarrierAntenna",{"x":316,"y":-227,"z":6}],["aircraftCarrierAntenna",{"x":158,"y":-227,"z":6}],["aircraftCarrier7",{"x":192,"y":-116,"z":6}],["aircraftCarrier7",{"x":320,"y":-116,"z":6}]],"attachHooks":[["boxLocation1",{"x":650,"y":-10,"z":23}],["boxLocation2",{"x":714,"y":-16,"z":23}],["hatch1",{"x":220,"y":-20,"z":2,"attachAlign":["top","left"]}],["heliStart",{"x":612,"y":-20,"z":6,"attachAlign":["bottom","center"]}],["hatch2",{"x":412,"y":-20,"z":2,"attachAlign":["top","left"]}],["bottom",{"x":-64,"y":70,"z":21,"attachAlign":["top","left"]}]],"diskFolder":"intro"},"intro.boxes":{"attributes":{"width":32,"height":32},"hitbox":[0,7,32,7,32,32,0,32],"sprites":[["boxes",{"x":0,"y":0,"key":"main"}]],"frames":{"falling":{"main":{"sprite":"boxesFalling"}}},"diskFolder":"intro"},"intro.parachute":{"attributes":{"width":32,"height":32,"rotation":0,"ro":[14,2]},"sprites":[["chute",{"x":0,"y":0,"horizon":[0.6,0.6]}]],"frames":{"left":{"attributes":{"rotation":20}},"right":{"attributes":{"rotation":-20}}},"animations":{"default":{"repeat":true,"easing":"linear","duration":5000,"timeline":[{"start":0,"end":0.5,"startFrame":"left","endFrame":"right"},{"start":0.5,"end":1,"startFrame":"right","endFrame":"left"}]}},"diskFolder":"intro"},"city.horizon":{"attributes":{"width":256,"height":160},"sprites":[["coast",{"z":-598,"horizon":[0.9,0.8]}]],"diskFolder":"scenery"},"city.cloud":{"attributes":{"width":256,"height":960},"sprites":[["cloud",{"z":-398,"horizon":[0.95,0.9],"alpha":0.9,"scale":0.5,"key":"main"}]],"frames":{"close":{"main":{"scale":0.8,"horizon":[0.85,0.85]}}},"diskFolder":"scenery"},"city.horizonStart":{"attributes":{"width":256,"height":160},"sprites":[["coastStart",{"z":-598,"horizon":[0.9,0.8]}]],"diskFolder":"scenery"},"city.cityStart":{"attributes":{"width":512,"height":288},"sprites":[["cityStart",{"z":-305,"horizon":[0.4,0.4]}]],"diskFolder":"scenery"},"city.city":{"attributes":{"width":512,"height":288},"sprites":[["city",{"z":-305,"horizon":[0.4,0.4]}]],"diskFolder":"scenery"},"city.cityDistance":{"attributes":{"width":256,"height":224},"sprites":[["cityDistance",{"z":-598,"horizon":[0.9,0.7]}]],"diskFolder":"scenery"},"city.layer2":{"attributes":{"width":384,"height":256},"hitbox":[240,120,240,0,295,0,295,120],"sprites":[["cityLayer2",{"z":-505,"horizon":[0.6,0.6]}],["cityLayer2",{"z":-505,"y":256,"h":80,"crop":[254,0,0,0],"horizon":[0.6,0.6]}]],"diskFolder":"scenery"},"city.bridge.foot":{"attributes":{"width":512,"height":288},"sprites":[["cityBridge",{"z":-305,"horizon":[0.4,0.4]}]],"diskFolder":"scenery"},"city.bridge.deck":{"attributes":{"width":1024,"height":192,"ro":[934,90]},"hitbox":[0,0,1024,0,1024,55,0,55],"spriteAttributes":{"accentColor":"#2ba04c"},"sprites":[["bridgeDeck",{"z":0,"x":4,"key":"deck"}],["bridgeDeck",{"z":1,"x":512,"flipX":true,"key":"deck2"}]],"frames":{"damaged":{"deck":{"sprite":"damagedBridgeDeck"},"deck2":{"sprite":"damagedBridgeDeck"}},"rotateSmall":{"deck":{"sprite":"damagedBridgeDeck"},"deck2":{"sprite":"damagedBridgeDeck"},"attributes":{"rotation":-1}},"rotateMedium":{"deck":{"sprite":"damagedBridgeDeck"},"deck2":{"sprite":"damagedBridgeDeck"},"attributes":{"rotation":-2}},"rotateDown":{"deck":{"sprite":"damagedBridgeDeck"},"deck2":{"sprite":"damagedBridgeDeck"},"attributes":{"rotation":-10}}},"diskFolder":"scenery"},"city.bridge.pillar":{"attributes":{"width":192,"height":544,"ro":[96,544]},"sprites":[["bridgePillar",{"z":0,"key":"pillar"}]],"frames":{"damaged":{"pillar":{"sprite":"bridgePillarBroken"}},"rotateSmall":{"attributes":{"rotation":-1},"pillar":{"sprite":"bridgePillarBroken"}},"rotateMedium":{"attributes":{"rotation":-3},"pillar":{"sprite":"bridgePillarBroken"}},"rotateDown":{"attributes":{"rotation":80},"pillar":{"sprite":"bridgePillarBroken","y":200}}},"diskFolder":"scenery"},"explosion":{"attributes":{"width":96,"height":96},"sprites":[["explosion1",{"key":"main"}]],"animations":{"default":{"duration":350,"timeline":[{"start":0,"end":1,"spriteAnimation":{"key":"main","sprites":["explosion1","explosion2","explosion3","explosion4","explosion5","explosion6","explosion7","explosion8","explosion9","explosion10","explosion11","explosion12","explosion13","explosion14","explosion15","explosion16","explosion17","explosion18","explosion19","explosion20"]}}]}},"diskFolder":"scenery"},"ocean.front":{"attributes":{"width":1024,"height":96},"sprites":[["waterFront1",{"z":-20,"key":"left","horizon":[0.4,0]}],["waterFront2",{"x":512,"z":-20,"key":"right","horizon":[0.4,0]}]],"frames":{"waveR":{"left":{"scaleX":1.125,"x":32,"scaleY":0.95,"y":5},"right":{"scaleX":0.875,"x":32,"scaleY":0.95,"y":5}},"waveL":{"left":{"scaleX":0.875,"x":-32,"scaleY":1.05,"y":-5},"right":{"scaleX":1.125,"x":-32,"scaleY":1.05,"y":-5}}},"animations":{"default":{"repeat":true,"easing":"linear","duration":20000,"timer":"global","timeline":[{"start":0,"end":0.2,"startFrame":"default","endFrame":"waveL"},{"start":0.2,"end":0.5,"startFrame":"waveL","endFrame":"default"},{"start":0.5,"end":0.8,"startFrame":"default","endFrame":"waveR"},{"start":0.8,"end":1,"startFrame":"waveR","endFrame":"default"}]}},"diskFolder":"scenery"},"ocean.middle":{"attributes":{"width":512,"height":192},"sprites":[["waterMiddle",{"z":-500,"w":513,"key":"middle","horizon":[0.8,0.1]}]],"frames":{"wave":{"middle":{"y":4}}},"animations":{"default":{"repeat":true,"easing":"linear","duration":10000,"timer":"global","timeline":[{"start":0,"end":0.5,"startFrame":"default","endFrame":"wave"},{"start":0.5,"end":1,"startFrame":"wave","endFrame":"default"}]}},"diskFolder":"scenery"},"ocean.horizon":{"attributes":{"width":260,"height":160},"sprites":[["waterHorizon",{"z":-600,"w":260,"horizon":[1,0.4]}]],"diskFolder":"scenery"},"background.night":{"attributes":{"width":1024,"height":576},"sprites":[["stars",{"z":0,"y":-100,"w":672,"h":288,"key":"topleft","ro":[672,288]}],["stars",{"z":0,"w":672,"h":288,"x":672,"y":-100,"key":"topright","attachTo":"topleft"}],["stars",{"z":0,"w":672,"h":288,"x":0,"y":188,"key":"bottomleft","attachTo":"topleft"}],["stars",{"z":0,"w":672,"h":288,"x":672,"y":188,"key":"bottomright","attachTo":"topleft"}]],"frames":{"middle":{"topleft":{"rotation":-3}},"end":{"topleft":{"alpha":0.5,"rotation":-6},"topright":{"alpha":0.5},"bottomleft":{"alpha":0.5},"bottomright":{"alpha":0.5}}},"diskFolder":"scenery"},"background.horizon":{"attributes":{"width":1230,"height":50},"gradients":[{"z":2,"w":1230,"h":50,"key":"sky","topColor":["#dddd00",0],"bottomColor":["#dddd00",1]}],"frames":{"dawn":{"sky":{"h":80,"topColor":["#dddd00",0],"bottomColor":["#dddd00",0.6]}}},"diskFolder":"scenery"},"background.sky":{"attributes":{"width":1230,"height":576},"gradients":[{"z":2,"w":1230,"h":400,"key":"sky","topColor":["#000000",0],"bottomColor":["#000000",0]}],"frames":{"dawn":{"sky":{"topColor":["#000020",0.3],"bottomColor":["#213a9e",0.6]}},"dawn2":{"sky":{"topColor":["#0f1630",0.5],"bottomColor":["#5e6d9f",0.8]}},"dawn3":{"sky":{"topColor":["#191f3d",0.8],"bottomColor":["#8b8289",1]}},"dawn4":{"sky":{"topColor":["#27273d",1],"bottomColor":["#cb8946",1]}},"dawn5":{"sky":{"topColor":["#3e2d30",1],"bottomColor":["#fd7321",1]}},"dawn6":{"sky":{"topColor":["#383b65",1],"bottomColor":["#fdab3a",1]}},"dawn7":{"sky":{"topColor":["#354898",1],"bottomColor":["#fcc67b",1]}},"dawn8":{"sky":{"topColor":["#3856c1",1],"bottomColor":["#f3d7b1",1]}},"dawn9":{"sky":{"topColor":["#477cfc",1],"bottomColor":["#babcd9",1]}}},"diskFolder":"scenery"},"background.sun":{"attributes":{"width":96,"height":96,"scale":0.6},"sprites":[["sun",{"x":0,"y":0,"z":4,"crop":[1,1,1,1]}],["directGlare",{"x":-40,"y":-40,"z":2000,"crop":[1,1,1,1],"alpha":0,"key":"glare"}]],"frames":{"noGlare":{"glare":{"maxAlpha":0}},"full":{"attributes":{"scale":1},"glare":{"maxAlpha":1}},"large":{"attributes":{"scale":1.2},"glare":{"maxAlpha":0}}},"diskFolder":"scenery"},"dino":{"attributes":{"width":200,"height":153},"sprites":[["dinoBody",{"z":2,"ro":[82,24],"key":"body"}],["dinoTentacles",{"x":26,"y":37,"z":2,"ro":[16,16],"attachTo":"body"}],["dinoArm",{"x":16,"y":82,"z":3,"ro":[34,16],"key":"arm","attachTo":"body"}],["dinoNeck",{"x":-32,"y":42,"z":1,"ro":[50,16],"key":"neck","attachTo":"body"}],["dinoJaw",{"x":-89,"y":52,"z":1,"ro":[70,16],"key":"jaw","attachTo":"neck"}],["dinoTongue",{"x":-39,"y":52,"z":-1,"ro":[70,16],"attachTo":"neck","key":"tongue"}],["dinoHead",{"x":-94,"y":23,"z":2,"ro":[70,37],"key":"head","attachTo":"neck"}],["dinoTail",{"x":124,"y":24,"z":1,"ro":[10,22],"attachTo":"body"}],["dinoUpperLeg",{"x":116,"y":46,"z":3,"ro":[32,16],"key":"upperLeg","attachTo":"body"}],["dinoLowerLeg",{"x":144,"y":86,"z":5,"rotation":-55,"ro":[16,16],"key":"lowerLeg","attachTo":"upperLeg"}],["dinoFeet",{"x":172,"y":114,"z":6,"ro":[26,8],"key":"feet","attachTo":"lowerLeg"}],["dinoToes",{"x":157,"y":118,"z":7,"ro":[22,20],"attachTo":"feet"}],["dinoBackUpperLeg",{"x":114,"y":36,"z":-3,"ro":[22,20],"key":"backUpperLeg","attachTo":"body"}],["dinoBackLowerLeg",{"x":114,"y":63,"z":-2,"ro":[16,20],"key":"backLowerLeg","attachTo":"backUpperLeg"}],["dinoBackFeet",{"x":98,"y":95,"z":-1,"ro":[24,16],"key":"backFeet","attachTo":"backLowerLeg"}],["dinoBackToes",{"x":82,"y":95,"z":0,"ro":[26,11],"key":"backToes","attachTo":"backFeet"}]],"frames":{"roar1":{"head":{"rotation":40},"jaw":{"rotation":-42,"x":-8},"tongue":{"x":-20},"neck":{"rotation":0},"body":{"rotation":20},"arm":{"rotation":-40},"tail":{"rotation":-10},"topLeg":{"rotation":25},"bottomLeg":{"rotation":-50},"feet":{"rotation":-10},"toes":{"rotation":-10},"upperLegBack":{"rotation":10},"lowerLegBack":{"rotation":-60},"feetBack":{"rotation":-80},"toesBack":{"rotation":0}}},"diskFolder":"test"},"test.wall":{"attributes":{"width":40,"height":150},"gradients":[{"w":40,"h":150,"topColor":["#606060",1],"bottomColor":["#606060",1]}],"diskFolder":"test"}},"entities":{"PlayerShip":{"structure":{"composition":"player.ship","components":["ViewportLocked","DamageSupport","SunBlock","LaserSolid"],"animation":null,"attachments":{"mainWeapon":{"weapon":{"pattern":"player.bullets","target":"PlayerEnemy","angle":180}},"laserWeapon":{"weapon":{"pattern":"player.laser","target":"PlayerEnemy","angle":180}},"trail":null,"reverseTrail":null,"reverseTrail2":null}},"states":{"dead":{"frame":"hidden","audio":"explosion","attachments":{"trail":null,"reverseTrail":null,"reverseTrail2":null,"mainWeapon":null,"explosion":{"composition":"weapons.largeExplosion","animation":"default"}}},"damaged":{"frame":"damaged"},"shooting":{"attachments":{"mainWeapon":{"weapon":{"active":true}}}},"noShooting":{"attachments":{"mainWeapon":{"weapon":{"active":false}}}},"laserShooting":{"attachments":{"laserWeapon":{"weapon":{"active":true}}}},"noLaserShooting":{"attachments":{"laserCharge":null,"laserWeapon":{"weapon":{"active":false}}}},"laserCharge":{"attachments":{"laserCharge":{"particles":{"emitter":"player.laserCharge"}}}},"stopLaserCharge":{"attachments":{"laserCharge":null}},"starting":{"attachments":{"trail":{"particles":{"emitter":["player.trail",{"particle":{"velocity":50,"startSize":10},"emitter":{"amount":100}}]}},"reverseTrail":null,"reverseTrail2":null}},"flying":{"attachments":{"trail":{"particles":{"emitter":"player.trail"}},"reverseTrail":null,"reverseTrail2":null}},"reverse":{"attachments":{"trail":null,"reverseTrail":{"particles":{"emitter":"player.reverse"}},"reverseTrail2":{"particles":{"emitter":"player.reverse"}}}},"turned":{"frame":"turned"},"turning":{"animation":"turnAround"},"turningDamaged":{"animation":"turnAroundDamaged"}},"habitats":[{"name":"Ocean","scenery":"City.Ocean","position":{"x":200,"y":380},"scrollSpeed":{"vx":-100,"vy":0},"background":["City.Sunrise",3]}],"diskFolder":"PlayerShip"},"ExtraLife":{"structure":{"composition":"powerups.life","animation":"default","components":["DamageSupport","PlayerHit"]},"states":{"pickedUp":{"frame":["pickedUp",{"duration":300}],"animation":null,"audio":"powerup","attachments":{"explosion":{"particles":{"emitter":"powerup.pickup"}}}},"disappear":{"animation":null,"frame":"disappear"}},"diskFolder":"common"},"Bonus":{"structure":{"composition":"powerups.bonus","animation":"default","components":["DamageSupport","PlayerHit"]},"states":{"pickedUp":{"frame":["pickedUp",{"duration":300}],"animation":null,"audio":"powerup","attachments":{"explosion":{"particles":{"emitter":["powerup.pickup",{"particle":{"startColor":[0.65,0.48,0,0.6],"endColor":[0.65,0.48,0,0]}}]}}}},"disappear":{"animation":null,"frame":"disappear"}},"diskFolder":"common"},"Upgrade":{"structure":{"composition":"powerups.upgrade","animation":"default","components":["DamageSupport","PlayerHit"]},"states":{"pickedUp":{"frame":["pickedUp",{"duration":300}],"animation":null,"audio":"powerup","attachments":{"explosion":{"particles":{"emitter":["powerup.pickup",{"particle":{"startColor":[0.1,0.7,0.1,0.6],"endColor":[0.3,0.7,0.3,0]}}]}}}},"disappear":{"animation":null,"frame":"disappear"}},"diskFolder":"common"},"Radar":{"structure":{"composition":"droneShip.radar","frame":"emitEnd"},"states":{"pulse":{"animation":"pulse"},"stopPulse":{"animation":null,"frame":"emitEnd"},"dead":{"animation":null,"audio":"explosion","removeComponents":["SolidCollision","PlayerEnemy"],"frame":"broken","attachments":{"explosion":{"composition":"explosion","animation":"default"},"smoke":{"particles":{"emitter":["smoke",{"emitter":{"w":10,"h":2,"amount":100,"duration":6000}}]}}}}},"diskFolder":"common"},"HeliRocket":{"structure":{"composition":"weapons.rocket","components":["PlayerHit"],"frame":"small","attachments":{"trail":{"particles":{"emitter":"missile.trail"}},"tip":null}},"states":{"hide":{"attachments":{"trail":null,"tip":null}},"explode":{"frame":"hidden","attachments":{"trail":null,"tip":{"weapon":{"pattern":"mine.explosion","target":"PlayerShip","angle":0,"active":true}}}},"waterHit":{"attachments":{"trail":null,"tip":{"particles":{"emitter":["fountain",{"emitter":{"w":60,"duration":1000}}]}}}}},"habitats":[{"name":"Ocean","scenery":"City.Ocean","scrollSpeed":{"vx":-100,"vy":0},"background":["City.Sunrise",2]}],"diskFolder":"common"},"BattleShip":{"structure":{"composition":"battleship.deck","components":["ShipSolid","GravitySolid",["HideBelow",{"hideBelow":540,"z":-12}]],"attachments":{"bottom":{"particles":{"emitter":["waterSplashes",{"emitter":{"warmed":true}}]}},"cabin1":{"composition":"battleship.firstCabin","attachments":{"radar":{"entity":"Radar"}}},"cabin1burn":null,"cabin2burn":null,"cabin2":{"composition":"battleship.secondCabin","components":["DamageSupport"]},"mineCannon":{"entity":"MineCannon"},"deckGun1":{"entity":"BulletCannon"},"deckGun2":{"entity":"BulletCannon"},"deckGun3":{"entity":"LaserCannon","state":"mirrored"},"package":{"composition":"cloth","frame":"medium"},"boxLocation1":{"entity":"ShipBoxes"},"boxLocation2":{"entity":"ShipBoxes"},"boxLocation3":{"composition":"intro.boxes"},"hatch1":{"composition":"shipHatch","attachments":{"payload":{"entity":"BulletCannon","state":"mirrored"}}},"hatch2":{"composition":"shipHatch","attachments":{"payload":{"entity":"BulletCannon"}}},"hatch3":{"composition":"shipHatch","attachments":{"payload":{"entity":"BulletCannon"}}},"heliPlace1":{"entity":"Helicopter","state":"landed"},"heliPlace2":{"entity":"Helicopter","state":"landed"},"engineCore":{"composition":"battleship.engine","frame":"perc0"}}},"states":{"risen":{"frame":"risen"},"lowered":{"frame":"lowered"},"sinking":{"frame":"sinking"},"t1o":{"attachments":{"hatch1":{"frame":"open"}}},"t1r":{"attachments":{"hatch1":{"frame":"risen"}}},"t2o":{"attachments":{"hatch2":{"frame":"open"}}},"t2r":{"attachments":{"hatch2":{"frame":"risen"}}},"t3o":{"attachments":{"hatch3":{"frame":"open"}}},"t3r":{"attachments":{"hatch3":{"frame":"risen"}}},"engineDoorOpen":{"audio":"hatch-open","attachments":{"cabin1":{"composition":"battleship.firstCabin"},"cabin1burn":null,"cabin2burn":null,"cabin2":{"composition":"battleship.secondCabin","frame":["open",{"easing":"easeInOutQuad","duration":2000}]}}},"engineTilt":{"attachments":{"cabin1":{"composition":"battleship.firstCabin"},"cabin1burn":null,"cabin2burn":null,"cabin2":{"composition":"battleship.secondCabin","frame":["open",{"easing":"easeInOutQuad","duration":2000}]},"engineCore":{"composition":"battleship.engine","animation":"heavyShake","attachments":{"smoke":{"particles":{"emitter":["smoke",{"emitter":{"w":60,"amount":50}}]}}}}}},"engineDestroyed":{"audio":"explosion","attachments":{"engineCore":{"frame":"destroyed","animation":null,"attachments":{"explosion":{"composition":"weapons.largeExplosion","animation":"default"}}}}},"packageOpen":{"attachments":{"package":{"frame":"down"},"laserField":{"entity":"LaserCannonForceField"}}},"cabin1Explode":{"attachments":{"cabin1explode":{"weapon":{"pattern":"building.explosion","target":"PlayerShip","angle":0,"active":true}},"cabin1burn":{"particles":{"emitter":["smoke",{"emitter":{"w":160}}]}}}},"cabin1Smoke":{"attachments":{"cabin1":{"composition":"battleship.firstCabinDestroyed"},"cabin1burn":{"particles":{"emitter":["smoke",{"emitter":{"w":160}}]}}}},"cabin2Explode":{"attachments":{"cabin2explode":{"weapon":{"pattern":"building.explosion2","target":"PlayerShip","angle":0,"active":true}},"cabin2burn":{"particles":{"emitter":["smoke",{"emitter":{"w":220}}]}}}},"cabin2Smoke":{"attachments":{"cabin2":{"composition":"battleship.secondCabinDestroyed"},"cabin2burn":{"particles":{"emitter":["smoke",{"emitter":{"w":220}}]}},"engineCore":null}}},"habitats":[{"name":"Start","scenery":"City.Coast","position":{"rx":0.8,"ry":0.7},"scrollSpeed":{"vx":-100,"vy":0},"background":["City.Sunrise",2]},{"name":"Fase 1","scenery":"City.Coast","position":{"rx":0.5,"ry":0.7},"scrollSpeed":{"vx":-100,"vy":0},"background":["City.Sunrise",2]},{"name":"Fase 2","scenery":"City.Coast","position":{"rx":-0.17,"ry":0.65},"scrollSpeed":{"vx":-100,"vy":0},"background":["City.Sunrise",2]},{"name":"Fase 3","scenery":"City.Coast","position":{"rx":-0.7,"ry":0.7},"scrollSpeed":{"vx":100,"vy":0},"background":["City.Sunrise",2]},{"name":"Sunk","scenery":"City.Coast","position":{"rx":-0.2,"ry":0.85},"scrollSpeed":{"vx":100,"vy":0},"background":["City.Sunrise",2]}],"diskFolder":"enemies.BattleShip"},"BulletCannon":{"structure":{"composition":"bulletCannon","attachments":{"gun":{"weapon":{"pattern":"cannon.gun","target":"PlayerShip","angle":0,"barrel":"barrel"}},"smoke":null}},"states":{"mirrored":{"frame":"mirrored"},"dead":{"animation":"dead","audio":"explosion","removeComponents":["SolidCollision","PlayerEnemy"],"attachments":{"smoke":{"particles":{"emitter":["smoke",{"emitter":{"w":10,"h":2,"amount":100,"duration":6000}}]}},"gun":null,"explosion":{"composition":"explosion","animation":"default"}}},"shells":{"attachments":{"explosion":{"particles":{"emitter":["shells",{"emitter":{"w":10,"h":10,"amount":170,"duration":200}}]}}}},"noshells":{"attachments":{"explosion":null}},"shooting":{"attachments":{"gun":{"weapon":{"active":true}}}}},"diskFolder":"enemies.BulletCannon"},"WarDrone":{"structure":{"composition":"drone","components":["DamageSupport","GravitySupport","SolidCollision","PlayerEnemy","PlayerHit"],"attachments":{"trail":{"particles":{"emitter":"drone.trail"}}}},"states":{"damaged":{"frame":"damaged","attachments":{"trail":null}},"turned":{"frame":"turned"},"dead":{"frame":"hidden","audio":"explosion","removeComponents":["SolidCollision","PlayerEnemy"],"attachments":{"trail":null,"explosion":{"composition":"explosion","animation":"default"},"smoke":{"particles":{"emitter":"drone.smoke"}}}}},"habitats":[{"name":"Ocean","scenery":"City.Ocean","scrollSpeed":{"vx":-100,"vy":0},"background":["City.Sunrise",2]}],"diskFolder":"enemies.Drone"},"DroneShip":{"structure":{"composition":"droneShip.main","components":["ShipSolid",["HideBelow",{"hideBelow":540,"z":-12}]],"attachments":{"bottom":{"particles":{"emitter":["waterSplashes",{"emitter":{"w":550,"amount":300,"warmed":true}}]}},"hatch1":{"composition":"shipHatch"},"gun":{"entity":"BulletCannon"},"boxLocation1":{"entity":"ShipBoxes"},"radar":{"entity":"Radar","state":"stopPulse"}}},"states":{"t1o":{"attachments":{"hatch1":{"frame":"open"}}},"t1r":{"attachments":{"hatch1":{"frame":"risen"}}},"activateGun":{"attachments":{"gun":{"state":"shooting"}}},"deactivateGun":{"attachments":{"gun":{"state":"default"}}},"gunDestroyed":{"attachments":{"gun":{"state":"dead"}}},"radarPulse":{"attachments":{"radar":{"state":"pulse"}}},"radarStopPulse":{"attachments":{"radar":{"state":"stopPulse"}}},"radarDestroyed":{"attachments":{"radar":{"state":"dead"}}}},"habitats":[{"name":"Ocean","scenery":"City.Ocean","position":{"rx":0.3,"ry":0.7},"scrollSpeed":{"vx":-40,"vy":0},"background":["City.Sunrise",1]}],"diskFolder":"enemies.DroneShip"},"Helicopter":{"structure":{"composition":"helicopter","components":["DamageSupport","GravitySupport","SunBlock"],"attachments":{"gun":{"weapon":{"pattern":"heli.gun","target":"PlayerShip","angle":-5,"barrel":"barrel"}},"rockets":{"weapon":{"pattern":"heli.rocket","target":"PlayerShip"}},"smoke":null}},"states":{"damaged":{"frame":"damaged"},"crashed":{"frame":"damaged","attachments":{"smoke":{"particles":{"emitter":["smoke",{"emitter":{"w":50,"h":10,"amount":100,"duration":2000}}]}}}},"landed":{"frame":"landed"},"foreground":{"frame":"foreground"},"dead":{"frame":"damaged","animation":null,"audio":"explosion","removeComponents":["SolidCollision","PlayerEnemy"],"attachments":{"rockets":{"weapon":{"active":false},"composition":"explosion","animation":"default"},"smoke":{"particles":{"emitter":["smoke",{"emitter":{"w":50,"h":10,"amount":100}}]}},"gun":null}},"flying":{"animation":"flying"},"toForeground":{"animation":"turning"},"tilted":{"frame":"tilted"},"leveled":{"frame":"leveled"},"turning":{"animation":"turnAround","gun":{"weapon":{"active":false}},"rockets":{"weapon":{"active":false}}},"shooting":{"animation":"flying","attachments":{"gun":{"weapon":{"active":true}},"rockets":{"weapon":{"active":true}}}}},"habitats":[{"name":"Ocean","scenery":"City.Ocean","scrollSpeed":{"vx":-100,"vy":0},"background":["City.Sunrise",1]}],"diskFolder":"enemies.Helicopter"},"LargeDrone":{"structure":{"composition":"largeDrone","components":["DamageSupport","GravitySupport","SolidCollision","PlayerEnemy"],"attachments":{"trail":{"particles":{"emitter":["drone.trail",{"particle":{"startSize":15}}]}},"rockets":{"weapon":{"pattern":"largeDrone.homingRocket","target":"PlayerShip"}},"rockets2":{"weapon":{"pattern":"largeDrone.rockets","target":"PlayerShip"}}}},"states":{"eyeMove":{"animation":"eye","attachments":{"trail":{"particles":{"emitter":["drone.trail",{"particle":{"startSize":20}}]}}}},"laugh":{"animation":"laugh","audio":"laugh"},"reload":{"animation":"rocketReload"},"shootRockets":{"attachments":{"rockets":{"weapon":{"active":true,"maxBursts":1}}}},"rocketStrike":{"attachments":{"rockets2":{"weapon":{"active":true,"maxBursts":1}}}},"fireRocket":{"animation":"rocketShot"},"reloadRocket":{"animation":"rocketReload"},"damaged":{"frame":"damaged","attachments":{"trail":null}},"turned":{"frame":"turned"},"dead":{"frame":"hidden","audio":"explosion","removeComponents":["SolidCollision","PlayerEnemy"],"attachments":{"trail":null,"explosion":{"composition":"explosion","animation":"default"},"smoke":{"particles":{"emitter":"drone.smoke"}}}}},"habitats":[{"name":"Ocean","scenery":"City.Ocean","scrollSpeed":{"vx":-100,"vy":0},"background":["City.Sunrise",1]},{"name":"Bridge","scenery":"City.Bridge","scrollSpeed":{"vx":0,"vy":0},"background":["City.Sunrise",3]}],"diskFolder":"enemies.LargeDrone"},"LargeBackgroundDrone":{"structure":{"composition":"largeDrone","frame":"background","components":[],"attachments":{"trail":{"particles":{"emitter":["drone.trail",{"particle":{"startSize":15}}]}},"gun":{"weapon":{"pattern":"largeDrone.takeover","target":"IntroHeliBackground"}}}},"states":{"eyeMove":{"animation":"eye"},"turned":{"frame":"turned"},"shoot":{"attachments":{"gun":{"weapon":{"active":true}}}}},"habitats":[{"name":"Ocean","scenery":"City.Ocean","scrollSpeed":{"vx":-100,"vy":0},"background":["City.Sunrise",1]}],"diskFolder":"enemies.LargeDrone"},"LaserCannon":{"structure":{"composition":"laserCannon","attachments":{"gun":{"weapon":{"pattern":"cannon.laser","target":"PlayerShip","angle":0,"barrel":"barrel"}},"smoke":null}},"states":{"mirrored":{"frame":"mirrored"},"close":{"frame":["close",{"duration":300}],"attachments":{"gun":null,"charge":null}},"open":{"frame":["open",{"duration":300}]},"charge":{"attachments":{"charge":{"particles":{"emitter":"laserCharge"}}}},"charged":{"frame":"charge","attachments":{"charge":null}},"discharge":{"frame":"done","attachments":{"charge":null,"discharge":{"particles":{"emitter":["smoke",{"emitter":{"w":10,"h":2,"amount":200,"duration":300}}]}}}},"dead":{"animation":"dead","audio":"explosion","removeComponents":["SolidCollision","PlayerEnemy"],"attachments":{"smoke":{"particles":{"emitter":["smoke",{"emitter":{"w":10,"h":2,"amount":100,"duration":3000}}]}},"charge":null,"gun":null,"explosion":{"composition":"explosion","animation":"default"}}},"shooting":{"attachments":{"gun":{"weapon":{"active":true}}}}},"habitats":[{"name":"Test walls","scenery":"Test.Walls","position":{"rx":0.4,"ry":0.6},"scrollSpeed":{"vx":0,"vy":0}}],"diskFolder":"enemies.LaserCannon"},"LaserCannonForceField":{"structure":{"particles":{"emitter":["forceField",{"emitter":{"w":140,"h":75,"amount":200}}]},"components":["SolidCollision"]},"states":{"stopped":{"particles":{"emitter":["forceFieldDisperse",{"emitter":{"w":140,"h":75,"amount":200,"warmed":true}}]}},"started":{"particles":{"active":true}}},"diskFolder":"enemies.LaserCannon"},"Mine":{"structure":{"composition":"mine","components":[["DamageSupport",{"weight":20}],"SolidCollision",["SubmergeSupport",{"submergeSprite":"shadow"}],"PlayerEnemy",["Rotating",{"vr":0}]],"attachments":{"explosion":{}}},"states":{"rotate":{"components":[["Rotating",{"vr":40}]]},"open":{"animation":"opening"},"blinking":{"components":[["Rotating",{"vr":120}]],"animation":"blinking"},"dead":{"components":[["Rotating",{"vr":0}]],"frame":"hidden","removeComponents":["SolidCollision","PlayerEnemy"],"attachments":{"explosion":{"weapon":{"pattern":"mine.explosion","target":"PlayerShip","angle":0,"active":true}},"smoke":{"particles":{"emitter":["drone.smoke",{"emitter":{"w":60,"h":60,"amount":450,"duration":600},"particle":{"startSize":30,"endSize":20}}]}}}},"explode":{"components":[["Rotating",{"vr":0}]],"frame":"hidden","removeComponents":["SolidCollision","PlayerEnemy"],"attachments":{"explosion":{"weapon":{"pattern":"mine.blast","target":"PlayerShip","angle":0,"active":true}},"smoke":{"particles":{"emitter":["drone.smoke",{"emitter":{"w":60,"h":60,"amount":450,"duration":600},"particle":{"startSize":30,"endSize":20}}]}}}}},"habitats":[{"name":"Ocean","scenery":"City.Ocean","scrollSpeed":{"vx":-100,"vy":0},"background":["City.Sunrise",2]}],"diskFolder":"enemies.Mine"},"MineCannon":{"structure":{"composition":"mineCannon","attachments":{"smoke":null}},"states":{"dead":{"frame":["dead",{"duration":0}],"animation":null,"audio":"explosion","removeComponents":["SolidCollision","PlayerEnemy"],"attachments":{"smoke":{"particles":{"emitter":["smoke",{"emitter":{"w":10,"h":2,"amount":100,"duration":3000}}]}},"gun":null,"explosion":{"composition":"explosion","animation":"default"}}},"aimLow":{"frame":["aimLow",{"duration":1500}]},"aimHigh":{"frame":["aimHigh",{"duration":1500}]},"shoot":{"animation":"blinking","audio":"explosion"}},"diskFolder":"enemies.MineCannon"},"IntroShip":{"structure":{"composition":"intro.ship","components":["ShipSolid","GravitySolid",["HideBelow",{"hideBelow":540,"z":-12}]],"attachments":{"bottom":{"particles":{"emitter":["waterSplashes",{"emitter":{"w":850,"amount":300,"warmed":true}}]}},"hatch1":{"composition":"shipHatch"},"hatch2":{"composition":"shipHatch","attachments":{"payload":{"name":"player1","entity":"PlayerShip"}}},"boxLocation1":{"entity":"ShipBoxes"},"boxLocation2":{"entity":"ShipBoxes"},"heliStart":{"entity":"IntroHeli"}}},"states":{"t1o":{"attachments":{"hatch1":{"frame":"open"}}},"t1r":{"attachments":{"hatch1":{"frame":"risen"}}},"t2o":{"attachments":{"hatch2":{"frame":"open"}}},"closed":{"attachments":{"hatch2":{"frame":"closed"}}},"t2r":{"attachments":{"hatch2":{"frame":"risen"}}},"heliStart":{"attachments":{"heliStart":{"state":"liftOff"}}},"shipStart":{"attachments":{"hatch2":{"frame":"risen","attachments":{"player1":{"state":"starting"}}}}},"shipLiftOff":{"attachments":{"hatch2":{"frame":"risen","attachments":{"player1":{"state":"flying"}}}}}},"habitats":[{"name":"Ocean","scenery":"City.Ocean","position":{"rx":-0.3,"ry":0.8},"scrollSpeed":{"vx":-40,"vy":0},"background":["City.Sunrise",0]}],"diskFolder":"intro"},"IntroHeli":{"structure":{"composition":"helicopter","attributes":{"scale":0.8}},"states":{"start":{"frame":"default","animation":false},"liftOff":{"animation":"flying"},"flying":{"frame":"tilted","animation":"flying"}},"diskFolder":"intro"},"IntroHeliBackground":{"structure":{"composition":"helicopter","frame":"background","components":["DamageSupport"]},"states":{"flying":{"animation":"flyingBackground"},"shot":{"animation":"flyingBackground","attachments":{"sparks":{"particles":{"emitter":"electric"}}}}},"habitats":[{"name":"Ocean","scenery":"City.Ocean","position":{"rx":0.3,"ry":0.3},"scrollSpeed":{"vx":-80,"vy":0},"background":["City.Sunrise",0]}],"diskFolder":"intro"},"IntroParachute":{"structure":{"composition":"intro.parachute"},"habitats":[{"name":"Ocean","scenery":"City.Ocean","position":{"rx":0.3,"ry":0.3},"scrollSpeed":{"vx":-80,"vy":0},"background":["City.Sunrise",0]}],"diskFolder":"intro"},"ShipBoxes":{"structure":{"composition":"intro.boxes","components":["GravitySupport","PlayerHit"]},"states":{"falling":{"frame":"falling"}},"diskFolder":"intro"},"Sun":{"structure":{"composition":"background.sun","components":[["LightGlare",{"glareAlphaLink":"glare"}],["Overlap",{"checkCollission":"SunBlock","applyAlphaTo":"glare"}]]},"states":{"full":{"frame":"full"},"large":{"frame":"large"}},"habitats":[],"diskFolder":"scenery"}},"particles":{"dust.bridge":{"emitter":{"w":1024,"h":10,"amount":300,"fidelity":"low","duration":3000},"gravity":[0,95],"particle":{"sprite":"explosion7","angle":0,"duration":4000,"angleRandom":20,"velocity":10,"startSize":40,"startSizeRandom":15,"endSize":20,"endSizeRandom":5,"startColor":[0.17,0.17,0.17,0.4],"endColor":[0.17,0.17,0.17,0]},"diskFolder":"common"},"powerup.pickup":{"emitter":{"w":2,"h":2,"amount":600,"duration":200},"gravity":[0,-50],"particle":{"sprite":"explosion7","angle":0,"angleRandom":360,"duration":1000,"durationRandom":0,"velocity":120,"velocityRandom":40,"startSize":15,"endSize":5,"startColor":[0.7,0.1,0.1,0.6],"endColor":[0.7,0.3,0.3,0]},"diskFolder":"common"},"waterSplashes":{"emitter":{"w":1300,"h":10,"amount":500,"fidelity":"low"},"gravity":[-80,5],"particle":{"sprite":"explosion7","angle":0,"angleRandom":20,"velocity":10,"startSize":30,"endSize":30,"startColor":[1,1,1,0.8],"endColor":[0.8,0.8,0.8,0],"endColorRandom":[0.1,0.1,0,0.2]},"diskFolder":"common"},"player.trail":{"emitter":{"w":2,"h":2,"amount":200,"fidelity":"high"},"particle":{"sprite":"explosion7","angle":180,"angleRandom":0,"duration":500,"durationRandom":0,"velocity":200,"velocityRandom":10,"startSize":12,"endSize":1,"startColor":[1,0.8,0.5,0.6],"startColorRandom":[0,0.05,0,0],"endColor":[0.9,0.2,0.2,0],"endColorRandom":[0,0,0,0]},"diskFolder":"common"},"player.trail2":{"emitter":{"w":2,"h":2,"amount":200,"fidelity":"high"},"particle":{"sprite":"explosion7","angle":180,"angleRandom":0,"duration":500,"durationRandom":0,"velocity":200,"velocityRandom":10,"startSize":8,"endSize":1,"startColor":[1,0.8,0.5,0.6],"startColorRandom":[0,0.05,0,0],"endColor":[0.9,0.2,0.2,0],"endColorRandom":[0,0,0,0]},"diskFolder":"common"},"player.reverse":{"emitter":{"w":2,"h":2,"amount":200,"fidelity":"high"},"particle":{"sprite":"explosion7","angle":0,"angleRandom":0,"duration":500,"durationRandom":0,"velocity":200,"velocityRandom":10,"startSize":5,"endSize":1,"startColor":[1,0.8,0.5,0.6],"startColorRandom":[0,0.05,0,0],"endColor":[0.9,0.2,0.2,0],"endColorRandom":[0,0,0,0]},"diskFolder":"common"},"missile.trail":{"emitter":{"w":2,"h":2,"amount":200,"fidelity":"high"},"gravity":[0,0],"particle":{"sprite":"explosion7","angle":0,"angleRandom":0,"duration":1300,"durationRandom":0,"velocity":0,"velocityRandom":0,"startSize":10,"endSize":1,"startColor":[0.7,0.7,0.5,0.6],"startColorRandom":[0,0,0,0],"endColor":[0.3,0.3,0.3,0],"endColorRandom":[0,0,0,0]},"diskFolder":"common"},"explosion":{"emitter":{"w":2,"h":2,"amount":200,"duration":500},"gravity":[0,40],"particle":{"sprite":"explosion7","angles":[0,20,100,180,230,330],"duration":1000,"durationRandom":0,"velocity":50,"velocityRandom":10,"startSize":30,"endSize":1,"startColor":[0.3,0.2,0.1,1],"startColorRandom":[0,0,0,0],"endColor":[0.1,0.1,0.1,0],"endColorRandom":[0,0,0,0]},"diskFolder":"common"},"electric":{"emitter":{"w":70,"h":15,"amount":150,"duration":1500},"particle":{"sprite":"explosion7","angle":0,"angleRandom":20,"duration":800,"durationRandom":0,"velocity":20,"velocityRandom":0,"startSize":4,"startSizeRandom":2,"endSize":2,"endSizeRandom":1,"startColor":[1,1,0,0.4],"startColorRandom":[0,0,0,0],"endColor":[0.2,0.5,1,0.1],"endColorRandom":[0,0,0,0]},"diskFolder":"common"},"sparks":{"emitter":{"w":2,"h":2,"amount":200,"duration":350},"gravity":[0,200],"particle":{"sprite":"explosion7","angle":0,"angleRandom":70,"duration":500,"durationRandom":0,"velocity":90,"velocityRandom":0,"startSize":2,"startSizeRandom":0,"endSize":3,"endSizeRandom":2,"startColor":[1,1,0,0.6],"startColorRandom":[0,0,0,0],"endColor":[1,1,0,0.2],"endColorRandom":[0,0,0,0]},"diskFolder":"common"},"laserHit":{"emitter":{"w":4,"h":4,"amount":200,"duration":500},"gravity":[0,100],"particle":{"sprite":"explosion7","angle":0,"angleRandom":70,"duration":500,"durationRandom":0,"velocity":50,"velocityRandom":0,"startSize":10,"startSizeRandom":4,"endSize":4,"endSizeRandom":2,"startColor":[1,0.4,0,0.8],"startColorRandom":[0.2,0.1,0,0],"endColor":[1,0.4,0,0.2],"endColorRandom":[0,0,0,0]},"diskFolder":"common"},"player.laserCharge":{"emitter":{"w":2,"h":2,"amount":70,"reverse":true},"gravity":[0,10],"particle":{"sprite":"explosion7","angle":0,"angleRandom":60,"duration":500,"durationRandom":0,"velocity":100,"velocityRandom":15,"startSize":6,"startSizeRandom":1,"endSize":1,"endSizeRandom":0,"startColor":[1,0.2,0,0.8],"startColorRandom":[0.9,0,0,0],"endColor":[1,1,0.3,0.2],"endColorRandom":[0,0,0,0]},"diskFolder":"common"},"smoke":{"emitter":{"w":160,"h":20,"amount":300},"gravity":[20,-60],"particle":{"sprite":"explosion7","angle":0,"angleRandom":20,"duration":2500,"durationRandom":500,"velocity":10,"startSize":30,"endSize":80,"startColor":[0.1,0.1,0.1,1],"startColorRandom":[0,0,0,0.2],"endColor":[0.1,0.1,0.1,0],"endColorRandom":[0,0,0,0]},"diskFolder":"common"},"fountain":{"emitter":{"w":10,"h":10,"amount":300},"gravity":[0,90],"particle":{"sprite":"explosion7","angle":-90,"angleRandom":50,"velocity":120,"startSize":10,"endSize":10,"startColor":[1,1,1,0.8],"startColorRandom":[0,0.1,0,0.2],"endColor":[0.1,0.1,0.1,0],"endColorRandom":[0,0,0,0.2]},"diskFolder":"common"},"forceField":{"emitter":{"w":200,"h":150,"amount":170},"particle":{"sprite":"explosion7","angle":0,"angleRandom":180,"duration":800,"velocity":2,"startSize":2,"endSize":4,"startColor":[0.7,0.7,1,0.8],"startColorRandom":[0,0,0,0],"endColor":[0.2,0.2,0.4,0],"endColorRandom":[0,0,0,0]},"diskFolder":"common"},"forceFieldDisperse":{"emitter":{"w":200,"h":150,"amount":170,"duration":1000},"gravity":[0,-50],"particle":{"sprite":"explosion7","angle":0,"angleRandom":180,"duration":800,"velocity":8,"startSize":2,"endSize":2,"startColor":[0.7,0.7,1,0.8],"startColorRandom":[0,0,0,0],"endColor":[0.8,0.9,0.3,1],"endColorRandom":[0,0,0,0]},"diskFolder":"common"},"shells":{"emitter":{"w":10,"h":10,"amount":170,"duration":200},"gravity":[0,160],"particle":{"sprite":"bulletShell","angle":-50,"angleRandom":20,"duration":1200,"velocity":120,"startSize":20,"endSize":20,"startColor":[0.5,0.6,0.2,1],"endColor":[0.5,0.6,0.2,0.3]},"diskFolder":"enemies.BulletCannon"},"drone.trail":{"emitter":{"w":2,"h":2,"amount":50,"fidelity":"high"},"gravity":[0,0],"particle":{"sprite":"explosion7","angle":0,"angleRandom":0,"duration":250,"durationRandom":0,"velocity":0,"velocityRandom":10,"startSize":10,"endSize":1,"startColor":[0.5,0.5,0.9,0.6],"startColorRandom":[0,0,0,0],"endColor":[0.2,0.2,0.9,0],"endColorRandom":[0,0,0,0]},"diskFolder":"enemies.Drone"},"drone.smoke":{"emitter":{"w":2,"h":2,"amount":400,"duration":300},"gravity":[-100,0],"particle":{"sprite":"explosion7","angle":0,"angleRandom":360,"duration":1800,"durationRandom":0,"velocity":10,"velocityRandom":5,"startSize":15,"endSize":5,"startColor":[0.05,0.05,0.05,0.6],"startColorRandom":[0,0,0,0],"endColor":[0.05,0.05,0.05,0],"endColorRandom":[0,0,0,0]},"diskFolder":"enemies.Drone"},"laserCharge":{"emitter":{"w":2,"h":2,"amount":70,"reverse":true},"gravity":[0,10],"particle":{"sprite":"explosion7","angle":0,"angleRandom":360,"duration":800,"durationRandom":0,"velocity":100,"velocityRandom":15,"startSize":6,"startSizeRandom":1,"endSize":1,"endSizeRandom":0,"startColor":[1,0.2,0,0.8],"startColorRandom":[0,0,0,0],"endColor":[1,1,0,0.2],"endColorRandom":[0,0,0,0]},"diskFolder":"enemies.LaserCannon"}},"paths":{"powerup.circles":{"path":[{"x":0.5,"y":0.5},{"x":0.51,"y":0.51},{"x":0.48,"y":0.52},{"x":0.47,"y":0.47},{"x":0.55,"y":0.45},{"x":0.57,"y":0.57},{"x":0.41,"y":0.59},{"x":0.39,"y":0.39},{"x":0.5,"y":0.5}],"diskFolder":"common"},"powerup.short":{"path":[{"x":0.51,"y":0.51},{"x":0.48,"y":0.52},{"x":0.47,"y":0.47},{"x":0.5,"y":0.45},{"x":0.51,"y":0.51}],"diskFolder":"common"},"mineCannon.lowShot":{"path":[{"x":0.8,"y":0.6,"events":[[0.8,{"event":"Loose"}]]},{"x":0.7,"y":0.6},{"x":0.6,"y":0.9}],"diskFolder":"common"},"mineCannon.highShot":{"path":[{"x":0.8,"y":0.6,"events":[[0.8,{"event":"Loose"}]]},{"x":0.6,"y":0.3},{"x":0.3,"y":0.5},{"x":0.1,"y":0.9}],"diskFolder":"common"},"sunrise":{"path":[{"x":0.9,"y":0.7},{"x":0.8,"y":0.3},{"x":0.4,"y":0.1}],"diskFolder":"common"},"evadePattern":{"path":[{"x":0.1,"y":0.5},{"x":0.9,"y":0.2},{"x":0.7,"y":0.8},{"x":0.5,"y":0.2},{"x":0.3,"y":0.8},{"x":0.1,"y":0.5},{"x":0.3,"y":0.2},{"x":0.9,"y":0.5},{"x":0.4,"y":0.9},{"x":0.1,"y":0.5}],"diskFolder":"common"},"drone.straight":{"path":[{"x":1.1,"y":0.5},{"x":-0.1,"y":0.5}],"diskFolder":"enemies.Drone"},"drone.pattern1":{"path":[{"x":1.1,"y":0.5},{"x":0.9,"y":0.2},{"x":0.7,"y":0.8},{"x":0.5,"y":0.2},{"x":0.3,"y":0.8},{"x":0.1,"y":0.5,"events":[[0.2,{"setState":["turned",500]}]]},{"x":0.3,"y":0.2,"events":[[0.9,{"setState":["turned",500]}]]},{"x":0.9,"y":0.5},{"x":-0.1,"y":0.6}],"diskFolder":"enemies.Drone"},"drone.pattern2":{"path":[{"x":1.1,"y":0.5},{"x":0.5,"y":0.7},{"x":0.1,"y":0.5,"events":[[0.1,{"setState":["turned",500]}]]},{"x":0.3,"y":0.2},{"x":0.8,"y":0.2,"events":[[0.6,{"setState":["turned",500]}]]},{"x":0.9,"y":0.4},{"x":0.4,"y":0.5},{"x":-0.1,"y":0.2}],"diskFolder":"enemies.Drone"},"drone.pattern3":{"path":[{"x":0.5,"y":-0.1},{"x":0.5,"y":0.2},{"x":0.7,"y":0.31},{"x":0.8,"y":0.5},{"x":0.5,"y":0.5},{"x":-0.1,"y":0.3}],"diskFolder":"enemies.Drone"},"drone.pattern4":{"path":[{"x":0.5,"y":1.11},{"x":0.5,"y":0.8},{"x":0.7,"y":0.8},{"x":0.93,"y":0.69},{"x":0.8,"y":0.5},{"x":0.5,"y":0.5},{"x":-0.1,"y":0.7}],"diskFolder":"enemies.Drone"},"drone.pattern5":{"path":[{"x":-0.2,"y":0.5,"events":[[0,{"setState":["turned",0]}]]},{"x":0.5,"y":0.8},{"x":0.93,"y":0.69,"events":[[0,{"setState":["turned",0]}]]},{"x":0.8,"y":0.5},{"x":0.5,"y":0.5},{"x":-0.1,"y":0.7}],"diskFolder":"enemies.Drone"},"drone.pattern6":{"path":[{"x":1.1,"y":0.2},{"x":0.2,"y":0.4,"events":[[0,{"setState":["turned",0]}]]},{"x":0.6,"y":0.2},{"x":1.1,"y":0.2}],"diskFolder":"enemies.Drone"},"heli.pattern1":{"path":[{"x":1.1,"y":0.5},{"x":0.9,"y":0.4},{"x":0.8,"y":0.2},{"x":0.9,"y":0.1},{"x":0.9,"y":0.3},{"x":0.5,"y":0.3},{"x":0.5,"y":0.1},{"x":0.6,"y":0.3},{"x":0.7,"y":0.7},{"x":0.8,"y":0.5}],"diskFolder":"enemies.Helicopter"},"heli.repeat1":{"path":[{"x":0.8,"y":0.5},{"x":0.9,"y":0.3},{"x":0.8,"y":0.2},{"x":0.7,"y":0.4},{"x":0.8,"y":0.5}],"diskFolder":"enemies.Helicopter"},"heli.repeat2":{"path":[{"x":0.8,"y":0.5},{"x":0.9,"y":0.4},{"x":0.8,"y":0.3},{"x":0.7,"y":0.4},{"x":0.9,"y":0.6},{"x":0.7,"y":0.7},{"x":0.8,"y":0.5}],"diskFolder":"enemies.Helicopter"},"heli.battleship1":{"path":[{"x":0.38,"y":0.73,"events":[[0.5,{"event":"detach"}],[0.8,{"setState":["leveled",1000]}]]},{"x":0.38,"y":0.5},{"x":0.2,"y":0.4,"events":[[0.1,{"setState":["turning",1000]}]]},{"x":0.3,"y":0.3},{"x":0.7,"y":0.4,"events":[[0,{"setState":["turning",1000]}]]},{"x":0.7,"y":0.2,"events":[[0,{"setState":["toForeground",1000]}],[0.1,{"setState":["foreground",1000]}],[0.8,{"setState":["flying",1000]}],[0.8,{"setState":["shooting",1000]}],[0.8,{"event":"active"}]]},{"x":0.6,"y":0.4},{"x":0.7,"y":0.4},{"x":0.6,"y":0.2}],"diskFolder":"enemies.Helicopter"},"heli.battleship2a":{"path":[{"x":0.38,"y":0.73,"events":[[0.5,{"event":"detach"}],[0.8,{"setState":["leveled",1000]}]]},{"x":0.38,"y":0.5},{"x":0.2,"y":0.4,"events":[[0.1,{"setState":["turning",1000]}],[0.7,{"event":"moveShip"}]]},{"x":0.3,"y":0.3},{"x":0.6,"y":0.2}],"diskFolder":"enemies.Helicopter"},"heli.battleship2b":{"path":[{"x":0.6,"y":0.2},{"x":0.7,"y":0.4,"events":[[0,{"setState":["turning",1000]}]]},{"x":0.7,"y":0.2,"events":[[0,{"setState":["toForeground",1000]}],[0.1,{"setState":["foreground",1000]}],[0.8,{"setState":["flying",1000]}],[0.8,{"setState":["shooting",1000]}],[0.8,{"event":"active"}]]},{"x":0.6,"y":0.4},{"x":0.65,"y":0.4},{"x":0.7,"y":0.3}],"diskFolder":"enemies.Helicopter"},"heli.battleship2c":{"path":[{"x":0.8,"y":0.3},{"x":0.7,"y":0.4},{"x":0.8,"y":0.5},{"x":0.85,"y":0.4},{"x":0.8,"y":0.3}],"diskFolder":"enemies.Helicopter"},"largeDrone.intro":{"path":[{"x":1.1,"y":0.2},{"x":0.8,"y":0.5},{"x":0.7,"y":0.4}],"diskFolder":"enemies.LargeDrone"},"largeDrone.eight":{"path":[{"x":0.7,"y":0.4},{"x":0.65,"y":0.3},{"x":0.7,"y":0.2},{"x":0.75,"y":0.3},{"x":0.65,"y":0.5},{"x":0.7,"y":0.6},{"x":0.75,"y":0.5},{"x":0.7,"y":0.4}],"diskFolder":"enemies.LargeDrone"},"largeDrone.eight2":{"path":[{"x":0.8,"y":0.4},{"x":0.65,"y":0.2},{"x":0.7,"y":0.1},{"x":0.85,"y":0.2},{"x":0.65,"y":0.5},{"x":0.8,"y":0.7},{"x":0.85,"y":0.5},{"x":0.8,"y":0.4}],"diskFolder":"enemies.LargeDrone"},"playerLiftOff":{"path":[{"x":0.2,"y":0.6},{"x":0.19,"y":0.56},{"x":0.2,"y":0.55}],"diskFolder":"intro"},"intro.HeliLiftOff":{"path":[{"x":0.3,"y":0.6},{"x":0.32,"y":0.46},{"x":0.3,"y":0.35},{"x":0.15,"y":0.4},{"x":-0.25,"y":0.35}],"diskFolder":"intro"},"intro.HeliBackground":{"path":[{"x":-0.3,"y":0.3},{"x":0.1,"y":0.37},{"x":0.4,"y":0.3}],"diskFolder":"intro"},"intro.HeliBackgroundCrash":{"path":[{"x":0.4,"y":0.3},{"x":0.35,"y":0.35,"events":[[0.9,{"event":"Escape1"}]]},{"x":0.45,"y":0.4},{"x":0.5,"y":0.3},{"x":0.45,"y":0.2,"events":[[0.5,{"event":"Escape2"}]]},{"x":0.4,"y":0.25,"events":[[0.8,{"event":"Escape3"}]]},{"x":1.2,"y":0.2}],"diskFolder":"intro"},"intro.DroneBackground":{"path":[{"x":1.1,"y":0.3},{"x":0.9,"y":0.2},{"x":0.7,"y":0.3,"events":[[0,{"setState":["shoot",0]}]]},{"x":0.7,"y":0.47,"events":[[0.6,{"setState":["turned",0]}],[0.7,{"setState":["eyeMove",0]}]]},{"x":0.8,"y":0.3},{"x":0.95,"y":0.15},{"x":1.2,"y":0.1}],"diskFolder":"intro"}},"sceneries":{"City.CoastWithCloud":{"width":1023,"height":576,"right":"City.Coast","left":"City.Coast","backgrounds":[["City.Sunrise",2]],"altitudes":[0,100],"elements":[{"x":0,"y":-85,"composition":"ocean.front"},{"x":0,"y":-45,"components":["ShipSolid","BulletSolid","GravityLiquid"],"w":1024,"h":45,"attributes":{"liquidParticles":"waterSplashes","liquidDensity":8}},{"x":0,"y":-165,"composition":"city.cloud","distance":0.1,"frame":"default"},{"x":0,"y":5,"composition":"ocean.middle","distance":0.5},{"x":0,"y":-30,"composition":"ocean.horizon","distance":0.25},{"x":0,"y":-46,"composition":"city.horizon","distance":0.25}],"diskFolder":"scenery"},"City.CoastWithCloud2":{"width":1023,"height":576,"right":"City.Coast","left":"City.Coast","backgrounds":[["City.Sunrise",2]],"altitudes":[0,100],"elements":[{"x":0,"y":-85,"composition":"ocean.front"},{"x":0,"y":-45,"components":["ShipSolid","BulletSolid","GravityLiquid"],"w":1024,"h":45,"attributes":{"liquidParticles":"waterSplashes","liquidDensity":8}},{"x":0,"y":-265,"composition":"city.cloud","distance":0.2,"frame":"close"},{"x":0,"y":5,"composition":"ocean.middle","distance":0.5},{"x":0,"y":-30,"composition":"ocean.horizon","distance":0.25},{"x":0,"y":-46,"composition":"city.horizon","distance":0.25}],"diskFolder":"scenery"},"City.Coast":{"width":1023,"height":576,"right":{"City.CoastWithCloud":0.1,"City.CoastWithCloud2":0.1,"City.Coast":0.8},"left":{"City.CoastWithCloud":0.1,"City.CoastWithCloud2":0.1,"City.Coast":0.8},"backgrounds":[["City.Sunrise",2]],"altitudes":[0,100],"elements":[{"x":0,"y":-85,"composition":"ocean.front"},{"x":0,"y":-45,"components":["ShipSolid","BulletSolid","GravityLiquid"],"w":1024,"h":45,"attributes":{"liquidParticles":"waterSplashes","liquidDensity":8}},{"x":0,"y":5,"composition":"ocean.middle","distance":0.5},{"x":0,"y":-30,"composition":"ocean.horizon","distance":0.25},{"x":0,"y":-46,"composition":"city.horizon","distance":0.25}],"diskFolder":"scenery"},"City.CoastStart":{"width":1023,"height":576,"right":"City.Coast","left":"City.Ocean","backgrounds":[["City.Sunrise",1]],"altitudes":[0,250],"elements":[{"x":0,"y":-85,"composition":"ocean.front"},{"x":0,"y":-45,"components":["ShipSolid","BulletSolid","GravityLiquid"],"w":1024,"h":45,"attributes":{"liquidParticles":"waterSplashes","liquidDensity":8}},{"x":0,"y":5,"composition":"ocean.middle","distance":0.5},{"x":0,"y":-30,"composition":"ocean.horizon","distance":0.25},{"x":0,"y":-46,"composition":"city.horizonStart","distance":0.25}],"diskFolder":"scenery"},"City.OceanWithCloud":{"width":1023,"height":576,"right":"City.Ocean","left":"City.Ocean","backgrounds":[["City.Sunrise",0]],"altitudes":[0,250],"elements":[{"x":0,"y":-85,"composition":"ocean.front"},{"x":0,"y":-45,"components":["ShipSolid","BulletSolid","GravityLiquid"],"w":1024,"h":45,"attributes":{"liquidParticles":"waterSplashes","liquidDensity":8}},{"x":0,"y":-165,"composition":"city.cloud","distance":0.1,"frame":"default"},{"x":0,"y":5,"composition":"ocean.middle","distance":0.5},{"x":0,"y":-30,"composition":"ocean.horizon","distance":0.25}],"diskFolder":"scenery"},"City.OceanWithCloud2":{"width":1023,"height":576,"right":"City.Ocean","left":"City.Ocean","backgrounds":[["City.Sunrise",0]],"altitudes":[0,250],"elements":[{"x":0,"y":-85,"composition":"ocean.front"},{"x":0,"y":-45,"components":["ShipSolid","BulletSolid","GravityLiquid"],"w":1024,"h":45,"attributes":{"liquidParticles":"waterSplashes","liquidDensity":8}},{"x":0,"y":-265,"composition":"city.cloud","distance":0.2,"frame":"close"},{"x":0,"y":5,"composition":"ocean.middle","distance":0.5},{"x":0,"y":-30,"composition":"ocean.horizon","distance":0.25}],"diskFolder":"scenery"},"City.Ocean":{"width":1023,"height":576,"right":{"City.OceanWithCloud":0.1,"City.OceanWithCloud2":0.1,"City.Ocean":0.8},"left":{"City.OceanWithCloud":0.1,"City.OceanWithCloud2":0.1,"City.Ocean":0.8},"backgrounds":[["City.Sunrise",0]],"altitudes":[0,250],"elements":[{"x":0,"y":-85,"composition":"ocean.front"},{"x":0,"y":-45,"components":["ShipSolid","BulletSolid","GravityLiquid"],"w":1024,"h":45,"attributes":{"liquidParticles":"waterSplashes","liquidDensity":8}},{"x":0,"y":5,"composition":"ocean.middle","distance":0.5},{"x":0,"y":-30,"composition":"ocean.horizon","distance":0.25}],"diskFolder":"scenery"},"City.BayStart":{"width":1023,"height":576,"right":"City.Bay","left":"City.Coast","backgrounds":[["City.Sunrise",2]],"altitudes":[0,250],"elements":[{"x":0,"y":-85,"composition":"ocean.front"},{"x":0,"y":-45,"components":["ShipSolid","BulletSolid","GravityLiquid"],"w":1024,"h":45,"attributes":{"liquidParticles":"waterSplashes","liquidDensity":8}},{"x":0,"y":5,"composition":"ocean.middle","distance":0.5},{"x":0,"y":-30,"composition":"ocean.horizon","distance":0.25},{"x":0,"y":-46,"composition":"city.horizon","distance":0.25},{"x":0,"y":-148,"composition":"city.cityStart","distance":0.5}],"diskFolder":"scenery"},"City.Bay":{"width":1023,"height":576,"left":"City.Bay","right":"City.Bay","backgrounds":[["City.Sunrise",3]],"altitudes":[0,250],"elements":[{"x":0,"y":-85,"z":-20,"composition":"ocean.front"},{"x":0,"y":-45,"components":["ShipSolid","BulletSolid","GravityLiquid"],"w":1024,"h":45,"attributes":{"liquidParticles":"waterSplashes","liquidDensity":8}},{"x":0,"y":5,"composition":"ocean.middle","distance":0.5},{"x":0,"y":-30,"composition":"ocean.horizon","distance":0.25},{"x":0,"y":-46,"composition":"city.horizon","distance":0.25},{"x":0,"y":-148,"composition":"city.city","distance":0.5},{"x":0,"y":-180,"composition":"city.layer2","distance":0.375},{"x":240,"y":-180,"w":60,"h":105,"components":["SunBlock"],"distance":0.375}],"diskFolder":"scenery"},"City.BayFull":{"width":1023,"height":576,"left":"City.BayFull","right":"City.BayFull","backgrounds":[["City.Sunrise",3]],"altitudes":[0,250,500,700,900],"elements":[{"x":0,"y":-85,"z":-20,"composition":"ocean.front"},{"x":0,"y":-45,"components":["ShipSolid","BulletSolid","GravityLiquid"],"w":1024,"h":45,"attributes":{"liquidParticles":"waterSplashes","liquidDensity":8}},{"x":0,"y":5,"composition":"ocean.middle","distance":0.5},{"x":0,"y":-45,"composition":"city.cityDistance","distance":0.25},{"x":0,"y":-148,"composition":"city.city","distance":0.5},{"x":0,"y":-180,"composition":"city.layer2","distance":0.375},{"x":240,"y":-180,"w":60,"h":105,"components":["SunBlock"],"distance":0.375}],"diskFolder":"scenery"},"City.Bridge":{"width":1023,"height":576,"left":"City.Bay","right":"City.BayFull","backgrounds":[["City.Sunrise",3]],"elements":[{"x":0,"y":-85,"z":-20,"composition":"ocean.front"},{"x":0,"y":-45,"components":["ShipSolid","BulletSolid","GravityLiquid"],"w":1024,"h":45,"attributes":{"liquidParticles":"waterSplashes","liquidDensity":8}},{"x":0,"y":5,"composition":"ocean.middle","distance":0.5},{"x":0,"y":-45,"composition":"city.cityDistance","distance":0.25},{"x":0,"y":-20,"composition":"city.bridge.foot","distance":0.5},{"x":0,"y":-760,"z":300,"components":["SunBlock","BridgeFrontDeck"],"composition":["city.bridge.deck",{"attributes":{"scale":1.1},"spriteAttributes":{"accentColor":"#b15a5a","lightness":0.6}}],"distance":1.1},{"x":0,"y":-590,"z":300,"components":["PillarLeft"],"composition":["city.bridge.pillar",{"attributes":{"scale":1.1},"spriteAttributes":{"lightness":0.6}}],"distance":1.1},{"x":920,"y":-590,"z":300,"components":["PillarRight"],"composition":["city.bridge.pillar",{"attributes":{"scale":1.1},"spriteAttributes":{"lightness":0.6,"flipX":true}}],"distance":1.1},{"x":0,"y":-610,"z":-40,"components":["SunBlock","BridgeCeiling","ShipSolid"],"composition":["city.bridge.deck",{"spriteAttributes":{"accentColor":"#2ba04c"}}],"distance":1},{"x":0,"y":-470,"z":-42,"components":["SunBlock","BridgeCeilingBackground"],"composition":["city.bridge.deck",{"attributes":{"scale":0.9},"spriteAttributes":{"accentColor":"#b15a5a"}}],"distance":0.9},{"x":0,"y":-345,"z":-44,"components":["SunBlock"],"composition":["city.bridge.deck",{"attributes":{"scale":0.8},"spriteAttributes":{"accentColor":"#2ba04c"}}],"distance":0.8},{"x":0,"y":-240,"z":-46,"composition":["city.bridge.deck",{"attributes":{"scale":0.7},"spriteAttributes":{"accentColor":"#b15a5a","horizon":[0.2,0.2]}}],"distance":0.7},{"x":20,"y":-190,"z":-47,"composition":["city.bridge.pillar",{"attributes":{"scale":0.5},"spriteAttributes":{"horizon":[0.2,0.2]}}],"distance":0.7},{"x":600,"y":-190,"z":-46,"composition":["city.bridge.pillar",{"attributes":{"scale":0.5},"spriteAttributes":{"horizon":[0.2,0.2],"flipX":true}}],"distance":0.7},{"x":0,"y":-160,"z":-48,"composition":["city.bridge.deck",{"attributes":{"scale":0.62},"spriteAttributes":{"accentColor":"#2ba04c","horizon":[0.3,0.3]}}],"distance":0.62},{"x":0,"y":-90,"z":-50,"composition":["city.bridge.deck",{"attributes":{"scale":0.55},"spriteAttributes":{"accentColor":"#b15a5a","horizon":[0.3,0.3]}}],"distance":0.55},{"x":0,"y":-40,"z":-52,"composition":["city.bridge.deck",{"attributes":{"scale":0.5},"spriteAttributes":{"accentColor":"#2ba04c","horizon":[0.4,0.4]}}],"distance":0.5}],"diskFolder":"scenery"},"Test.Walls":{"width":1023,"height":576,"right":"Test.Walls","left":"Test.Walls","elements":[{"components":["ShipSolid","BulletSolid","LaserSolid","SolidCollision","Collision"],"x":100,"y":-385,"composition":"test.wall"},{"components":["ShipSolid","BulletSolid","LaserSolid","SolidCollision","Collision"],"x":700,"y":-485,"composition":"test.wall"}],"diskFolder":"test"}},"weapons":{"player.bullets":{"spawnRhythm":{"initialDelay":1,"burst":1,"shotDelay":120,"burstDelay":1,"spawns":[["bullet",{"angleRange":{"from":[0,-6],"to":[1,6],"step":3}}],["muzzleFlash",{}]]},"spawnables":{"bullet":{"spawnPosition":[0,0.5],"velocity":[1050,1200],"composition":"weapons.lightBullet","damage":[{"velocity":[-20000,-30000],"affects":"health","duration":[2,4],"name":"Bullet"}],"queue":[{"cleanOutOfScreen":true},{"duration":4000}],"collisions":{"SolidCollision":{"spawns":[["sparkHit",{}],["sparks",{"emitter":{"duration":100}}]]},"WaterCollision":{"spawns":[["splash",{}]]}}},"muzzleFlash":{"spawnPosition":[0,0.5],"attached":true,"velocity":0,"composition":"weapons.muzzleFlash","queue":[{"duration":120,"audio":"laser-shot"}]},"sparkHit":{"spawnPosition":"outside","velocity":0,"composition":"weapons.solidHit","queue":[{"duration":100,"audio":"laser-hit"}]},"sparks":{"spawnPosition":"outside","velocity":0,"particles":"sparks","queue":[{"duration":500}]},"splash":{"spawnPosition":"outside","velocity":0,"composition":"weapons.waterHit","queue":[{"duration":305}]}},"diskFolder":"PlayerShip"},"player.laser":{"spawnRhythm":{"initialDelay":1,"burst":1,"shotDelay":3000,"burstDelay":1,"shot":[{"state":"laserCharge","audio":"laser-charge","duration":1500},{"state":"stopLaserCharge","duration":300},{"spawn":true,"duration":100,"audio":"laser-fire"}],"spawns":[["laser",{"angle":180}]]},"spawnables":{"laser":{"spawnPosition":[0,0.5],"attached":true,"beam":true,"velocity":2800,"composition":"weapons.laser","queue":[{"duration":340},{"velocity":0},{"duration":300},{"duration":300,"frame":"disappear"}],"damage":[{"velocity":[-500,-1000],"affects":"health","duration":[80,160],"name":"Laser"}],"collisions":{"SolidCollision":{"cooldown":10,"spawns":[["sparks",{"angle":180}]],"remove":false}}},"splash":{"spawnPosition":"outside","velocity":0,"composition":"weapons.waterHit","queue":[{"duration":305}]},"sparks":{"attached":true,"spawnPosition":"outside","velocity":0,"particles":"laserHit","queue":[{"duration":150}]}},"diskFolder":"PlayerShip"},"cannon.gun":{"aiming":{"offsetAimAngle":0,"sight":95,"resetOnDeactivation":true,"rotateSpeed":60,"range":[70,-2]},"spawnRhythm":{"initialDelay":[500,150],"burst":[3,7],"shotDelay":[150,100],"burstDelay":[1000,400],"shot":[{"state":"shells","duration":0},{"spawn":true,"duration":50},{"state":"noshells","duration":0}],"spawns":[["bullet",{}],["muzzleFlash",{}]]},"spawnables":{"bullet":{"spawnPosition":[0,0.5],"velocity":[400,500],"composition":"weapons.bullet","queue":[{"duration":4000,"audio":["gun-shot",{"volume":0.8}]}],"damage":[{"velocity":[-3000,-15000],"affects":"health","duration":[2,4],"name":"Laser"}],"collisions":{"PlayerShip":{"spawns":[["spark",{}]]},"WaterCollision":{"spawns":[["splash",{}]]}}},"muzzleFlash":{"spawnPosition":[0,0.5],"attached":true,"velocity":0,"composition":"weapons.muzzleFlash","queue":[{"duration":400}]},"spark":{"spawnPosition":"outside","velocity":0,"composition":"weapons.solidHit","queue":[{"duration":100,"audio":"laser-hit"}]},"splash":{"spawnPosition":"outside","velocity":0,"composition":"weapons.waterHit","queue":[{"duration":305}]}},"diskFolder":"enemies.BulletCannon"},"cannon.laser":{"aiming":{"offsetAimAngle":0,"sight":95,"resetOnDeactivation":true,"rotateSpeed":60,"range":[70,-2]},"spawnRhythm":{"initialDelay":[500,150],"burst":1,"shotDelay":1,"burstDelay":1000,"shot":[{"state":"charge","audio":"laser-charge","duration":1200},{"stopAiming":true,"state":"charged","duration":500},{"duration":100},{"spawn":true,"duration":100,"audio":"laser-fire"},{"state":"discharge","duration":500},{"duration":500},{"stopAiming":false,"duration":0}],"spawns":[["laser",{"angle":180}],["laser",{"angle":200}],["laser",{"angle":160}],["laser",{"angle":220}],["laser",{"angle":140}]]},"spawnables":{"laser":{"spawnPosition":[0,0.5],"beam":true,"attached":true,"velocity":2500,"composition":"weapons.laser","queue":[{"duration":350},{"velocity":0},{"duration":150},{"duration":300,"frame":"disappear"}],"damage":[{"velocity":[-2000,-4000],"affects":"health","duration":[2,4],"name":"Laser"}],"collisions":{"LaserSolid":{"cooldown":10,"spawns":[["sparks",{"angle":180}]],"remove":false},"PlayerShip":{"cooldown":10,"spawns":[["sparks",{"angle":180}]],"remove":false}}},"splash":{"spawnPosition":"outside","velocity":0,"composition":"weapons.waterHit","queue":[{"duration":305}]},"sparks":{"attached":true,"spawnPosition":"outside","velocity":0,"particles":"laserHit","queue":[{"duration":50}]}},"diskFolder":"enemies.LaserCannon"},"turret.bullet":{"spawnRhythm":{"initialDelay":[1500,150],"burst":[3,9],"shotDelay":[150,90],"burstDelay":[3000,400],"spawns":[["bullet",{}],["muzzleFlash",{}]]},"spawnables":{"bullet":{"spawnPosition":[0,0.5],"velocity":[250,300],"composition":"weapons.bullet","queue":[{"duration":4000}],"collisions":{"SolidCollision":{"spawns":[["spark",{}]]},"WaterCollision":{"spawns":[["splash",{}]]}}},"muzzleFlash":{"spawnPosition":[0,0.5],"attached":true,"velocity":0,"composition":"weapons.muzzleFlash","queue":[{"duration":400}]},"spark":{"spawnPosition":"outside","velocity":0,"composition":"weapons.solidHit","queue":[{"duration":100}]},"splash":{"spawnPosition":"outside","velocity":0,"composition":"weapons.waterHit","queue":[{"duration":305}]}},"diskFolder":"test"},"turret.doubleBullet":{"spawnRhythm":{"initialDelay":[1500,150],"burst":[3,9],"shotDelay":[150,90],"burstDelay":[3000,400],"spawns":[["bullet",{"angle":-2}],["bullet",{"angle":2}],["muzzleFlash",{}]]},"spawnables":{"bullet":{"spawnPosition":[0,0.5],"velocity":[250,300],"composition":"weapons.bullet","queue":[{"duration":4000}],"collisions":{"SolidCollision":{"spawns":[["spark",{}]]},"WaterCollision":{"spawns":[["splash",{}]]}}},"muzzleFlash":{"spawnPosition":[0,0.5],"attached":true,"velocity":0,"composition":"weapons.muzzleFlash","queue":[{"duration":400}]},"spark":{"spawnPosition":"outside","velocity":0,"composition":"weapons.solidHit","queue":[{"duration":100}]},"splash":{"spawnPosition":"outside","velocity":0,"composition":"weapons.waterHit","queue":[{"duration":305}]}},"diskFolder":"test"},"heli.rocket":{"spawnRhythm":{"initialDelay":[2000,1000],"burst":1,"shotDelay":[500,250],"burstDelay":[3000,2000],"spawns":[["rocket",{"angle":-90,"autoRotate":false}]]},"spawnables":{"rocket":{"spawnPosition":[0,0.5],"velocity":[400,500],"entity":"HeliRocket","damage":[{"velocity":[-10000,-30000],"affects":"health","duration":[4,8],"name":"Blast"}],"queue":[{"duration":130},{"velocity":0,"angle":0,"autoRotate":true},{"duration":500},{"velocity":[450,500],"steering":80,"sight":25},{"duration":6000}],"collisions":{"PlayerShip":{"state":"hide","spawns":[["hit",{}]]},"GravityLiquid":{"state":"waterHit","spawns":[["hit",{}]]}}},"hit":{"spawnPosition":"outside","velocity":0,"composition":"weapons.explosion","queue":[{"duration":100,"audio":"explosion"},{"duration":2000}]}},"diskFolder":"enemies.Helicopter"},"heli.gun":{"aiming":{"offsetAimAngle":-5,"sight":25,"resetOnDeactivation":true,"rotateSpeed":60,"range":[10,-50]},"spawnRhythm":{"initialDelay":[1500,150],"burst":[5,9],"shotDelay":[100,60],"burstDelay":[3000,400],"spawns":[["bullet",{}],["muzzleFlash",{}]]},"spawnables":{"bullet":{"spawnPosition":[0,0.5],"velocity":[350,500],"composition":"weapons.bullet","queue":[{"duration":4000,"audio":["gun-shot",{"volume":0.8}]}],"damage":[{"velocity":[-2000,-15000],"affects":"health","duration":[2,4],"name":"Laser"}],"collisions":{"PlayerShip":{"spawns":[["spark",{}]]},"WaterCollision":{"spawns":[["splash",{}]]}}},"muzzleFlash":{"spawnPosition":[0,0.5],"attached":true,"velocity":0,"composition":"weapons.muzzleFlash","queue":[{"duration":400}]},"spark":{"spawnPosition":"outside","velocity":0,"composition":"weapons.solidHit","queue":[{"duration":100,"audio":"laser-hit"}]},"splash":{"spawnPosition":"outside","velocity":0,"composition":"weapons.waterHit","queue":[{"duration":305}]}},"diskFolder":"enemies.Helicopter"},"largeDrone.takeover":{"spawnRhythm":{"maxBursts":1,"initialDelay":10,"burst":2,"shotDelay":200,"burstDelay":8000,"spawns":[["bullet",{}],["muzzleFlash",{}]]},"spawnables":{"bullet":{"spawnPosition":[0,0.5],"velocity":400,"composition":"weapons.sphere","damage":[{"velocity":[-20000,-30000],"affects":"health","duration":[2,4],"name":"Laser"}],"queue":[{"cleanOutOfScreen":true},{"aimOnTarget":true,"duration":0},{"duration":4000}],"collisions":{"IntroHeliBackground":{"spawns":[["sparks",{}],["sparkHit",{}]]}}},"muzzleFlash":{"spawnPosition":[0,0.5],"attached":true,"velocity":0,"composition":"weapons.muzzleFlash","queue":[{"duration":400,"audio":"laser-shot"}]},"sparks":{"spawnPosition":"outside","velocity":0,"particles":"sparks","queue":[{"duration":500}]},"sparkHit":{"spawnPosition":"outside","velocity":0,"composition":"weapons.solidHit","queue":[{"duration":100,"audio":"laser-hit"}]}},"diskFolder":"enemies.LargeDrone"},"largeDrone.rockets":{"spawnRhythm":{"initialDelay":500,"burst":16,"shotDelay":10,"burstDelay":1000,"shot":[{"spawn":true,"duration":100},{"state":"fireRocket","duration":200},{"duration":20},{"state":"reloadRocket","duration":300}],"spawns":[["rocket",{"angle":0,"autoRotate":false}]]},"spawnables":{"rocket":{"spawnPosition":[0,0.5],"velocity":250,"entity":"HeliRocket","damage":[{"velocity":[-10000,-30000],"affects":"health","duration":[4,8],"name":"Blast"}],"queue":[{"cleanOutOfScreen":true},{"velocity":[450,500]},{"duration":4000},{"collide":"PlayerShip"}],"collisions":{"PlayerShip":{"state":"hide","spawns":[["hit",{}]]},"GravityLiquid":{"state":"waterHit","spawns":[["hit",{}]]}}},"hit":{"spawnPosition":"outside","velocity":0,"composition":"weapons.explosion","queue":[{"duration":100,"audio":"explosion"},{"duration":2000}]}},"diskFolder":"enemies.LargeDrone"},"largeDrone.homingRocket":{"spawnRhythm":{"initialDelay":1000,"burst":3,"shotDelay":500,"burstDelay":1000,"shot":[{"spawn":true,"duration":100},{"state":"fireRocket","duration":200},{"duration":1000},{"state":"reloadRocket","duration":1500}],"spawns":[["rocket",{"angle":-90,"autoRotate":false}],["rocket",{"angle":90,"autoRotate":false}],["wideRocket",{"angle":-120,"autoRotate":false}],["wideRocket",{"angle":120,"autoRotate":false}]]},"spawnables":{"rocket":{"spawnPosition":[0,0.5],"velocity":250,"entity":"HeliRocket","damage":[{"velocity":[-10000,-30000],"affects":"health","duration":[4,8],"name":"Blast"}],"queue":[{"duration":220},{"velocity":0,"angle":0,"autoRotate":true},{"duration":500},{"velocity":[450,500],"steering":180,"sight":360},{"duration":3000},{"collide":"PlayerShip"}],"collisions":{"PlayerShip":{"state":"hide","spawns":[["hit",{}]]},"GravityLiquid":{"state":"waterHit","spawns":[["hit",{}]]}}},"wideRocket":{"spawnPosition":[0,0.5],"velocity":250,"entity":"HeliRocket","damage":[{"velocity":[-10000,-30000],"affects":"health","duration":[4,8],"name":"Blast"}],"queue":[{"cleanOutOfScreen":true},{"duration":550},{"velocity":0,"angle":0},{"duration":170},{"velocity":[450,500]},{"duration":4000},{"collide":"PlayerShip"}],"collisions":{"PlayerShip":{"state":"hide","spawns":[["hit",{}]]},"GravityLiquid":{"state":"waterHit","spawns":[["hit",{}]]}}},"hit":{"spawnPosition":"outside","velocity":0,"composition":"weapons.explosion","queue":[{"duration":100,"audio":"explosion"},{"duration":2000}]}},"diskFolder":"enemies.LargeDrone"},"mine.blast":{"spawnRhythm":{"maxBursts":1,"initialDelay":1,"burst":1,"shotDelay":0,"burstDelay":0,"spawns":[["explosion",{}],["bullet",{"angleRange":{"from":45,"to":405,"step":45}}]]},"spawnables":{"explosion":{"spawnPosition":[0.5,0.5],"velocity":[0,0],"composition":"weapons.largeExplosion","emitDamage":[{"targets":["Mine","PlayerShip"],"velocity":-1000,"accelleration":50,"upperBounds":0,"speed":1200,"affects":["health"],"duration":100,"name":"Explosion"}],"queue":[{"duration":100,"audio":"explosion"},{"duration":2000}]},"bullet":{"spawnPosition":[0,0.5],"velocity":100,"composition":"weapons.bullet","damage":[{"velocity":[-3000,-20000],"affects":"health","duration":[2,4],"name":"Laser"}],"queue":[{"cleanOutOfScreen":true},{"duration":500,"velocity":500},{"duration":11000}],"collisions":{"PlayerShip":{"spawns":[["spark",{}]]}}},"spark":{"spawnPosition":"outside","velocity":0,"composition":"weapons.solidHit","queue":[{"duration":100}]}},"diskFolder":"enemies.Mine"},"mine.explosion":{"spawnRhythm":{"maxBursts":1,"initialDelay":1,"burst":1,"shotDelay":0,"burstDelay":0,"spawns":[["explosion",{}]]},"spawnables":{"explosion":{"spawnPosition":[0.5,0.5],"velocity":[0,0],"composition":"weapons.largeExplosion","emitDamage":[{"targets":["Mine","PlayerShip"],"velocity":-1000,"accelleration":50,"upperBounds":0,"speed":1200,"affects":["health"],"duration":100,"name":"Explosion"}],"queue":[{"duration":100,"audio":"explosion"},{"duration":2000}]}},"diskFolder":"enemies.Mine"},"boss.searchBullet":{"spawnRhythm":{"initialDelay":[1500,150],"burst":1,"shotDelay":[150,90],"burstDelay":[3000,800],"spawns":[["bullet",{"angle":0}],["bullet",{"angle":20}],["bullet",{"angle":-20}],["bullet",{"angle":40}],["bullet",{"angle":-40}],["muzzleFlash",{}]]},"spawnables":{"bullet":{"spawnPosition":[0,0.5],"velocity":[200,600],"composition":"weapons.bullet","queue":[{"duration":[2000,800],"velocity":[0,100],"easing":"easeOutQuad"},{"velocity":[900,1200],"aimOnTarget":true},{"duration":3000}],"collisions":{"SolidCollision":{"spawns":[["spark",{}]]},"WaterCollision":{"spawns":[["splash",{}]]}}},"muzzleFlash":{"spawnPosition":[0,0.5],"attached":true,"velocity":0,"composition":"weapons.muzzleFlash","queue":[{"duration":400}]},"spark":{"spawnPosition":"outside","velocity":0,"composition":"weapons.solidHit","queue":[{"duration":100}]},"splash":{"spawnPosition":"outside","velocity":0,"composition":"weapons.waterHit","queue":[{"duration":305}]}},"diskFolder":"test"},"boss.extreme-search":{"spawnRhythm":{"initialDelay":[1500,150],"burst":1,"shotDelay":4000,"burstDelay":[1500,500],"spawns":[["bullet",{"angleRange":{"from":0,"to":360,"step":8}}]]},"spawnables":{"bullet":{"spawnPosition":[0,0.5],"velocity":200,"composition":"weapons.bullet","queue":[{"cleanOutOfScreen":true},{"duration":200},{"duration":500,"velocity":0},{"velocity":[900,1200],"aimOnTarget":true},{"duration":3000}],"collisions":{"SolidCollision":{"spawns":[["spark",{}]]},"WaterCollision":{"spawns":[["splash",{}]]}}},"spark":{"spawnPosition":"outside","velocity":0,"composition":"weapons.solidHit","queue":[{"duration":100}]},"splash":{"spawnPosition":"outside","velocity":0,"composition":"weapons.waterHit","queue":[{"duration":305}]}},"diskFolder":"test"},"boss.extreme-test":{"spawnRhythm":{"initialDelay":[1500,150],"burst":[5,30],"shotDelay":200,"burstDelay":[2000,10],"spawns":[["bullet",{"angleRange":{"from":0,"to":360,"step":8}}]]},"spawnables":{"bullet":{"spawnPosition":[0,0.5],"velocity":200,"composition":"weapons.bullet","queue":[{"cleanOutOfScreen":true},{"duration":13000}],"collisions":{"SolidCollision":{"spawns":[["spark",{}]]},"WaterCollision":{"spawns":[["splash",{}]]}}},"spark":{"spawnPosition":"outside","velocity":0,"composition":"weapons.solidHit","queue":[{"duration":100}]},"splash":{"spawnPosition":"outside","velocity":0,"composition":"weapons.waterHit","queue":[{"duration":305}]}},"diskFolder":"test"},"boss.spawn":{"spawnRhythm":{"initialDelay":[1500,150],"burst":[3,5],"shotDelay":[350,250],"burstDelay":[3000,400],"spawns":[["bullet",{}],["muzzleFlash",{}]]},"spawnables":{"bullet":{"spawnPosition":[0,0.5],"velocity":[250,300],"composition":"weapons.sphere","queue":[{"duration":1500,"velocity":20},{"duration":4000}],"collisions":{"SolidCollision":{"spawns":[["spark",{}]]},"WaterCollision":{"spawns":[["splash",{}]]}}},"subSpawn":{"spawnPosition":[0,0.5],"velocity":[250,300],"composition":"weapons.bullet","queue":[{"duration":1500}],"collisions":{"SolidCollision":{"spawns":[["spark",{}]]},"WaterCollision":{"spawns":[["splash",{}]]}}},"muzzleFlash":{"spawnPosition":[0,0.5],"attached":true,"velocity":0,"composition":"weapons.muzzleFlash","queue":[{"duration":400}]},"spark":{"spawnPosition":"outside","velocity":0,"composition":"weapons.solidHit","queue":[{"duration":100}]},"splash":{"spawnPosition":"outside","velocity":0,"composition":"weapons.waterHit","queue":[{"duration":305}]}},"diskFolder":"test"},"building.explosion":{"spawnRhythm":{"initialDelay":1,"maxBursts":1,"burst":14,"shotDelay":200,"burstDelay":0,"spawns":[["explosion",{"spawnBox":{"w":150,"h":100}}]]},"spawnables":{"explosion":{"spawnPosition":[0.5,0.5],"velocity":[0,0],"composition":"weapons.largeExplosion","emitDamage":[{"targets":["PlayerShip"],"velocity":-1000,"accelleration":50,"upperBounds":0,"speed":1200,"affects":["health"],"duration":100,"name":"Explosion"}],"queue":[{"duration":100,"audio":"explosion"},{"duration":1000}]}},"diskFolder":"test"},"building.explosion2":{"spawnRhythm":{"maxBursts":1,"initialDelay":1,"burst":18,"shotDelay":180,"burstDelay":0,"spawns":[["explosion",{"spawnBox":{"w":250,"h":100}}]]},"spawnables":{"explosion":{"spawnPosition":[0.5,0.5],"velocity":[0,0],"composition":"weapons.largeExplosion","emitDamage":[{"targets":["PlayerShip"],"velocity":-1000,"accelleration":50,"upperBounds":0,"speed":2000,"affects":["health"],"duration":100,"name":"Explosion"}],"queue":[{"duration":100,"audio":"explosion"},{"duration":1000}]}},"diskFolder":"test"}}}'),r=n.animations,a=t=>r[t],o=n.compositions,s=t=>o[t],l=n.entities,c=t=>l[t],h=n.particles,u=t=>h[t],d=n.paths,p=t=>d[t],f=n.sceneries,m=t=>f[t],y=n.weapons,g=t=>y[t]},function(t,e,i){var n;t.exports=(n=n||function(t,e){var i=Object.create||function(){function t(){}return function(e){var i;return t.prototype=e,i=new t,t.prototype=null,i}}(),n={},r=n.lib={},a=r.Base={extend:function(t){var e=i(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},o=r.WordArray=a.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||l).stringify(this)},concat:function(t){var e=this.words,i=t.words,n=this.sigBytes,r=t.sigBytes;if(this.clamp(),n%4)for(var a=0;a<r;a++){var o=i[a>>>2]>>>24-a%4*8&255;e[n+a>>>2]|=o<<24-(n+a)%4*8}else for(a=0;a<r;a+=4)e[n+a>>>2]=i[a>>>2];return this.sigBytes+=r,this},clamp:function(){var e=this.words,i=this.sigBytes;e[i>>>2]&=4294967295<<32-i%4*8,e.length=t.ceil(i/4)},clone:function(){var t=a.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var i,n=[],r=function(e){e=e;var i=987654321,n=4294967295;return function(){var r=((i=36969*(65535&i)+(i>>16)&n)<<16)+(e=18e3*(65535&e)+(e>>16)&n)&n;return r/=4294967296,(r+=.5)*(t.random()>.5?1:-1)}},a=0;a<e;a+=4){var s=r(4294967296*(i||t.random()));i=987654071*s(),n.push(4294967296*s()|0)}return new o.init(n,e)}}),s=n.enc={},l=s.Hex={stringify:function(t){for(var e=t.words,i=t.sigBytes,n=[],r=0;r<i;r++){var a=e[r>>>2]>>>24-r%4*8&255;n.push((a>>>4).toString(16)),n.push((15&a).toString(16))}return n.join("")},parse:function(t){for(var e=t.length,i=[],n=0;n<e;n+=2)i[n>>>3]|=parseInt(t.substr(n,2),16)<<24-n%8*4;return new o.init(i,e/2)}},c=s.Latin1={stringify:function(t){for(var e=t.words,i=t.sigBytes,n=[],r=0;r<i;r++){var a=e[r>>>2]>>>24-r%4*8&255;n.push(String.fromCharCode(a))}return n.join("")},parse:function(t){for(var e=t.length,i=[],n=0;n<e;n++)i[n>>>2]|=(255&t.charCodeAt(n))<<24-n%4*8;return new o.init(i,e)}},h=s.Utf8={stringify:function(t){try{return decodeURIComponent(escape(c.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return c.parse(unescape(encodeURIComponent(t)))}},u=r.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=h.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var i=this._data,n=i.words,r=i.sigBytes,a=this.blockSize,s=r/(4*a),l=(s=e?t.ceil(s):t.max((0|s)-this._minBufferSize,0))*a,c=t.min(4*l,r);if(l){for(var h=0;h<l;h+=a)this._doProcessBlock(n,h);var u=n.splice(0,l);i.sigBytes-=c}return new o.init(u,c)},clone:function(){var t=a.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),d=(r.Hasher=u.extend({cfg:a.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,i){return new t.init(i).finalize(e)}},_createHmacHelper:function(t){return function(e,i){return new d.HMAC.init(t,i).finalize(e)}}}),n.algo={});return n}(Math),n)},function(t,e,i){"use strict";(function(t){i.d(e,"a",(function(){return n}));const n=(e,{color:i="#FFFFFF",sup:n=null}={})=>{const r=(e,i,n,r)=>t.e(" 2D, Text, Tween, UILayerDOM, Delay").attr({w:t.viewport.width,z:1,alpha:0,baseText:e}).textAlign("center").text(e).attr({y:r}).textColor(i).textFont({size:n,weight:"bold",family:"Press Start 2P"});let a=[r(e,i,"30px",240)];if(n){const t=r(n,i,"16px",200);a=a.concat(t)}return{fadeIn:t=>new Promise(e=>{a[0].one("TweenEnd",e),a.forEach(e=>e.tween({alpha:1},t))}),fadeOut:t=>new Promise(e=>{a[0].one("TweenEnd",e),a.forEach(e=>e.tween({alpha:0},t))}),show:()=>{a.forEach(t=>t.attr({alpha:1}))},hide:()=>{a.forEach(t=>t.attr({alpha:0}))},zoomOut:t=>new Promise(e=>{a.forEach(t=>t.attr({alpha:1,scale:1,avoidCss3dTransforms:!0}).text(()=>(t.css({transform:`scale(${t.scale})`,transformOrigin:"center center"}),t.baseText)).dynamicTextGeneration(!0)),a[0].one("TweenEnd",()=>{a.forEach(t=>{t.attr({alpha:0,scale:1,avoidCss3dTransforms:!1}).text(t.baseText).dynamicTextGeneration(!1)}),e()}),a.forEach(e=>e.tween({alpha:0,scale:3},t))}),remove:()=>{a.forEach(t=>t.destroy())},blink:(t,e=4)=>new Promise(i=>{a[0].delay(()=>a.forEach(t=>t.attr({alpha:(t.alpha+1)%2})),t,2*e-1,i)})}}}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){i.d(e,"a",(function(){return a}));var n=i(4),r=i(18);const a=(e,i,{portrait:a=null}={})=>new Promise(o=>{t("Dialog").each((function(){this.trigger("Abort"),this.destroy()}));const s=i.split("\n"),l=.8*t.viewport.width,c=t.viewport.height-20,h=Math.max(4,s.length+1+(e?2:0)),u=t.e("UILayerWebGL, 2D, Color, Tween, Dialog").attr({w:l,h:15*h,alpha:0}).color("#000000").attr({x:50,y:c+50,z:100});u.bind("Abort",o);let d=0;const p=a&&Object(n.b)(a);let f=null;p&&(f=t.e(["UILayerWebGL","2D",r.a,"Dialog"].join(", ")).attr({x:0,y:0,w:40,h:40}).compose(p,{autoStartAnimation:!1}),f.attr({x:u.x+5,y:u.y+u.h-f.h,z:u.z+1}),d=f.w+10,u.attach(f)),u.tween({y:c-15*h,alpha:.8},200);let m=15;if(e){const i=t.e("UILayerDOM, 2D, Text").attr({w:l-20,x:u.x+10+d,y:u.y+10,z:101,alpha:1}).text(e).textColor("#707070").textFont({size:"10px",weight:"bold",family:"Press Start 2P"});u.attach(i),m=30}s.forEach((e,i)=>{u.attach(t.e("UILayerDOM, 2D, Text").attr({w:l-20,x:u.x+10+d,y:u.y+m+20*i,z:101}).text(e).textColor("#909090").textFont({size:"10px",weight:"bold",family:"Press Start 2P"}))});const y=s.join(" ").split(" ").length,g=s.length+Math.ceil(y/4);let v=0;t.e("Dialog, Delay").delay((function(){v++,f&&(v===g?(f.stopAnimation(),f.displayFrame("idle")):f.playAnimation("talking"))}),1e3,g,(function(){u.one("TweenEnd",()=>{t("Dialog").each((function(){this.destroy()})),o()}),u.tween({y:c+50,alpha:0},200)}))})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){i.d(e,"b",(function(){return r}));var n=i(42);const r=(t,e,i)=>{const n=i||t,r=Object.entries(e).reduce((t,[e,i])=>Object.prototype.hasOwnProperty.call(n,e)&&n[e]!==i?t.concat({key:e,current:n[e],newValue:i}):t,[]);return 0!=r.length&&(e=>{r.forEach(({key:i,current:n,newValue:r})=>{t[i]="overrideColor"===i?{_red:(1-e)*n._red+e*r._red,_green:(1-e)*n._green+e*r._green,_blue:(1-e)*n._blue+e*r._blue}:(1-e)*n+e*r})})};t.c("TweenPromise",{required:n.a,async tweenPromise(t,e,i){const n=r(this,t);return this.animate(n,e,i)}}),e.a="TweenPromise"}).call(this,i(0).default)},function(t,e,i){var n,r,a,o,s,l,c,h,u,d,p,f,m,y,g,v,_,x,b;t.exports=(n=i(5),i(33),void(n.lib.Cipher||(r=n,a=r.lib,o=a.Base,s=a.WordArray,l=a.BufferedBlockAlgorithm,c=r.enc,c.Utf8,h=c.Base64,u=r.algo.EvpKDF,d=a.Cipher=l.extend({cfg:o.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,i){this.cfg=this.cfg.extend(i),this._xformMode=t,this._key=e,this.reset()},reset:function(){l.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function t(t){return"string"==typeof t?b:_}return function(e){return{encrypt:function(i,n,r){return t(n).encrypt(e,i,n,r)},decrypt:function(i,n,r){return t(n).decrypt(e,i,n,r)}}}}()}),a.StreamCipher=d.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),p=r.mode={},f=a.BlockCipherMode=o.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}}),m=p.CBC=function(){var t=f.extend();function e(t,e,i){var n=this._iv;if(n){var r=n;this._iv=void 0}else r=this._prevBlock;for(var a=0;a<i;a++)t[e+a]^=r[a]}return t.Encryptor=t.extend({processBlock:function(t,i){var n=this._cipher,r=n.blockSize;e.call(this,t,i,r),n.encryptBlock(t,i),this._prevBlock=t.slice(i,i+r)}}),t.Decryptor=t.extend({processBlock:function(t,i){var n=this._cipher,r=n.blockSize,a=t.slice(i,i+r);n.decryptBlock(t,i),e.call(this,t,i,r),this._prevBlock=a}}),t}(),y=(r.pad={}).Pkcs7={pad:function(t,e){for(var i=4*e,n=i-t.sigBytes%i,r=n<<24|n<<16|n<<8|n,a=[],o=0;o<n;o+=4)a.push(r);var l=s.create(a,n);t.concat(l)},unpad:function(t){var e=255&t.words[t.sigBytes-1>>>2];t.sigBytes-=e}},a.BlockCipher=d.extend({cfg:d.cfg.extend({mode:m,padding:y}),reset:function(){d.reset.call(this);var t=this.cfg,e=t.iv,i=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=i.createEncryptor;else n=i.createDecryptor,this._minBufferSize=1;this._mode&&this._mode.__creator==n?this._mode.init(this,e&&e.words):(this._mode=n.call(i,this,e&&e.words),this._mode.__creator=n)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);var e=this._process(!0)}else e=this._process(!0),t.unpad(e);return e},blockSize:4}),g=a.CipherParams=o.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}}),v=(r.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext,i=t.salt;if(i)var n=s.create([1398893684,1701076831]).concat(i).concat(e);else n=e;return n.toString(h)},parse:function(t){var e=h.parse(t),i=e.words;if(1398893684==i[0]&&1701076831==i[1]){var n=s.create(i.slice(2,4));i.splice(0,4),e.sigBytes-=16}return g.create({ciphertext:e,salt:n})}},_=a.SerializableCipher=o.extend({cfg:o.extend({format:v}),encrypt:function(t,e,i,n){n=this.cfg.extend(n);var r=t.createEncryptor(i,n),a=r.finalize(e),o=r.cfg;return g.create({ciphertext:a,key:i,iv:o.iv,algorithm:t,mode:o.mode,padding:o.padding,blockSize:t.blockSize,formatter:n.format})},decrypt:function(t,e,i,n){return n=this.cfg.extend(n),e=this._parse(e,n.format),t.createDecryptor(i,n).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}}),x=(r.kdf={}).OpenSSL={execute:function(t,e,i,n){n||(n=s.random(8));var r=u.create({keySize:e+i}).compute(t,n),a=s.create(r.words.slice(e),4*i);return r.sigBytes=4*e,g.create({key:r,iv:a,salt:n})}},b=a.PasswordBasedCipher=_.extend({cfg:_.cfg.extend({kdf:x}),encrypt:function(t,e,i,n){var r=(n=this.cfg.extend(n)).kdf.execute(i,t.keySize,t.ivSize);n.iv=r.iv;var a=_.encrypt.call(this,t,e,r.key,n);return a.mixIn(r),a},decrypt:function(t,e,i,n){n=this.cfg.extend(n),e=this._parse(e,n.format);var r=n.kdf.execute(i,t.keySize,t.ivSize,e.salt);return n.iv=r.iv,_.decrypt.call(this,t,e,r.key,n)}}))))},function(t,e,i){"use strict";(function(t){t.c("ControlScheme",{init(){this.has("Cheats")||this.addComponent("Cheats"),this.trigger("Activated"),t.trigger("PlayerActivated")},remove(){this.has("Cheats")&&this.removeComponent("Cheats"),this.trigger("Deactivated"),t.trigger("PlayerDeactivated")}}),e.a="ControlScheme"}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return o})),i.d(e,"d",(function(){return s}));const n=t=>(t<0?-180:180)-t,r={},a=e=>{if(r[e])return r[e];const i=t.math.degToRad(e),n={x:Math.cos(i),y:Math.sin(i)};return r[e]=n,n},o=(t,e)=>{const i=a(t.rotation);return[i.x*e,i.y*e]},s=(t,e)=>{const i=a(t.rotation+90);return[i.x*e,i.y*e]}}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var n=i(136),r=i.n(n),a=i(137),o=i.n(a),s=i(138);const l=()=>2*Math.random()-1,c={},h=(t,e)=>{const i=t.attachedTo||t,n=i.x+Math.random()*t.w,r=i.y+Math.random()*t.h,a=e.velocity+l()*e.velocityRandom,o=e.currentAngle+l()*e.angleRandom,s=e.duration+l()*e.durationRandom,h=e.startSize+l()*e.startSizeRandom,u=e.endSize+l()*e.endSizeRandom,d=e.startColor.map((t,i)=>t+l()*e.startColorRandom[i]),p=e.endColor.map((t,i)=>t+l()*e.endColorRandom[i]),f=t.timeFrame-(e.expired||0)*s;return{aPosition:[n,r,(m=e.sprite,c[m].index)],aVelocity:[a,o*Math.PI/180,e.emitterReverse?-1:1],aOrientation:[n,r,0],aSize:[h,u],aLife:[f,s,e.gravity[0],e.gravity[1]],expire:f+s,aLayer:[t._globalZ,t._alpha],aColor1:d,aColor2:p};var m};let u=null;t.defaultShader("Particle",new t.WebGLShader(r.a,o.a,[{name:"aPosition",width:3},{name:"aVelocity",width:3},{name:"aOrientation",width:3},{name:"aLayer",width:2},{name:"aSize",width:2},{name:"aLife",width:4},{name:"aColor1",width:4},{name:"aColor2",width:4}],(function(t,e){const i=t.program.context;u&&!t.program.hasTime&&(i.uniform4f(t.program.shader.time,e.timeFrame,0,0,0),t.program.hasTime=e.timeFrame,i.uniformMatrix4fv(t.program.shader.spriteMatrix,!1,[0,1,2,3].reduce((t,e)=>{const i=Object.values(c).find(t=>t.index===e);return t.concat(i?i.coords:[0,0,0,0])},[])))})));t.c("ParticleEmitter",{required:"2D, "+s.a,ready:!0,__image:"",img:null,events:{LayerAttached:"_setupParticles",GameLoop:"_renderParticles"},init:function(){this._particlesPaused=!1,this.bind("Draw",this._drawParticles),this._drawLayer&&this._setupParticles(this._drawLayer),this.initialDraw=!0,this._mbr={_x:0,_y:0,_w:t.viewport.width,_h:t.viewport.height},this.trigger("Invalidate"),this.bind("Freeze",()=>{this.stopEmission()}),this.bind("Unfreeze",()=>{this.startEmission()}),this.bind("Change",t=>{Object.prototype.hasOwnProperty.call(t,"angle")&&(this.particleSettings.currentAngle=this.particleSettings.angle+t.angle)})},remove(){this.initialDraw=!0,this.unbind("Draw",this._drawParticles),this.trigger("Invalidate")},pauseParticles(){this._particlesPaused=!0},resumeParticles(){this._particlesPaused=!1},_setupParticles(e){"WebGL"===e.type&&(this._establishShader("Particle",t.defaultShader("Particle")),""!==this.__image&&this.program.setTexture(e.makeTexture(this.__image,this.img,!1)))},_drawParticles(t){if(!0===this.initialDraw){this.particleBuffer.growArrays(this._particles.length);for(let t=0;t<this._particles.length;t++)this._writeParticle(t,this._particles[t]);this.initialDraw=!1}t.program.draw(t,this)},_writeParticle(t,e){this.particleBuffer.writeParticle(t,e)},attachToEntity(e){this.attachedTo=e,this.z=e.z,e.bind("Reorder",()=>{this.z=e.z}),e.bind("Change",t=>{Object.prototype.hasOwnProperty.call(t,"angle")&&(this.particleSettings.currentAngle=this.particleSettings.angle+t.angle)}),this.particleSettings.currentAngle=this.particleSettings.angle+(e.angle||0),e.bind("Move",()=>{this.x=e.x,this.y=e.y,this._mbr={_x:0,_y:0,_w:t.viewport.width,_h:t.viewport.height}}),e.bind("Freeze",()=>{this.stopEmission()}),e.bind("Unfreeze",()=>{this.startEmission()}),e.bind("Remove",()=>{this.stopEmission(),this.attachedTo=null,this.autoDestruct=!0})},particles({emitter:{amount:e=150,w:i=10,h:n=10,duration:r=1/0,warmed:a=!1,reverse:o=!1,fidelity:s="low"},gravity:l=[0,0],particle:{velocity:u=80,velocityRandom:d=20,angle:p=0,angleRandom:f=360,duration:m=2e3,durationRandom:y=500,startSize:g=12,startSizeRandom:v=2,endSize:_=24,endSizeRandom:x=8,sprite:b=null,startColor:w=[1,1,1,1],startColorRandom:C=[0,0,0,0],endColor:k=[0,0,0,1],endColorRandom:S=[0,0,0,0]}}={},D=null){return this.particleSettings={amount:e,gravity:l,velocity:u,velocityRandom:d,angle:p,currentAngle:p,angleRandom:f,duration:m,durationRandom:y,startSize:g,startSizeRandom:v,endSize:_,endSizeRandom:x,sprite:b,startColor:w,startColorRandom:C,endColor:k,endColorRandom:S,emitterDuration:r,emitterReverse:o,emitterFidelity:s},D&&this.attachToEntity(D),this.attr({w:i,h:n}),this.timeFrame=0,this.startEmission({warmed:a}),this.particleSettings.sprite&&((e,i)=>{const n=c[i];if(n)return e.__image=n.image,void(e.program&&e._drawLayer&&e.program.setTexture(e._drawLayer.makeTexture(e.__image,e.img,!1)));const r=t.e("WebGL, "+i).attr({x:5e3,y:5e3});e.__image=r.__image,e.program&&e._drawLayer&&e.program.setTexture(e._drawLayer.makeTexture(e.__image,e.img,!1)),c[i]={index:Object.keys(c).length,coords:r.__coord,image:r.__image},r.destroy()})(this,this.particleSettings.sprite),this._particles=Array(e).fill(0).map(()=>h(this,{...this.particleSettings,duration:0,durationRandom:0})),this.lastExpired=this._particles.reduce((t,e)=>e.expire>t?e.expire:t,0),this.nextExpireRatio="low"===s?140:m/e,this.nextExpireCheck=m/e,this.trigger("Invalidate"),this},stopEmission(){this.emissionRate=0,this.shouldHaveEmitted=0},startEmission({warmed:t=!1}={}){this.emissionRate=this.particleSettings.amount/this.particleSettings.duration,this.startTime=t?-1:0,this.shouldHaveEmitted=t?this.particleSettings.amount:Math.min(this.startTime/1e3*this.emissionRate,1)*this.particleSettings.amount},_renderParticles({dt:t,inGameTime:e}){if(this.particleSettings&&!this._particlesPaused){if(u=u||e,this.timeFrame=e-u,-1!==this.startTime&&(this.startTime+=t,this.shouldHaveEmitted=Math.min(this.startTime/1e3*this.emissionRate,1)*this.particleSettings.amount),this.timeFrame>=this.nextExpireCheck&&this.startTime<this.particleSettings.emitterDuration){this.nextExpireCheck=this.timeFrame+this.nextExpireRatio;const t=-1===this.startTime;for(let e=0;e<this.shouldHaveEmitted;e++)if(this._particles[e].expire<this.timeFrame+20){const i=h(this,t?{...this.particleSettings,expired:.9*Math.random()}:this.particleSettings);i.expire>this.lastExpired&&(this.lastExpired=i.expire),this._particles[e]=i,this._writeParticle(e,i)}t&&(this.startTime=0)}this.autoDestruct&&this.timeFrame>this.lastExpired&&this.destroy()}}}),e.a="ParticleEmitter"}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){i.d(e,"a",(function(){return o}));var n=i(69),r=i(70),a=i(10);const o=({existing:e=!1,hasLaser:i=!1,turned:s=!1}={})=>async({spawn:l,exec:c,waitForEvent:h,allowDamage:u,setHealthbar:d,showState:p,setGameSpeed:f,addScreenTrauma:m,playerHit:y,wait:g,loseLife:v})=>{const _=t("Player").get(0),x=e&&t("PlayerShip").get(0),b=x||l("PlayerShip",{location:{rx:s?.8:.2,ry:.5},defaultVelocity:400});_.invincible||(b===x?(await u(b,{health:b.health||50}),b.unbind("HealthChange"),b.unbind("Turn"),b.unbind("Dead")):(b.health=b.health||50,g(2e3).then(async()=>{await u(b,{})}))),i&&(b.hasLaser=!0),b.health<25&&b.displayFrame("damaged"),d(b.health/50),s&&await p(b,"turned"),p(b,"flying"),b.addComponent(n.a,r.a),b.uniqueBind("HealthChange",t=>{t<b.health&&y(t-b.health);try{d(t/50)}catch(t){}t<25&&"dead"!==b.appliedEntityState&&b.displayFrame("damaged")}),b.uniqueBind("turn",()=>{b.health<25?p(b,"turningDamaged"):p(b,"turning")}),_.has(a.a)&&_.assignControls(b),h(b,"Dead",async()=>{b.attr({disableControls:!0,vx:0,vy:0}),m(.8),f(.4);const t=p(b,"dead");await g(150),f(.7),await g(600),m(.5),await t;const e=!!b.xFlipped,i=b.hasLaser;b.destroy(),await v(),f(1),await g(1e3),c(o({turned:e,hasLaser:i}))})}}).call(this,i(0).default)},function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e,i){"use strict";(function(t){i.d(e,"d",(function(){return a})),i.d(e,"e",(function(){return o})),i.d(e,"a",(function(){return l})),i.d(e,"b",(function(){return h})),i.d(e,"c",(function(){return u}));var n=i(42),r=i(51);const a=(t,e,i)=>({_red:Math.round(e._red*(1-t)+i._red*t),_green:Math.round(e._green*(1-t)+i._green*t),_blue:Math.round(e._blue*(1-t)+i._blue*t),_strength:e._strength*(1-t)+i._strength*t}),o=([t,e])=>({_red:parseInt(t.slice(1,3),16),_green:parseInt(t.slice(3,5),16),_blue:parseInt(t.slice(5,7),16),_strength:e}),s=t=>t&&2===t.length&&"string"==typeof t[0]?o(t):t,l=(t,e,i,n,r)=>{const o={nextTopColor:s(e),nextBottomColor:s(i),startTopColor:n?s(n):t.topColor(),startBottomColor:r?s(r):t.bottomColor()};return e=>{t._topColor=a(e,o.startTopColor,o.nextTopColor),t._bottomColor=a(e,o.startBottomColor,o.nextBottomColor),t.trigger("Invalidate")}},c=()=>t("ScreenFader").get(0)||t.e("WebGL, 2D, ScreenFader, ColorFade").attr({z:5e3,x:0,y:0,w:t.viewport.width,h:t.viewport.height}),h=(t="#000000")=>{const e=c();return e.topColor(t,1),e.bottomColor(t,1),{start:async i=>{await e.colorFade([t,1],[t,0],i/2),await e.colorFade([t,0],[t,0],i/2),e.destroy()}}},u=(t="#000000")=>{const e=c();return e.topColor(t,0),e.bottomColor(t,0),{start:async i=>{await e.colorFade([t,1],[t,0],i/2),await e.colorFade([t,1],[t,1],i/2)}}};t.c("ColorFade",{required:[n.a,r.a].join(","),colorFade(t,e,i,n){const r=l(this,t,e);return this.animate(r,i,n)}})}).call(this,i(0).default)},function(t,e){var i=Array.isArray;t.exports=i},function(t,e,i){"use strict";(function(t){i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return l}));var n=i(19),r=i(12),a=i(3);let o=!1;const s=()=>o,l=()=>{o=!o,o?(Object(n.b)(0),a.a.pauseAudio(),t("Delay").each((function(){return this.pauseDelays()})),t("Tween").each((function(){return this.pauseTweens()})),t(r.a).each((function(){return this.pauseParticles()}))):(a.a.resumeAudio(),Object(n.b)(1),t("Delay").each((function(){return this.resumeDelays()})),t("Tween").each((function(){return this.resumeTweens()})),t(r.a).each((function(){return this.resumeParticles()}))),t.trigger("GamePause",o)}}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var n=i(24),r=i(68),a=(i(188),i(42)),o=i(8),s=i(15),l=i(72),c=i(51),h=i(27),u=i(50),d=i(52),p=i(134),f=i(1),m=i(135);const y={sprites:[],gradients:[],attachHooks:[],attributes:{},frames:{},animations:{},hitbox:[]},g={top:0,center:.5,bottom:1},v={left:0,center:.5,right:1},_=["x","y","z","w","h","rx","ry","rotation","alpha","maxAlpha","overrideColor","overrideColorStrength","horizon","scale","scaleX","scaleY"],x=(t,e)=>void 0===t?e:t,b=(t,e)=>{let i=null;return t.appliedDefinition.sprites.forEach((t,n)=>{t[1].key===e&&(i=n)}),null===i?null:t.composableParts[i]},w=(t,e)=>"default"===e?((t,e)=>{const i={};return(e.sprites||[]).filter(([,t])=>t.key).map(([t,e])=>i[e.key]={z:0,rotation:0,alpha:1,scale:1,topDesaturation:0,bottomDesaturation:0,overrideColorStrength:e.overrideColor||e.accentColor?1:0,sprite:t,...e,x:0,y:0}),(e.gradients||[]).filter(t=>t.key).map(t=>i[t.key]={z:0,rotation:0,...t,x:0,y:0}),i.attributes={w:e.attributes.width,h:e.attributes.height,rotation:x(e.attributes.rotation,0),scale:x(e.attributes.scale,1)},!0===t.xFlipped&&(i.flipX=!0),i})(t,t.appliedDefinition):e&&t.appliedDefinition.frames[e],C=(t,e,i)=>{const r=w(t,e);if(!r)return()=>{};const a=w(t,i),c=(t=>e=>Object.entries(e).filter(([t])=>_.includes(t)).reduce((e,[i,n])=>{switch(i){case"x":e.dx=t.xFlipped?-n:n;break;case"y":e.dy=n;break;case"z":e.z=t.z+n;break;case"rx":e.drx=t.xFlipped?-n:n;break;case"ry":e.dry=n;break;case"w":e.sw=n;break;case"overrideColor":null===n?e.overrideColorStrength=0:(e.overrideColor=Object(m.a)(n),e.overrideColorStrength=1);break;case"horizon":e.topDesaturation=n[1],e.bottomDesaturation=n[0];break;default:e[i]=n}return e},{}))(t),p=Object.entries(r).reduce((e,[i,r])=>{if("attributes"===i){const n={};void 0===t.scale&&void 0===r.scale||(r.w&&(n.w=r.w*(r.scale||t.scale)),r.h&&(n.h=r.h*(r.scale||t.scale)));const s=c({...r,...n});void 0!==s.sw&&t.addComponent(d.a);const l=a&&c({...a[i]});return e.concat(Object(o.b)(t,s,l))}if("flipX"===i){t.addComponent(u.a);const i=t.xFlipped;return e.concat(()=>{i===t.xFlipped&&(t.xFlipped?t.unflipX():t.flipX())})}const p=t.composableParts.find(t=>t.attr("key")===i);if(p){const s=t.appliedDefinition.sprites.find(([,t])=>t.key===i),l={z:0,alpha:1,scaleX:1,scaleY:1,horizon:[0,0],...s&&s[1],x:0,y:0};l.w&&void 0!==t.scale&&(l.w=l.w*t.scale),l.h&&void 0!==t.scale&&(l.h=l.h*t.scale);const u=c({...l,...r,...void 0!==r.rotation&&{rotation:p._parent.rotation+r.rotation}}),d=a&&c({...l,...a[i]});u.overrideColor&&(p.addComponent(h.a),p.overrideColorMode="all"),0!==u.topDesaturation&&p.addComponent(n.a);const f=r.sprite;return e.concat([Object(o.b)(p,u,d),f&&(()=>{p._spriteName!==f&&(p.sprite(f),p._spriteName=f)})])}const f=t.gradientParts.find(t=>t.attr("key")===i);if(f){const n={z:0,w:f.originalSize.w,h:f.originalSize.h,...t.appliedDefinition.gradients.find(t=>t.key===i)||{},x:0,y:0},l=c({...n,...r}),h=a&&c({...n,...a[i]});return e.concat(Object(o.b)(f,l,h),Object(s.a)(f,r.topColor,r.bottomColor))}const m=t.currentAttachHooks[i];if(m){m.addComponent(l.a);const t=c({...{x:0,y:0},...r});return e.concat([Object(o.b)(m,t)])}return e},[]).filter(Boolean);return t=>p.forEach(e=>e(t))},k="ComposableHook";t.c(k,{events:{Freeze(){this._children.forEach(t=>t.freeze&&t.freeze())},Unfreeze(){this._children.forEach(t=>t.unfreeze&&t.unfreeze())}}});t.c("Composable",{required:a.a,events:{Reorder(){const t=this.z-this.currentZ;this.forEachPart(e=>{e.z+=t}),Object.values(this.currentAttachHooks).forEach(e=>{e.z+=t,e.currentAttachment&&(e.currentAttachment.z+=t)}),this.currentZ=this.z},Freeze(){this.stopAnimation(),this._children.forEach(t=>t.freeze&&t.freeze())},Unfreeze(){this._children.forEach(t=>t.unfreeze&&t.unfreeze()),this.getAnimation("default")?this.playAnimation("default"):this.appliedEntityDefinition&&this.appliedEntityDefinition.structure&&this.appliedEntityDefinition.structure.frame?this.displayFrame(this.appliedEntityDefinition.structure.frame):this.displayFrame("default")}},init(){this.appliedDefinition=y,this.composableParts=[],this.collisionComponents=[],this.gradientParts=[],this.currentAttachHooks={},this.currentZ=this.z,this.animationListeners=[],this.displayFrame=this.displayFrame.bind(this),this.playAnimation=this.playAnimation.bind(this)},compose(t,{autoStartAnimation:e=!0}={}){if(this.appliedDefinition===t)return;const i={...y,...t};return this.setOwnAttributes(i.attributes),this.buildSprites(i.sprites,i.spriteAttributes),this.buildGradients(i.gradients),this.appliedDefinition=t,this.forEachPart((t,e)=>{const i=this.spriteOptions(e);if(!i.attachTo)return;const n=b(this,i.attachTo);n&&n.attach(t)}),this.buildAttachHooks(i.attachHooks),i.hitbox.length>0&&(this.addComponent("Collision"),this.collision(i.hitbox)),i.attributes.scale&&(this.addComponent(r.a),this.attr({scale:i.attributes.scale})),this.getAnimation("default")&&e&&this.playAnimation("default"),this},getAnimation(t){return this.appliedDefinition.animations&&this.appliedDefinition.animations[t]},async playAnimation(t){const e=this.getAnimation(t);if(!e)throw new Error(`Animation ${t} not found in playAnimation`);if(e.startEase){const t=e.timeline[0].startFrame;await this.displayFrame(t,e.startEase.duration,e.startEase.easing)}this.activeAnimation={name:t,data:e,easing:f.e[e.easing||"linear"],timeline:e.timeline.map(t=>({...t}))},this.animationStart=e.timer&&"global"===e.timer?Object(p.a)():1*new Date,this.bind("GameLoop",this.updateAnimationFrame),await new Promise(t=>this.animationListeners.push(t))},animationPlaying(){return null!==this.activeAnimation},stopAnimation(){this.unbind("GameLoop",this.updateAnimationFrame),this.activeAnimation=null,this.animationListeners.forEach(t=>t()),this.animationListeners=[]},updateAnimationFrame({inGameTime:t}){t<this.animationStart&&(this.animationStart=t);const e=t-this.animationStart,i=(this.activeAnimation.data.repeat?e%this.activeAnimation.data.duration:e)/this.activeAnimation.data.duration,n=this.activeAnimation.easing(i);if(this.activeAnimation.timeline.forEach(t=>{if(t.start>n||n>t.end)return;t.animateFn||(t.animateFn=t.startFrame&&t.endFrame&&C(this,t.endFrame,t.startFrame)||t.spriteAnimation&&((t,e)=>{const i=t.composableParts.find(t=>t.attr("key")===e.key);return i?t=>{const n=Math.min(Math.floor(t*e.sprites.length),e.sprites.length-1),r=e.sprites[n];i.sprite(r),i._spriteName=r}:()=>{}})(this,t.spriteAnimation)||(()=>{}));const e=(n-t.start)/(t.end-t.start);t.animateFn(e)}),i>=1&&!this.activeAnimation.data.repeat){const t=this.activeAnimation.data.after;this.stopAnimation(),t&&t.animation&&this.playAnimation(t.animation)}},setOwnAttributes(t){if(!t)return;const e={};if(t.width&&(e.w=t.width),t.height&&(e.h=t.height),t.ro){const[e,i]=t.ro;this.origin(e,i)}this.attr(e)},buildSprites(t,e){const i=[],n=this.appliedDefinition.sprites;let r=0;t.forEach((t,a,o)=>{const s=n[r];if(s){if(t[0]!==s[0]){const i=o[a+1];if(i&&i[0]===s[0])return this.composableParts.splice(r,0,this.createAndAttachSprite(t,e)),void r++;const n=this.composableParts[r];this.detach(n),n.destroy(),this.composableParts.splice(r,1,this.createAndAttachSprite(t,e)),r++}else if(t[0]===s[0]){const i=this.composableParts[r];this.applySpriteOptions(i,{...e,...t[1]}),r++}}else i.push(t)}),this.composableParts.slice(r).forEach(t=>{this.detach(t),t.destroy()}),this.composableParts=this.composableParts.slice(0,r).concat(i.map(t=>this.createAndAttachSprite(t,e)))},buildGradients(t){const e=[],i=this.appliedDefinition.gradients;let n=0;t.forEach(t=>{if(i[n]){const e=this.composableParts[n];this.applySpriteOptions(e,t),n++}else e.push(t)}),this.gradientParts.slice(n).forEach(t=>{this.detach(t),t.destroy()}),this.gradientParts=this.gradientParts.slice(0,n).concat(e.map(t=>this.createAndAttachGradient(t)))},createAndAttachGradient(e){const i=this._drawLayer?this._drawLayer.name:"WebGL",n=t.e([i,"2D",c.a,l.a].join(", "));return this.applyGradientOptions(n,e),n.attr({originalSize:{w:n.w,h:n.h}}),this.attach(n),n},applyGradientOptions(t,e){if(t.attr({x:this.x+(e.x||0),y:this.y+(e.y||0),z:this.z+(e.z||0)}),e.key&&t.attr({key:e.key}),t.attr({w:e.w||t.w,h:e.h||t.h,alpha:void 0===e.alpha?1:e.alpha}),e.topColor&&t.topColor(e.topColor[0],e.topColor[1]),e.bottomColor&&t.bottomColor(e.bottomColor[0],e.bottomColor[1]),e.ro){const[i,n]=e.ro;t.origin(i,n),e.rotation&&t.attr({rotation:e.rotation})}e.hitbox&&(t.addComponent("Collision"),t.collision(e.hitbox)),e.hideBelow&&t.addComponent("HideBelow").attr({hideBelow:e.hideBelow}),e.hideAbove&&t.addComponent("HideBelow").attr({hideAbove:e.hideAbove})},createAndAttachSprite([e,i],n){const a=this._drawLayer?this._drawLayer.name:"WebGL",o=t.e([a,"2D",l.a,r.a,e].join(", "));o._spriteName=e;const s={...n,...i};return this.applySpriteOptions(o,s),o.attr({originalSize:{w:o.w,h:o.h}}),o.root=this,this.attach(o),s.stretch&&o.activateStretch(this),o},applySpriteOptions(t,e){if(t.attr({x:this.x+(e.x||0),y:this.y+(e.y||0),z:this.z+(e.z||0)}),e.key&&t.attr({key:e.key}),e.crop){const[i,n,r,a]=e.crop;t.crop(a,i,t.w-n-a,t.h-r-i)}if(e.scale&&t.attr({scale:e.scale}),e.scaleX&&t.attr({scale:e.scaleX}),e.scaleY&&t.attr({scale:e.scaleY}),e.stretch&&(t.addComponent(d.b),t.attr({stretch:e.stretch})),e.overrideColor&&(t.addComponent(h.a),t.colorOverride(e.overrideColor)),e.accentColor&&(t.addComponent(h.a),t.colorOverride(e.accentColor,"partial")),e.lightness&&(t.addComponent(h.a),t.attr({lightness:e.lightness})),t.attr({w:e.w||t.w,h:e.h||t.h,alpha:void 0===e.alpha?1:e.alpha,maxAlpha:void 0===e.maxAlpha?1:e.maxAlpha}),e.flipX&&t.flip("X"),e.ro){const[i,n]=e.ro;t.origin(i,n),e.rotation&&t.attr({rotation:e.rotation})}if(e.hitbox&&(t.addComponent("Collision"),t.collision(e.hitbox)),e.hideBelow&&t.addComponent("HideBelow").attr({hideBelow:e.hideBelow}),e.hideAbove&&t.addComponent("HideBelow").attr({hideAbove:e.hideAbove}),e.horizon){const[i,r]=e.horizon;t.addComponent(n.a).saturationGradient(i,r)}},forEachPart(t){this.composableParts.forEach((e,i,n)=>t(e,i,n))},spriteOptions(t){return this.appliedDefinition.sprites[t][1]},attachHookSettings(t){return e=this.appliedDefinition,i=t,(e.attachHooks.find(([t])=>t===i)||[])[1]||{};var e,i},attachEntity(t,e){const i=this.attachHookSettings(t),n=this.currentAttachHooks[t];if(!n)return;if(n.currentAttachment&&n.currentAttachment!==e&&n.currentAttachment.destroy(),!e)return void n.attr({currentAttachment:null});const r=i.attachAlign||["top","left"],a=n.x-v[r[1]]*e.w,o=n.y-g[r[0]]*e.h;e.attr({x:a,y:o,z:n.z}),e.detachFromParent=()=>{n.detach(e),n.attr({currentAttachment:null})},n.attach(e),n.attr({currentAttachment:e})},clearAttachment(t){this.attachEntity(t,null)},buildAttachHooks(e){e.forEach(([e,i])=>{const n=this.currentAttachHooks[e]||t.e("2D, "+k);if(n.attr({x:this.x+(i.x||0),y:this.y+(i.y||0),z:this.z+(i.z||0),w:1,h:1,currentAttachment:n.currentAttachment||null}),i.attachTo){const t=b(this,i.attachTo);t?t.attach(n):this.attach(n)}else this.attach(n);this.currentAttachHooks[e]=n})},getElementByKey(t){return b(this,t)},addCollisionComponent(t,e=[]){return this.collisionComponents.push(t),(this.has("Collision")||e.length>0)&&this.addComponent(t),this.composableParts.forEach(i=>i.has("Collision")&&(e.length>0?e.forEach(t=>i[t]=function(...e){this.root[t](...e)}):i.addComponent(t))),this},clearCollisionComponents(){return this.collisionComponents.forEach(t=>this.removeComponent(t)),this.composableParts.forEach(t=>this.collisionComponents.forEach(e=>t.removeComponent(e))),this.collisionComponents=[],this},async displayFrame(t,e=0,i){if(!w(this,t))return;const n=C(this,t);return this.animate(n,e,i)}}),e.a="Composable"}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){i.d(e,"a",(function(){return r})),i.d(e,"b",(function(){return a}));let n=1;const r=()=>n,a=e=>(n=e,t("SpriteAnimation").each((function(){if(!this.has("TimeManager"))return this.animationSpeed=e})),t("Delay").each((function(){if(!this.has("TimeManager"))return this.delaySpeed=e})),t("Tween").each((function(){if(!this.has("TimeManager"))return this.tweenSpeed=e})));t.bind("NewEntity",e=>{const i=t(e.id);i.has("TimeManager")||(i.has("SpriteAnimation")&&(i.animationSpeed=n),i.has("Delay")&&(i.delaySpeed=n),i.has("Tween")&&(i.tweenSpeed=n))})}).call(this,i(0).default)},function(t,e,i){var n=i(191),r=i(233)((function(t,e,i){n(t,e,i)}));t.exports=r},function(t,e,i){"use strict";(function(t){var n=i(10);t.c("Player",{init(){this.reset()},reset(){this.has(n.a)&&this.removeComponent(n.a)}}),e.a="Player"}).call(this,i(0).default)},function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"a",(function(){return s}));var n=i(1),r=i(34),a=i.n(r);const o=()=>async({exec:t})=>{const e=[{x:.3,y:.8},{x:.5,y:.2},{x:.5,y:.4},{x:.9,y:.2},{x:.9,y:.4},{x:.9,y:.8}],i=(t=>{const e=Array(t).fill().map(()=>{let t=null;return{p:new Promise(e=>{t=e}),res:t}}),i=Promise.allSettled(e.map(({p:t})=>t));return e.map(({res:t})=>()=>(t(),i))})(6).map(async(i,r)=>{await t(((t,e,i,r,a=0)=>async({spawn:o,wait:s,addScreenTrauma:l,waitForEvent:c,race:h,showState:u,allowDamage:d,awardPoints:p,moveTo:f})=>{let m=null;await s(50*t);const y=o("Mine",{location:{rx:e.x,ry:e.y>1?.9:e.y},defaultVelocity:200});e.y>1&&(m=f(y,{y:e.y},null,n.c),await m.process),await u(y,"rotate"),await d(y,{health:40}),m=f(y,{x:i.x},null,n.c),await h([()=>c(y,"Dead",async()=>{m&&m.abort(),r(),"explode"!==y.appliedEntityState&&(p(100,y.x,y.y),u(y,"dead"),l(.3),await s(500),y.destroy(),m&&m.abort())}),async()=>{if(await m.process,m.wasCompleted()){if(await r(),await s(a),"dead"===y.appliedEntityState)return;if(m=f(y,{y:i.y},null,n.b),await m.process,m.wasCompleted()){if(await s(200+2e3*Math.random()),await u(y,"open",500),"dead"===y.appliedEntityState)return;if(u(y,"blinking"),await s(1e3),"dead"===y.appliedEntityState)return;u(y,"explode"),l(.3),await s(500),y.destroy()}}}])})(r,{x:1.2,y:1.1},e[r],i))});await Promise.all(i)},s=()=>async({exec:t})=>{const e=[.05,.14,.27,.36,.45,.54,.63,.77,.86],i=a()([.2,.3,.4,.5]),r=Array(9).fill().map(async(r,a)=>{await t(((t,e,i)=>async({spawn:r,wait:a,addScreenTrauma:o,waitForEvent:s,race:l,allowDamage:c,showState:h,moveTo:u})=>{let d=null;await a(50*t);const p=r("Mine",{location:{rx:e.x,ry:e.y>1?.9:e.y},defaultVelocity:200});await h(p,"rotate"),await c(p,{health:40}),h(p,"blinking"),await a(2e3),await l([()=>s(p,"Dead",async()=>{d&&d.abort(),"explode"!==p.appliedEntityState&&(h(p,"dead"),o(.3),await a(1e3),p.destroy(),d&&d.abort())}),async()=>{"dead"!==p.appliedEntityState&&(d=u(p,{y:i.y},null,n.b),await d.process,d.wasCompleted()&&(await h(p,"open",500),"dead"!==p.appliedEntityState&&(h(p,"dead"),o(.3),await a(1e3),p.destroy())))}])})(a,{x:e[a],y:.88},{x:e[a],y:i[a%i.length]}))});await Promise.all(r)}},function(t,e,i){var n=i(100),r="object"==typeof self&&self&&self.Object===Object&&self,a=n||r||Function("return this")();t.exports=a},function(t,e,i){"use strict";(function(t){i.d(e,"b",(function(){return s})),i.d(e,"c",(function(){return l}));var n=i(27),r=i(14),a=i.n(r);let o={_red:0,_green:0,_blue:0,_strength:1};const s=()=>o,l=e=>{let i={};a()(e)?i=e:t.assignColor(e,i),o._red===i._red&&o._green===i._green&&o._blue===i._blue||(o=i,t("Horizon").forEach(t=>t.colorDesaturation(i)))};t.c("Horizon",{required:[n.a].join(","),init(){this.colorDesaturation(o)}}),e.a="Horizon"}).call(this,i(0).default)},function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,e,i){"use strict";(function(t){i.d(e,"b",(function(){return d})),i.d(e,"a",(function(){return p}));var n=i(11),r=i(18),a=i(95),o=i(12),s=i(4),l=i(20),c=i.n(l),h=i(3);const u=e=>{if(!e)return{};let i=e.x,n=e.y;return e.rx&&(i=t.viewport.width*e.rx),e.ry&&(n=t.viewport.height*e.ry),{x:i,y:n}},d=(e,i={})=>{const{location:n,...r}=i;return t.e("2D, WebGL, EntityDefinition").attr({x:0,y:0}).applyDefinition(e).attr({...u(n),...r})},p="EntityDefinition",f=(e,i,l,u)=>{const d=[];if(l.composition){const t=Object(s.b)(l.composition);i.addComponent(r.a).compose(t),l.frame||(i.getAnimation("default")?d.push(i.playAnimation("default")):d.push(i.displayFrame("default",u))),l.animation||i.stopAnimation()}if(void 0!==l.animation&&i.has(r.a)&&d.push(l.animation?i.playAnimation(l.animation):i.stopAnimation()),l.frame&&i.has(r.a)){const[t,e]="string"==typeof l.frame?[l.frame,{duration:u}]:l.frame;d.push(i.displayFrame(t,e.duration||u,e.easing))}if(l.audio&&h.a.playAudio(l.audio),l.entity&&i.addComponent(p).applyDefinition(l.entity),l.state&&d.push(i.showState(l.state,u)),l.particles){if(l.particles.emitter){const r=l.particles.emitter;if(Array.isArray(r)){const e=c()({},Object(s.d)(r[0]),r[1]);if(i.emitter)i.emitter.particles(e,i);else{const n=t.e(o.a).particles(e,i);i.attr({w:e.emitter.w,h:e.emitter.h}),i.emitter=n,i.emitting=r[0]}}else{const e=Object(s.d)(r);if(i.emitter)i.emitter.particles(e,i);else{const n=t.e(o.a).particles(e,i);i.attr({w:e.emitter.w,h:e.emitter.h}),i.emitter=n,i.emitting=r}}if(!!e.xFlipped!=!!i.emitter.xFlipped){const t=(i.angle||0)-i.emitter.particleSettings.currentAngle;i.emitter.xFlipped=!i.emitter.xFlipped,i.angle=Object(n.a)(i.emitter.particleSettings.currentAngle)+t,i.trigger("Change",{angle:i.angle})}}!0===l.particles.active&&i.emitter.startEmission(),!1===l.particles.active&&i.emitter.stopEmission()}if(l.components&&l.components.forEach(t=>{if("string"==typeof t)i.addComponent(t);else{const[e,n]=t;i.addComponent(e).attr(n)}}),l.removeComponents&&l.removeComponents.forEach(t=>i.removeComponent(t)),l.weapon){if(l.weapon.pattern){const t=Object(s.g)(l.weapon.pattern);if(!i.has(a.a)||i.definition&&i.definition.pattern!==t){if(l.weapon.barrel){const t=e.getElementByKey(l.weapon.barrel);i.barrel=t}else i.barrel=null;i.attr({difficulty:0,mainEntity:e}).addComponent(a.a).weapon({...l.weapon,pattern:t})}}d.push(l.weapon.active?i.activate(l.weapon.maxBursts):i.deactivate())}return l.attachments&&"function"==typeof i.attachEntity&&Object.entries(l.attachments).forEach(([n,r])=>{if(r){const a=r.name||n,o=i[a]||t.e("2D").attr({w:1,h:1,sourceEntity:e});d.push(f(e,o,r,u)),i.attachEntity(n,o),i[a]=o}else i.clearAttachment(n),i[n]=null}),Promise.all(d)};t.c(p,{init(){this.appliedEntityDefinition=null,this.appliedEntityName=null,this.appliedEntityState="default",this.showState=this.showState.bind(this)},applyDefinition(t){const e=Object(s.c)(t);this.addComponent(t);const i=e.structure;return f(this,this,i,0),this.appliedEntityDefinition=e,this.appliedEntityName=t,this},showState(t,e=0){const i="default"===t?this.appliedEntityDefinition.structure:this.appliedEntityDefinition.states[t];if(i)return this.appliedEntityState=t,f(this,this,i,e)}})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var n=i(14),r=i.n(n);t.c("ColorEffects",{init(){this.attr({overrideColor:{_red:0,_green:0,_blue:0},overrideColorMode:"none",overrideColorStrength:0})},colorDesaturation(t){return null===t||(this.attr({desaturationColor:{_red:t._red/255,_green:t._green/255,_blue:t._blue/255}}),this.trigger("Invalidate")),this},colorOverride(e,i="all",n=1){if(null==e)return this;let a={};return r()(e)?a=e:t.assignColor(e,a),this.attr({overrideColor:{_red:a._red/255,_green:a._green/255,_blue:a._blue/255},overrideColorMode:i,overrideColorStrength:n}),this.trigger("Invalidate"),this},clearColorOverride(){return this.attr({overrideColorMode:"none"}),this.trigger("Invalidate"),this},saturationGradient(t,e){return this.attr({topDesaturation:t,bottomDesaturation:e}),this}}),e.a="ColorEffects"}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){i.d(e,"a",(function(){return o}));var n=i(34),r=i.n(n);const a=t=>t[0],o=e=>a(r()(t(e).get()))}).call(this,i(0).default)},function(t,e,i){"use strict";i.d(e,"b",(function(){return a}));let n=null;const r=()=>{if(n)return n;const t=localStorage.getItem("SPDLZR-SET");if(!t)return{};try{n=JSON.parse(t)}catch(t){n=null}return n||{}},a=(t,e)=>{const i=r();i[t]=e,n=i,localStorage.setItem("SPDLZR-SET",JSON.stringify(i))};e.a=(t,e)=>{const i=r()[t];return void 0===i?e:i}},function(t,e,i){var n;t.exports=(n=i(5),i(67),i(319),i(320),i(40),i(41),i(91),i(128),i(321),i(129),i(322),i(323),i(324),i(92),i(325),i(33),i(9),i(326),i(327),i(328),i(329),i(330),i(331),i(332),i(333),i(334),i(335),i(336),i(337),i(338),i(339),i(340),i(341),n)},function(t,e,i){"use strict";(function(t){i.d(e,"b",(function(){return r})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){return o})),i.d(e,"d",(function(){return s}));var n=i(45);t.c("Background",{required:["2D, WebGL",n.a].join(","),init(){this.attr({x:0,y:0,w:t.viewport.width/t.viewport._scale,h:t.viewport.height/t.viewport._scale,z:-1e3}),this.bind("ViewportScale",this.updateBackdrop)},remove(){Object.keys(this.elements).forEach(t=>{this.elements[t].destroy(),delete this.elements[t]})},updateBackdrop(){this.attr({w:t.viewport.width/t.viewport._scale,h:t.viewport.height/t.viewport._scale})}});const r=(e,i)=>{(t("Background").get(0)||t.e("Background")).setAnimation(e,i)},a=e=>{(t("Background").get(0)||t.e("Background")).setActiveCheckpoint(e)},o=()=>(t("Background").get(0)||t.e("Background")).targetCheckpoint,s=e=>{(t("Background").get(0)||t.e("Background")).setCheckpointLimit(e)}}).call(this,i(0).default)},function(t,e,i){var n=i(202),r=i(208);t.exports=function(t,e){var i=r(t,e);return n(i)?i:void 0}},function(t,e,i){var n,r,a,o,s,l,c,h;t.exports=(h=i(5),i(91),i(92),r=(n=h).lib,a=r.Base,o=r.WordArray,s=n.algo,l=s.MD5,c=s.EvpKDF=a.extend({cfg:a.extend({keySize:4,hasher:l,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var i=this.cfg,n=i.hasher.create(),r=o.create(),a=r.words,s=i.keySize,l=i.iterations;a.length<s;){c&&n.update(c);var c=n.update(t).finalize(e);n.reset();for(var h=1;h<l;h++)c=n.finalize(c),n.reset();r.concat(c)}return r.sigBytes=4*s,r}}),n.EvpKDF=function(t,e,i){return c.create(i).compute(t,e)},h.EvpKDF)},function(t,e,i){var n=i(250),r=i(252),a=i(16);t.exports=function(t){return(a(t)?n:r)(t)}},function(t,e,i){"use strict";(function(t){i.d(e,"e",(function(){return c})),i.d(e,"c",(function(){return h})),i.d(e,"d",(function(){return u})),i.d(e,"a",(function(){return d})),i.d(e,"b",(function(){return g}));var n=i(4),r=i(28),a=i(43),o=i(20),s=i.n(o);const l=t=>"string"==typeof t?t:(t=>{let e=Math.random();for(let i in t){const n=t[i];if(!(e>n))return i;e-=n}})(t),c=e=>{(Object(r.a)("Scenery")||t.e("Scenery, 2D")).setNextScenery(e)},h=()=>(Object(r.a)("Scenery")||t.e("Scenery, 2D")).movingDirection,u=e=>{(Object(r.a)("Scenery")||t.e("Scenery, 2D")).setAltitude(e)},d=()=>(Object(r.a)("Scenery")||t.e("Scenery, 2D")).altitude;let p=null,f=0,m=null;const y=()=>{m(),p=null,f=0,m=null},g=(t,e=0)=>new Promise(i=>{p=t,f=e,m=i});t.c("SceneryBlock",{required:"2D, Motion, "+a.a,events:{Freeze(){this._children.forEach(t=>t.freeze())},Unfreeze(){this._children.forEach(t=>t.unfreeze())}},init(){this.bind("Move",this.sceneryBlockMoved)},remove(){this.unbind("Move",this.sceneryBlockMoved)},moveScenery(e,i,{vx:n,vy:r}){this.shift(e,i);const a=e-n/t.timer.FPS(),o=i-r/t.timer.FPS();this._children.forEach(t=>{1!==t.distance&&t.shift(-a*(1-t.distance),-o*(1-t.distance*t.distance))})},sceneryBlockMoved(){if(this.sceneryName===p){const e=this.vx/t.timer.FPS();(e<=0&&this.x>=-f&&this.x<-f-e||e>0&&this.x>f-e&&this.x<=f)&&y()}const e={v1:this.x,v2:this.x+this.w,v3:1/0,v4:-1/0},i=this.dx,n=this.dy;this._children.forEach(t=>{1!==t.distance&&(t.shift(-i*(1-t.distance),-n*(1-t.distance*t.distance)),t.distance===this.farthestDistance&&(t.x<e.v3&&(e.v3=t.x),t.x+t.w>e.v4&&(e.v4=t.x+t.w)))}),this.sceneryVectors=e}});const v=(e,i,r)=>{const a=t.e("SceneryBlock").attr({x:i,y:r,w:e.width,h:e.height});let o=[];a.resetPositioning=function(){const e={x:t.viewport.width/2,y:t.viewport.height/2},i=this.w/2,n=this.h/2,r={x:this.x+i,y:this.y+n};o.forEach(t=>t(e,r,i,n))};let l=1;return e.elements.forEach(i=>{let r;if(i.composition){let e;e="string"==typeof i.composition?Object(n.b)(i.composition):s()({},Object(n.b)(i.composition[0]),i.composition[1]),r=t.e("2D, Composable").compose(e).attr({z:i.z}),i.frame&&r.displayFrame(i.frame)}if(i.components)if(r)i.components.forEach(t=>r.addComponent(t));else{const e=["2D"].concat(i.components);r=t.e(e.join(", ")).attr({z:i.z||0,w:i.w,h:i.h})}i.attributes&&r.attr(i.attributes);const c=void 0===i.distance?1:i.distance;c<l&&(l=c),o.push((t,n,a,o)=>{const s=(i.x<0?e.width*c:0)+i.x,l=e.height*(c*c)+i.y,h=n.x*c+t.x*(1-c),u=n.y*(c*c)+t.y*(1-c*c),d=h-a*c,p=u-o*(c*c);r.attr({x:d+s,y:p+l,distance:c})}),a.attach(r)}),a.attr({farthestDistance:l}),a.resetPositioning(),a},_=(e,i)=>{const n=t.viewport.width/t.viewport._scale;return(n-(n-i*e)/2)/(i*e)*i},x=1,b=2,w=3;t.c("Scenery",{init(){this.currentScenery=null,this.movingDirection={vx:0,vy:0},this.altitude=0,this.blocks=[],this.delay=null,this.bind("GameLoop",this.verifySceneryContent)},remove(){this.unbind("GameLoop",this.verifySceneryContent),this.blocks.forEach(t=>t.destroy())},setNextScenery(t){Object(n.f)(t)&&(0===this.blocks.length?(this.startScenery(t,{direction:w}),this.checkCountDown=5):this.currentScenery=t)},startScenery(t,{startXPos:e=0,startYPos:i=null,direction:r=x}={}){this.altitude=i||this.altitude;const a=Object(n.f)(t);if(!a)throw new Error(`Scenery ${t} not found`);let o=this.blocks.find(e=>e.__frozen&&e.sceneryName===t);if(o){o.unfreeze();const t=e-o.x,i=this.altitude-o.y;o.moveScenery(t,i,this.movingDirection),o.resetPositioning()}else{let i=this.blocks.find(t=>t.__frozen);if(o=v(a,e,this.altitude),o.sceneryName=t,i){const t=this.blocks.indexOf(i);i.destroy(),this.blocks[t]=o}else this.blocks.push(o)}if(o.attr(this.movingDirection),r===x||r===w){const t=e+o.w,i=this.currentScenery||l(a.right);_(o.farthestDistance,a.width)>t&&(this.currentScenery=null,this.startScenery(i,{startXPos:t,startYPos:this.altitude,direction:x}))}if(r===b||r===w){const t=this.currentScenery||l(a.left),i=e-Object(n.f)(t).width;-_(o.farthestDistance,a.width)<i&&(this.currentScenery=null,this.startScenery(t,{startXPos:i,startYPos:this.altitude,direction:b}))}},setScrollVelocity({vx:t,vy:e}){this.movingDirection={vx:t,vy:e},this.blocks.forEach(i=>i.attr({vx:t,vy:e})),this.checkCountDown>5&&(this.checkCountDown=0===this.blocks.length?1/0:5)},setAltitude(t){this.blocks.forEach(e=>!e.__frozen&&e.moveScenery(0,t-this.altitude,this.movingDirection)),this.altitude=t},verifySceneryContent({dt:e}){if(0===e)return;const{vx:i,vy:r}=this.movingDirection;if(0===i&&0===r)return;if(this.checkCountDown--,this.checkCountDown>0)return;const a=t.timer.FPS();this.checkCountDown=Math.min(800/Math.abs(i)*a,800/Math.abs(r)*a);const o=this.blocks.reduce((t,e)=>{if(e.__frozen)return t;const i=e.sceneryVectors;return{v1:t.v1<i.v1?t.v1:i.v1,v2:t.v2>i.v2?t.v2:i.v2,v3:t.v3<i.v3?t.v3:i.v3,v4:t.v4>i.v4?t.v4:i.v4,left:t.v1<i.v1?t.left:e,right:t.v2>i.v2?t.right:e}},{v1:1/0,v2:-1/0,v3:1/0,v4:-1/0,left:null,right:null}),s=t.viewport.width/t.viewport._scale;if(i<0&&o.left.sceneryVectors.v4<0&&(o.left.attr({vx:0,vy:0}),o.left.freeze()),i>0&&o.right.sceneryVectors.v3>s&&(o.right.attr({vx:0,vy:0}),o.right.freeze()),i<0&&o.v4<s+800){const t=o.right,e=this.currentScenery||l(Object(n.f)(t.sceneryName).right);return this.currentScenery=null,void this.startScenery(e,{startXPos:o.v2+i/a,startYPos:this.altitude,direction:x})}if(i>0&&o.v3>-800){const t=o.left,e=this.currentScenery||l(Object(n.f)(t.sceneryName).left);this.currentScenery=null;const r=Object(n.f)(e),s=o.v1-r.width;this.startScenery(e,{startXPos:s+i/a,startYPos:this.altitude,direction:b})}else;}})}).call(this,i(0).default)},function(t,e,i){var n=i(37),r=i(204),a=i(205),o=n?n.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":o&&o in Object(t)?r(t):a(t)}},function(t,e,i){var n=i(23).Symbol;t.exports=n},function(t,e,i){var n=i(75),r=i(83);t.exports=function(t){return null!=t&&r(t.length)&&!n(t)}},function(t,e,i){var n=i(112),r=i(255),a=i(38);t.exports=function(t){return a(t)?n(t):r(t)}},function(t,e,i){var n,r,a;t.exports=(a=i(5),r=(n=a).lib.WordArray,n.enc.Base64={stringify:function(t){var e=t.words,i=t.sigBytes,n=this._map;t.clamp();for(var r=[],a=0;a<i;a+=3)for(var o=(e[a>>>2]>>>24-a%4*8&255)<<16|(e[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|e[a+2>>>2]>>>24-(a+2)%4*8&255,s=0;s<4&&a+.75*s<i;s++)r.push(n.charAt(o>>>6*(3-s)&63));var l=n.charAt(64);if(l)for(;r.length%4;)r.push(l);return r.join("")},parse:function(t){var e=t.length,i=this._map,n=this._reverseMap;if(!n){n=this._reverseMap=[];for(var a=0;a<i.length;a++)n[i.charCodeAt(a)]=a}var o=i.charAt(64);if(o){var s=t.indexOf(o);-1!==s&&(e=s)}return function(t,e,i){for(var n=[],a=0,o=0;o<e;o++)if(o%4){var s=i[t.charCodeAt(o-1)]<<o%4*2,l=i[t.charCodeAt(o)]>>>6-o%4*2;n[a>>>2]|=(s|l)<<24-a%4*8,a++}return r.create(n,a)}(t,e,n)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},a.enc.Base64)},function(t,e,i){var n;t.exports=(n=i(5),function(t){var e=n,i=e.lib,r=i.WordArray,a=i.Hasher,o=e.algo,s=[];!function(){for(var e=0;e<64;e++)s[e]=4294967296*t.abs(t.sin(e+1))|0}();var l=o.MD5=a.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,e){for(var i=0;i<16;i++){var n=e+i,r=t[n];t[n]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}var a=this._hash.words,o=t[e+0],l=t[e+1],p=t[e+2],f=t[e+3],m=t[e+4],y=t[e+5],g=t[e+6],v=t[e+7],_=t[e+8],x=t[e+9],b=t[e+10],w=t[e+11],C=t[e+12],k=t[e+13],S=t[e+14],D=t[e+15],z=a[0],F=a[1],A=a[2],P=a[3];z=c(z,F,A,P,o,7,s[0]),P=c(P,z,F,A,l,12,s[1]),A=c(A,P,z,F,p,17,s[2]),F=c(F,A,P,z,f,22,s[3]),z=c(z,F,A,P,m,7,s[4]),P=c(P,z,F,A,y,12,s[5]),A=c(A,P,z,F,g,17,s[6]),F=c(F,A,P,z,v,22,s[7]),z=c(z,F,A,P,_,7,s[8]),P=c(P,z,F,A,x,12,s[9]),A=c(A,P,z,F,b,17,s[10]),F=c(F,A,P,z,w,22,s[11]),z=c(z,F,A,P,C,7,s[12]),P=c(P,z,F,A,k,12,s[13]),A=c(A,P,z,F,S,17,s[14]),z=h(z,F=c(F,A,P,z,D,22,s[15]),A,P,l,5,s[16]),P=h(P,z,F,A,g,9,s[17]),A=h(A,P,z,F,w,14,s[18]),F=h(F,A,P,z,o,20,s[19]),z=h(z,F,A,P,y,5,s[20]),P=h(P,z,F,A,b,9,s[21]),A=h(A,P,z,F,D,14,s[22]),F=h(F,A,P,z,m,20,s[23]),z=h(z,F,A,P,x,5,s[24]),P=h(P,z,F,A,S,9,s[25]),A=h(A,P,z,F,f,14,s[26]),F=h(F,A,P,z,_,20,s[27]),z=h(z,F,A,P,k,5,s[28]),P=h(P,z,F,A,p,9,s[29]),A=h(A,P,z,F,v,14,s[30]),z=u(z,F=h(F,A,P,z,C,20,s[31]),A,P,y,4,s[32]),P=u(P,z,F,A,_,11,s[33]),A=u(A,P,z,F,w,16,s[34]),F=u(F,A,P,z,S,23,s[35]),z=u(z,F,A,P,l,4,s[36]),P=u(P,z,F,A,m,11,s[37]),A=u(A,P,z,F,v,16,s[38]),F=u(F,A,P,z,b,23,s[39]),z=u(z,F,A,P,k,4,s[40]),P=u(P,z,F,A,o,11,s[41]),A=u(A,P,z,F,f,16,s[42]),F=u(F,A,P,z,g,23,s[43]),z=u(z,F,A,P,x,4,s[44]),P=u(P,z,F,A,C,11,s[45]),A=u(A,P,z,F,D,16,s[46]),z=d(z,F=u(F,A,P,z,p,23,s[47]),A,P,o,6,s[48]),P=d(P,z,F,A,v,10,s[49]),A=d(A,P,z,F,S,15,s[50]),F=d(F,A,P,z,y,21,s[51]),z=d(z,F,A,P,C,6,s[52]),P=d(P,z,F,A,f,10,s[53]),A=d(A,P,z,F,b,15,s[54]),F=d(F,A,P,z,l,21,s[55]),z=d(z,F,A,P,_,6,s[56]),P=d(P,z,F,A,D,10,s[57]),A=d(A,P,z,F,g,15,s[58]),F=d(F,A,P,z,k,21,s[59]),z=d(z,F,A,P,m,6,s[60]),P=d(P,z,F,A,w,10,s[61]),A=d(A,P,z,F,p,15,s[62]),F=d(F,A,P,z,x,21,s[63]),a[0]=a[0]+z|0,a[1]=a[1]+F|0,a[2]=a[2]+A|0,a[3]=a[3]+P|0},_doFinalize:function(){var e=this._data,i=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;i[r>>>5]|=128<<24-r%32;var a=t.floor(n/4294967296),o=n;i[15+(r+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),i[14+(r+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),e.sigBytes=4*(i.length+1),this._process();for(var s=this._hash,l=s.words,c=0;c<4;c++){var h=l[c];l[c]=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8)}return s},clone:function(){var t=a.clone.call(this);return t._hash=this._hash.clone(),t}});function c(t,e,i,n,r,a,o){var s=t+(e&i|~e&n)+r+o;return(s<<a|s>>>32-a)+e}function h(t,e,i,n,r,a,o){var s=t+(e&n|i&~n)+r+o;return(s<<a|s>>>32-a)+e}function u(t,e,i,n,r,a,o){var s=t+(e^i^n)+r+o;return(s<<a|s>>>32-a)+e}function d(t,e,i,n,r,a,o){var s=t+(i^(e|~n))+r+o;return(s<<a|s>>>32-a)+e}e.MD5=a._createHelper(l),e.HmacMD5=a._createHmacHelper(l)}(Math),n.MD5)},function(t,e,i){"use strict";(function(t){t.c("Animator",{events:{Freeze(){this.animations=[],this.animating=!1,this.unbind("GameLoop",this._animateTick)}},init(){this.animations=[]},remove(){this.unbind("GameLoop",this._animateTick)},animate(e,i,n="linear"){return e?0===i?(e(1),Promise.resolve()):new Promise(r=>{const a={transition:e,timer:new t.easing(i,n),resolver:r};this.animations.push(a),this.animating||(this.animating=!0,this.uniqueBind("GameLoop",this._animateTick))}):Promise.resolve()},_animateTick({dt:t}){const e=[];this.animations.forEach((i,n)=>{const{timer:r,transition:a,resolver:o}=i;r.tick(t),a(r.value()),r.complete&&(a(1),e.push(n),o())}),e.reverse().forEach(t=>this.animations.splice(t,1)),0===this.animations.length&&(this.animating=!1,this.unbind("GameLoop",this._animateTick))}}),e.a="Animator"}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){t.c("PausableMotion",{required:"Motion",init(){this.unbind("UpdateFrame",this._linearMotionTick),this.bind("GameLoop",this._linearMotionTick)}}),e.a="PausableMotion"}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){t.c("Listener",{init(){this.listeners=[]},remove(){this.listeners.forEach(({object:t,event:e,callback:i})=>{t.unbind(e,i)}),this.listeners=[]},listenTo(t,e,i,n){null==n&&(n=this);const r=(...t)=>{i.apply(n,t)};this.listeners.push({object:t,event:e,callback:r}),t.uniqueBind(e,r)}}),e.a="Listener"}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){i.d(e,"b",(function(){return f}));var n=i(18),r=i(4),a=i(26),o=i(8),s=i(94),l=i(12),c=i(1),h=i(24),u=i(15),d=i(20),p=i.n(d);t.c("Animation",{init(){this.elements={}},remove(){this.unbind("GameLoop",this._animateTick)},setAnimation(t,{maxCheckpoint:e=0,start:i=0,...n}={}){this.currentAnimation!==t&&(this.currentAnimation=t,this.maxAllowedCheckpoint=e,this.setActiveCheckpoint(i,n))},setCheckpointLimit(t){const e=this.maxAllowedCheckpoint;this.maxAllowedCheckpoint=t,this.targetCheckpoint<t&&!this.playingAnimation&&this.setActiveCheckpoint(this.targetCheckpoint===e?this.targetCheckpoint:this.targetCheckpoint+1)},setActiveCheckpoint(e,{autoStart:i=!0,duration:o=null}={}){this.unbind("GameLoop",this.updateAnimation);const s=this.currentAnimation.checkpoints[e];if(this.playingAnimation=!1,!s)return;this.targetCheckpoint=e;let d=Object.keys(this.elements);if((s.composables||[]).forEach(([e,i])=>{const a=Object(r.b)(e),o=this.elements[i.key];if(d=d.filter(t=>t!==i.key),o&&o.appliedDefinition===a){const t=i.frame||"default";o.targetFrame!==t&&o.displayFrame(t)}else{o&&o.destroy();const e=(i.relativeX||0)*t.viewport.width,r=(i.relativeY||0)*t.viewport.height,s=t.e(["2D","WebGL",n.a].join(",")).attr({x:e,y:r,w:40,h:40,z:this.z||0}).compose(a);s.displayFrame(i.frame||"default"),this.elements[i.key]=s}}),(s.entities||[]).forEach(([e,i])=>{const n=this.elements[i.key];if(d=d.filter(t=>t!==i.key),n)this.z&&n.attr({z:this.z}),i.state&&n.showState(i.state);else{const n=(i.relativeX||0)*t.viewport.width,r=(i.relativeY||0)*t.viewport.height,o=t(e).get(0)||Object(a.b)(e,i).attr({x:n,y:r,z:(this.z||0)+(i.z||0)});i.detach&&o.detachFromParent&&o.detachFromParent(),this.elements[i.key]=o,i.state&&o.showState(i.state)}}),(s.particles||[]).forEach(([e,i])=>{const n=this.elements[i.key];if(d=d.filter(t=>t!==i.key),n)this.z&&n.attr({z:(this.z||0)+(i.z||0)}),i.state&&n.showState(i.state);else{const n=(i.relativeX||0)*t.viewport.width,a=(i.relativeY||0)*t.viewport.height,o=p()({},Object(r.d)(e),i.particles),s=t.e(l.a).attr({x:n,y:a,z:(this.z||0)+(i.z||0)}).particles(o);i.detach&&s.detachFromParent&&s.detachFromParent(),this.elements[i.key]=s}}),s.background&&Object(h.c)(s.background),d.forEach(t=>{delete this.elements[t]}),s.backgroundColor){const t=Object(u.e)([s.backgroundColor,1]);Object(h.c)(t)}i&&s.timeline&&e<this.maxAllowedCheckpoint&&(this.animationDuration=o||s.timeline.defaultDuration,this.animationDuration&&(this.animationTimer=new t.easing(this.animationDuration,c.d),this.timeLineEvents=s.timeline.transitions.map(t=>({...t,handled:!1})),this.playingAnimation=!0,this.uniqueBind("GameLoop",this.updateAnimation)))},updateAnimation({dt:e}){this.animationTimer.tick(e);const i=this.animationTimer.value();this.timeLineEvents.forEach(n=>{if(!(n.handled||n.start>i)){if(n.targetFrame&&n.key){const t=this.elements[n.key];n.handled=!0,t&&t.displayFrame(n.targetFrame,(n.end-n.start)*this.animationDuration)}if(n.targetState&&n.key){const t=this.elements[n.key];n.handled=!0,t&&t.showState(n.targetState,(n.end-n.start)*this.animationDuration)}if(n.attributes&&n.key){const t=this.elements[n.key];if(n.handled=!0,t){const e=Object(o.b)(t,n.attributes);t.animate(e,(n.end-n.start)*this.animationDuration)}}if(n.components&&n.key){const t=this.elements[n.key];n.handled=!0,t&&n.components.forEach(e=>t.addComponent(e))}if(n.targetBackgroundColor)if(n.sourceColor&&n.ease){n.ease.tick(e);const t=Object(u.d)(n.ease.value(),n.sourceColor,n.targetColor);Object(h.c)(t),n.ease.value()>=1&&(n.handled=!0)}else{n.sourceColor=Object(h.b)(),n.targetColor=Object(u.e)([n.targetBackgroundColor,1]),n.ease=new t.easing((n.end-n.start)*this.animationDuration,c.d),n.ease.tick(e);const i=Object(u.d)(n.ease.value(),n.sourceColor,n.targetColor);Object(h.c)(i)}if(n.path&&n.key){n.handled=!0;const t=this.elements[n.key];if(!t)return;t.addComponent(s.a);const e=(n.end-n.start)*this.animationDuration,i=n.path.data||Object(r.e)(n.path.name).path;t.flyPattern(i,{duration:e,start:n.path.start||0,end:n.path.end||1,easing:n.path.easing||"linear"})}if(n.remove&&n.key){if(n.handled=!0,!this.elements[n.key])return;this.elements[n.key].destroy(),delete this.elements[n.key]}}}),i>=1&&(this.unbind("GameLoop",this.updateAnimation),this.playingAnimation=!1,this.maxAllowedCheckpoint>this.targetCheckpoint&&this.currentAnimation.checkpoints.length>this.targetCheckpoint+1?(this.trigger("CheckpointReached",{checkpoint:this.targetCheckpoint+1}),this.setActiveCheckpoint(this.targetCheckpoint+1)):(this.trigger("CheckpointReached",{checkpoint:this.targetCheckpoint+1}),this.trigger("AnimationEnded",{checkpoint:this.targetCheckpoint})))}}),e.a="Animation";const f=(e,{max:i=1/0,start:n=0,z:r=0}={})=>{const a=t.e("Animation").attr({z:r});a.setAnimation(e,{maxCheckpoint:i,start:n});let o=null,s=[];return a.bind("CheckpointReached",({checkpoint:t})=>{o=t,s=s.filter(({checkpoint:e,resolver:i})=>null==e?(i({checkpoint:t,player:a}),!0):!(e<=t)||(i(t),!1))}),{waitTillCheckpoint:t=>t<=o?Promise.resolve():new Promise((e,i)=>{s.push({checkpoint:t,resolver:e,rejecter:i})}),onCheckpointChange:t=>{s.push({checkpoint:null,resolver:t})},updateCheckpoint:t=>{a.setActiveCheckpoint(t)},updateCheckpointLimit:t=>{a.setCheckpointLimit(t)},waitTillEnd:()=>new Promise(t=>a.one("AnimationEnded",t)),destroy:()=>{s.forEach(({rejecter:t})=>t&&t(new Error("Animation destroyed"))),a.destroy()}}}}).call(this,i(0).default)},function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i(30),r=i.n(n),a=i(71),o=i.n(a);const s=()=>{const t=(()=>{const t=localStorage.getItem("SPDLZR");if(!t)return[];const e=t.slice(0,20),i=t.slice(20),n=r.a.AES.decrypt(i,e).toString(r.a.enc.Utf8);return n.length>1?JSON.parse(n):[]})(),e="SPL",i=[{initials:e,score:3e4},{initials:e,score:2e4},{initials:e,score:1e4},{initials:e,score:5e3},{initials:e,score:2500},{initials:e,score:1500},{initials:e,score:1e3},{initials:e,score:5e3},{initials:e,score:2e3},{initials:e,score:1500}].concat(t);return o()(i,"score").reverse()}},function(t,e,i){"use strict";(function(t){i.d(e,"a",(function(){return s})),i.d(e,"d",(function(){return l})),i.d(e,"b",(function(){return c})),i.d(e,"c",(function(){return h}));let n=100,r=0,a=0,o=1;const s=()=>o,l=(t,e,i,s)=>{r+=t,a+=1,r>=n&&a>=10&&(s.exec(u(e,i,25*o)),r=0,a=0,n*=1.1)},c=()=>{h()},h=()=>{o=1,t.trigger("MultiplierChange",o),n=100,r=0},u=(e,i,n)=>async({allowDamage:r,showState:a,waitForEvent:s,wait:l,spawn:c,awardPoints:h,moveWithPattern:u})=>{const d=c("Bonus",{location:{x:e,y:i},defaultVelocity:40});await r(d,{health:10}),s(d,"Dead",async()=>{h(n,e,i,!1),o+=1,t.trigger("MultiplierChange",o),await a(d,"pickedUp"),await l(2e3),d.destroy()});const p=u(d,"powerup.short");await p.process,await a(d,"disappear",1e3),d.destroy()}}).call(this,i(0).default)},function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},function(t,e,i){var n=i(111),r=i(77);t.exports=function(t,e,i,a){var o=!i;i||(i={});for(var s=-1,l=e.length;++s<l;){var c=e[s],h=a?a(i[c],t[c],c,i,t):void 0;void 0===h&&(h=t[c]),o?r(i,c,h):n(i,c,h)}return i}},function(t,e,i){"use strict";(function(t){var n=i(11);const r=t=>{Array.from(t._children).forEach(e=>{"function"==typeof e.attr&&e.attr({x:t.x+(t.w-e.w)-(e.x-t.x)}),void 0!==e._dx&&(e._dx=-e._dx),"function"==typeof e.flip&&(e._flipX?e.unflip("X"):e.flip("X")),(t=>{if(!t.emitter)return;const e=t.angle||0;t.emitter.xFlipped=!t.emitter.xFlipped,t.angle=Object(n.a)(e),t.trigger("Change",{angle:t.angle})})(e),e._children&&r(e)})};t.c("Flipable",{flipX(){if(this.xFlipped)return;this.xFlipped=!0;const t=this._rotation;this.rotation=0;try{"function"==typeof this.flip&&(this._flipX?this.unflip("X"):this.flip("X")),r(this)}catch(t){console.log(t)}return this._mirrorCollision(),this._mirrorRotationPoints(),this._mirrorStretchPoints(),this.rotation=-t,this},unflipX(){if(!this.xFlipped)return;this.xFlipped=!1;const t=this._rotation;this.rotation=0;try{"function"==typeof this.unflip&&(this._flipX?this.unflip("X"):this.flip("X")),r(this)}catch(t){console.log(t)}return this._mirrorCollision(),this._mirrorRotationPoints(),this._mirrorStretchPoints(),this.rotation=-t,this},_mirrorCollision(){if(this.map&&this.map.points)for(let t=0;t<this.map.points.length;t++){const e=this.map.points[t];if(t%2==0){const i=e-this.x;this.map.points[t]=this.x+(this.w-i)}}},_mirrorStretchPoints(){const t=e=>{Array.from(e._children).forEach(e=>{void 0!==e.stretch&&e.stretch[1]===e.stretch[3]&&(e.stretch[1]=1-e.stretch[1],e.stretch[3]=1-e.stretch[3],e._children&&t(e))})};void 0!==this.stretch&&this.stretch[1]===this.stretch[3]&&(this.stretch[1]=1-this.stretch[1],this.stretch[3]=1-this.stretch[3]),t(this)},_mirrorRotationPoints(){const t=e=>{Array.from(e._children).forEach(e=>{"function"==typeof e.attr&&(null!==e.origin&&(e._origin.x=e.w-e._origin.x),e._children&&t(e))})};this._origin.x=this.w-this._origin.x,t(this)}}),e.a="Flipable"}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var n=i(132),r=i.n(n),a=i(133),o=i.n(a);t.extend({defaultGradientShader(e){return e?this._defaultGradientShader=e:(void 0===this._defaultGradientShader&&(this._defaultGradientShader=new t.WebGLShader(r.a,o.a,[{name:"aPosition",width:2},{name:"aOrientation",width:3},{name:"aLayer",width:2},{name:"aColor",width:4}],(function(t,e){t.program.writeVector("aColor",e._topColor._red/255,e._topColor._green/255,e._topColor._blue/255,e._topColor._strength,e._bottomColor._red/255,e._bottomColor._green/255,e._bottomColor._blue/255,e._bottomColor._strength)}))),this._defaultGradientShader)}});t.c("Gradient",{events:{LayerAttached:"_setupGradient"},init(){this._topColor={_red:0,_green:0,_blue:0,_strength:1},this._bottomColor={_red:0,_green:0,_blue:0,_strength:1},this.ready=!0,this.bind("Draw",this._drawGradient),this._drawLayer&&this._setupGradient(this._drawLayer),this.trigger("Invalidate")},remove(){this.unbind("Draw",this._drawGradient),this.has("DOM")&&(this._element.style.backgroundColor="transparent"),this.trigger("Invalidate")},_setupGradient(e){"WebGL"===e.type&&this._establishShader("Gradient",t.defaultGradientShader())},_drawGradient(t){"webgl"===t.type&&t.program.draw(t,this)},topColor(t,e){return t?(this._setColor(this._topColor,t,e),this):this._topColor},bottomColor(t,e){return t?(this._setColor(this._bottomColor,t,e),this):this._bottomColor},_setColor(e,i,n){"string"==typeof i?t.assignColor(i,e):(e._red=i[0],e._green=i[1],e._blue=i[2]),void 0!==n&&(e._strength=n),this.trigger("Invalidate")}}),e.a="Gradient"}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){i.d(e,"a",(function(){return r})),i.d(e,"b",(function(){return a}));var n=i(11);const r="Stretchable",a="Stretcher";t.c(r,{properties:{sw:{set(t){t!==this._w&&this._stretch(t,this._h,"w")},get(){return this._w},configurable:!0,enumerable:!0},sh:{set(t){t!==this._h&&this._stretch(this._w,t,"h")},get(){return this._h},configurable:!0,enumerable:!0}},_stretch(t,e,i){this.trigger("Stretch",{dw:t-this._w,dh:e-this._h});const n={axis:i,amount:"w"===i?t-this._w:e-this._h};this._w=t,this._h=e,this._calculateMBR(),this.trigger("Resize",n),this.trigger("Invalidate")}}),t.c(a,{init(){this._handleStretch=this._handleStretch.bind(this)},_handleStretch(t){const e=this.stretch[3]*t.dw,i=this.stretch[1]*t.dw-e,r=this.stretch[0]*t.dh,a=this.stretch[2]*t.dh-r;this._w+=i,this._h+=a;const[o,s]=Object(n.c)(this,e);this._x+=o,this._y+=s,this.trigger("Invalidate")},activateStretch(t){t.uniqueBind("Stretch",this._handleStretch)}})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){i.d(e,"a",(function(){return n}));const n=(e,i,n,r="#FFFFFF",a="20px")=>{const o=t.e("2D, UILayerDOM, Text").attr({x:i.x,y:i.y+n,w:i.w,z:i.z+1}).text(e).textColor(r).textAlign("center").textFont({size:a,weight:"bold",family:"Press Start 2P"});return i.attach(o),o}}).call(this,i(0).default)},function(t,e,i){var n=i(55),r=i(197),a=i(198),o=i(199),s=i(200),l=i(201);function c(t){var e=this.__data__=new n(t);this.size=e.size}c.prototype.clear=r,c.prototype.delete=a,c.prototype.get=o,c.prototype.has=s,c.prototype.set=l,t.exports=c},function(t,e,i){var n=i(192),r=i(193),a=i(194),o=i(195),s=i(196);function l(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=r,l.prototype.get=a,l.prototype.has=o,l.prototype.set=s,t.exports=l},function(t,e,i){var n=i(48);t.exports=function(t,e){for(var i=t.length;i--;)if(n(t[i][0],e))return i;return-1}},function(t,e,i){var n=i(32)(Object,"create");t.exports=n},function(t,e,i){var n=i(217);t.exports=function(t,e){var i=t.__data__;return n(e)?i["string"==typeof e?"string":"hash"]:i.map}},function(t,e,i){var n=i(224),r=i(25),a=Object.prototype,o=a.hasOwnProperty,s=a.propertyIsEnumerable,l=n(function(){return arguments}())?n:function(t){return r(t)&&o.call(t,"callee")&&!s.call(t,"callee")};t.exports=l},function(t,e,i){(function(t){var n=i(23),r=i(226),a=e&&!e.nodeType&&e,o=a&&"object"==typeof t&&t&&!t.nodeType&&t,s=o&&o.exports===a?n.Buffer:void 0,l=(s?s.isBuffer:void 0)||r;t.exports=l}).call(this,i(78)(t))},function(t,e){t.exports=function(t){return function(e){return t(e)}}},function(t,e,i){var n=i(112),r=i(231),a=i(38);t.exports=function(t){return a(t)?n(t,!0):r(t)}},function(t,e){t.exports=function(t){return t}},function(t,e,i){var n=i(269),r=i(74),a=i(270),o=i(271),s=i(272),l=i(36),c=i(101),h=c(n),u=c(r),d=c(a),p=c(o),f=c(s),m=l;(n&&"[object DataView]"!=m(new n(new ArrayBuffer(1)))||r&&"[object Map]"!=m(new r)||a&&"[object Promise]"!=m(a.resolve())||o&&"[object Set]"!=m(new o)||s&&"[object WeakMap]"!=m(new s))&&(m=function(t){var e=l(t),i="[object Object]"==e?t.constructor:void 0,n=i?c(i):"";if(n)switch(n){case h:return"[object DataView]";case u:return"[object Map]";case d:return"[object Promise]";case p:return"[object Set]";case f:return"[object WeakMap]"}return e}),t.exports=m},function(t,e,i){var n=i(36),r=i(25);t.exports=function(t){return"symbol"==typeof t||r(t)&&"[object Symbol]"==n(t)}},function(t,e,i){var n=i(65);t.exports=function(t){if("string"==typeof t||n(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}},function(t,e,i){var n,r,a,o,s,l;t.exports=(l=i(5),r=(n=l).lib,a=r.Base,o=r.WordArray,(s=n.x64={}).Word=a.extend({init:function(t,e){this.high=t,this.low=e}}),s.WordArray=a.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:8*t.length},toX32:function(){for(var t=this.words,e=t.length,i=[],n=0;n<e;n++){var r=t[n];i.push(r.high),i.push(r.low)}return o.create(i,this.sigBytes)},clone:function(){for(var t=a.clone.call(this),e=t.words=this.words.slice(0),i=e.length,n=0;n<i;n++)e[n]=e[n].clone();return t}}),l)},function(t,e,i){"use strict";(function(t){t.c("Scalable",{properties:{scaleX:{set(t){t!==this._scaleX&&this._updateScaleX(t)},get(){return this._scaleX},configurable:!0,enumerable:!0},_scaleX:{value:1,writable:!0,enumerable:!1,configurable:!1},scaleY:{set(t){t!==this._scaleY&&this._updateScaleY(t)},get(){return this._scaleY},configurable:!0,enumerable:!0},_scaleY:{value:1,writable:!0,enumerable:!1,configurable:!1},scale:{set(t){t!==this._scale&&this._updateScale(t)},get(){return this._scale},configurable:!0,enumerable:!0},_scale:{value:1,writable:!0,enumerable:!1,configurable:!1}},_updateScaleX(t){const e=this._scaleX;this._scaleX=t;const i=this.w;this.w=this.w/e*t,this.x=this.x+(i-this.w)/2,this._children.filter(t=>t.attr).forEach(n=>{const r=n.x-this.x;n.attr({x:this.x+r/e*t,w:(n.w+i-this.w)/e*t})}),this.map&&this.map.points&&(this.map.points=this.map.points.map((i,n)=>{if(n%2==1)return this.y;const r=n%2==0?this.x:this.y;return r+(i-r)/e*t}))},_updateScaleY(t){const e=this._scaleY;this._scaleY=t;const i=this.h;this.h=this.h/e*t,this.y=this.y+(i-this.h)/2,this._children.filter(t=>t.attr).forEach(n=>{const r=n.y-this.y;n.attr({y:this.y+r/e*t,h:(n.h+i-this.h)/e*t})}),this.map&&this.map.points&&(this.map.points=this.map.points.map((i,n)=>{if(n%2==0)return this.y;const r=n%2==0?this.x:this.y;return r+(i-r)/e*t}))},_updateScale(t){const e=this._scale;this._scale=t;const i=this.w,n=this.h;this.w=this.w/e*t,this.x=this.x+(i-this.w)/2,this.h=this.h/e*t,this.y=this.y+(n-this.h)/2,this._children.filter(t=>t.attr).forEach(r=>{const a=r.x-this.x,o=r.y-this.y;r.attr({x:this.x+a/e*t,y:this.y+o/e*t,w:(r.w+i-this.w)/e*t,h:(r.h+n-this.h)/e*t})}),this.map&&this.map.points&&(this.map.points=this.map.points.map((i,n)=>{const r=n%2==0?this.x:this.y;return r+(i-r)/e*t}))}}),e.a="Scalable"}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){t.c("ShipControls",{init(){this.bind("NewDirection",t=>{if(!this.disableControls)if(-1===t.x&&!this.xFlipped||1===t.x&&this.xFlipped){if("dead"===this.appliedEntityState)return;"reverse"!==this.appliedEntityState&&this.showState("reverse")}else"flying"!==this.appliedEntityState&&this.showState("flying")})},controlPrimary(t){this.disableControls||"dead"!==this.appliedEntityState&&(t&&this.controlSecondary(!1),t?this.showState("shooting"):this.showState("noShooting"))},controlSecondary(t){this.disableControls||this.hasLaser&&"dead"!==this.appliedEntityState&&(t&&this.controlPrimary(!1),t?this.showState("laserShooting"):this.showState("noLaserShooting"))},controlSwitch(){},controlBlock(){}}),e.a="ShipControls"}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var n=i(93);t.c("ShipCollision",{required:"Collision, "+n.a,init(){this.onHit("ShipSolid",t=>{const e=this.motionDelta();let i=0,n=0,r=0,a=0;t.map(t=>{let o=0,s=0;if("SAT"===t.type)o-=t.overlap*t.nx,s-=t.overlap*t.ny;else{const{obj:i}=t,n={x:0,y:0};i.intersect(this.x-e.x+n.x,this.y+n.y,this.w,this.h)&&(s-=e.y-n.y),i.intersect(this.x+n.y,this.y-e.y+n.y,this.w,this.h)&&(o-=e.x-n.x)}if(0!==o&&(o>0?(r<0&&this._squashShip(),r=1,i=Math.max(i,o)):(r>0&&this._squashShip(),r=-1,i=Math.min(i,o))),0!==s)return s<0?(a>0&&this._squashShip(),a=-1,n=Math.min(n,s)):(a<0&&this._squashShip(),a=1,n=Math.max(n,s))});const o=this.x,s=this.y;this.shift(i,n),(o===this.x&&i||s===this.y&&n)&&this._squashShip()}),this.onHit("PlayerEnemy",()=>{this.processDamage({velocity:-13e3,affects:"health",name:"Impact"})}),this.onHit("PlayerHit",t=>{this.health<=0||t.map(t=>{const e=t.obj;e.processDamage&&e.processDamage({velocity:-5e3,affects:"health",name:"Impact"})})})},_squashShip(){this.processDamage({velocity:-25e3,affects:"health",name:"Impact"})}}),e.a="ShipCollision"}).call(this,i(0).default)},function(t,e,i){var n=i(282),r=i(284),a=i(113),o=i(114),s=a((function(t,e){if(null==t)return[];var i=e.length;return i>1&&o(t,e[0],e[1])?e=[]:i>2&&o(e[0],e[1],e[2])&&(e=[e[0]]),r(t,n(e,1),[])}));t.exports=s},function(t,e,i){"use strict";(function(t){var n=i(11);t.c("Delta2D",{required:"2D",properties:{drx:{set:function(t){const e=t-this._drx,[i,r]=Object(n.c)(this,e);this.shift(i,r),this._drx=t},get:function(){return this._drx},enumerable:!0,configurable:!1},_drx:{value:0,writable:!0,enumerable:!1,configurable:!1},dry:{set:function(t){const e=t-this._dry,[i,r]=Object(n.d)(this,e);this.shift(i,r),this._dry=t},get:function(){return this._dry},enumerable:!0,configurable:!1},_dry:{value:0,writable:!0,enumerable:!1,configurable:!1},dx:{set:function(t){this.shift(t-this._dx,0),this._dx=t},get:function(){return this._dx},enumerable:!0,configurable:!1},_dx:{value:0,writable:!0,enumerable:!1,configurable:!1},dy:{set:function(t){this.shift(0,t-this._dy),this._dy=t},get:function(){return this._dy},enumerable:!0,configurable:!1},_dy:{value:0,writable:!0,enumerable:!1,configurable:!1}}}),e.a="Delta2D"}).call(this,i(0).default)},function(t,e,i){"use strict";i.d(e,"b",(function(){return r})),i.d(e,"a",(function(){return a})),i.d(e,"c",(function(){return o}));const n=(t,e,i,n)=>Math.sqrt((i-t)*(i-t)+(n-e)*(n-e)),r=(t,e,i,r)=>{const a=n(t,e,i,r);return[(i-t)/a,(r-e)/a]},a=(t,{affects:e,duration:i=1,velocity:n=0,accelleration:r=0,upperBounds:a=1/0,lowerBounds:o=-1/0,origin:s,speed:l,name:c="Impact"})=>(t.effects=(t.effects||[]).concat({affects:e,duration:i,velocity:n,accelleration:r,upperBounds:a,lowerBounds:o,active:0,origin:s,speed:l,name:c}),t),o=(t={})=>(e,i)=>{if(void 0===e.effects||0===e.effects.length)return!1;const{mutations:r,effects:a}=e.effects.reduce((r,a)=>{let o=1/0;if(a.origin&&a.speed&&void 0!==e.x&&void 0!==e.y){const t=n(e.x,e.y,a.origin.x,a.origin.y),r=(a.active+i)/1e3*a.speed;o=t<r?(r-t)/a.speed*1e3:0}const s=Math.min(i,o,a.duration)/1e3,l=a.velocity*s+.5*a.accelleration*s*s,c=l>a.upperBounds?a.upperBounds:l<a.lowerBounds?a.lowerBounds:l,h=0!==c?r.mutations.concat([].concat(a.affects).reduce((i,n)=>i.concat(Object.entries(((i,n)=>t[i]?t[i](n,a,e):{[i]:n})(n,c)).reduce((t,[e,i])=>t.concat([[e,t=>t+i]]),[])),[])):r.mutations;return r.mutations!==h?{...r,mutations:h}:r},{mutations:[],effects:e.effects.reduce((t,e)=>e.duration>i?t.concat({...e,duration:e.duration-i,active:e.active+i,velocity:e.velocity+e.accelleration*i/1e3}):t,[])});return r.reduce((t,[i,n])=>{const r=void 0!==t[i]?t[i]:e[i];return t[i]=n(r),t},{effects:a})}},function(t,e,i){var n=i(32)(i(23),"Map");t.exports=n},function(t,e,i){var n=i(36),r=i(14);t.exports=function(t){if(!r(t))return!1;var e=n(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},function(t,e,i){var n=i(209),r=i(216),a=i(218),o=i(219),s=i(220);function l(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=r,l.prototype.get=a,l.prototype.has=o,l.prototype.set=s,t.exports=l},function(t,e,i){var n=i(103);t.exports=function(t,e,i){"__proto__"==e&&n?n(t,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[e]=i}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,i){var n=i(107);t.exports=function(t){var e=new t.constructor(t.byteLength);return new n(e).set(new n(t)),e}},function(t,e){t.exports=function(t,e){var i=-1,n=t.length;for(e||(e=Array(n));++i<n;)e[i]=t[i];return e}},function(t,e,i){var n=i(109)(Object.getPrototypeOf,Object);t.exports=n},function(t,e){var i=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||i)}},function(t,e){t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}},function(t,e,i){var n=i(228),r=i(61),a=i(85),o=a&&a.isTypedArray,s=o?r(o):n;t.exports=s},function(t,e,i){(function(t){var n=i(100),r=e&&!e.nodeType&&e,a=r&&"object"==typeof t&&t&&!t.nodeType&&t,o=a&&a.exports===r&&n.process,s=function(){try{var t=a&&a.require&&a.require("util").types;return t||o&&o.binding&&o.binding("util")}catch(t){}}();t.exports=s}).call(this,i(78)(t))},function(t,e){var i=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&i.test(t))&&t>-1&&t%1==0&&t<e}},function(t,e){t.exports=function(t,e){for(var i=-1,n=null==t?0:t.length,r=Array(n);++i<n;)r[i]=e(t[i],i,t);return r}},function(t,e,i){var n=i(266),r=i(118),a=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols,s=o?function(t){return null==t?[]:(t=Object(t),n(o(t),(function(e){return a.call(t,e)})))}:r;t.exports=s},function(t,e){t.exports=function(t,e){for(var i=-1,n=e.length,r=t.length;++i<n;)t[r+i]=e[i];return t}},function(t,e,i){var n=i(16),r=i(65),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/;t.exports=function(t,e){if(n(t))return!1;var i=typeof t;return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=t&&!r(t))||(o.test(t)||!a.test(t)||null!=e&&t in Object(e))}},function(t,e,i){var n,r,a,o,s,l,c,h;t.exports=(h=i(5),r=(n=h).lib,a=r.WordArray,o=r.Hasher,s=n.algo,l=[],c=s.SHA1=o.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var i=this._hash.words,n=i[0],r=i[1],a=i[2],o=i[3],s=i[4],c=0;c<80;c++){if(c<16)l[c]=0|t[e+c];else{var h=l[c-3]^l[c-8]^l[c-14]^l[c-16];l[c]=h<<1|h>>>31}var u=(n<<5|n>>>27)+s+l[c];u+=c<20?1518500249+(r&a|~r&o):c<40?1859775393+(r^a^o):c<60?(r&a|r&o|a&o)-1894007588:(r^a^o)-899497514,s=o,o=a,a=r<<30|r>>>2,r=n,n=u}i[0]=i[0]+n|0,i[1]=i[1]+r|0,i[2]=i[2]+a|0,i[3]=i[3]+o|0,i[4]=i[4]+s|0},_doFinalize:function(){var t=this._data,e=t.words,i=8*this._nDataBytes,n=8*t.sigBytes;return e[n>>>5]|=128<<24-n%32,e[14+(n+64>>>9<<4)]=Math.floor(i/4294967296),e[15+(n+64>>>9<<4)]=i,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=o.clone.call(this);return t._hash=this._hash.clone(),t}}),n.SHA1=o._createHelper(c),n.HmacSHA1=o._createHmacHelper(c),h.SHA1)},function(t,e,i){var n,r,a,o;t.exports=(n=i(5),a=(r=n).lib.Base,o=r.enc.Utf8,void(r.algo.HMAC=a.extend({init:function(t,e){t=this._hasher=new t.init,"string"==typeof e&&(e=o.parse(e));var i=t.blockSize,n=4*i;e.sigBytes>n&&(e=t.finalize(e)),e.clamp();for(var r=this._oKey=e.clone(),a=this._iKey=e.clone(),s=r.words,l=a.words,c=0;c<i;c++)s[c]^=1549556828,l[c]^=909522486;r.sigBytes=a.sigBytes=n,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher,i=e.finalize(t);return e.reset(),e.finalize(this._oKey.clone().concat(i))}})))},function(t,e,i){"use strict";(function(t){var n=i(17),r=i(73);const a=(t,e)=>{if(!e&&t._isFlashing<1)return;e&&t._isFlashing<1&&(t._isFlashing=e?3:0),t._isFlashing--;const i=t._isFlashing>1;t.forEachPart?t.forEachPart(t=>t.attr({hitFlash:!!i&&{_red:.9,_green:.9,_blue:.9}})):t.attr({hitFlash:!!i&&{_red:.9,_green:.9,_blue:.9}})},o=Object(r.c)({health:(t,e,i)=>{const n=1-("Bullet"===e.name&&i.bulletResistance||0);return{health:Math.ceil(t)*n}},position:(t,e,i)=>{if(void 0===i.weight)return{};const[n,a]=Object(r.b)(e.origin.x,e.origin.y,i.x,i.y);return{xForce:n,yForce:a}}});t.c("DamageSupport",{events:{EnterFrame:"_handleEffects"},init(){this.attr({health:0,vulnerable:!1}),this._isFlashing=0,this.allowDamage=this.allowDamage.bind(this),this.hasHealth=this.hasHealth.bind(this)},allowDamage(t){this.attr({vulnerable:!0,...t})},stopDamage(){this.attr({vulnerable:!1}),a(this,!1)},hasHealth(){return this.attr("health")>0},processDamage(t){if(!Object(n.a)()&&!this.hidden&&this.vulnerable){const e=this;[].concat(t).forEach(t=>Object(r.a)(e,t))}},_handleEffects({dt:t}){if(!this.effects||0===this.effects.length)return void a(this,!1);const e=o(this,t);!1!==e?(e.health&&e.health!==this.health&&this.trigger("HealthChange",e.health),a(this,e.health&&e.health<this.health),Object.assign(this,e),this.health<=0&&(this.stopDamage(),this.trigger("Dead"),this.trigger("HealthChange",0))):a(this,!1)}}),e.a="DamageSupport"}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var n=i(157),r=i(159);t.c("WayPointMotion",{required:r.a,init(){this.createStackablePropertyFor("xPath","x"),this.createStackablePropertyFor("yPath","y")},remove(){this.stopFlyPattern()},flyPattern(e,{duration:i,velocity:r,easing:a="linear",start:o=0,end:s=1}={}){this.pattern=e;const l=t.viewport.width,c=t.viewport.height,h=this.pattern[0],u=e.map(({x:t,y:e})=>({x:(t-h.x)*l,y:(e-h.y)*c}));this.bezierPath=Object(n.a)(u),this.eventQueue=e.reduce((t,e,i)=>{if(void 0===e.events)return t;const n=this.bezierPath.curves[i];return t.concat(e.events.map(([t,e])=>({pos:n.min+n.length*t/this.bezierPath.length,event:e})))},[]);const d=(i||this.bezierPath.length/r*1e3)/(s-o);this.wayPointEasing=new t.easing(d,a),this.wayPointEasing.tick(o*d),this.targetPatternValue=s;const p=this.wayPointEasing.value();return this.pathOffset=this.bezierPath.get(p),this.inMotion||(this.inMotion=!0,this.bind("GameLoop",this.updateAcceleration)),this},stopFlyPattern(){this.inMotion&&(this.unbind("GameLoop",this.updateAcceleration),this.inMotion=!1,this.trigger("PatternAborted"))},updateAcceleration({dt:t}){this.wayPointEasing.tick(t);const e=this.wayPointEasing.value();this.eventQueue=this.eventQueue.filter(t=>!(t.pos<=e)||(((t,e)=>{const i=t.event;i.setState&&e.showState&&e.showState(i.setState[0],i.setState[1]),i.event&&e.trigger(i.event)})(t,this),!1));const i=this.bezierPath.get(e);i&&this.attr({xPath:i.x-this.pathOffset.x,yPath:i.y-this.pathOffset.y}),(e>=this.targetPatternValue||!i)&&(this.unbind("GameLoop",this.updateAcceleration),this.applyStackableProperty("xPath","x"),this.applyStackableProperty("yPath","y"),this.inMotion=!1,this.trigger("PatternCompleted",{patternCompleted:!0}))}}),e.a="WayPointMotion"}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var n=i(4),r=i(12),a=i(43),o=i(18),s=i(139),l=i(140),c=i(141),h=i(50),u=i(26),d=i(8),p=i(1),f=i(3),m=i(11);const y=(t,e)=>t?Object(m.a)(e):e,g=(t,e,i=0)=>{return void 0===e?i:(n=e,Array.isArray(n)&&2===n.length&&n.every(t=>"number"==typeof t)?e[0]+(e[1]-e[0])*t:e);var n},v=(t,e)=>e&&Object.entries(e).reduce((e,[i,n])=>({...e,[i]:g(t,n)}),{});t.c("ScreenBound",{required:"2D",init(){this.bind("GameLoop",this._checkBounds)},_checkBounds(){const e=-t.viewport._x+t.viewport._width/t.viewport._scale+10,i=-t.viewport._x-50,n=-t.viewport._y+t.viewport._height/t.viewport._scale+10,r=-t.viewport._y-50;(this.x>e||i>this.x||r>this.y||this.y>n)&&this.freeze()}});t.c("Bullet",{required:`2D, Motion, WebGL, ${s.a}, ${l.a}, ${h.a}, ${a.a}`,events:{Freeze(){this.cooldowns={},this._parent&&this._parent.detach(this)}},init(){this.cooldowns={}},_targetHit(e,i,n){const r=this.bulletSettings.collisions[n];this.cooldowns[n]=30,e&&e.processDamage&&this.bulletSettings.damage&&t.rectManager.overlap(e,t.viewport.rect())&&e.processDamage(this.bulletSettings.damage),r.state&&this.showState(r.state),(r.spawns||[]).forEach(([t,e])=>{x(this.weaponDefinition,t,e,this,i,this.target)}),!1!==r.remove&&(this.unbind("GameLoop",this._updateBullet),this.bulletTime=0,this.freeze())},_bulletHitOn(t,e){const i=e[0].obj,n=((t,e)=>{let i=null,n=null;if("SAT"===e.type){const[r,a]=Object(m.c)(t,t.w),o=t.bulletSettings.attached?r:-e.overlap;i=t.x+o-e.overlap*e.nx,n=t.y+a+t.h/2-e.overlap*e.ny}else{const r=e.obj,a=t.x<r.x&&t.w+t.x>r.x||void 0!==t.vx&&t.vx>0,o=t.x<r.x+r.w&&t.x+t.w>r.x||void 0!==t.vx&&t.vx<0,s=t.y<r.y&&t.h+t.y>r.y,l=t.y<r.w+r.h&&t.y+t.h>r.y;!a||s||l?!o||s||l?s?(i=t.x+t.w/2,n=r.y):l&&(i=t.x+t.w/2,n=r.y+r.h):(i=r.x+r.w,n=t.y+t.h/2):(i=r.x,n=t.y+t.h/2)}return{x:i,y:n,angle:t.angle}})(this,e[0]);this._targetHit(i,n,t)},bullet(t,e,i){this.weaponDefinition=t,this.bulletSettings={...e},this.bulletSettings.queue=(this.bulletSettings.queue||[]).map(t=>({duration:0,delay:0,...v(this.difficulty,t)})),this.bulletSettings.damage=e.damage&&e.damage.map(t=>v(this.difficulty,t));const n=g(this.difficulty,e.velocity);this.attr({angle:e.angle,velocity:this.bulletSettings.attached?0:n,beamVelocity:this.bulletSettings.attached?n:0,target:i}),this.bulletTime=0,this.maxBulletTime=this.bulletSettings.queue.reduce((t,e)=>t+g(this.difficulty,e.duration),0),this.uniqueBind("GameLoop",this._updateBullet)},_updateBullet({dt:e}){if(this.bulletTime+=e,this.bulletSettings.collisions&&(Object.keys(this.bulletSettings.collisions).forEach(t=>{const i=this.cooldowns[t];void 0!==i&&i>0&&(this.cooldowns[t]=i-e)}),this.bulletSettings.beam)){let e=1/0,i=null,n=null;const r=Object(m.b)(this.angle);Object.keys(this.bulletSettings.collisions).forEach(a=>{const o=t.raycast(this,r,-1,a);o[0]&&o[0].distance<e&&(e=o[0].distance,i=o[0],n=a)}),i?(this.beamBlocked=!0,this.sw=i.distance+6,this._targetHit(i.obj,{x:i.x,y:i.y},n)):(this.beamBlocked=!1,this.sw=this.beamLength)}const i=this.bulletSettings.queue[0];if(i){i.delay=(i.delay||0)-e;const n=0===i.duration?1:(i.duration-(i.duration+i.delay))/i.duration;if(i.delay<=0&&0===i.duration&&(void 0!==i.velocity&&(this.bulletSettings.attached?this.attr({beamVelocity:i.velocity}):this.attr({velocity:i.velocity})),void 0!==i.angle&&this.attr({angle:y(this.xFlipped,i.angle)}),void 0!==i.cleanOutOfScreen&&this.addComponent("ScreenBound"),void 0!==i.collide&&(this._targetHit(void 0,{x:this.ox,y:this.oy},i.collide),i.collide=void 0),void 0!==i.steering&&this.addComponent(c.a).attr({steering:i.steering,sight:i.sight}),void 0!==i.aimOnTarget)){const e=t(this.target);if(e.length>0){const i=t(e[Math.floor(Math.random()*e.length)]),n={x:i.x+i.w/2,y:i.y+i.h/2},r={x:this.x-n.x,y:this.y-n.y},a=Math.atan2(r.y,r.x)/Math.PI*180;this.attr({angle:a,rotation:a})}}if(i.duration>0){if(i.audio){const[t,e]=[].concat(i.audio);f.a.playAudio(t,e),i.audio=null}if(void 0!==i.frame&&(this.displayFrame(i.frame,i.duration),i.frame=null),!i.animateFn&&void 0!==i.velocity){const t=Object(d.b)(this,this.bulletSettings.attached?{beamVelocity:i.velocity}:{velocity:i.velocity}),e=p.e[i.easing||"linear"];i.animateFn=i=>t(e(i))}i.animateFn&&i.animateFn(n)}n>=1&&this.bulletSettings.queue.shift()}this.bulletTime>this.maxBulletTime&&0===this.bulletSettings.queue.length&&(this.unbind("GameLoop",this._updateBullet),this._parent&&this._parent.detach(this),this.bulletTime=0,this.freeze())}});let _=[];t.bind("SceneDestroy",()=>_=[]);const x=(e,i,a,s,l,c)=>{const h=e.spawnables[i];if(!h)throw new Error(`Spawn ${i} not defined`);((t,e,i,n,r)=>{const a={...t,...e};if(a.angleRange)for(let t=g(n,a.angleRange.from);t<=g(n,a.angleRange.to);t+=g(n,a.angleRange.step)){const e=i.angle+t;r({...a,angle:e})}else{const t=(i.angle||0)+({...a,...e}.angle||0);r({...a,angle:t})}})(h,a,l,s.difficulty,a=>{const d=(e=>{const i=_.find(t=>t.__frozen&&t.bulletDefinition===e);if(i)return e.entity&&i.showState("default"),i.unfreeze(),i.attr({x:3e3,y:3e3,angle:0,rotation:0}),i;const a=t.e("Bullet").attr({x:3e3,y:3e3,angle:0,rotation:0});if(a.bulletDefinition=e,e.sprite&&a.addComponent(e.sprite),e.composition){const t=Object(n.b)(e.composition);a.addComponent(o.a).compose(t)}if(e.particles){const t=Object(n.d)(e.particles);a.addComponent(r.a).particles(t)}if(e.entity&&a.addComponent(u.a).applyDefinition(e.entity),!e.beam){const t=Object.keys(e.collisions||{});t.length>0&&(a.has("Collision")||a.addComponent("Collision"),t.forEach(t=>{a.onHit(t,e=>a._bulletHitOn(t,e))}))}return _=_.concat(a),a})(h),p=!1!==a.autoRotate,f=y(s.xFlipped,a.angle||0),m=p?f:0,g=y(s.xFlipped,m);if(d.attr({itemName:i,difficulty:s.difficulty,x:l.x-d.w/2,y:l.y-d.h/2,z:s.z,autoRotate:p,angle:f,steering:0,rotation:g}),"object"==typeof a.spawnPosition){const{w:t=0,h:e=0}=a.spawnBox||{},i=-t/2+Math.random()*t,n=-e/2+Math.random()*e;d.attr({x:l.x-d._origin.x+i,y:l.y-d._origin.y+n})}h.attached&&s.attach(d),h.emitDamage&&h.emitDamage.forEach(e=>{const i={...v(s.difficulty,e),origin:{...l}},n=s.sourceEntity&&s.sourceEntity[0];e.targets.reduce((e,i)=>e.concat(Array.from(t(i))),[]).filter((t,e,i)=>i.indexOf(t)===e&&t!==n).forEach(e=>{const n=t(e);n.processDamage&&n.processDamage(i)})}),d.bullet(e,a,c)})};t.c("Weapon",{init(){this.xFlipped=!1,this.spawnQueue=[],this.burstsFired=0},weapon(t){return this.definition=t,this.active=!1,this.aimingEnabled=!0,this},flip(t){"X"===t&&(this.xFlipped=!this.xFlipped,void 0!==this.definition.angle&&(this.definition.angle=Object(m.a)(this.definition.angle||0)))},unflip(t){"X"===t&&(this.xFlipped=!this.xFlipped,void 0!==this.definition.angle&&(this.definition.angle=Object(m.a)(this.definition.angle||0)))},async activate(t){if(!this.definition.pattern)return;this.active=!0,this.burstsFired=0,this.activatedAt=1*new Date;const e=this.definition.pattern.spawnRhythm;return this.maxBursts=t||e.maxBursts||1/0,this.initialDelay=g(this.difficulty,e.initialDelay),this._makeQueue(),this.uniqueBind("GameLoop",this._updateSpawnFrame),new Promise(t=>{this.one("WeaponFireComplete",()=>t(this))})},_makeQueue(){const t=this.definition.pattern.spawnRhythm;this.shotQueue=(t.shot||[{spawn:!0,duration:0}]).map(t=>({...t,duration:g(this.difficulty,t.duration||0)})),this.shotQueueLength=this.shotQueue.reduce((t,e)=>t+e.duration,0)},async deactivate(){return this.active=!1,this.unbind("GameLoop",this._updateSpawnFrame),this.trigger("WeaponFireComplete"),this},_weaponSpawn(t,e=0){t.spawns.forEach(([t,i])=>{x(this.definition.pattern,t,i,this,{x:this.x+(this.definition.x||0),y:this.y+(this.definition.y||0),angle:this.definition.angle+e},this.definition.target)})},_aimBarrel({dt:e}){const i=this.definition.pattern.aiming;let n=0;if(i&&this.barrel){if(!this.aimingEnabled)return this.barrel.rotation;const r=t(this.definition.target);if(r.length>0){const a=t(r[Math.floor(Math.random()*r.length)]),o={x:a.x+a.w/2,y:a.y+a.h/2},s={x:this.barrel.ox-o.x,y:this.barrel.oy-o.y},l=Math.atan2(s.y,s.x);if(this.barrel.root.xFlipped){const r=l/Math.PI*180-180,a=Object(m.a)(t.math.clamp(Object(m.a)(r<0?r+180:r),i.range[1],i.range[0])),o=(a<0?a+360:a)-180,s=.001*i.rotateSpeed*e,c=t.math.clamp(o-this.barrel.rotation,-s,s),h=this.barrel.rotation+c;n=h+(i.offsetAimAngle||0),this.barrel.attr({rotation:h})}else{const r=l/Math.PI*180,a=t.math.clamp(r,i.range[1],i.range[0]),o=.001*i.rotateSpeed*e,s=t.math.clamp(a-this.barrel.rotation,-o,o),c=this.barrel.rotation+s;n=c-(i.offsetAimAngle||0),this.barrel.attr({rotation:c})}}}return n},_updateSpawnFrame({dt:t}){const e=this.definition.pattern.spawnRhythm,i=this._aimBarrel({dt:t});if(this.initialDelay>0){if(this.initialDelay-=t,!(this.initialDelay<=0))return;this.shotIndex=0,this.shotDelay=0}if(this.shotDelay<=0){const n=0-this.shotDelay,r=this.mainEntity,a=this.shotQueue[0];if(a){a.delay=(a.delay||0)-t;const n=0===a.duration?1:(a.duration-(a.duration+a.delay))/a.duration;a.state&&r&&(r.showState(a.state,a.duration),a.state=void 0),!0===a.stopAiming&&(this.aimingEnabled=!1,a.stopAiming=void 0),a.audio&&(f.a.playAudio(a.audio),a.audio=void 0),!1===a.stopAiming&&(this.aimingEnabled=!0,a.stopAiming=void 0),a.spawn&&(this._weaponSpawn(e,i),a.spawn=!1),n>=1&&this.shotQueue.shift()}if(n>this.shotQueueLength&&0===this.shotQueue.length){if(this.shotIndex++,this.shotIndex>=g(this.difficulty,e.burst)){const t=g(this.difficulty,e.burstDelay);return this.burstsFired+=1,this.initialDelay=t+g(this.difficulty,e.shotDelay),void(g(this.difficulty,this.maxBursts)<=this.burstsFired?this.deactivate():this._makeQueue())}this.shotDelay=g(this.difficulty,e.shotDelay),this.shotDelay>0&&this._makeQueue()}}this.shotDelay-=t}}),e.a="Weapon"}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){i.d(e,"a",(function(){return r})),i.d(e,"b",(function(){return a}));var n=i(1);const r=({existing:e=!1}={})=>async({spawn:i,showState:n,moveWithPattern:r})=>{const a=e&&t("IntroHeliBackground").get(0)||i("IntroHeliBackground",{location:{rx:-.3,ry:.3},z:-300,defaultVelocity:70});n(a,"flying");const o=r(a,"intro.HeliBackground");await o.process},a=({existing:e=!1}={},i)=>async({spawn:r,showState:a,allowDamage:o,moveWithPattern:s,waitForEvent:l,moveTo:c,wait:h})=>{const u=e&&t("IntroHeliBackground").get(0)||r("IntroHeliBackground",{location:{rx:-.3,ry:.3},z:-300,defaultVelocity:70});let d;a(u,"flying"),l(u,"Dead",async()=>{a(u,"shot");const t=s(u,"intro.HeliBackgroundCrash",150,n.a);d=t.process}),l(u,"Escape1",async()=>{const t=r("IntroParachute",{x:u.x+10,y:u.y,z:-290,defaultVelocity:20}),e=c(t,{y:.6,x:.2},null,n.b);await e.process,t.destroy()}),l(u,"Escape2",async()=>{const t=r("IntroParachute",{x:u.x+10,y:u.y,z:-290,defaultVelocity:20}),e=c(t,{y:.6,x:.2},null,n.b);await e.process,t.destroy()}),l(u,"Escape3",async()=>{i.setVolume(0,4e3),await h(4e3),i.stop()});const p=e&&t("LargeBackgroundDrone").get(0)||r("LargeBackgroundDrone",{location:{rx:1.1,ry:.3},z:-280,defaultVelocity:200});a(p,"eyeMove"),await o(u,{health:10});const f=s(p,"intro.DroneBackground");await f.process,await h(100),await d,u.destroy(),p.destroy()}}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var n=i(10),r=i(21);t.c("PlayerAssignable",{init(){this._attachControllerAssignTrigger(),this.preferredPlayer=null},_assignControls(){const t=this._preferredplayer()||this._firstUnassignedPlayer();null!=t?(this.preferredPlayer=t.getId(),this.setupControls(t),t.one("Deactivated",()=>{this._attachControllerAssignTrigger()})):this._attachControllerAssignTrigger()},_attachControllerAssignTrigger(){this.one("Fire",this._assignControls)},_preferredplayer(){if(null!==this.preferredPlayer){const e=t(this.preferredPlayer);if(!e.has(n.a))return e}},_firstUnassignedPlayer(){const e=t(r.a);return Array.from(e).map(e=>t(e)).find(t=>!t.has(n.a))}}),e.a="PlayerAssignable"}).call(this,i(0).default)},function(t,e,i){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i=function(t,e){var i=t[1]||"",n=t[3];if(!n)return i;if(e&&"function"==typeof btoa){var r=(o=n,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */"),a=n.sources.map((function(t){return"/*# sourceURL="+n.sourceRoot+t+" */"}));return[i].concat(a).concat([r]).join("\n")}var o;return[i].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+i+"}":i})).join("")},e.i=function(t,i){"string"==typeof t&&(t=[[null,t,""]]);for(var n={},r=0;r<this.length;r++){var a=this[r][0];null!=a&&(n[a]=!0)}for(r=0;r<t.length;r++){var o=t[r];null!=o[0]&&n[o[0]]||(i&&!o[2]?o[2]=i:i&&(o[2]="("+o[2]+") and ("+i+")"),e.push(o))}},e}},function(t,e,i){var n,r,a={},o=(n=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===r&&(r=n.apply(this,arguments)),r}),s=function(t,e){return e?e.querySelector(t):document.querySelector(t)},l=function(t){var e={};return function(t,i){if("function"==typeof t)return t();if(void 0===e[t]){var n=s.call(this,t,i);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}}(),c=null,h=0,u=[],d=i(179);function p(t,e){for(var i=0;i<t.length;i++){var n=t[i],r=a[n.id];if(r){r.refs++;for(var o=0;o<r.parts.length;o++)r.parts[o](n.parts[o]);for(;o<n.parts.length;o++)r.parts.push(_(n.parts[o],e))}else{var s=[];for(o=0;o<n.parts.length;o++)s.push(_(n.parts[o],e));a[n.id]={id:n.id,refs:1,parts:s}}}}function f(t,e){for(var i=[],n={},r=0;r<t.length;r++){var a=t[r],o=e.base?a[0]+e.base:a[0],s={css:a[1],media:a[2],sourceMap:a[3]};n[o]?n[o].parts.push(s):i.push(n[o]={id:o,parts:[s]})}return i}function m(t,e){var i=l(t.insertInto);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=u[u.length-1];if("top"===t.insertAt)n?n.nextSibling?i.insertBefore(e,n.nextSibling):i.appendChild(e):i.insertBefore(e,i.firstChild),u.push(e);else if("bottom"===t.insertAt)i.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var r=l(t.insertAt.before,i);i.insertBefore(e,r)}}function y(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=u.indexOf(t);e>=0&&u.splice(e,1)}function g(t){var e=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var n=function(){0;return i.nc}();n&&(t.attrs.nonce=n)}return v(e,t.attrs),m(t,e),e}function v(t,e){Object.keys(e).forEach((function(i){t.setAttribute(i,e[i])}))}function _(t,e){var i,n,r,a;if(e.transform&&t.css){if(!(a="function"==typeof e.transform?e.transform(t.css):e.transform.default(t.css)))return function(){};t.css=a}if(e.singleton){var o=h++;i=c||(c=g(e)),n=w.bind(null,i,o,!1),r=w.bind(null,i,o,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",v(e,t.attrs),m(t,e),e}(e),n=k.bind(null,i,e),r=function(){y(i),i.href&&URL.revokeObjectURL(i.href)}):(i=g(e),n=C.bind(null,i),r=function(){y(i)});return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else r()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=o()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var i=f(t,e);return p(i,e),function(t){for(var n=[],r=0;r<i.length;r++){var o=i[r];(s=a[o.id]).refs--,n.push(s)}t&&p(f(t,e),e);for(r=0;r<n.length;r++){var s;if(0===(s=n[r]).refs){for(var l=0;l<s.parts.length;l++)s.parts[l]();delete a[s.id]}}}};var x,b=(x=[],function(t,e){return x[t]=e,x.filter(Boolean).join("\n")});function w(t,e,i,n){var r=i?"":n.css;if(t.styleSheet)t.styleSheet.cssText=b(e,r);else{var a=document.createTextNode(r),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(a,o[e]):t.appendChild(a)}}function C(t,e){var i=e.css,n=e.media;if(n&&t.setAttribute("media",n),t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}function k(t,e,i){var n=i.css,r=i.sourceMap,a=void 0===e.convertToAbsoluteUrls&&r;(e.convertToAbsoluteUrls||a)&&(n=d(n)),r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var o=new Blob([n],{type:"text/css"}),s=t.href;t.href=URL.createObjectURL(o),s&&URL.revokeObjectURL(s)}},function(t,e,i){(function(e){var i="object"==typeof e&&e&&e.Object===Object&&e;t.exports=i}).call(this,i(203))},function(t,e){var i=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return i.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},function(t,e,i){var n=i(77),r=i(48);t.exports=function(t,e,i){(void 0!==i&&!r(t[e],i)||void 0===i&&!(e in t))&&n(t,e,i)}},function(t,e,i){var n=i(32),r=function(){try{var t=n(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=r},function(t,e,i){var n=i(221)();t.exports=n},function(t,e,i){(function(t){var n=i(23),r=e&&!e.nodeType&&e,a=r&&"object"==typeof t&&t&&!t.nodeType&&t,o=a&&a.exports===r?n.Buffer:void 0,s=o?o.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var i=t.length,n=s?s(i):new t.constructor(i);return t.copy(n),n}}).call(this,i(78)(t))},function(t,e,i){var n=i(79);t.exports=function(t,e){var i=e?n(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}},function(t,e,i){var n=i(23).Uint8Array;t.exports=n},function(t,e,i){var n=i(223),r=i(81),a=i(82);t.exports=function(t){return"function"!=typeof t.constructor||a(t)?{}:n(r(t))}},function(t,e){t.exports=function(t,e){return function(i){return t(e(i))}}},function(t,e){t.exports=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}},function(t,e,i){var n=i(77),r=i(48),a=Object.prototype.hasOwnProperty;t.exports=function(t,e,i){var o=t[e];a.call(t,e)&&r(o,i)&&(void 0!==i||e in t)||n(t,e,i)}},function(t,e,i){var n=i(230),r=i(59),a=i(16),o=i(60),s=i(86),l=i(84),c=Object.prototype.hasOwnProperty;t.exports=function(t,e){var i=a(t),h=!i&&r(t),u=!i&&!h&&o(t),d=!i&&!h&&!u&&l(t),p=i||h||u||d,f=p?n(t.length,String):[],m=f.length;for(var y in t)!e&&!c.call(t,y)||p&&("length"==y||u&&("offset"==y||"parent"==y)||d&&("buffer"==y||"byteLength"==y||"byteOffset"==y)||s(y,m))||f.push(y);return f}},function(t,e,i){var n=i(63),r=i(234),a=i(236);t.exports=function(t,e){return a(r(t,e,n),t+"")}},function(t,e,i){var n=i(48),r=i(38),a=i(86),o=i(14);t.exports=function(t,e,i){if(!o(i))return!1;var s=typeof e;return!!("number"==s?r(i)&&a(e,i.length):"string"==s&&e in i)&&n(i[e],t)}},function(t,e,i){var n=i(251);t.exports=function(t,e){var i=-1,r=t.length,a=r-1;for(e=void 0===e?r:e;++i<e;){var o=n(i,a),s=t[o];t[o]=t[i],t[i]=s}return t.length=e,t}},function(t,e,i){!function(){"use strict";var e=Math.abs,n=Math.min,r=Math.max,a=Math.cos,o=Math.sin,s=Math.acos,l=Math.sqrt,c=Math.PI,h={x:0,y:0,z:0},u=i(117),d=i(257),p=function(t){var i=t&&t.forEach?t:[].slice.call(arguments),n=!1;if("object"==typeof i[0]){n=i.length;var r=[];i.forEach((function(t){["x","y","z"].forEach((function(e){void 0!==t[e]&&r.push(t[e])}))})),i=r}var a=!1,o=i.length;if(n){if(n>4){if(1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");a=!0}}else if(6!==o&&8!==o&&9!==o&&12!==o&&1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");var s=!a&&(9===o||12===o)||t&&t[0]&&void 0!==t[0].z;this._3d=s;for(var l=[],c=0,h=s?3:2;c<o;c+=h){var d={x:i[c],y:i[c+1]};s&&(d.z=i[c+2]),l.push(d)}this.order=l.length-1,this.points=l;var p=["x","y"];s&&p.push("z"),this.dims=p,this.dimlen=p.length,function(t){for(var i=t.order,n=t.points,r=u.align(n,{p1:n[0],p2:n[i]}),a=0;a<r.length;a++)if(e(r[a].y)>1e-4)return void(t._linear=!1);t._linear=!0}(this),this._t1=0,this._t2=1,this.update()},f=i(258);function m(t,e,i,n,r){void 0===r&&(r=.5);var a=u.projectionratio(r,t),o=1-a,s={x:a*e.x+o*n.x,y:a*e.y+o*n.y},l=u.abcratio(r,t);return{A:{x:i.x+(i.x-s.x)/l,y:i.y+(i.y-s.y)/l},B:i,C:s}}p.SVGtoBeziers=function(t){return f(p,t)},p.quadraticFromPoints=function(t,e,i,n){if(void 0===n&&(n=.5),0===n)return new p(e,e,i);if(1===n)return new p(t,e,e);var r=m(2,t,e,i,n);return new p(t,r.A,i)},p.cubicFromPoints=function(t,e,i,n,r){void 0===n&&(n=.5);var a=m(3,t,e,i,n);void 0===r&&(r=u.dist(e,a.C));var o=r*(1-n)/n,s=u.dist(t,i),l=(i.x-t.x)/s,c=(i.y-t.y)/s,h=r*l,d=r*c,f=o*l,y=o*c,g=e.x-h,v=e.y-d,_=e.x+f,x=e.y+y,b=a.A,w=b.x+(g-b.x)/(1-n),C=b.y+(v-b.y)/(1-n),k=b.x+(_-b.x)/n,S=b.y+(x-b.y)/n,D={x:t.x+(w-t.x)/n,y:t.y+(C-t.y)/n},z={x:i.x+(k-i.x)/(1-n),y:i.y+(S-i.y)/(1-n)};return new p(t,D,z,i)};var y=function(){return u};p.getUtils=y,p.PolyBezier=d,p.prototype={getUtils:y,valueOf:function(){return this.toString()},toString:function(){return u.pointsToString(this.points)},toSVG:function(t){if(this._3d)return!1;for(var e=this.points,i=["M",e[0].x,e[0].y,2===this.order?"Q":"C"],n=1,r=e.length;n<r;n++)i.push(e[n].x),i.push(e[n].y);return i.join(" ")},setRatios:function(t){if(t.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=t,this._lut=[]},verify:function(){var t=this.coordDigest();t!==this._print&&(this._print=t,this.update())},coordDigest:function(){return this.points.map((function(t,e){return""+e+t.x+t.y+(t.z?t.z:0)})).join("")},update:function(t){this._lut=[],this.dpoints=u.derive(this.points,this._3d),this.computedirection()},computedirection:function(){var t=this.points,e=u.angle(t[0],t[this.order],t[1]);this.clockwise=e>0},length:function(){return u.length(this.derivative.bind(this))},_lut:[],getLUT:function(t){if(this.verify(),t=t||100,this._lut.length===t)return this._lut;this._lut=[],t--;for(var e=0;e<=t;e++)this._lut.push(this.compute(e/t));return this._lut},on:function(t,e){e=e||5;for(var i,n=this.getLUT(),r=[],a=0,o=0;o<n.length;o++)i=n[o],u.dist(i,t)<e&&(r.push(i),a+=o/n.length);return!!r.length&&a/r.length},project:function(t){var e,i,n,r,a=this.getLUT(),o=a.length-1,s=u.closest(a,t),l=s.mdist,c=s.mpos,h=(c+1)/o,d=.1/o;for(l+=1,e=i=(c-1)/o;i<h+d;i+=d)n=this.compute(i),(r=u.dist(t,n))<l&&(l=r,e=i);return(n=this.compute(e)).t=e,n.d=l,n},get:function(t){return this.compute(t)},point:function(t){return this.points[t]},compute:function(t){return this.ratios?u.computeWithRatios(t,this.points,this.ratios,this._3d):u.compute(t,this.points,this._3d,this.ratios)},raise:function(){for(var t,e,i=this.points,n=[i[0]],r=i.length,a=1;a<r;a++)t=i[a],e=i[a-1],n[a]={x:(r-a)/r*t.x+a/r*e.x,y:(r-a)/r*t.y+a/r*e.y};return n[r]=i[r-1],new p(n)},derivative:function(t){var e,i,n=1-t,r=0,a=this.dpoints[0];2===this.order&&(a=[a[0],a[1],h],e=n,i=t),3===this.order&&(e=n*n,i=n*t*2,r=t*t);var o={x:e*a[0].x+i*a[1].x+r*a[2].x,y:e*a[0].y+i*a[1].y+r*a[2].y};return this._3d&&(o.z=e*a[0].z+i*a[1].z+r*a[2].z),o},curvature:function(t){return u.curvature(t,this.points,this._3d)},inflections:function(){return u.inflections(this.points)},normal:function(t){return this._3d?this.__normal3(t):this.__normal2(t)},__normal2:function(t){var e=this.derivative(t),i=l(e.x*e.x+e.y*e.y);return{x:-e.y/i,y:e.x/i}},__normal3:function(t){var e=this.derivative(t),i=this.derivative(t+.01),n=l(e.x*e.x+e.y*e.y+e.z*e.z),r=l(i.x*i.x+i.y*i.y+i.z*i.z);e.x/=n,e.y/=n,e.z/=n,i.x/=r,i.y/=r,i.z/=r;var a={x:i.y*e.z-i.z*e.y,y:i.z*e.x-i.x*e.z,z:i.x*e.y-i.y*e.x},o=l(a.x*a.x+a.y*a.y+a.z*a.z);a.x/=o,a.y/=o,a.z/=o;var s=[a.x*a.x,a.x*a.y-a.z,a.x*a.z+a.y,a.x*a.y+a.z,a.y*a.y,a.y*a.z-a.x,a.x*a.z-a.y,a.y*a.z+a.x,a.z*a.z];return{x:s[0]*e.x+s[1]*e.y+s[2]*e.z,y:s[3]*e.x+s[4]*e.y+s[5]*e.z,z:s[6]*e.x+s[7]*e.y+s[8]*e.z}},hull:function(t){var e,i=this.points,n=[],r=[],a=0,o=0,s=0;for(r[a++]=i[0],r[a++]=i[1],r[a++]=i[2],3===this.order&&(r[a++]=i[3]);i.length>1;){for(n=[],o=0,s=i.length-1;o<s;o++)e=u.lerp(t,i[o],i[o+1]),r[a++]=e,n.push(e);i=n}return r},split:function(t,e){if(0===t&&e)return this.split(e).left;if(1===e)return this.split(t).right;var i=this.hull(t),n={left:2===this.order?new p([i[0],i[3],i[5]]):new p([i[0],i[4],i[7],i[9]]),right:2===this.order?new p([i[5],i[4],i[2]]):new p([i[9],i[8],i[6],i[3]]),span:i};return n.left._t1=u.map(0,0,1,this._t1,this._t2),n.left._t2=u.map(t,0,1,this._t1,this._t2),n.right._t1=u.map(t,0,1,this._t1,this._t2),n.right._t2=u.map(1,0,1,this._t1,this._t2),e?(e=u.map(e,t,1,0,1),n.right.split(e).left):n},extrema:function(){var t,e,i=this.dims,n={},r=[];return i.forEach(function(i){e=function(t){return t[i]},t=this.dpoints[0].map(e),n[i]=u.droots(t),3===this.order&&(t=this.dpoints[1].map(e),n[i]=n[i].concat(u.droots(t))),n[i]=n[i].filter((function(t){return t>=0&&t<=1})),r=r.concat(n[i].sort(u.numberSort))}.bind(this)),r=r.sort(u.numberSort).filter((function(t,e){return r.indexOf(t)===e})),n.values=r,n},bbox:function(){var t=this.extrema(),e={};return this.dims.forEach(function(i){e[i]=u.getminmax(this,i,t[i])}.bind(this)),e},overlaps:function(t){var e=this.bbox(),i=t.bbox();return u.bboxoverlap(e,i)},offset:function(t,e){if(void 0!==e){var i=this.get(t),n=this.normal(t),r={c:i,n:n,x:i.x+n.x*e,y:i.y+n.y*e};return this._3d&&(r.z=i.z+n.z*e),r}if(this._linear){var a=this.normal(0),o=this.points.map((function(e){var i={x:e.x+t*a.x,y:e.y+t*a.y};return e.z&&n.z&&(i.z=e.z+t*a.z),i}));return[new p(o)]}return this.reduce().map((function(e){return e._linear?e.offset(t)[0]:e.scale(t)}))},simple:function(){if(3===this.order){var t=u.angle(this.points[0],this.points[3],this.points[1]),i=u.angle(this.points[0],this.points[3],this.points[2]);if(t>0&&i<0||t<0&&i>0)return!1}var n=this.normal(0),r=this.normal(1),a=n.x*r.x+n.y*r.y;return this._3d&&(a+=n.z*r.z),e(s(a))<c/3},reduce:function(){var t,i,n=0,r=0,a=[],o=[],s=this.extrema().values;for(-1===s.indexOf(0)&&(s=[0].concat(s)),-1===s.indexOf(1)&&s.push(1),n=s[0],t=1;t<s.length;t++)r=s[t],(i=this.split(n,r))._t1=n,i._t2=r,a.push(i),n=r;return a.forEach((function(t){for(n=0,r=0;r<=1;)for(r=n+.01;r<=1.01;r+=.01)if(!(i=t.split(n,r)).simple()){if(e(n-(r-=.01))<.01)return[];(i=t.split(n,r))._t1=u.map(n,0,1,t._t1,t._t2),i._t2=u.map(r,0,1,t._t1,t._t2),o.push(i),n=r;break}n<1&&((i=t.split(n,1))._t1=u.map(n,0,1,t._t1,t._t2),i._t2=t._t2,o.push(i))})),o},scale:function(t){var e=this.order,i=!1;if("function"==typeof t&&(i=t),i&&2===e)return this.raise().scale(i);var n=this.clockwise,r=i?i(0):t,a=i?i(1):t,o=[this.offset(0,10),this.offset(1,10)],s=u.lli4(o[0],o[0].c,o[1],o[1].c);if(!s)throw new Error("cannot scale this curve. Try reducing it first.");var c=this.points,h=[];return[0,1].forEach(function(t){var i=h[t*e]=u.copy(c[t*e]);i.x+=(t?a:r)*o[t].n.x,i.y+=(t?a:r)*o[t].n.y}.bind(this)),i?([0,1].forEach(function(r){if(2!==this.order||!r){var a=c[r+1],o={x:a.x-s.x,y:a.y-s.y},u=i?i((r+1)/e):t;i&&!n&&(u=-u);var d=l(o.x*o.x+o.y*o.y);o.x/=d,o.y/=d,h[r+1]={x:a.x+u*o.x,y:a.y+u*o.y}}}.bind(this)),new p(h)):([0,1].forEach(function(t){if(2!==this.order||!t){var i=h[t*e],n=this.derivative(t),r={x:i.x+n.x,y:i.y+n.y};h[t+1]=u.lli4(i,r,s,c[t+1])}}.bind(this)),new p(h))},outline:function(t,e,i,n){e=void 0===e?t:e;var r,a=this.reduce(),o=a.length,s=[],l=[],c=0,h=this.length(),p=void 0!==i&&void 0!==n;function f(t,e,i,n,r){return function(a){var o=n/i,s=(n+r)/i,l=e-t;return u.map(a,0,1,t+o*l,t+s*l)}}a.forEach((function(r){w=r.length(),p?(s.push(r.scale(f(t,i,h,c,w))),l.push(r.scale(f(-e,-n,h,c,w)))):(s.push(r.scale(t)),l.push(r.scale(-e))),c+=w})),l=l.map((function(t){return(r=t.points)[3]?t.points=[r[3],r[2],r[1],r[0]]:t.points=[r[2],r[1],r[0]],t})).reverse();var m=s[0].points[0],y=s[o-1].points[s[o-1].points.length-1],g=l[o-1].points[l[o-1].points.length-1],v=l[0].points[0],_=u.makeline(g,m),x=u.makeline(y,v),b=[_].concat(s).concat([x]).concat(l),w=b.length;return new d(b)},outlineshapes:function(t,e,i){e=e||t;for(var n=this.outline(t,e).curves,r=[],a=1,o=n.length;a<o/2;a++){var s=u.makeshape(n[a],n[o-a],i);s.startcap.virtual=a>1,s.endcap.virtual=a<o/2-1,r.push(s)}return r},intersects:function(t,e){return t?t.p1&&t.p2?this.lineIntersects(t):(t instanceof p&&(t=t.reduce()),this.curveintersects(this.reduce(),t,e)):this.selfintersects(e)},lineIntersects:function(t){var e=n(t.p1.x,t.p2.x),i=n(t.p1.y,t.p2.y),a=r(t.p1.x,t.p2.x),o=r(t.p1.y,t.p2.y),s=this;return u.roots(this.points,t).filter((function(t){var n=s.get(t);return u.between(n.x,e,a)&&u.between(n.y,i,o)}))},selfintersects:function(t){var e,i,n,r,a=this.reduce(),o=a.length-2,s=[];for(e=0;e<o;e++)n=a.slice(e,e+1),r=a.slice(e+2),i=this.curveintersects(n,r,t),s=s.concat(i);return s},curveintersects:function(t,e,i){var n=[];t.forEach((function(t){e.forEach((function(e){t.overlaps(e)&&n.push({left:t,right:e})}))}));var r=[];return n.forEach((function(t){var e=u.pairiteration(t.left,t.right,i);e.length>0&&(r=r.concat(e))})),r},arcs:function(t){t=t||.5;return this._iterate(t,[])},_error:function(t,i,n,r){var a=(r-n)/4,o=this.get(n+a),s=this.get(r-a),l=u.dist(t,i),c=u.dist(t,o),h=u.dist(t,s);return e(c-l)+e(h-l)},_iterate:function(t,e){var i,n=0,r=1;do{i=0,r=1;var s,l,c,h,d,p=this.get(n),f=!1,m=!1,y=r,g=1;do{if(m=f,h=c,y=(n+r)/2,s=this.get(y),l=this.get(r),(c=u.getccenter(p,s,l)).interval={start:n,end:r},f=this._error(c,p,n,r)<=t,(d=m&&!f)||(g=r),f){if(r>=1){if(c.interval.end=g=1,h=c,r>1){var v={x:c.x+c.r*a(c.e),y:c.y+c.r*o(c.e)};c.e+=u.angle({x:c.x,y:c.y},v,this.get(1))}break}r+=(r-n)/2}else r=y}while(!d&&i++<100);if(i>=100)break;h=h||c,e.push(h),n=g}while(r<1);return e}},t.exports=p}()},function(t,e,i){!function(){"use strict";var e=Math.abs,n=Math.cos,r=Math.sin,a=Math.acos,o=Math.atan2,s=Math.sqrt,l=Math.pow,c=function(t){return t<0?-l(-t,1/3):l(t,1/3)},h=Math.PI,u=2*h,d=h/2,p=Number.MAX_SAFE_INTEGER||9007199254740991,f=Number.MIN_SAFE_INTEGER||-9007199254740991,m={x:0,y:0,z:0},y={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(t,e){var i=e(t),n=i.x*i.x+i.y*i.y;return void 0!==i.z&&(n+=i.z*i.z),s(n)},compute:function(t,e,i){if(0===t)return e[0];var n=e.length-1;if(1===t)return e[n];var r=e,a=1-t;if(0===n)return e[0];if(1===n)return d={x:a*r[0].x+t*r[1].x,y:a*r[0].y+t*r[1].y},i&&(d.z=a*r[0].z+t*r[1].z),d;if(n<4){var o,s,l,c=a*a,h=t*t,u=0;2===n?(r=[r[0],r[1],r[2],m],o=c,s=a*t*2,l=h):3===n&&(o=c*a,s=c*t*3,l=a*h*3,u=t*h);var d={x:o*r[0].x+s*r[1].x+l*r[2].x+u*r[3].x,y:o*r[0].y+s*r[1].y+l*r[2].y+u*r[3].y};return i&&(d.z=o*r[0].z+s*r[1].z+l*r[2].z+u*r[3].z),d}for(var p=JSON.parse(JSON.stringify(e));p.length>1;){for(var f=0;f<p.length-1;f++)p[f]={x:p[f].x+(p[f+1].x-p[f].x)*t,y:p[f].y+(p[f+1].y-p[f].y)*t},void 0!==p[f].z&&(p[f]=p[f].z+(p[f+1].z-p[f].z)*t);p.splice(p.length-1,1)}return p[0]},computeWithRatios:function(t,e,i,n){var r,a=1-t,o=i,s=e,l=o[0],c=o[1],h=o[2],u=o[3];return l*=a,c*=t,2===s.length?(r=l+c,{x:(l*s[0].x+c*s[1].x)/r,y:(l*s[0].y+c*s[1].y)/r,z:!!n&&(l*s[0].z+c*s[1].z)/r}):(l*=a,c*=2*a,h*=t*t,3===s.length?(r=l+c+h,{x:(l*s[0].x+c*s[1].x+h*s[2].x)/r,y:(l*s[0].y+c*s[1].y+h*s[2].y)/r,z:!!n&&(l*s[0].z+c*s[1].z+h*s[2].z)/r}):(l*=a,c*=1.5*a,h*=3*a,u*=t*t*t,4===s.length?(r=l+c+h+u,{x:(l*s[0].x+c*s[1].x+h*s[2].x+u*s[3].x)/r,y:(l*s[0].y+c*s[1].y+h*s[2].y+u*s[3].y)/r,z:!!n&&(l*s[0].z+c*s[1].z+h*s[2].z+u*s[3].z)/r}):void 0))},derive:function(t,e){for(var i=[],n=t,r=n.length,a=r-1;r>1;r--,a--){for(var o,s=[],l=0;l<a;l++)o={x:a*(n[l+1].x-n[l].x),y:a*(n[l+1].y-n[l].y)},e&&(o.z=a*(n[l+1].z-n[l].z)),s.push(o);i.push(s),n=s}return i},between:function(t,e,i){return e<=t&&t<=i||y.approximately(t,e)||y.approximately(t,i)},approximately:function(t,i,n){return e(t-i)<=(n||1e-6)},length:function(t){var e,i,n=0,r=y.Tvalues.length;for(e=0;e<r;e++)i=.5*y.Tvalues[e]+.5,n+=y.Cvalues[e]*y.arcfn(i,t);return.5*n},map:function(t,e,i,n,r){return n+(r-n)*((t-e)/(i-e))},lerp:function(t,e,i){var n={x:e.x+t*(i.x-e.x),y:e.y+t*(i.y-e.y)};return e.z&&i.z&&(n.z=e.z+t*(i.z-e.z)),n},pointToString:function(t){var e=t.x+"/"+t.y;return void 0!==t.z&&(e+="/"+t.z),e},pointsToString:function(t){return"["+t.map(y.pointToString).join(", ")+"]"},copy:function(t){return JSON.parse(JSON.stringify(t))},angle:function(t,e,i){var n=e.x-t.x,r=e.y-t.y,a=i.x-t.x,s=i.y-t.y;return o(n*s-r*a,n*a+r*s)},round:function(t,e){var i=""+t,n=i.indexOf(".");return parseFloat(i.substring(0,n+1+e))},dist:function(t,e){var i=t.x-e.x,n=t.y-e.y;return s(i*i+n*n)},closest:function(t,e){var i,n,r=l(2,63);return t.forEach((function(t,a){(n=y.dist(e,t))<r&&(r=n,i=a)})),{mdist:r,mpos:i}},abcratio:function(t,i){if(2!==i&&3!==i)return!1;if(void 0===t)t=.5;else if(0===t||1===t)return t;var n=l(t,i)+l(1-t,i);return e((n-1)/n)},projectionratio:function(t,e){if(2!==e&&3!==e)return!1;if(void 0===t)t=.5;else if(0===t||1===t)return t;var i=l(1-t,e);return i/(l(t,e)+i)},lli8:function(t,e,i,n,r,a,o,s){var l=(t-i)*(a-s)-(e-n)*(r-o);return 0!=l&&{x:((t*n-e*i)*(r-o)-(t-i)*(r*s-a*o))/l,y:((t*n-e*i)*(a-s)-(e-n)*(r*s-a*o))/l}},lli4:function(t,e,i,n){var r=t.x,a=t.y,o=e.x,s=e.y,l=i.x,c=i.y,h=n.x,u=n.y;return y.lli8(r,a,o,s,l,c,h,u)},lli:function(t,e){return y.lli4(t,t.c,e,e.c)},makeline:function(t,e){var n=i(116),r=t.x,a=t.y,o=e.x,s=e.y,l=(o-r)/3,c=(s-a)/3;return new n(r,a,r+l,a+c,r+2*l,a+2*c,o,s)},findbbox:function(t){var e=p,i=p,n=f,r=f;return t.forEach((function(t){var a=t.bbox();e>a.x.min&&(e=a.x.min),i>a.y.min&&(i=a.y.min),n<a.x.max&&(n=a.x.max),r<a.y.max&&(r=a.y.max)})),{x:{min:e,mid:(e+n)/2,max:n,size:n-e},y:{min:i,mid:(i+r)/2,max:r,size:r-i}}},shapeintersections:function(t,e,i,n,r){if(!y.bboxoverlap(e,n))return[];var a=[],o=[t.startcap,t.forward,t.back,t.endcap],s=[i.startcap,i.forward,i.back,i.endcap];return o.forEach((function(e){e.virtual||s.forEach((function(n){if(!n.virtual){var o=e.intersects(n,r);o.length>0&&(o.c1=e,o.c2=n,o.s1=t,o.s2=i,a.push(o))}}))})),a},makeshape:function(t,e,i){var n=e.points.length,r=t.points.length,a=y.makeline(e.points[n-1],t.points[0]),o=y.makeline(t.points[r-1],e.points[0]),s={startcap:a,forward:t,back:e,endcap:o,bbox:y.findbbox([a,t,e,o])},l=y;return s.intersections=function(t){return l.shapeintersections(s,s.bbox,t,t.bbox,i)},s},getminmax:function(t,e,i){if(!i)return{min:0,max:0};var n,r,a=p,o=f;-1===i.indexOf(0)&&(i=[0].concat(i)),-1===i.indexOf(1)&&i.push(1);for(var s=0,l=i.length;s<l;s++)n=i[s],(r=t.get(n))[e]<a&&(a=r[e]),r[e]>o&&(o=r[e]);return{min:a,mid:(a+o)/2,max:o,size:o-a}},align:function(t,e){var i=e.p1.x,a=e.p1.y,s=-o(e.p2.y-a,e.p2.x-i);return t.map((function(t){return{x:(t.x-i)*n(s)-(t.y-a)*r(s),y:(t.x-i)*r(s)+(t.y-a)*n(s)}}))},roots:function(t,e){e=e||{p1:{x:0,y:0},p2:{x:1,y:0}};var i=t.length-1,r=y.align(t,e),o=function(t){return 0<=t&&t<=1};if(2===i){if(0!==(m=(g=r[0].y)-2*(v=r[1].y)+(_=r[2].y))){var l=-s(v*v-g*_),h=-g+v;return[-(l+h)/m,-(-l+h)/m].filter(o)}return v!==_&&0===m?[(2*v-_)/(2*v-2*_)].filter(o):[]}var d=r[0].y,p=r[1].y,f=r[2].y,m=3*p-d-3*f+r[3].y,g=3*d-6*p+3*f,v=-3*d+3*p,_=d;if(y.approximately(m,0)){if(y.approximately(g,0))return y.approximately(v,0)?[]:[-_/v].filter(o);var x=2*g;return[((b=s(v*v-4*g*_))-v)/x,(-v-b)/x].filter(o)}var b,w,C=(r=(3*(v/=m)-(g/=m)*g)/3)/3,k=(b=(2*g*g*g-9*g*v+27*(_/=m))/27)/2,S=k*k+C*C*C;if(S<0){var D=-r/3,z=s(D*D*D),F=-b/(2*z),A=a(F<-1?-1:F>1?1:F),P=2*c(z);return[P*n(A/3)-g/3,P*n((A+u)/3)-g/3,P*n((A+2*u)/3)-g/3].filter(o)}if(0===S)return[2*(w=k<0?c(-k):-c(k))-g/3,-w-g/3].filter(o);var E=s(S);return[(w=c(-k+E))-c(k+E)-g/3].filter(o)},droots:function(t){if(3===t.length){var e=t[0],i=t[1],n=t[2],r=e-2*i+n;if(0!==r){var a=-s(i*i-e*n),o=-e+i;return[-(a+o)/r,-(-a+o)/r]}return i!==n&&0===r?[(2*i-n)/(2*(i-n))]:[]}if(2===t.length)return(e=t[0])!==(i=t[1])?[e/(e-i)]:[]},curvature:function(t,i,n,r){var a,o,c,h,u,d,p=y.derive(i),f=p[0],m=p[1],g=y.compute(t,f),v=y.compute(t,m),_=g.x*g.x+g.y*g.y;if(n?(a=s(l(g.y*v.z-v.y*g.z,2)+l(g.z*v.x-v.z*g.x,2)+l(g.x*v.y-v.x*g.y,2)),o=l(_+g.z*g.z,1.5)):(a=g.x*v.y-g.y*v.x,o=l(_,1.5)),0===a||0===o)return{k:0,r:0};if(u=a/o,d=o/a,!r){var x=y.curvature(t-.001,i,n,!0).k,b=y.curvature(t+.001,i,n,!0).k;h=(b-u+(u-x))/2,c=(e(b-u)+e(u-x))/2}return{k:u,r:d,dk:h,adk:c}},inflections:function(t){if(t.length<4)return[];var e=y.align(t,{p1:t[0],p2:t.slice(-1)[0]}),i=e[2].x*e[1].y,n=e[3].x*e[1].y,r=e[1].x*e[2].y,a=18*(-3*i+2*n+3*r-(u=e[3].x*e[2].y)),o=18*(3*i-n-3*r),s=18*(r-i);if(y.approximately(a,0)){if(!y.approximately(o,0)){var l=-s/o;if(0<=l&&l<=1)return[l]}return[]}var c=o*o-4*a*s,h=Math.sqrt(c),u=2*a;return y.approximately(u,0)?[]:[(h-o)/u,-(o+h)/u].filter((function(t){return 0<=t&&t<=1}))},bboxoverlap:function(t,i){var n,r,a,o,s,l=["x","y"],c=l.length;for(n=0;n<c;n++)if(a=t[r=l[n]].mid,o=i[r].mid,s=(t[r].size+i[r].size)/2,e(a-o)>=s)return!1;return!0},expandbox:function(t,e){e.x.min<t.x.min&&(t.x.min=e.x.min),e.y.min<t.y.min&&(t.y.min=e.y.min),e.z&&e.z.min<t.z.min&&(t.z.min=e.z.min),e.x.max>t.x.max&&(t.x.max=e.x.max),e.y.max>t.y.max&&(t.y.max=e.y.max),e.z&&e.z.max>t.z.max&&(t.z.max=e.z.max),t.x.mid=(t.x.min+t.x.max)/2,t.y.mid=(t.y.min+t.y.max)/2,t.z&&(t.z.mid=(t.z.min+t.z.max)/2),t.x.size=t.x.max-t.x.min,t.y.size=t.y.max-t.y.min,t.z&&(t.z.size=t.z.max-t.z.min)},pairiteration:function(t,e,i){var n=t.bbox(),r=e.bbox(),a=1e5,o=i||.5;if(n.x.size+n.y.size<o&&r.x.size+r.y.size<o)return[(a*(t._t1+t._t2)/2|0)/a+"/"+(a*(e._t1+e._t2)/2|0)/a];var s=t.split(.5),l=e.split(.5),c=[{left:s.left,right:l.left},{left:s.left,right:l.right},{left:s.right,right:l.right},{left:s.right,right:l.left}];c=c.filter((function(t){return y.bboxoverlap(t.left.bbox(),t.right.bbox())}));var h=[];return 0===c.length?h:(c.forEach((function(t){h=h.concat(y.pairiteration(t.left,t.right,o))})),h=h.filter((function(t,e){return h.indexOf(t)===e})))},getccenter:function(t,e,i){var a,s=e.x-t.x,l=e.y-t.y,c=i.x-e.x,h=i.y-e.y,p=s*n(d)-l*r(d),f=s*r(d)+l*n(d),m=c*n(d)-h*r(d),g=c*r(d)+h*n(d),v=(t.x+e.x)/2,_=(t.y+e.y)/2,x=(e.x+i.x)/2,b=(e.y+i.y)/2,w=v+p,C=_+f,k=x+m,S=b+g,D=y.lli8(v,_,w,C,x,b,k,S),z=y.dist(D,t),F=o(t.y-D.y,t.x-D.x),A=o(e.y-D.y,e.x-D.x),P=o(i.y-D.y,i.x-D.x);return F<P?((F>A||A>P)&&(F+=u),F>P&&(a=P,P=F,F=a)):P<A&&A<F?(a=P,P=F,F=a):P+=u,D.s=F,D.e=P,D.r=z,D},numberSort:function(t,e){return t-e}};t.exports=y}()},function(t,e){t.exports=function(){return[]}},function(t,e,i){var n=i(89),r=i(81),a=i(88),o=i(118),s=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)n(e,a(t)),t=r(t);return e}:o;t.exports=s},function(t,e,i){var n=i(121),r=i(88),a=i(39);t.exports=function(t){return n(t,a,r)}},function(t,e,i){var n=i(89),r=i(16);t.exports=function(t,e,i){var a=e(t);return r(t)?a:n(a,i(t))}},function(t,e,i){var n=i(288),r=i(25);t.exports=function t(e,i,a,o,s){return e===i||(null==e||null==i||!r(e)&&!r(i)?e!=e&&i!=i:n(e,i,a,o,t,s))}},function(t,e,i){var n=i(289),r=i(292),a=i(293);t.exports=function(t,e,i,o,s,l){var c=1&i,h=t.length,u=e.length;if(h!=u&&!(c&&u>h))return!1;var d=l.get(t);if(d&&l.get(e))return d==e;var p=-1,f=!0,m=2&i?new n:void 0;for(l.set(t,e),l.set(e,t);++p<h;){var y=t[p],g=e[p];if(o)var v=c?o(g,y,p,e,t,l):o(y,g,p,t,e,l);if(void 0!==v){if(v)continue;f=!1;break}if(m){if(!r(e,(function(t,e){if(!a(m,e)&&(y===t||s(y,t,i,o,l)))return m.push(e)}))){f=!1;break}}else if(y!==g&&!s(y,g,i,o,l)){f=!1;break}}return l.delete(t),l.delete(e),f}},function(t,e,i){var n=i(14);t.exports=function(t){return t==t&&!n(t)}},function(t,e){t.exports=function(t,e){return function(i){return null!=i&&(i[t]===e&&(void 0!==e||t in Object(i)))}}},function(t,e,i){var n=i(127),r=i(66);t.exports=function(t,e){for(var i=0,a=(e=n(e,t)).length;null!=t&&i<a;)t=t[r(e[i++])];return i&&i==a?t:void 0}},function(t,e,i){var n=i(16),r=i(90),a=i(301),o=i(304);t.exports=function(t,e){return n(t)?t:r(t,e)?[t]:a(o(t))}},function(t,e,i){var n;t.exports=(n=i(5),function(t){var e=n,i=e.lib,r=i.WordArray,a=i.Hasher,o=e.algo,s=[],l=[];!function(){function e(e){for(var i=t.sqrt(e),n=2;n<=i;n++)if(!(e%n))return!1;return!0}function i(t){return 4294967296*(t-(0|t))|0}for(var n=2,r=0;r<64;)e(n)&&(r<8&&(s[r]=i(t.pow(n,.5))),l[r]=i(t.pow(n,1/3)),r++),n++}();var c=[],h=o.SHA256=a.extend({_doReset:function(){this._hash=new r.init(s.slice(0))},_doProcessBlock:function(t,e){for(var i=this._hash.words,n=i[0],r=i[1],a=i[2],o=i[3],s=i[4],h=i[5],u=i[6],d=i[7],p=0;p<64;p++){if(p<16)c[p]=0|t[e+p];else{var f=c[p-15],m=(f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3,y=c[p-2],g=(y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10;c[p]=m+c[p-7]+g+c[p-16]}var v=n&r^n&a^r&a,_=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),x=d+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&h^~s&u)+l[p]+c[p];d=u,u=h,h=s,s=o+x|0,o=a,a=r,r=n,n=x+(_+v)|0}i[0]=i[0]+n|0,i[1]=i[1]+r|0,i[2]=i[2]+a|0,i[3]=i[3]+o|0,i[4]=i[4]+s|0,i[5]=i[5]+h|0,i[6]=i[6]+u|0,i[7]=i[7]+d|0},_doFinalize:function(){var e=this._data,i=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return i[r>>>5]|=128<<24-r%32,i[14+(r+64>>>9<<4)]=t.floor(n/4294967296),i[15+(r+64>>>9<<4)]=n,e.sigBytes=4*i.length,this._process(),this._hash},clone:function(){var t=a.clone.call(this);return t._hash=this._hash.clone(),t}});e.SHA256=a._createHelper(h),e.HmacSHA256=a._createHmacHelper(h)}(Math),n.SHA256)},function(t,e,i){var n;t.exports=(n=i(5),i(67),function(){var t=n,e=t.lib.Hasher,i=t.x64,r=i.Word,a=i.WordArray,o=t.algo;function s(){return r.create.apply(r,arguments)}var l=[s(1116352408,3609767458),s(1899447441,602891725),s(3049323471,3964484399),s(3921009573,2173295548),s(961987163,4081628472),s(1508970993,3053834265),s(2453635748,2937671579),s(2870763221,3664609560),s(3624381080,2734883394),s(310598401,1164996542),s(607225278,1323610764),s(1426881987,3590304994),s(1925078388,4068182383),s(2162078206,991336113),s(2614888103,633803317),s(3248222580,3479774868),s(3835390401,2666613458),s(4022224774,944711139),s(264347078,2341262773),s(604807628,2007800933),s(770255983,1495990901),s(1249150122,1856431235),s(1555081692,3175218132),s(1996064986,2198950837),s(2554220882,3999719339),s(2821834349,766784016),s(2952996808,2566594879),s(3210313671,3203337956),s(3336571891,1034457026),s(3584528711,2466948901),s(113926993,3758326383),s(338241895,168717936),s(666307205,1188179964),s(773529912,1546045734),s(1294757372,1522805485),s(1396182291,2643833823),s(1695183700,2343527390),s(1986661051,1014477480),s(2177026350,1206759142),s(2456956037,344077627),s(2730485921,1290863460),s(2820302411,3158454273),s(3259730800,3505952657),s(3345764771,106217008),s(3516065817,3606008344),s(3600352804,1432725776),s(4094571909,1467031594),s(275423344,851169720),s(430227734,3100823752),s(506948616,1363258195),s(659060556,3750685593),s(883997877,3785050280),s(958139571,3318307427),s(1322822218,3812723403),s(1537002063,2003034995),s(1747873779,3602036899),s(1955562222,1575990012),s(2024104815,1125592928),s(2227730452,2716904306),s(2361852424,442776044),s(2428436474,593698344),s(2756734187,3733110249),s(3204031479,2999351573),s(3329325298,3815920427),s(3391569614,3928383900),s(3515267271,566280711),s(3940187606,3454069534),s(4118630271,4000239992),s(116418474,1914138554),s(174292421,2731055270),s(289380356,3203993006),s(460393269,320620315),s(685471733,587496836),s(852142971,1086792851),s(1017036298,365543100),s(1126000580,2618297676),s(1288033470,3409855158),s(1501505948,4234509866),s(1607167915,987167468),s(1816402316,1246189591)],c=[];!function(){for(var t=0;t<80;t++)c[t]=s()}();var h=o.SHA512=e.extend({_doReset:function(){this._hash=new a.init([new r.init(1779033703,4089235720),new r.init(3144134277,2227873595),new r.init(1013904242,4271175723),new r.init(2773480762,1595750129),new r.init(1359893119,2917565137),new r.init(2600822924,725511199),new r.init(528734635,4215389547),new r.init(1541459225,327033209)])},_doProcessBlock:function(t,e){for(var i=this._hash.words,n=i[0],r=i[1],a=i[2],o=i[3],s=i[4],h=i[5],u=i[6],d=i[7],p=n.high,f=n.low,m=r.high,y=r.low,g=a.high,v=a.low,_=o.high,x=o.low,b=s.high,w=s.low,C=h.high,k=h.low,S=u.high,D=u.low,z=d.high,F=d.low,A=p,P=f,E=m,O=y,T=g,M=v,B=_,R=x,L=b,j=w,H=C,I=k,G=S,U=D,q=z,V=F,N=0;N<80;N++){var X=c[N];if(N<16)var W=X.high=0|t[e+2*N],Y=X.low=0|t[e+2*N+1];else{var K=c[N-15],$=K.high,Z=K.low,Q=($>>>1|Z<<31)^($>>>8|Z<<24)^$>>>7,J=(Z>>>1|$<<31)^(Z>>>8|$<<24)^(Z>>>7|$<<25),tt=c[N-2],et=tt.high,it=tt.low,nt=(et>>>19|it<<13)^(et<<3|it>>>29)^et>>>6,rt=(it>>>19|et<<13)^(it<<3|et>>>29)^(it>>>6|et<<26),at=c[N-7],ot=at.high,st=at.low,lt=c[N-16],ct=lt.high,ht=lt.low;W=(W=(W=Q+ot+((Y=J+st)>>>0<J>>>0?1:0))+nt+((Y+=rt)>>>0<rt>>>0?1:0))+ct+((Y+=ht)>>>0<ht>>>0?1:0),X.high=W,X.low=Y}var ut,dt=L&H^~L&G,pt=j&I^~j&U,ft=A&E^A&T^E&T,mt=P&O^P&M^O&M,yt=(A>>>28|P<<4)^(A<<30|P>>>2)^(A<<25|P>>>7),gt=(P>>>28|A<<4)^(P<<30|A>>>2)^(P<<25|A>>>7),vt=(L>>>14|j<<18)^(L>>>18|j<<14)^(L<<23|j>>>9),_t=(j>>>14|L<<18)^(j>>>18|L<<14)^(j<<23|L>>>9),xt=l[N],bt=xt.high,wt=xt.low,Ct=q+vt+((ut=V+_t)>>>0<V>>>0?1:0),kt=gt+mt;q=G,V=U,G=H,U=I,H=L,I=j,L=B+(Ct=(Ct=(Ct=Ct+dt+((ut+=pt)>>>0<pt>>>0?1:0))+bt+((ut+=wt)>>>0<wt>>>0?1:0))+W+((ut+=Y)>>>0<Y>>>0?1:0))+((j=R+ut|0)>>>0<R>>>0?1:0)|0,B=T,R=M,T=E,M=O,E=A,O=P,A=Ct+(yt+ft+(kt>>>0<gt>>>0?1:0))+((P=ut+kt|0)>>>0<ut>>>0?1:0)|0}f=n.low=f+P,n.high=p+A+(f>>>0<P>>>0?1:0),y=r.low=y+O,r.high=m+E+(y>>>0<O>>>0?1:0),v=a.low=v+M,a.high=g+T+(v>>>0<M>>>0?1:0),x=o.low=x+R,o.high=_+B+(x>>>0<R>>>0?1:0),w=s.low=w+j,s.high=b+L+(w>>>0<j>>>0?1:0),k=h.low=k+I,h.high=C+H+(k>>>0<I>>>0?1:0),D=u.low=D+U,u.high=S+G+(D>>>0<U>>>0?1:0),F=d.low=F+V,d.high=z+q+(F>>>0<V>>>0?1:0)},_doFinalize:function(){var t=this._data,e=t.words,i=8*this._nDataBytes,n=8*t.sigBytes;return e[n>>>5]|=128<<24-n%32,e[30+(n+128>>>10<<5)]=Math.floor(i/4294967296),e[31+(n+128>>>10<<5)]=i,t.sigBytes=4*e.length,this._process(),this._hash.toX32()},clone:function(){var t=e.clone.call(this);return t._hash=this._hash.clone(),t},blockSize:32});t.SHA512=e._createHelper(h),t.HmacSHA512=e._createHmacHelper(h)}(),n.SHA512)},function(t,e){t.exports="attribute vec2 aPosition;\nattribute vec3 aOrientation;\nattribute vec2 aLayer;\nattribute vec4 aColor;\nattribute vec4 aDesaturation;\nattribute vec2 aGradient;\n\nvarying lowp vec4 vColor;\nvarying lowp vec4 vDesaturation;\nvarying lowp vec2 vGradient;\nvarying lowp vec2 vLayer;\nuniform  vec4 uViewport;\n\nmat4 viewportScale = mat4(2.0 / uViewport.z, 0, 0, 0,    0, -2.0 / uViewport.w, 0,0,    0, 0,1,0,    -1,+1,0,1);\nvec4 viewportTranslation = vec4(uViewport.xy, 0, 0);\n\nvoid main() {\n  vec2 pos = aPosition;\n  vec2 entityOrigin = aOrientation.xy;\n  mat2 entityRotationMatrix = mat2(cos(aOrientation.z), sin(aOrientation.z), -sin(aOrientation.z), cos(aOrientation.z));\n\n  pos = entityRotationMatrix * (pos - entityOrigin) + entityOrigin;\n  gl_Position = viewportScale * (viewportTranslation + vec4(pos, 1.0/(1.0+exp(aLayer.x) ), 1) );\n\n  vColor = aColor;\n  vDesaturation = aDesaturation;\n  vGradient = aGradient;\n  vLayer = aLayer;\n}\n\n"},function(t,e){t.exports="precision mediump float;\nvarying lowp vec4 vColor;\nvarying lowp vec2 vGradient;\nvarying lowp vec4 vDesaturation;\nvarying lowp vec2 vLayer;\nvoid main(void) {\n\n  //gl_FragColor = vec4(vColor.rgb*vColor.a*vLayer.y, vColor.a*vLayer.y);\n\n  mediump float mixFactor = vGradient.x;\n\n  mediump float lightness = (0.2126*vColor.r + 0.7152*vColor.g + 0.0722*vColor.b);\n  mediump float lightnessBase = (0.2126*vDesaturation.r + 0.7152*vDesaturation.g + 0.0722*vDesaturation.b);\n  mediump vec4 baseColor = vec4(vDesaturation.rgb, vColor.a) * (1.0 + (lightness - lightnessBase));\n  mediump vec4 mixColor = vec4(\n      (baseColor.rgba * mixFactor) + (vColor.rgba * (1.0 - mixFactor))\n      );\n\n  gl_FragColor = vec4(\n      mixColor.rgb * vColor.a * vLayer.y,\n      vColor.a * vLayer.y\n      );\n}\n\n"},function(t,e){t.exports="attribute vec2 aPosition;\nattribute vec3 aOrientation;\nattribute vec2 aLayer;\nattribute vec4 aColor;\n\nvarying lowp vec4 vColor;\nvarying lowp vec2 vLayer;\nuniform vec4 uViewport;\n\nmat4 viewportScale = mat4(2.0 / uViewport.z, 0, 0, 0,    0, -2.0 / uViewport.w, 0,0,    0, 0,1,0,    -1,+1,0,1);\nvec4 viewportTranslation = vec4(uViewport.xy, 0, 0);\n\nvoid main() {\n  vec2 pos = aPosition;\n  vec2 entityOrigin = aOrientation.xy;\n  mat2 entityRotationMatrix = mat2(cos(aOrientation.z), sin(aOrientation.z), -sin(aOrientation.z), cos(aOrientation.z));\n\n  pos = entityRotationMatrix * (pos - entityOrigin) + entityOrigin;\n  gl_Position = viewportScale * (viewportTranslation + vec4(pos, 1.0/(1.0+exp(aLayer.x) ), 1) );\n\n  vColor = aColor;\n  vLayer = aLayer;\n}\n\n"},function(t,e){t.exports="precision mediump float;\nvarying lowp vec4 vColor;\nvarying lowp vec2 vLayer;\nvoid main(void) {\n  gl_FragColor = vec4(vColor.rgb*vColor.a*vLayer.y, vColor.a*vLayer.y);\n}\n"},function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));const n=1*new Date,r=()=>n},function(t,e,i){"use strict";(function(t){i.d(e,"a",(function(){return r}));const n={},r=e=>{const i=n[e];if(i)return i;const r={};t.assignColor(e,r);const a={_red:r._red/255,_green:r._green/255,_blue:r._blue/255};return n[e]=a,a}}).call(this,i(0).default)},function(t,e){t.exports="attribute vec3 aPosition;\nattribute vec3 aVelocity;\nattribute vec3 aOrientation;\nattribute vec2 aLayer;\nattribute vec2 aSize;\nattribute vec4 aLife;\nattribute vec4 aColor1;\nattribute vec4 aColor2;\n\nvarying lowp vec4 vColor;\nvarying lowp vec2 vLayer;\nvarying lowp vec3 vLife;\n\nuniform  vec4 uViewport;\nuniform  vec4 uTimeOffset;\n\nmat4 viewportScale = mat4(2.0 / uViewport.z, 0, 0, 0,    0, -2.0 / uViewport.w, 0,0,    0, 0,1,0,    -1,+1,0,1);\nvec4 viewportTranslation = vec4(uViewport.xy, 0, 0);\n\nfloat gravity(float accelleration, float duration) {\n  // https://www.vcalc.com/equation/?uuid=e6ccc22d-da27-11e2-8e97-bc764e04d25f\n  return 0.5 * accelleration * (duration / 1000.0) * (duration / 1000.0);\n}\n\nvoid main() {\n  vec2 pos = aPosition.xy;\n  vec2 entityOrigin = aOrientation.xy;\n  mat2 entityRotationMatrix = mat2(cos(aOrientation.z), sin(aOrientation.z), -sin(aOrientation.z), cos(aOrientation.z));\n\n  mat2 entityAngleMatrix = mat2(cos(aVelocity.y), sin(aVelocity.y), -sin(aVelocity.y), cos(aVelocity.y));\n  pos = entityRotationMatrix * (pos - entityOrigin) + entityOrigin;\n\n  float duration = uTimeOffset.x - aLife.x;\n  if (aVelocity.z == -1.0) {\n    duration = aLife.y - duration;\n  }\n  float durationScale = duration / aLife.y;\n\n  float dist = aVelocity.x * (duration / 1000.0);\n\n  vec2 movement = vec2(cos(aVelocity.y) * dist, sin(aVelocity.y) * dist);\n  vec2 gravityDisplacement = vec2(gravity(aLife.z, duration), gravity(aLife.a, duration));\n\n  pos = pos + movement + gravityDisplacement;\n\n  gl_Position = viewportScale * (viewportTranslation + vec4(pos, 1.0/(1.0+exp(aLayer.x) ), 1) );\n\tgl_PointSize = (1.0 - durationScale) * aSize.x + durationScale * aSize.y;\n\n  vColor = mix(aColor1, aColor2, durationScale);\n  vLayer = aLayer;\n  vLife = vec3(duration, aLife.y, aPosition.z);\n}\n\n"},function(t,e){t.exports="precision mediump float;\nvarying lowp vec4 vColor;\nvarying lowp vec3 vLife;\n\nuniform sampler2D uSampler;\nuniform mediump vec2 uTextureDimensions;\nuniform highp mat4 uSpriteMatrix;\n\nvoid main(void) {\n  if (vLife.x > vLife.y || vLife.x < 0.0) {\n    discard;\n  }\n\n  highp vec4 uSpriteCoords2 = uSpriteMatrix[0];\n  if (vLife.z > 0.0 && vLife.z < 2.0) {\n    uSpriteCoords2 = uSpriteMatrix[1];\n  }\n  if (vLife.z > 1.0 && vLife.z < 3.0) {\n    uSpriteCoords2 = uSpriteMatrix[2];\n  }\n  if (vLife.z > 2.0 && vLife.z < 4.0) {\n    uSpriteCoords2 = uSpriteMatrix[3];\n  }\n\n  if (uSpriteCoords2.b == 0.0) {\n    gl_FragColor = vColor;\n    return;\n  }\n\n  highp vec2 coord = (uSpriteCoords2.xy + (gl_PointCoord * uSpriteCoords2.ba)) / uTextureDimensions;\n  mediump vec4 texelColor = texture2D(uSampler, coord);\n  mediump float lightness = (0.2126*texelColor.r + 0.7152*texelColor.g + 0.0722*texelColor.b);\n\n  mediump vec3 mixedColor = vColor.rgb * (lightness * 1.3);\n  gl_FragColor = vec4(mixedColor * texelColor.a * vColor.a, texelColor.a * vColor.a);\n}\n"},function(t,e,i){"use strict";(function(t){class i{constructor(t,e,i){this.context=t,this.attributes=i,this.stride=e,this.array_size=16,this.max_size=4096,this.render_size=0,this._attributeArray=new Float32Array(this.array_size*this.stride),this._attributeBuffer=this.context.createBuffer(),this.active=!0}reactivate(){this.active=!0,this.render_size=0}deactivate(){this.active=!1}growArrays(t){if(this.render_size=Math.min(t,this.max_size),this.array_size>=this.max_size)return;if(this.array_size>=t)return;const e=Math.min(t,this.max_size),i=new Float32Array(e*this.stride);i.set(this._attributeArray),this._attributeArray=i,this.array_size=e}writeParticle(t,e){const i=this.attributes;let n=t*this.stride;for(let t=0;t<i.length;t++)for(let r=0;r<i[t].width;r++)this._attributeArray[n]=e[i[t].name][r],n++}draw(){const t=this.context;t.bindBuffer(t.ARRAY_BUFFER,this._attributeBuffer);const e=this.attributes;for(var i=0;i<e.length;i++){let n=e[i];t.vertexAttribPointer(n.location,n.width,n.type,!1,this.stride*n.bytes,n.offset*n.bytes)}t.bufferData(t.ARRAY_BUFFER,this._attributeArray,t.STATIC_DRAW),t.drawArrays(t.POINTS,0,this.render_size)}}class n{constructor(t,e){this.shader=e,this.layer=t,this.context=t.context,this.draw=function(){},this.array_size=0,this.max_size=96}initAttributes(t){this.attributes=t,this._attribute_table={};for(var e=0,i=0;i<t.length;i++){var n=t[i];this._attribute_table[n.name]=n,n.bytes=n.bytes||Float32Array.BYTES_PER_ELEMENT,n.type=n.type||this.context.FLOAT,n.offset=e,n.location=this.context.getAttribLocation(this.shader,n.name),this.context.enableVertexAttribArray(n.location),e+=n.width}this.stride=e,this.buffers=[]}registerEntity(t){const e=this.buffers.find(t=>!1===t.active);if(void 0===e){if(this.buffers.length>=this.max_size)throw"Number of entities exceeds maximum limit.";const e=new i(this.context,this.stride,this.attributes);this.buffers.push(e),t.particleBuffer=e}else e.reactivate(),t.particleBuffer=e}unregisterEntity(t){t.particleBuffer.deactivate(),t.particleBuffer=null}resetRegistry(){this.buffers=[]}setCurrentEntity(t){this.drawBuffers.push(t.particleBuffer)}switchTo(){this.context.useProgram(this.shader),this.drawBuffers=[],this.hasTime=!1}setTexture(t){void 0===this.texture_obj&&(t.setToProgram(this.shader,"uSampler","uTextureDimensions"),this.texture_obj=t)}renderBatch(){var t=this.texture_obj;t&&null===t.unit&&this.layer.texture_manager.bindTexture(t);for(let t=0;t<this.drawBuffers.length;t++)this.drawBuffers[t].active&&this.drawBuffers[t].draw()}setViewportUniforms(t){var e=this.context;e.useProgram(this.shader),e.uniform4f(this.shader.viewport,-t._x,-t._y,t._w,t._h)}}t.c("WebGLParticles",{init:function(){this.requires("Renderable"),this._customLayer||this._attachToLayer(t.s("DefaultWebGLLayer"))},remove:function(){this._detachFromLayer()},drawVars:{type:"webgl",pos:{},ctx:null,coord:[0,0,0,0],co:{x:0,y:0,w:0,h:0}},draw:function(){if(this.ready){var t=this.drawVars.pos;t._x=this._x,t._y=this._y,t._w=this._w,t._h=this._h;var e=this.__coord||[0,0,0,0],i=this.drawVars.co;i.x=e[0],i.y=e[1],i.w=e[2],i.h=e[3],this._flipX&&(i.x=i.x+i.w,i.w=-i.w),this._flipY&&(i.y=i.y+i.h,i.h=-i.h);var n=this._drawContext;return this.drawVars.gl=n,(this.drawVars.program=this.program).setCurrentEntity(this),this.trigger("Draw",this.drawVars),this}},_establishShader:function(t,e){if(void 0===this._drawLayer.programs[t]){const r=this._drawLayer._makeProgram(e);var i=this._drawContext;r.time=i.getUniformLocation(r,"uTimeOffset"),r.spriteMatrix=i.getUniformLocation(r,"uSpriteMatrix");const a=new n(this._drawLayer,r);a.name=t,a.initAttributes(e.attributeList),a.draw=e.drawCallback,a.setViewportUniforms(this._drawLayer._viewportRect()),this.program=a,this._drawLayer.programs[a.name]=a}else this.program=this._drawLayer.programs[t];this.program.registerEntity(this),this.ready=!0}}),e.a="WebGLParticles"}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){t.c("AngleMotion",{properties:{velocity:{set:function(t){this._velocity=t,this._setAngleAndVelocity(this._angle,this._velocity)},get:function(){return this._velocity},configurable:!0,enumerable:!0},_velocity:{value:0,writable:!0,enumerable:!1},angle:{set:function(t){this._angle=t,this._setAngleAndVelocity(this._angle,this._velocity)},get:function(){return this._angle},configurable:!0,enumerable:!0},_angle:{value:0,writable:!0,enumerable:!1}},_setAngleAndVelocity(t,e){0!==e?this.attr({vy:-Math.sin(t/180*Math.PI)*e,vx:-Math.cos(t/180*Math.PI)*e}):this.attr({vy:0,vx:0})}}),e.a="AngleMotion"}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var n=i(52);t.c("Beam",{required:n.a,properties:{beamVelocity:{set:function(t){this._beamVelocity=t,this._setBeamVelocity(this._beamVelocity)},get:function(){return this._beamVelocity},configurable:!0,enumerable:!0},_beamVelocity:{value:0,writable:!0,enumerable:!1}},events:{Freeze(){this._beamVelocity=0,this.beamBlocked=!1}},_setBeamVelocity(t){0!==t?(this.beamLength=this.sw,this.uniqueBind("EnterFrame",this._updateBeam)):this.unbind("EnterFrame",this._updateBeam)},_updateBeam({dt:t}){const e=this._beamVelocity*(t/1e3);this.beamBlocked||(this.sw+=e),this.beamLength+=e}}),e.a="Beam"}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){t.c("Steering",{properties:{steering:{set:function(t){this._steering!==t&&(this._steering=t,0===t?this.unbind("GameLoop",this._updateSteering):(this._updateSteering({dt:1}),this.uniqueBind("GameLoop",this._updateSteering)))},get:function(){return this._steering},configurable:!0,enumerable:!0},_steering:{value:0,writable:!0,enumerable:!1}},events:{Freeze(){this.currentTarget=null}},_updateSteering({dt:e}){if(!this.currentTarget&&this.target){const e=t(this.target);e.length>0&&(this.currentTarget=t(e[Math.floor(Math.random()*e.length)]))}if(!this.currentTarget)return;const i=this.currentTarget.x+this.currentTarget.w/2,n=this.currentTarget.y+this.currentTarget.h/2,r={x:this.x-i,y:this.y-n},a=Math.atan2(r.y,r.x)/Math.PI*180,o=this._steering/1e3*e,s=(a-this.angle-360)%360,l=(a-this.angle+360)%360,c=Math.abs(s)<Math.abs(l)?s:l;this.sight&&(c>this.sight||c<-this.sight)||(c>o?this.attr({angle:(360+this.angle+o)%360,rotation:this.autoRotate?this.rotation:(360+this.rotation+o)%360}):c<-o?this.attr({angle:(360+this.angle-o)%360,rotation:this.autoRotate?this.rotation:(360+this.rotation-o)%360}):this.attr({angle:(360+a)%360,rotation:this.autoRotate?this.rotation:(360+a)%360}))}}),e.a="Steering"}).call(this,i(0).default)},function(t,e){t.exports="attribute vec2 aPosition;\nattribute vec4 aSpriteDimensions;\nattribute vec3 aOrientation;\nattribute vec2 aLayer;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute vec4 aOverrideColor;\nattribute vec4 aGradient;\n\nvarying mediump vec3 vTextureCoord;\nvarying lowp vec4 vColor;\nvarying lowp vec4 vOverrideColor;\nvarying lowp vec4 vGradient;\nvarying lowp vec4 vSpriteDimensions;\n\nuniform vec4 uViewport;\n\nmat4 viewportScale = mat4(2.0 / uViewport.z, 0, 0, 0,    0, -2.0 / uViewport.w, 0,0,    0, 0,1,0,    -1,+1,0,1);\nvec4 viewportTranslation = vec4(uViewport.xy, 0, 0);\n\nvoid main() {\n  vec2 pos = aPosition;\n  vec2 entityOrigin = aOrientation.xy;\n  mat2 entityRotationMatrix = mat2(cos(aOrientation.z), sin(aOrientation.z), -sin(aOrientation.z), cos(aOrientation.z));\n\n  pos = entityRotationMatrix * (pos - entityOrigin) + entityOrigin ;\n  gl_Position = viewportScale * (viewportTranslation + vec4(pos, 1.0/(1.0+exp(aLayer.x) ), 1) );\n  vTextureCoord = vec3(aTextureCoord, aLayer.y);\n  vColor = aColor;\n  vOverrideColor = aOverrideColor;\n  vGradient = aGradient;\n  vSpriteDimensions = aSpriteDimensions;\n}\n\n"},function(t,e){t.exports="precision mediump float;\nvarying mediump vec3 vTextureCoord;\nvarying mediump vec4 vColor;\nvarying mediump vec4 vOverrideColor;\nvarying mediump vec4 vGradient;\nvarying mediump vec4 vSpriteDimensions;\n\nuniform sampler2D uSampler;\nuniform mediump vec2 uTextureDimensions;\n\nfloat random(vec3 scale, float seed) {\n  // use the fragment position for a different seed per-pixel\n  return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\nvec3 rgb2hsv(vec3 c) {\n  vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n  vec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n  vec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n  float d = q.x - min(q.w, q.y);\n  float e = 1.0e-10;\n  return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c) {\n  vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nvoid main() {\n  highp vec2 coord = vTextureCoord.xy / uTextureDimensions;\n\n  if ((vGradient.a >= 0.0) && (vTextureCoord.y >= vGradient.a)) {\n    gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n    return;\n  }\n\n  if ((vGradient.z >= 0.0) && (vTextureCoord.y <= vGradient.z)) {\n    gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n    return;\n  }\n\n  mediump vec4 texelColor = texture2D(uSampler, coord);\n  mediump float yCoord = (vTextureCoord.y - vSpriteDimensions.y) / vSpriteDimensions.a;\n  mediump float mixFactor = (vGradient.x * (1.0 - yCoord)) + (vGradient.y * yCoord);\n\n  mediump float lightness = (0.2126 * texelColor.r + 0.7152 * texelColor.g + 0.0722 * texelColor.b);\n  if (vOverrideColor.a >= 1.0 && vOverrideColor.a <= 2.0) {\n    mediump float overrideLightness = (0.2126 * vOverrideColor.r + 0.7152 * vOverrideColor.g + 0.0722 * vOverrideColor.b);\n    texelColor = mix(texelColor, vec4(vOverrideColor.rgb * (lightness + overrideLightness), texelColor.a), vOverrideColor.a - 1.0);\n  }\n  if (vOverrideColor.a == 6.0) {\n    texelColor = vec4(vOverrideColor.rgb, texelColor.a);\n  }\n  if (vOverrideColor.a >= 4.0 && vOverrideColor.a <= 5.0) {\n    vec3 texelHSV = rgb2hsv(texelColor.rgb);\n    if ((texelHSV.x < .84) && (texelHSV.x > .82)) {\n      vec3 overrideHSV = rgb2hsv(vOverrideColor.rgb);\n      texelHSV.x = overrideHSV.x;\n      texelHSV.y *= overrideHSV.y;\n      texelHSV.z *= overrideHSV.z;\n      vec3 texelRGB = hsv2rgb(texelHSV);\n      texelColor = mix(texelColor, vec4(texelRGB.rgb, texelColor.a), vOverrideColor.a - 4.0);\n    }\n  }\n\n  mediump float lightnessBase = (0.2126*vColor.r + 0.7152*vColor.g + 0.0722*vColor.b);\n  mediump vec4 baseColor = vec4(vColor.rgb, texelColor.a) * (1.0 + (lightness - lightnessBase));\n  mediump vec4 mixColor = vec4(\n    (baseColor.rgba * mixFactor) + (texelColor.rgba * (1.0 - mixFactor))\n  );\n\n  if (vColor.a > 1.0) {\n    mixColor.rgb = vColor.rgb;\n  }\n\n  gl_FragColor = vec4(\n    mixColor.rgb * vColor.a * texelColor.a * vTextureCoord.z,\n    texelColor.a * vTextureCoord.z\n  );\n}\n\n"},function(t,e,i){"use strict";(function(t){i.d(e,"a",(function(){return l}));var n=i(145),r=i(154),a=i(155),o=i(161),s=i(162);const l=e=>{let i;return async l=>{const c=Math.random();i=c;const h={currentScript:()=>i===c};if([n.a,a.a,o.a,r.a,s.a].forEach(t=>{return Object.assign(h,(i=t(h,e),n=e,Object.entries(i).reduce((t,[e,i])=>(t[e]="function"==typeof i?(...t)=>{if(!0===n.gameEnded)throw new Error("Game Over");return i(...t)}:i,t),{})));var i,n}),!0!==e.gameEnded){t.one("EndGame",()=>{i=null,e.gameEnded=!0,t.trigger("GameOver")});try{return await l(h)}finally{h.closeScript()}}}}}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var n=i(146),r=i(151),a=i(3);e.a=()=>({loadSpriteSheets:async e=>new Promise(i=>{const r={sprites:{}};n.a.filter(t=>e.includes(t.name)).forEach(t=>{r.sprites[t.image]=t.map}),t.load(r,i)}),loadAudio:async t=>Promise.all(t.map(t=>r.a.find(e=>e.name===t)).filter(Boolean).map(t=>a.a.loadAudio(t)))})}).call(this,i(0).default)},function(t,e,i){"use strict";var n=i(147),r=i.n(n),a=i(148),o=i(149),s=i.n(o),l=i(150);const c=[{name:"mega-texture",image:s.a,map:l},{name:"dino",image:r.a,map:a}];e.a=c},function(t,e,i){t.exports=i.p+"assets/c3ce4b75f71b356ea1b50ab501f75690.png"},function(t){t.exports=JSON.parse('{"tile":32,"tileh":32,"map":{"backgroundPlanet":[10,0,8,8],"dinoHead":[0,0,3,2],"dinoBody":[3,0,5,4],"dinoArm":[1,4,2,2],"dinoNeck":[3,4,2,2],"dinoJaw":[0,2,3,2],"dinoTail":[2,6,4,2],"dinoUpperLeg":[5,4,2,2],"dinoLowerLeg":[1,6,1,2],"dinoFeet":[0,6,1,1],"dinoToes":[0,5,1,1],"dinoTongue":[0,4,1,1],"dinoBackFeet":[0,7,1,1],"dinoBackUpperLeg":[6,6,2,2],"dinoBackLowerLeg":[7,4,1,2],"dinoBackToes":[8,4,1,1],"dinoTentacles":[8,0,2,1]}}')},function(t,e,i){t.exports=i.p+"assets/97baa0ed1f3e0f09de00f1e4c80ec2be.png"},function(t){t.exports=JSON.parse('{"tile":32,"tileh":32,"map":{"waterHorizon":[0,17,8,5],"waterMiddle":[32,0,16,6],"waterFront1":[0,29,16,3],"waterFront2":[16,29,16,3],"coastStart":[18,12,8,1],"coast":[8,17,8,1],"cityBridge":[0,24,16,5],"cityStart":[0,0,16,9],"city":[16,0,16,9],"cityLayer2":[0,9,12,8],"cityDistance":[32,6,8,7],"cityDistanceBaseBottom":[32,9,8,4],"cityDistanceBaseTop":[40,6,8,7],"bigBuildingTop":[16,13,13,6],"bigBuildingBrokenTop":[30,13,13,6],"bigBuildingLayer":[16,19,13,4],"bigBuildingBottom":[16,23,13,6],"bigBuildingBottom2":[30,23,13,6],"glass":[12,9,4,3],"cloud":[16,9,8,3],"shadow":[16,12,2,1],"bridgeDeck":[0,32,16,6],"damagedBridgeDeck":[16,32,16,6],"bridgePillar":[36,29,6,17],"bridgePillarBroken":[42,29,6,17],"bigGlare":[0,38,7,7],"sun":[12,13,3,3],"chute":[12,12,1,1],"directGlare":[8,18,6,6],"aircraftCarrierEnd":[30,43,6,5],"aircraftCarrierStart":[19,43,6,5],"aircraftCarrierBottomFlat":[22,45,4,3],"aircraftCarrierBottomSpace":[26,45,4,3],"aircraftCarrierTopFlat":[26,43,4,2],"aircraftCarrierClosed":[8,44,3,3],"aircraftCarrierDoor":[11,44,1,3],"aircraftCarrier5":[14,42,1,1],"aircraftCarrier7":[14,41,1,1],"aircraftCarrierEngine":[15,41,3,3],"aircraftCarrierEngineDestroyed":[15,38,3,3],"aircraftCarrierEngineMeter":[14,43,1,1],"aircraftCarrierOpenHatch":[31,38,4,1],"aircraftCarrierHatchLid":[31,39,4,1],"aircraftCarrierLowCabin":[17,46,1,2],"aircraftCarrierLowCabinStart":[18,46,1,2],"aircraftCarrierCabinStart":[7,38,1,6],"aircraftCarrierCabinRadar":[8,38,2,6],"aircraftCarrierCabin":[10,38,2,6],"aircraftCarrierCabinEnd":[12,38,2,6],"aircraftCarrierCabinStartBroken":[18,39,1,4],"aircraftCarrierCabinRadarBroken":[19,39,2,4],"aircraftCarrierCabinBroken":[21,39,2,4],"aircraftCarrierCabinEndBroken":[23,39,2,4],"aircraftCarrierRadar":[26,38,2,2],"aircraftCarrierRadarBroken":[26,40,2,2],"aircraftCarrierRadarEmit":[23,38,2,1],"aircraftCarrierAntenna":[29,38,2,3],"aircraftCarrierWires":[25,38,1,1],"aircraftCarrierHole":[22,38,1,1],"boxes":[28,39,1,1],"boxesFalling":[28,38,1,1],"debris1":[44,13,4,4],"stars":[44,17,21,9],"playerShip":[0,48,3,2],"playerShipTurning":[0,46,3,2],"playerShipDamaged":[0,50,3,2],"playerShipDamagedTurning":[3,46,3,2],"playerShipFront":[6,49,3,2],"muzzleFlash":[10,48,1,1],"shipEngineFire":[4,53,3,1],"freddie":[3,49,3,2],"standardMine":[3,51,1,1],"mineOpening1":[4,51,1,1],"mineOpening2":[5,51,1,1],"mineBlink":[6,51,1,1],"standardDrone":[0,52,2,2],"standardDroneDamage":[2,52,2,2],"standardRocket":[4,52,2,1],"helicopter":[0,54,4,2],"helicopter2":[4,54,4,2],"heliDamaged":[8,54,4,2],"helicopterLanded":[12,56,4,2],"helicopterTurning1":[16,56,2,2],"helicopterTurning2":[18,56,2,2],"helicopterGun":[12,54,1,1],"standardLargeDrone":[0,56,3,3],"standardLargeDroneDamage1":[3,56,3,3],"standardLargeDroneDamage2":[6,56,3,3],"standardLargeDroneDamage3":[9,56,3,3],"rapidFireBoost":[11,48,1,1],"speedBoost":[12,48,1,1],"damageBoost":[13,48,1,1],"aimBoost":[14,48,1,1],"heart":[13,49,1,1],"star":[14,49,1,1],"upgrade":[15,49,1,1],"powerUpBox":[10,49,1,1],"powerUpBox2":[11,49,1,1],"powerUpBox3":[12,49,1,1],"sphere1":[7,51,1,1],"sphere2":[8,51,1,1],"lightBullet":[9,51,1,1],"laserTank":[0,59,6,3],"laserTankBarrel":[6,59,4,2],"bulletCannon":[13,55,3,1],"mineCannon":[11,51,2,1],"turretFoot":[12,55,1,1],"general1":[16,48,4,4],"general2":[20,48,4,4],"pilot1":[16,52,4,4],"pilot2":[20,52,4,4],"shield":[10,59,4,4],"explosion1":[24,48,3,3],"explosion2":[27,48,3,3],"explosion3":[30,48,3,3],"explosion4":[33,48,3,3],"explosion5":[36,48,3,3],"explosion6":[24,51,3,3],"explosion7":[27,51,3,3],"explosion8":[30,51,3,3],"explosion9":[33,51,3,3],"explosion10":[36,51,3,3],"explosion11":[24,54,3,3],"explosion12":[27,54,3,3],"explosion13":[30,54,3,3],"explosion14":[33,54,3,3],"explosion15":[36,54,3,3],"explosion16":[24,57,3,3],"explosion17":[27,57,3,3],"explosion18":[30,57,3,3],"explosion19":[33,57,3,3],"explosion20":[36,57,3,3],"laserGunCore":[10,50,2,1],"laserGunHandle":[11,50,2,1],"laserGunBarrel":[13,50,3,1],"bulletShell":[13,12,1,1],"clothBottom":[12,47,5,1],"cloth":[12,44,5,3]}}')},function(t,e,i){"use strict";var n=i(152),r=i.n(n),a=i(153);const o=[{name:"effects",file:i.n(a).a,map:[{name:"explosion",type:"sfx",duration:629},{name:"gun-shot",type:"sfx",duration:295},{name:"hatch-open",type:"sfx",duration:1126,volume:.4},{name:"helicopter",type:"sfx",duration:409,loop:!0,volume:.4},{name:"laser-charge",type:"sfx",duration:1674,volume:.3},{name:"laser-fire",type:"sfx",duration:1725,volume:1.2},{name:"laser-hit",type:"sfx",duration:267},{name:"laser-shot",type:"sfx",duration:453,volume:.2},{name:"laugh",type:"sfx",duration:1695},{name:"powerup",type:"sfx",duration:906}]},{name:"hero",file:r.a,map:[{name:"hero",type:"music",loop:!0,loopEnd:180+55.682,loopStart:69.862}]}];e.a=o},function(t,e,i){t.exports=i.p+"assets/0876ed9d8d684d6b64a045aec617fce9.mp3"},function(t,e,i){t.exports=i.p+"assets/c19eaa5b6c377475cee4b91eeecbd883.ogg"},function(t,e,i){"use strict";(function(t){e.a=(e,i)=>{const n=(t,...e)=>t(...e),r=n=>{const r=Math.floor(n/40);return new Promise((n,a)=>t.e("Delay").delay(()=>{e.currentScript()||n(),!0===i.gameEnded&&a(new Error("Game Over"))},40,r,(function(){n(),this.destroy()})))};return{until:async(t,i)=>{let n=!1,r=0;for(t(e).then(()=>{n=!0});!n;)await i(e,r),r++},waitWhile:async(t,...e)=>{let i=await n(t,...e);for(;i;)await r(50),i=await n(t,...e)},waitForEvent:(t,e,i)=>new Promise((n,r)=>{const a=()=>{n()};t.one("Remove",a),t.one("GameOver",a),t.one(e,async()=>{t.unbind("Remove",a),t.unbind("GameOver",a);try{await i()}catch(t){return void r(t)}n()})}),wait:r,exec:async(t,...i)=>{await t(e,...i)},parallel:t=>Promise.all(t.map(t=>t())),race:t=>Promise.race(t.map(t=>t())),call:n}}}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var n=i(156),r=i(28),a=i(15),o=i(35),s=i(4),l=i(19),c=i(31),h=i(160),u=i(45),d=i(1);const p=new n.Noise(Object(h.a)());e.a=e=>({trauma:{value:0,time:0,handler:null},addScreenTrauma:i=>{e.trauma.value+=i,e.trauma.value>0&&null===e.trauma.handler&&(e.trauma.handler=({dt:i})=>{const n=e.trauma.value*e.trauma.value;e.trauma.value=Math.max(0,e.trauma.value-.001*i);let r=0,a=0;if(n>0){e.trauma.time+=i;const t=p.perlin2(.1,e.trauma.time/(360*(3-e.trauma.value))),o=p.perlin2(e.trauma.time/(360*(3-e.trauma.value)),.3);r=0+Math.round(30*n*t),a=0+Math.round(15*n*o)}t.viewport.x=r,t.viewport.y=a,0===n&&(t.unbind("GameLoop",e.trauma.handler),e.trauma.handler=null)},t.bind("GameLoop",e.trauma.handler))},setScrollingSpeed:async(e,i,{speed:n=50,instant:a=!1}={})=>{const s=Object(r.a)("Scenery")||t.e("Scenery, 2D");return a?s.setScrollVelocity({vx:-e,vy:i}):new Promise(r=>{const a=n/1e3,{vx:l,vy:c}=Object(o.c)(),h=Math.abs(i-c),u=Math.abs(e- -l),p=Math.max(u,h),f=new t.easing(p/a,d.b),m=({dt:n})=>{f.tick(n);const a=f.value();a>=1&&(t.unbind("GameLoop",m),r());const o=c*(1-a)+i*a,h=-l*(1-a)+e*a;s.setScrollVelocity({vx:-h,vy:o})};t.bind("GameLoop",m)})},setAltitude:async(e,{speed:i=50,instant:n=!1}={})=>n?Object(o.d)(e):new Promise(n=>{const r=i/1e3,a=Object(o.a)(),s=Math.abs(e-a),l=new t.easing(s/r,d.b),c=({dt:i})=>{l.tick(i);const r=l.value();r>=1&&(t.unbind("GameLoop",c),n());const s=a*(1-r)+e*r;Object(o.d)(s)};t.bind("GameLoop",c)}),setScenery:async t=>{Object(o.e)(t)},waitTillInScreen:(t,e)=>Object(o.b)(t,e),setBackground:async(t,e,i)=>{Object(c.b)(Object(s.a)(t)),void 0!==i&&Object(c.d)(i),void 0!==e&&0===Object(c.a)()&&Object(c.c)(e)},setGameSpeed:l.b,fadeIn:a.b,fadeOut:a.c,setBackgroundCheckpointLimit:async t=>{Object(c.d)(t)},setBackgroundCheckpoint:async t=>{Object(c.a)()<t&&Object(c.c)(t)},playAnimation:(t,e)=>Object(u.b)(Object(s.a)(t),e)})}).call(this,i(0).default)},function(t,e,i){!function(t){function e(t){function e(t,e,i){this.x=t,this.y=e,this.z=i}e.prototype.dot2=function(t,e){return this.x*t+this.y*e},e.prototype.dot3=function(t,e,i){return this.x*t+this.y*e+this.z*i},this.grad3=[new e(1,1,0),new e(-1,1,0),new e(1,-1,0),new e(-1,-1,0),new e(1,0,1),new e(-1,0,1),new e(1,0,-1),new e(-1,0,-1),new e(0,1,1),new e(0,-1,1),new e(0,1,-1),new e(0,-1,-1)],this.p=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],this.perm=new Array(512),this.gradP=new Array(512),this.seed(t||0)}e.prototype.seed=function(t){t>0&&t<1&&(t*=65536),(t=Math.floor(t))<256&&(t|=t<<8);for(var e=this.p,i=0;i<256;i++){var n;n=1&i?e[i]^255&t:e[i]^t>>8&255;var r=this.perm,a=this.gradP;r[i]=r[i+256]=n,a[i]=a[i+256]=this.grad3[n%12]}};var i=.5*(Math.sqrt(3)-1),n=(3-Math.sqrt(3))/6,r=1/6;function a(t){return t*t*t*(t*(6*t-15)+10)}function o(t,e,i){return(1-i)*t+i*e}e.prototype.simplex2=function(t,e){var r,a,o=(t+e)*i,s=Math.floor(t+o),l=Math.floor(e+o),c=(s+l)*n,h=t-s+c,u=e-l+c;h>u?(r=1,a=0):(r=0,a=1);var d=h-r+n,p=u-a+n,f=h-1+2*n,m=u-1+2*n;s&=255,l&=255;var y=this.perm,g=this.gradP,v=g[s+y[l]],_=g[s+r+y[l+a]],x=g[s+1+y[l+1]],b=.5-h*h-u*u,w=.5-d*d-p*p,C=.5-f*f-m*m;return 70*((b<0?0:(b*=b)*b*v.dot2(h,u))+(w<0?0:(w*=w)*w*_.dot2(d,p))+(C<0?0:(C*=C)*C*x.dot2(f,m)))},e.prototype.simplex3=function(t,e,i){var n,a,o,s,l,c,h=(t+e+i)*(1/3),u=Math.floor(t+h),d=Math.floor(e+h),p=Math.floor(i+h),f=(u+d+p)*r,m=t-u+f,y=e-d+f,g=i-p+f;m>=y?y>=g?(n=1,a=0,o=0,s=1,l=1,c=0):m>=g?(n=1,a=0,o=0,s=1,l=0,c=1):(n=0,a=0,o=1,s=1,l=0,c=1):y<g?(n=0,a=0,o=1,s=0,l=1,c=1):m<g?(n=0,a=1,o=0,s=0,l=1,c=1):(n=0,a=1,o=0,s=1,l=1,c=0);var v=m-n+r,_=y-a+r,x=g-o+r,b=m-s+2*r,w=y-l+2*r,C=g-c+2*r,k=m-1+.5,S=y-1+.5,D=g-1+.5;u&=255,d&=255,p&=255;var z=this.perm,F=this.gradP,A=F[u+z[d+z[p]]],P=F[u+n+z[d+a+z[p+o]]],E=F[u+s+z[d+l+z[p+c]]],O=F[u+1+z[d+1+z[p+1]]],T=.5-m*m-y*y-g*g,M=.5-v*v-_*_-x*x,B=.5-b*b-w*w-C*C,R=.5-k*k-S*S-D*D;return 32*((T<0?0:(T*=T)*T*A.dot3(m,y,g))+(M<0?0:(M*=M)*M*P.dot3(v,_,x))+(B<0?0:(B*=B)*B*E.dot3(b,w,C))+(R<0?0:(R*=R)*R*O.dot3(k,S,D)))},e.prototype.perlin2=function(t,e){var i=Math.floor(t),n=Math.floor(e);t-=i,e-=n,i&=255,n&=255;var r=this.perm,s=this.gradP,l=s[i+r[n]].dot2(t,e),c=s[i+r[n+1]].dot2(t,e-1),h=s[i+1+r[n]].dot2(t-1,e),u=s[i+1+r[n+1]].dot2(t-1,e-1),d=a(t);return o(o(l,h,d),o(c,u,d),a(e))},e.prototype.perlin3=function(t,e,i){var n=Math.floor(t),r=Math.floor(e),s=Math.floor(i);t-=n,e-=r,i-=s,n&=255,r&=255,s&=255;var l=this.perm,c=this.gradP,h=c[n+l[r+l[s]]].dot3(t,e,i),u=c[n+l[r+l[s+1]]].dot3(t,e,i-1),d=c[n+l[r+1+l[s]]].dot3(t,e-1,i),p=c[n+l[r+1+l[s+1]]].dot3(t,e-1,i-1),f=c[n+1+l[r+l[s]]].dot3(t-1,e,i),m=c[n+1+l[r+l[s+1]]].dot3(t-1,e,i-1),y=c[n+1+l[r+1+l[s]]].dot3(t-1,e-1,i),g=c[n+1+l[r+1+l[s+1]]].dot3(t-1,e-1,i-1),v=a(t),_=a(e),x=a(i);return o(o(o(h,f,v),o(u,m,v),x),o(o(d,y,v),o(p,g,v),x),_)},t.Noise=e}(t.exports)},function(t,e,i){"use strict";(function(t){i.d(e,"a",(function(){return l}));var n=i(158),r=i.n(n);const a=t=>{const e=t.length,i=[],n=[null];let r=2;i.push(t[0]/r);for(let a=1;a<e;a++)n.push(1/r),r=a<e-1?4:3.5,r-=n[a],i.push((t[a]-i[a-1])/r);for(let t=1;t<e;t++)i[e-t-1]-=n[e-t]*i[e-t];return i};class o{constructor(t){this.points=t,this.curves=[];const e=(t=>{const e=t.length-1;if(e<1)return[];let i,n;if(1===e)return i=[{x:(2*t[0].x+t[1].x)/3,y:(2*t[0].y+t[1].y)/3}],n=[{x:2*i[0].x-t[0].x,y:2*i[0].y-t[0].y}],[i,n];const r=[],o=[];for(let i=1;i<e-1;i++)r.push(4*t[i].x+2*t[i+1].x),o.push(4*t[i].y+2*t[i+1].y);r.unshift(t[0].x+2*t[1].x),o.unshift(t[0].y+2*t[1].y),r.push((8*t[e-1].x+t[e].x)/2),o.push((8*t[e-1].y+t[e].y)/2);const s=a(r),l=a(o);i=[],n=[];for(let r=0;r<e;r++)i.push({x:s[r],y:l[r]}),r<e-1?n.push({x:2*t[r+1].x-s[r+1],y:2*t[r+1].y-l[r+1]}):n.push({x:(t[e].x+s[e-1])/2,y:(t[e].y+l[e-1])/2});return[i,n]})(t);for(let i=0;i<t.length-1;i++){const n=t[i],a=t[i+1],o=e[0][i],s=e[1][i],l=new r.a(n.x,n.y,o.x,o.y,s.x,s.y,a.x,a.y);this.curves.push({curve:l,length:l.length()})}let i=0;this.curves.forEach(t=>{t.min=i/this.length,i+=t.length,t.max=i/this.length})}get length(){return this.curves.reduce((t,e)=>t+e.length,0)}getLUT(t){const e=Math.ceil(this.length/t);return this.curves.map(t=>{const i=Math.ceil(t.length/e);return t.curve.getLUT(i)}).reduce((t,e)=>t.concat(e),[])}get(t){const e=this.curves.find(e=>e.min<=t&&e.max>=t);if(!e)return null;const i=(t-e.min)/(e.max-e.min);return e.curve.get(i)}rotationAt(t){const e=this.curves.find(e=>e.min<=t&&e.max>=t),i=(t-e.min)/(e.max-e.min),n=e.curve.derivative(i);return 180*Math.atan2(n.y,n.x)/Math.PI}}const s={},l=t=>{const e=t.map(t=>`${t.x}|${t.y}|`).join();return s[e]=s[e]||new o(t),s[e]}}).call(this,i(0).default)},function(t,e,i){t.exports=i(116)},function(t,e,i){"use strict";(function(t){t.c("StackableCoordinates",{required:"2D",init(){this.stackableProps={},this.propertyStacks={},this.uniqueBind("Move",this._updateBaseCoords)},createStackablePropertyFor(e,i){void 0===this.stackableProps[e]&&(this.propertyStacks[i]?this.propertyStacks[i]=this.propertyStacks[i].concat(e):(this.propertyStacks[i]=[i,e],this.stackableProps[i]=this[i]),this.stackableProps[e]=0,t.defineField(this,e,()=>this.stackableProps[e],t=>{this.stackableProps[e]=t,this.recalculateStackableProp(i)}))},recalculateStackableProp(t){this._stackRecalc=!0,this[t]=this.propertyStacks[t].reduce((t,e)=>t+this.stackableProps[e],0),this._stackRecalc=!1},applyStackableProperty(t,e){this._stackRecalc=!0,this.stackableProps[e]+=this.stackableProps[t],this.stackableProps[t]=0,this._stackRecalc=!1},_updateBaseCoords(t){this._stackRecalc||(this.stackableProps.x+=this.x-t._x,this.stackableProps.y+=this.y-t._y)}}),e.a="StackableCoordinates"}).call(this,i(0).default)},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));let n=null;const r=[];for(n=1e6;n--;)r.push(Math.random());const a=()=>++n>=r.length?r[n=0]:r[n]},function(t,e,i){"use strict";(function(t){var n=i(1),r=i(26),a=i(4);i(94);const o=(e,i,n,r,a)=>{e.addComponent("WayPointMotion");const o=n||e.defaultVelocity;e.flyPattern(i,{velocity:o,easing:r});let s=null;return{wasCompleted:()=>s,process:new Promise((i,n)=>{const r=o=>{s=o&&o.patternCompleted,e.unbind("PatternCompleted",r),e.unbind("PatternAborted",r),t.unbind("GameOver",r),!0===a.gameEnded&&n(new Error("Game Over")),i()};e.one("PatternCompleted",r),e.one("PatternAborted",r),t.one("GameOver",r)}),abort:()=>e.stopFlyPattern()}};e.a=(e,i)=>({spawn:(t,e)=>Object(r.b)(t,e),displayFrame:(t,e,i,r=n.d)=>t.displayFrame(e,i,r),showState:(t,e,i,r=n.d)=>t.showState(e,i,r),showAnimation:(t,e)=>t.playAnimation(e),allowDamage:(t,e)=>{t.addCollisionComponent("DamageSupport",["processDamage"]),t.allowDamage(e)},moveWithPattern:(t,e,r=null,s=n.d)=>{const l=Object(a.e)(e);return o(t,l.path,r,s,i)},moveTo:(e,r,a=null,s=n.d)=>{const l=t.viewport.width,c=t.viewport.height,h=e.x/l,u=e.y/c,d=[{x:h,y:u},{x:h,y:u,...r}];return o(e,d,a,s,i)}})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var n=i(8),r=i(163),a=i(47);let o=[];t.bind("SceneDestroy",()=>o=[]);e.a=(e,i)=>{const s=(t("HUDLives").get(0)||t.e("2D, HUDLives, UILayerDOM, Text, HUD, "+n.a).attr({x:20,y:-10,w:100,alpha:0}).textColor("#FFFF00").textAlign("left").textFont({size:"8px",weight:"bold",family:"Press Start 2P"})).text("Lives: "+i.lives),l=t("HUDHealth").get(0)||t.e(`2D, HUDHealth, UILayerWebGL, HUD, ${r.a}, ${n.a}`).attr({x:150,y:-10,w:120,h:5,alpha:0,maxWidth:120});t("HUDHealthBar").get(0)||t.e("2D, HUDHealthBar, UILayerWebGL, Color, HUD, "+n.a).attr({x:149,y:-11,w:122,h:7,z:-1,alpha:0,baseAlpha:.6}).color("#000000");const c=(t("HUDScore").get(0)||t.e("2D, HUDScore, UILayerDOM, Text, HUD, "+n.a).attr({x:800,y:-10,w:220,alpha:0,score:0,displayScore:0}).textColor("#FFFF00").textAlign("left").textFont({size:"8px",weight:"bold",family:"Press Start 2P"})).text((function(){return this.score>this.displayScore+200?(this.displayScore+=10,this.textFont({size:"9px"}).textColor("#FFFF80")):this.score>this.displayScore+100?(this.displayScore+=5,this.textFont({size:"9px"}).textColor("#FFFF40")):this.score>this.displayScore&&(this.displayScore+=1,this.textFont({size:"8px"})),"Score: "+this.displayScore})).dynamicTextGeneration(!0,"GameLoop"),h=(t("HUDMultiplier").get(0)||t.e("2D, HUDMultiplier, UILayerDOM, Text, HUD, "+n.a).attr({x:800,y:10,w:220,alpha:0}).textColor("#FFFF00").textAlign("left").textFont({size:"8px",weight:"bold",family:"Press Start 2P"})).text(`Bonus: ${Object(a.a)()}x`);t.bind("MultiplierChange",()=>h.text(`Bonus: ${Object(a.a)()}x`));const u=[],d=()=>{e.closeScript(),Object(a.c)()};t.one("SceneDestroy",d),e.closeScript=()=>{t.unbind("SceneDestroy",d),t.unbind("MultiplierChange"),u.forEach(t=>t())};const p=async(e,i,r)=>{const a=(()=>{const e=o.find(t=>t.__frozen);if(e)return e.unfreeze(),e.attr({alpha:1});const i=t.e("2D, Text, DOM, "+n.a).attr({z:400,alpha:1,w:300}).textColor("#EEEEEE").textAlign("left").textFont({size:"12px",weight:"bold",family:"Press Start 2P"});return o=o.concat(i),i})().attr({x:i,y:r}).text(e);await a.tweenPromise({y:r-40,alpha:0},1e3),a.freeze()};return{onScriptClose:t=>{u.push(t)},setHealthbar:t=>{l.attr({health:t})},loseLife:()=>{if(i.lives-=1,i.lives<0)throw i.gameEnded=!0,t.trigger("GameOver"),new Error("Game Over");s.text("Lives: "+i.lives)},gainLife:()=>{i.lives+=1,s.text("Lives: "+i.lives)},awardPoints:async(t,n,r,o=!0)=>{i.score+=t,c.attr({score:i.score}),o&&Object(a.d)(t,n,r,e),await p("+"+t,n,r)},awardText:p,playerHit:a.b,showHUD:()=>{if(!0===i.hudShown)return;i.hudShown=!0;const e=[];return t("HUD").each((function(){this.tweenPromise&&e.push(this.tweenPromise({alpha:void 0===this.baseAlpha?1:this.baseAlpha,y:this.y+20},500))})),Promise.all(e)},hideHUD:()=>{if(!0!==i.hudShown)return;i.hudShown=!1;const e=[];return t("HUD").each((function(){this.tweenPromise&&e.push(this.tweenPromise({alpha:0,y:this.y-20},500))})),Promise.all(e)}}}}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){t.c("Health",{required:"Color",events:{EnterFrame(){}},properties:{health:{set:function(t){this._health=t,this.w=Math.min(this.maxWidth,this.maxWidth*t),this._green=144*this._health,this._red=144*(1-this._health),this.trigger("Invalidate")},get:function(){return this._health},configurable:!0,enumerable:!0},_health:{value:1,writable:!0,enumerable:!1}},init(){this.color(0,144,0)}}),e.a="Health"}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var n=i(2),r=i(96),a=i(13),o=i(6),s=i(3),l=i(7);const c=t=>async({showState:e,allowDamage:i,waitForEvent:n,call:r,awardPoints:a})=>{await i(t,{health:30}),n(t,"Dead",async()=>{a(25,t.x,t.y),e(t,"falling"),await r(t.activateGravity,"GravityLiquid")})};e.a=async({setScrollingSpeed:e,setScenery:i,loadSpriteSheets:h,loadAudio:u,setBackground:d,playAnimation:p,setAltitude:f,showHUD:m,parallel:y,exec:g,onScriptClose:v,fadeIn:_,wait:x})=>{const b=Object(o.a)("Loading...");b.fadeIn(2e3),await h(["mega-texture"]),await u(["effects","hero"]),s.a.playAudio("hero");const w=s.a.playAudio("helicopter",{volume:0});v(()=>{w.stop()}),await e(150,0,{instant:!0}),await i("City.Ocean"),d("City.Sunrise",0,2);const C=_();b.remove();const k=p("City.Intro"),S=t("IntroShip").get(0);g(c(S.boxLocation1)),g(c(S.boxLocation2)),await C.start(1e3),await y([()=>Object(l.a)("General","Let us escort you to the factory to install\nthe AI controlled defence systems. You are the last ship.",{portrait:"portraits.general"}),async()=>{await k.waitTillCheckpoint(1),w.setVolume(2,1500)},async()=>{await k.waitTillCheckpoint(3),w.setVolume(.6,3e3),g(Object(a.a)({existing:!0}))}]),m();const D=Object(o.a)("Get ready",{color:"#FF0000"}),z=D.blink(200,4);let F;await e(350,0),await y([async()=>{await k.waitTillEnd()},async()=>{await z,await D.zoomOut(500),D.remove(),F=g(Object(r.a)({existing:!0})),await y([async()=>{await Object(l.a)("General","We send some drones for some last manual target practice",{portrait:"portraits.general"}),await Object(l.a)("John","Let's go!",{portrait:"portraits.pilot"})},async()=>{await y([()=>g(Object(n.a)(2,"drone.straight",{delay:300,yOffset:.1})),async()=>{await x(1500),await g(Object(n.a)(2,"drone.straight",{delay:300,yOffset:-.1}))},async()=>{await x(3e3),await g(Object(n.a)(2,"drone.straight",{delay:300,yOffset:-.3}))}]),await g(Object(n.a)(5,"drone.pattern1")),await g(Object(n.a)(8,"drone.pattern2"))}])}]),k.destroy(),f(200),await g(Object(n.a)(5,"drone.pattern1")),await g(Object(n.a)(8,"drone.pattern2")),await Object(l.a)("John","Well that was fun. I will miss the manual mode..",{portrait:"portraits.pilot"}),await F,g(Object(r.b)({existing:!0},w)),await Object(l.a)("General","What is that!",{portrait:"portraits.general"}),await Object(l.a)("General","Evacuate! now!",{portrait:"portraits.general"}),await x(1e3);const A=Object(o.a)("Hacked",{color:"#FFFFFF",sup:"Chapter 1:"});await y([()=>Object(l.a)("General","The helicopter is out of control!",{portrait:"portraits.general"}),async()=>{await x(2e3),await A.fadeIn(500),await x(2e3),await A.fadeOut(500)}]),A.remove(),await y([()=>g(Object(n.a)(5,"drone.pattern3")),()=>g(Object(n.a)(5,"drone.pattern4"))]),await y([()=>g(Object(n.a)(5,"drone.pattern3")),()=>g(Object(n.a)(5,"drone.pattern4"))])}}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var n=i(6),r=i(2),a=i(7),o=i(22),s=i(3),l=i(1);const c=t=>async({awardPoints:e,showState:i,waitForEvent:n,allowDamage:r})=>{const a=n(t,"Dead",async()=>{e(200,t.x+20,t.y),i(t,"dead"),t.clearCollisionComponents()});t.addCollisionComponent("SolidCollision").addCollisionComponent("PlayerEnemy"),r(t,{health:750}),i(t,"shooting"),await a},h=e=>async({showState:i,waitForEvent:n,allowDamage:r,race:a,awardPoints:o,until:s})=>{const c=e.mineCannon;c.addCollisionComponent("SolidCollision").addCollisionComponent("PlayerEnemy");const h=n(c,"Dead",async()=>{o(250,c.x,c.y),i(c,"dead"),c.clearCollisionComponents()});await a([async()=>{await r(c,{health:1200});let e=!0;await s(()=>h,async({exec:i})=>{await i(((e,i)=>async({spawn:n,moveWithPattern:r,moveTo:a,addScreenTrauma:o,wait:s,waitForEvent:c,showState:h,allowDamage:u,race:d})=>{await h(e,i?"aimHigh":"aimLow");const p=e.currentAttachHooks.gun;if(!e.hasHealth())return;const f=n("Mine",{location:{x:p.x,y:p.y},defaultVelocity:350}).attr({z:p.z});c(f,"Loose",async()=>{f.attr({z:f.z+30})});const m=r(f,i?"mineCannon.highShot":"mineCannon.lowShot",null,l.c);await h(e,"shoot"),m.process.then(async()=>{await u(f,{health:40});const e=t("PlayerShip").get(0);let i;i=a(f,{y:1}),await i.process,i=a(f,{x:e.x/t.viewport.width}),await i.process,i=a(f,{y:e.y/t.viewport.height}),await d([()=>c(f,"Dead",async()=>{i&&i.abort(),"explode"!==f.appliedEntityState&&(h(f,"dead"),o(.3),await s(1e3),f.destroy(),i&&i.abort())}),async()=>{if(await i.process,i.wasCompleted()){if("dead"===f.appliedEntityState)return;await h(f,"open",500),h(f,"blinking"),await s(1e3),"dead"!==f.appliedEntityState&&(h(f,"explode"),o(.3),await s(1e3),f.destroy())}}])})})(c,e)),e=!e})},()=>h])},u=t=>async({wait:e,showState:i,moveTo:n,exec:r,parallel:a})=>{await a([()=>n(t,{y:.65},20,l.b).process,()=>i(t,"risen",2e3),async()=>{await e(1e3),await r(Object(o.a)())}]),await a([()=>n(t,{y:.7},20,l.b).process,()=>i(t,"lowered",2e3)])},d=t=>async({showState:e,wait:i,exec:n,parallel:r})=>{await i(1e3),await r([async()=>{await i(1e3),await n(c(t.deckGun2)),await i(1e3),await e(t,"t3o",2e3),await e(t,"t3r",2e3),await n(c(t.hatch3.payload))},()=>n((t=>async({call:e,wait:i,waitForEvent:n,showState:r,awardPoints:a,allowDamage:o,until:c,moveWithPattern:h})=>{const u=t.heliPlace1,d=s.a.playAudio("helicopter",{volume:.01});d.setVolume(.9,1e3),r(u,"flying"),await i(1e3),await r(u,"tilted",2e3);let p=h(u,"heli.battleship1",150,l.d);n(u,"detach",async()=>{u.detachFromParent()}),n(u,"active",async()=>{u.addCollisionComponent("SolidCollision").addCollisionComponent("PlayerEnemy"),await o(u,{health:500})}),n(u,"Remove",async()=>{d.stop()});const f=n(u,"Dead",async()=>{d.stop(),u.clearCollisionComponents(),p.abort(),a(250,u.x+20,u.y),await r(u,"dead"),u.z=t.z+6,await e(u.activateGravity)});await p.process,await c(()=>f,async()=>{if("dead"===u.appliedEntityState)return i(500);p=h(u,"heli.battleship2c",150,l.d),await p.process})})(t))]),await n(u(t)),await r([async()=>{await e(t,"t2o",1e3),await e(t,"t2r",1e3),await n(c(t.hatch2.payload))},async()=>{await e(t,"t1o",1e3),await e(t,"t1r",1e3),await n(c(t.hatch1.payload))}]),await n(u(t))},p=(e,i)=>async({allowDamage:n,awardText:r,showState:o,waitForEvent:s,wait:l,spawn:c,until:h})=>{const u=c("Upgrade",{location:{x:e,y:i},defaultVelocity:50});await n(u,{health:10});const d=s(u,"Dead",async()=>{const e=t("PlayerShip").get(0);e.hasLaser=!0,r("Laser weapon",u.x,u.y),await o(u,"pickedUp"),await l(2e3),u.destroy(),Object(a.a)(null,`You gained a new weapon! The LASER. Use the ${e.controlName("heavy")} to shoot.`)});await h(()=>d,async({moveWithPattern:t})=>{const e=t(u,"powerup.circles");await e.process}),u.destroy()},f=t=>async({showState:e,allowDamage:i,waitForEvent:n,call:r,awardPoints:a})=>{await i(t,{health:30}),n(t,"Dead",async()=>{a(25,t.x,t.y),e(t,"falling"),await r(t.activateGravity,"GravityLiquid")})};e.a=async({parallel:e,spawn:i,wait:o,showState:u,exec:m,moveTo:y,setBackgroundCheckpointLimit:g,setScrollingSpeed:v})=>{let _;const x=Object(n.a)("Warning!",{color:"#FF0000"});await e([()=>x.blink(500,4),()=>v(150,0),()=>Object(a.a)("John","Battleship approaching!",{portrait:"portraits.pilot"})]),x.remove();const b=i("BattleShip",{location:{rx:1.1,ry:.7},defaultVelocity:85});m(f(b.boxLocation1)),m(f(b.boxLocation2)),_=y(b,{x:.8},null,l.b),await e([()=>_.process,()=>m(h(b))]),await o(1e3),_=y(b,{x:.5},null,l.b),await e([()=>_.process,()=>m((t=>async({exec:e,waitForEvent:i,parallel:n,until:a,showState:o,awardPoints:s,allowDamage:l,wait:h})=>{const u=t.cabin1.radar;u.addCollisionComponent("SolidCollision"),o(u,"pulse"),await l(u,{health:500});let d=10;await n([()=>a(()=>i(u,"Dead",async()=>{s(100,u.x+20,u.y),o(u,"dead"),u.clearCollisionComponents()}),async({exec:t})=>{t(Object(r.a)(2,"drone.pattern2",{points:d})),d=d>0?d-5:0,await h(2e3)}),()=>e(c(t.deckGun1))])})(b))]),g(3),await o(1e3),_=y(b,{x:-.17},null,l.b),await e([()=>_.process,()=>m(d(b))]),await m((t=>async({wait:e,moveTo:i,showState:n,moveWithPattern:r,waitForEvent:a,awardPoints:o,allowDamage:c,call:h,until:u})=>{const d=t.heliPlace2,p=s.a.playAudio("helicopter",{volume:.01});p.setVolume(.9,1e3),n(d,"flying"),await e(1e3),await n(d,"tilted",2e3);let f=r(d,"heli.battleship2a",150,l.d);a(d,"detach",async()=>{d.detachFromParent()}),a(d,"active",async()=>{d.addCollisionComponent("SolidCollision").addCollisionComponent("PlayerEnemy"),await c(d,{health:500})}),a(d,"Remove",async()=>{p.stop()});const m=a(d,"Dead",async()=>{p.stop(),d.clearCollisionComponents(),f.abort(),o(250,d.x+20,d.y),await n(d,"dead"),await h(d.activateGravity)}),y=a(d,"moveShip",async()=>{const e=i(t,{x:-1},120,l.b);await e.process});await f.process,f=r(d,"heli.battleship2b",150,l.d),await y,await f.process,await u(()=>m,async()=>{if("dead"===d.appliedEntityState)return e(500);f=r(d,"heli.battleship2c",150,l.d),await f.process})})(b)),await m((e=>async({allowDamage:i,showState:n,wait:r,parallel:a,setScrollingSpeed:o,moveTo:s,awardPoints:c,exec:h,waitForEvent:u})=>{await r(2e3),await n(e,"packageOpen",1e3,l.b),await r(1e3);const d=e.deckGun3;await n(d,"open",500,l.b);const f=e.engineCore;f.addComponent("SolidCollision"),u(f,"Dead",async()=>{f.clearCollisionComponents(),n(e,"engineTilt"),u(f,"Dead",async()=>{f.clearCollisionComponents(),c(500,f.x+20,f.y),f.removeComponent("SolidCollision"),n(e.laserField,"stopped"),e.laserField.removeComponent("SolidCollision"),n(e,"engineDestroyed")}),await i(e.engineCore,{health:1e3})}),await i(e.engineCore,{health:500}),await i(d,{health:500}),d.addCollisionComponent("SolidCollision");const m=u(d,"Dead",async()=>{d.clearCollisionComponents(),c(250,d.x+20,d.y),n(d,"dead")});await i(d,{health:500}),n(d,"shooting"),await a([async()=>{t("PlayerShip").get(0).trigger("turn"),await r(1e3),await n(e,"engineDoorOpen"),await o(-100,0);const i=s(e,{x:-.9},85,l.b);await i.process},async()=>{await m,h(p(d.x+d.w/2,d.y-d.h))}])})(b)),await e([async()=>{_=y(b,{x:-.7},null,l.b),await _.process},()=>m((t=>async({allowDamage:e,showState:i,addScreenTrauma:n,waitForEvent:r,awardPoints:a,wait:o})=>{const s=t.cabin2;s.addCollisionComponent("SolidCollision");const l=r(s,"Dead",async()=>{a(2e3,s.x+s.w/2,s.y),i(t,"cabin2Explode"),n(.5),await o(2e3),n(.5),s.clearCollisionComponents(),i(t,"cabin2Smoke")});await e(s,{health:500,bulletResistance:.99}),await l,s.removeComponent("SolidCollision")})(b))]),await e([async()=>{_=y(b,{x:-.2},null,l.b),await _.process},()=>m((t=>async({allowDamage:e,showState:i,waitForEvent:n,awardPoints:r,addScreenTrauma:a,exec:o,wait:s})=>{const l=t.cabin1;l.addCollisionComponent("SolidCollision");const c=n(l,"Dead",async()=>{r(2e3,l.x+l.w/2,l.y),i(t,"cabin1Explode"),a(.5),await s(2e3),a(.5),l.clearCollisionComponents(),i(t,"cabin1Smoke")});var h,u;await e(l,{health:500,bulletResistance:.99}),await c,l.removeComponent("SolidCollision"),o((h=l.x+l.w/2,u=l.y-l.h,async({allowDamage:t,showState:e,waitForEvent:i,wait:n,spawn:r,gainLife:a,moveWithPattern:o})=>{const s=r("ExtraLife",{location:{x:h,y:u},defaultVelocity:50});await t(s,{health:10}),i(s,"Dead",async()=>{a(),await e(s,"pickedUp"),await n(2e3),s.destroy()});const l=o(s,"powerup.circles");await l.process,await e(s,"disappear",1e3),s.destroy()}))})(b))]),t("PlayerShip").get(0).trigger("turn"),await v(150,0),e([()=>u(b,"sinking",17e3,l.b),async()=>{_=y(b,{x:-1.7,y:.85},null,l.b),await _.process,b.destroy()}]),await o(4e3)}}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var n=i(6),r=i(13);e.a=async({setScrollingSpeed:e,setScenery:i,loadSpriteSheets:a,loadAudio:o,showHUD:s,showState:l,wait:c,exec:h})=>{const u=Object(n.a)("Loading...");u.fadeIn(2e3),await a(["mega-texture"]),await o(["effects"]),await e(0,0,{instant:!0}),await i("Test.Walls"),s(),u.remove(),h(Object(r.a)({existing:!0,hasLaser:!0}));const d=t("PlayerShip").get(0);await l(d,"turned"),await c(12e4),await l(d,"turned"),await c(3e5)}}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var n=i(53),r=i(17),a=i(3),o=i(168),s=i(29);const l={0:"Off",10:"Max"},c=t=>l[t]||t,h=[{name:"Resume",activate:()=>{setTimeout(()=>Object(r.b)())}},{getName:()=>{const t=Math.round(10*a.a.getEffectsVolume());return`Sound [${c(t)}]`},left:()=>{let t=Math.round(10*a.a.getEffectsVolume());t=Math.max(0,t-1),a.a.setEffectVolume(t/10),Object(s.b)("effectsVolume",t/10)},right:()=>{let t=Math.round(10*a.a.getEffectsVolume());t=Math.min(10,t+1),a.a.setEffectVolume(t/10),Object(s.b)("effectsVolume",t/10)},select:()=>{},deselect:()=>{}},{getName:()=>{const t=Math.round(10*a.a.getMusicVolume());return`Music [${c(t)}]`},left:()=>{let t=Math.round(10*a.a.getMusicVolume());t=Math.max(0,t-1),a.a.setMusicVolume(t/10),Object(s.b)("musicVolume",t/10)},right:()=>{let t=Math.round(10*a.a.getMusicVolume());t=Math.min(10,t+1),a.a.setMusicVolume(t/10),Object(s.b)("musicVolume",t/10)},select:()=>{},deselect:()=>{}},{name:"Restart",spaceAbove:!0,dangerous:!0,activate:()=>{setTimeout(()=>{Object(r.b)(),t.trigger("EndGame",{mode:"restart"}),t.enterScene("Game")})}},{name:"Quit",dangerous:!0,activate:()=>{setTimeout(()=>{Object(r.b)(),t.trigger("EndGame",{mode:"quit"}),t.enterScene("Intro")})}}];t.c("PauseMenu",{required:"UILayerDOM, 2D, Color",events:{Freeze(){this._children.forEach(t=>t.freeze())},Unfreeze(){this._children.forEach(t=>t.unfreeze())}},init(){},showMenu(t){return this.menu?this.menu.attachController(t):this.menuOptions(h,t),this},menuOptions(e,i){this.attr({x:(t.viewport.width-400)/2,w:400,alpha:.6,z:200}).color("#222222");let r=70;return Object(n.a)("Game paused",this,20),this.menu=t.e(o.a).attr({x:this.x,w:this.w,y:this.y+70,z:this.z+1}).menu(e,i),this.attach(this.menu),r+=this.menu.h+10,Object(n.a)("version: 2.1.5",this,r,"#eeeeee","8px"),r+=20,this.attr({y:(t.viewport.height-r)/2,h:r}),this}}),e.a="PauseMenu"}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var n=i(53);const r=(t,e)=>t?e?"#FF0000":"#FFFF00":e?"#FF6666":"#999999",a=t=>t.getName?t.getName():t.name,o=(t,e)=>{const i=t.item[e];if(!i)return;i();const n=a(t.item);t.text(n)};t.c("Menu",{required:"2D",events:{Freeze(){this._detachController&&(this._detachController(),this._detachController=null),this._children.forEach(t=>t.freeze())},Unfreeze(){this._children.forEach(t=>t.unfreeze())}},init(){},remove(){this._detachController&&(this._detachController(),this._detachController=null)},menu(t,e){let i=0;return this.items=t.map(t=>{t.spaceAbove&&(i+=16);const e=Object(n.a)(a(t),this,i,r(!1,t.dangerous),"16px");return e.item=t,i+=32,e}),this.attr({h:i}),this._menuItem=0,this.selectOption(null,0),this.attachController(e),this},attachController(t){this._detachController&&(this._detachController(),this._detachController=null);const e=()=>{this._menuItem=this.selectOption(this._menuItem,1)},i=()=>{this._menuItem=this.selectOption(this._menuItem,-1)},n=()=>{const t=this.items[this._menuItem];o(t,"left")},r=()=>{const t=this.items[this._menuItem];o(t,"right")},a=()=>{const t=this.items[this._menuItem];o(t,"activate")};return t.bind("Down",e),t.bind("Up",i),t.bind("Left",n),t.bind("Right",r),t.bind("Fire",a),this._detachController=()=>{t.unbind("Down",e),t.unbind("Up",i),t.unbind("Left",n),t.unbind("Right",r),t.unbind("Fire",a)},this},selectOption(t,e){const i=null===t?e:(t+this.items.length+e)%this.items.length;if(t!==i){const e=null!==t&&this.items[t].item.deselect;e&&e();const n=this.items[i].item.select;n&&n()}return this.items.forEach((t,e)=>t.textColor(r(e===i,t.item.dangerous))),i}}),e.a="Menu"}).call(this,i(0).default)},function(t,e,i){var n=i(261);t.exports=function(t){return n(t,4)}},function(t,e,i){"use strict";(function(t){i.d(e,"a",(function(){return s}));var n=i(171),r=i(172),a=i(97),o=i(21);const s=()=>{const e=t.e([o.a,"Color"].join(", ")).attr({name:"Player 1",z:0,playerNumber:1}).setName("Player 1").color("#FF0000");return t.e([n.a,a.a].join(", ")).controls({fire:[t.keys.SPACE],heavy:[t.keys.C,t.keys.SHIFT],switchWeapon:[t.keys.Z],shield:[t.keys.X],up:[t.keys.UP_ARROW,t.keys.W],down:[t.keys.DOWN_ARROW,t.keys.S],left:[t.keys.LEFT_ARROW,t.keys.A],right:[t.keys.RIGHT_ARROW,t.keys.D],pause:[t.keys.P]}),t.e([r.a,a.a].join(", ")).controls({gamepadIndex:0,fire:0,heavy:1,switchWeapon:2,pause:9,up:12,down:13,left:14,right:15}),e}}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var n=i(17),r=i(44),a=i(10);t.c("AnalogKeyboardControls",{init(){this._player=null,this.requires(r.a),this.bind("RemoveComponent",t=>{t===a.a&&this.removeComponent("AnalogKeyboardControls")})},remove(){this.unbind("KeyDown",this._keyHandling)},setupControls(t){this._player=t,t.addComponent(a.a),t.assignControls=t=>{this.assignControls(t)}},controls(t){return this.controlMap=t,this.uniqueBind("KeyDown",this._keyHandling),this},_keyHandling(t){t.key===this.controlMap.pause&&Object(n.b)(),this.controlMap.fire.some(e=>e===t.key)&&(this.trigger("Fire",t),this._player&&this._player.trigger("Fire",t)),this.controlMap.up.some(e=>e===t.key)&&(this.trigger("Up",t),this._player&&this._player.trigger("Up",t)),this.controlMap.down.some(e=>e===t.key)&&(this.trigger("Down",t),this._player&&this._player.trigger("Down",t)),this.controlMap.left.some(e=>e===t.key)&&(this.trigger("Left",t),this._player&&this._player.trigger("Left",t)),this.controlMap.right.some(e=>e===t.key)&&(this.trigger("Right",t),this._player&&this._player.trigger("Right",t))},assignControls(t){if(t.hasPlayerControls)return;const{controlMap:e}=this;let i=0,n=0,r={up:!1,down:!1,left:!1,right:!1};t.hasPlayerControls=!0,t.addComponent("Motion").bind("GamePause",(function(t){t?(r={up:!1,down:!1,left:!1,right:!1},this.disabledBeforePause=this.disableControls,this.disableControl()):this.disabledBeforePause||this.enableControl()})).bind("Move",(function(){const t=500*i;(this.vy<t&&t<=0&&this.ay<0||this.vy>t&&t>=0&&this.ay>0)&&(this.vy=t,this.ay=0);const e=700*n;(this.vx<e&&e<=0&&this.ax<0||this.vx>e&&e>=0&&this.ax>0)&&(this.vx=e,this.ax=0)})),t.controlName=t=>this.controlMap[t].map(t=>{switch(t){case 32:return"spacebar"}return String.fromCharCode(t)+" key"}).join(" or "),t.disableControls=!1,t.prevSets={ax:t.ax,ay:t.ay,vx:t.vx,vy:t.vy},t.disableControl=function(){!0!==this.disableControls&&(this.disableControls=!0,this.prevSets={ax:this.ax,ay:this.ay,vx:this.vx,vy:this.vy},this.ax=0,this.ay=0,this.vx=0,this.vy=0,n=0,i=0)},t.enableControl=function(){!1!==this.disableControls&&(this.disableControls=!1,this.ax=this.prevSets.ax,this.ay=this.prevSets.ay,this.vx=this.prevSets.vx,this.vy=this.prevSets.vy)};const a=()=>{i=0,r.up&&(i-=1),r.down&&(i+=1),i=Math.min(1,Math.max(-1,i)),t.ay+=3e3*i,t.vy>0&&0===t.ay&&(t.ay-=6e3),t.vy<0&&0===t.ay&&(t.ay+=6e3),n=0,r.left&&(n-=1),r.right&&(n+=1),n=Math.min(1,Math.max(-1,n)),t.ax+=4200*n,t.vx>0&&0===t.ax&&(t.ax-=8400),t.vx<0&&0===t.ax&&(t.ax+=8400)};this.listenTo(t,"KeyDown",(function(i){t.disableControls||(e.fire.some(t=>t===i.key)&&t.controlPrimary(!0),e.switchWeapon.some(t=>t===i.key)&&t.controlSwitch(!0),e.heavy.some(t=>t===i.key)&&t.controlSecondary(!0),e.shield.some(t=>t===i.key)&&t.controlBlock(!0),e.up.some(t=>t===i.key)&&(r.up=!0),e.down.some(t=>t===i.key)&&(r.down=!0),e.left.some(t=>t===i.key)&&(r.left=!0),e.right.some(t=>t===i.key)&&(r.right=!0),a())})),this.listenTo(t,"KeyUp",(function(i){t.disableControls||(e.fire.some(t=>t===i.key)&&t.controlPrimary(!1),e.switchWeapon.some(t=>t===i.key)&&t.controlSwitch(!1),e.heavy.some(t=>t===i.key)&&t.controlSecondary(!1),e.shield.some(t=>t===i.key)&&t.controlBlock(!1),e.up.some(t=>t===i.key)&&(r.up=!1),e.down.some(t=>t===i.key)&&(r.down=!1),e.left.some(t=>t===i.key)&&(r.left=!1),e.right.some(t=>t===i.key)&&(r.right=!1),a())}))}}),e.a="AnalogKeyboardControls"}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var n=i(17),r=i(44),a=i(173),o=i(10);t.c("GamepadControls",{init(){this.requires(r.a),this.bind("RemoveComponent",(function(t){t===o.a&&this.removeComponent("GamepadControls")})),this.emits={}},remove(){this.unbind("GamepadKeyChange",this._keyHandling)},setupControls(t){this._player=t,t.addComponent(o.a),t.assignControls=t=>{this.assignControls(t)}},controls(t){if(this.controlMap=t,null!=t.gamepadIndex)return this.requires(a.a),this.gamepad(t.gamepadIndex),this.bind("GamepadKeyChange",this._keyHandling),this.bind("GamepadAxisChange",this._stickHandling),this},_stickHandling(t){let e;1===t.axis&&(e="vertical",t.value<-.5?this._startEmit(e,"Up"):t.value>.5?this._startEmit(e,"Down"):this._stopEmit(e)),0===t.axis&&(e="horizontal",t.value<-.5?this._startEmit(e,"Left"):t.value>.5?this._startEmit(e,"Right"):this._stopEmit(e))},_startEmit(t,e){(this.emits[t]&&this.emits[t].value)!==e&&(this._stopEmit(t),this.trigger(e),this._player&&this._player.trigger(e),this.emits[t]={interval:setInterval(()=>{this.trigger(e),this._player&&this._player.trigger(e)},200),value:e})},_stopEmit(t){return clearInterval(this.emits[t]&&this.emits[t].interval),delete this.emits[t]},_keyHandling(t){this.lastPressed&&this.lastPressed.getTime()>(new Date).getTime()-200||(this.lastPressed=new Date,t.button===this.controlMap.pause&&t.pressed&&Object(n.b)(),t.button===this.controlMap.fire&&t.pressed&&(this.trigger("Fire",t),this._player&&this._player.trigger("Fire",t)),t.button===this.controlMap.up&&t.pressed&&(this.trigger("Up",t),this._player&&this._player.trigger("Up",t)),t.button===this.controlMap.down&&t.pressed&&(this.trigger("Down",t),this._player&&this._player.trigger("Down",t)),t.button===this.controlMap.left&&t.pressed&&(this.trigger("Left",t),this._player&&this._player.trigger("Left",t)),t.button===this.controlMap.right&&t.pressed&&(this.trigger("Right",t),this._player&&this._player.trigger("Right",t)))},assignControls(t){t.hasPlayerControls||(t.hasPlayerControls=!0,t.addComponent("GamepadMultiway").gamepadMultiway({speed:{y:550,x:750},gamepadIndex:this.controlMap.gamepadIndex,analog:!0}).bind("GamePause",(function(t){t?(this.disabledBeforePause=this.disableControls,this.disableControl()):this.disabledBeforePause||this.enableControl()})),t.controlName=t=>{const e=this._getGamepad(),i=this.controlMap[t];if(e.id){if(["sony","dualshock","playstation","sixaxis","ps3","ps3","ps(r)"].some(t=>-1!==e.id.toLowerCase().indexOf(t))){return["✖ button","◯ button","□ button","△ button","Left shoulder button (L1)","Right shoulder button (R1)","Left trigger (L2)","Right trigger (R2)","Share button","Option button","Left stick (L3)","Right stick (R3)","D-pad up button","D-pad down button","D-pad left button","D-pad right button","Playstation button","touchpad"][i]}if(["xbox","x-box"].some(t=>-1!==e.id.toLowerCase().indexOf(t))){return["a button","b button","x button","y button","Left bumper (LB)","Right bumper (RB)","Left trigger (LT)","Right trigger (RT)","Select button","Start button","Left stick (L)","Right stick (R)","D-pad up button","D-pad down button","D-pad left button","D-pad right button"][i]}}let n="1st";switch(i){case 0:n="1st";break;case 1:n="2nd";break;case 2:n="3rd";break;default:n=i+1+"th"}return n+" button"},this.listenTo(t,"GamepadKeyChange",e=>{e.button===this.controlMap.fire&&t.controlPrimary(e.pressed),e.button===this.controlMap.switchWeapon&&t.controlSwitch(e.pressed),e.button===this.controlMap.heavy&&t.controlSecondary(e.pressed),e.button===this.controlMap.shield&&t.controlBlock(e.pressed)}))}}),e.a="GamepadControls"}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){t.c("Gamepad",{_gpEnterFrame:function(){var t=this._getGamepad(this._gamepadIndex);t&&t.timestamp!==this._timestamp&&(this._timestamp=t.timestamp,this._emitGamepadEvents(t))},_emitGamepadEvents:function(t){for(var e=0;e<t.buttons.length;e++)(void 0!==this._buttonsState[e]&&this._buttonsState[e]!==t.buttons[e].value||void 0===this._buttonsState[e]&&0!==t.buttons[e].value)&&this.trigger("GamepadKeyChange",{button:e,value:t.buttons[e].value,pressed:t.buttons[e].pressed}),this._buttonsState[e]=t.buttons[e].value;for(var i=0;i<t.axes.length;i++)(void 0!==this._axesState[i]&&this._axesState[i]!==t.axes[i]||void 0===this._axesState[i]&&0!==t.axes[i])&&this.trigger("GamepadAxisChange",{axis:i,value:t.axes[i]})},_getGamepad:function(){var t=null,e=navigator.getGamepads||navigator.webkitGetGamepads;return e&&(t=e.apply(navigator)[this._gamepadIndex]),t},gamepad:function(t){return this._gamepadIndex=t||0,this._timestamp=0,this._buttonsState=[],this._axesState=[],this.bind("EnterFrame",this._gpEnterFrame),this}}),t.c("GamepadMultiway",{_AXIS_THRESHOLD:.75,_AXIS_ANALOG_THRESHOLD:.12,_BUTTONS_DIRECTION:{12:-90,13:90,14:180,15:0},_AXES_DIRECTION:{0:[180,0],1:[-90,90],2:[180,0],3:[-90,90]},init:function(){this.requires("Motion, Gamepad")},_gamepadKeyChange:function(t){this.disableControls||t.button in this._BUTTONS_DIRECTION&&(1===t.value&&-1===this._buttonsPressed.indexOf(t.button)?(this.vx=Math.round(1e3*(this.vx+this._buttons[t.button].x))/1e3,this.vy=Math.round(1e3*(this.vy+this._buttons[t.button].y))/1e3,this._buttonsPressed.push(t.button)):0===t.value&&-1!==this._buttonsPressed.indexOf(t.button)&&(this.vx=Math.round(1e3*(this.vx-this._buttons[t.button].x))/1e3,this.vy=Math.round(1e3*(this.vy-this._buttons[t.button].y))/1e3,this._buttonsPressed.splice(this._buttonsPressed.indexOf(t.button),1)))},_gamepadAxisChange:function(t){this.disableControls||t.axis in this._AXES_DIRECTION&&(this._analogControl?this._analogHandling(t):this._digitalHandling(t))},_digitalHandling:function(t){if(t.value<=-this._AXIS_THRESHOLD||t.value>=this._AXIS_THRESHOLD){var e=t.value<0?0:1,i=t.axis+":"+e;if(-1!==this._axesPressed.indexOf(i))return;this.vx=Math.round(1e3*(this.vx+this._axes[t.axis][e].x))/1e3,this.vy=Math.round(1e3*(this.vy+this._axes[t.axis][e].y))/1e3,this._axesPressed.push(i)}else for(var n=0;n<this._axesPressed.length;n++){var r=this._axesPressed[n];if(parseInt(r.substr(0,1),10)===t.axis){var a=r.split(":");this.vx=Math.round(1e3*(this.vx-this._axes[t.axis][parseInt(a[1],10)].x))/1e3,this.vy=Math.round(1e3*(this.vy-this._axes[t.axis][parseInt(a[1],10)].y))/1e3,this._axesPressed.splice(this._axesPressed.indexOf(r),1)}}},_analogHandling:function(t){t.value<=-this._AXIS_ANALOG_THRESHOLD||t.value>=this._AXIS_ANALOG_THRESHOLD?(0===t.axis&&(this.vx=t.value*this._speed.x),1===t.axis&&(this.vy=t.value*this._speed.y)):(0===t.axis&&(this.vx=0),1===t.axis&&(this.vy=0))},_calcSpeed:function(t){for(var e in this._BUTTONS_DIRECTION)this._buttons[e]={x:Math.round(1e3*Math.cos(this._BUTTONS_DIRECTION[e]*(Math.PI/180))*t.x)/1e3,y:Math.round(1e3*Math.sin(this._BUTTONS_DIRECTION[e]*(Math.PI/180))*t.y)/1e3};for(var i in this._AXES_DIRECTION)this._axes[i]=[],this._axes[i][0]={x:Math.round(1e3*Math.cos(this._AXES_DIRECTION[i][0]*(Math.PI/180))*t.x)/1e3,y:Math.round(1e3*Math.sin(this._AXES_DIRECTION[i][0]*(Math.PI/180))*t.y)/1e3},this._axes[i][1]={x:Math.round(1e3*Math.cos(this._AXES_DIRECTION[i][1]*(Math.PI/180))*t.x)/1e3,y:Math.round(1e3*Math.sin(this._AXES_DIRECTION[i][1]*(Math.PI/180))*t.y)/1e3}},gamepadMultiway:function(t){return t=t||{},this.requires("Gamepad"),this.gamepad(t.gamepadIndex||0),this._speed={x:150,y:150},this._buttons={},this._buttonsPressed=[],this._axes={},this._axesPressed=[],this._speedOnAxes={},this._analogControl=t.analog,t.speed&&(t.speed.x&&t.speed.y?(this._speed.x=t.speed.x,this._speed.y=t.speed.y):(this._speed.x=t.speed,this._speed.y=t.speed)),this._calcSpeed(this._speed),this.bind("GamepadKeyChange",this._gamepadKeyChange),this.bind("GamepadAxisChange",this._gamepadAxisChange),this},enableControl:function(){return this.disableControls=!1,void 0!==this.disabledVelocities&&(this.vx=this.disabledVelocities.x,this.vy=this.disabledVelocities.y),this.disabledVelocities=void 0,this},disableControl:function(){return this.disableControls=!0,this.disabledVelocities={x:this.vx,y:this.vy},this.vx=0,this.vy=0,this}}),e.a="Gamepad"}).call(this,i(0).default)},function(t,e,i){"use strict";var n=i(164),r=i(3);const a=(t,e)=>async({spawn:i,call:n,waitForEvent:a,wait:o,until:s,allowDamage:l,moveWithPattern:c,awardPoints:h,showState:u})=>{const d=i("Helicopter",{location:{rx:1.1,ry:.5},defaultVelocity:100});d.addCollisionComponent("SolidCollision").addCollisionComponent("PlayerEnemy"),await l(d,{health:900});const p=r.a.playAudio("helicopter",{volume:.01});p.setVolume(2,2e3),await o(2e3),u(d,"shooting");let f=c(d,t);const m=a(d,"Dead",async()=>{f.abort(),p.stop(),h(250,d.x+20,d.y),await u(d,"dead"),await n(d.activateGravity)});a(d,"Remove",async()=>{p.stop()}),await f.process,await s(()=>m,async()=>{if("dead"===d.appliedEntityState)return o(500);f=c(d,e,150),await f.process})};var o=i(1),s=i(2);const l=()=>async({spawn:t,waitForEvent:e,until:i,parallel:n,wait:r,awardPoints:a,showState:l,allowDamage:c,exec:h,moveTo:u})=>{let d=null;const p=t("DroneShip",{location:{rx:1.1,ry:.7},defaultVelocity:150});var f;h((f=p.boxLocation1,async({showState:t,allowDamage:e,waitForEvent:i,call:n,awardPoints:r})=>{await e(f,{health:30}),i(f,"Dead",async()=>{r(25,f.x,f.y),t(f,"falling"),await n(f.activateGravity,"GravityLiquid")})})),l(p,"activateGun"),p.gun.addCollisionComponent("SolidCollision").addCollisionComponent("PlayerEnemy");const m=e(p.gun,"Dead",async()=>{a(200,p.gun.x+20,p.gun.y),l(p.gun,"dead"),p.gun.clearCollisionComponents()});await c(p.gun,{health:600}),d=u(p,{x:.5},null,o.c),p.radar.addCollisionComponent("SolidCollision");let y=!1;const g=e(p.radar,"Dead",async()=>{y=!0,a(100,p.radar.x+20,p.radar.y),l(p.radar,"dead"),p.radar.clearCollisionComponents()});l(p,"radarPulse"),await c(p.radar,{health:300}),await d.process,d=u(p,{x:-.8},null,o.a),d.process.then(()=>p.destroy());let v=10;await n([()=>i(()=>g,async({exec:t})=>{y||(t(Object(s.a)(2,"drone.pattern2",{points:v})),v=v>0?v-5:0),await r(1500)}),()=>m])};var c=i(13),h=i(6),u=i(22);var d=async({setScrollingSpeed:t,setScenery:e,loadSpriteSheets:i,loadAudio:n,wait:o,setAltitude:d,setBackground:p,parallel:f,showHUD:m,exec:y})=>{const g=Object(h.a)("Loading...");g.fadeIn(2e3),await i(["mega-texture"]),await n(["effects","hero"]),r.a.playAudio("hero"),await t(350,0,{instant:!0}),d(200,{instant:!0}),p("City.Sunrise",1,2),await e("City.Ocean"),m(),g.remove(),y(Object(c.a)({existing:!0})),await f([async()=>{await o(2e3),await d(0)},()=>y(a("heli.pattern1","heli.repeat1"))]),await f([()=>y(Object(s.a)(4,"drone.pattern6")),async()=>{await o(2e3),await y(Object(s.a)(4,"drone.pattern6",{yOffset:.2}))},async()=>{await o(4e3),await y(Object(s.a)(4,"drone.pattern6",{yOffset:.4}))}]),await y(Object(s.a)(4,"drone.pattern5")),await y(l()),await y(Object(s.a)(4,"drone.pattern1")),await y(Object(u.b)()),await e("City.CoastStart"),await y(Object(u.b)()),await f([()=>y(Object(s.a)(4,"drone.pattern6")),async()=>{await o(2e3),await y(Object(s.a)(4,"drone.pattern6",{yOffset:.2}))},async()=>{await o(4e3),await y(Object(s.a)(4,"drone.pattern6",{yOffset:.4}))}]),await y(l())},p=i(165);var f=async({setScrollingSpeed:t,setScenery:e,loadSpriteSheets:i,loadAudio:n,setBackground:a,exec:o,showHUD:l})=>{const u=Object(h.a)("Loading...");u.fadeIn(2e3),await i(["mega-texture"]),await n(["effects","hero"]),r.a.playAudio("hero"),await t(350,0,{instant:!0}),await e("City.Coast"),a("City.Sunrise",2,2),l(),u.remove(),o(Object(c.a)({existing:!0})),await o(Object(s.a)(5,"drone.pattern2")),await o(p.a)},m=i(7);var y=async({setScrollingSpeed:t,setScenery:e,loadSpriteSheets:i,loadAudio:n,parallel:a,setBackground:o,wait:l,exec:u,showHUD:d})=>{const p=Object(h.a)("Loading...");p.fadeIn(2e3),await i(["mega-texture"]),await n(["effects","hero"]),r.a.playAudio("hero"),await t(150,0,{instant:!0}),await e("City.Coast"),o("City.Sunrise",3,3),d(),p.remove(),u(Object(c.a)({existing:!0,hasLaser:!0})),await t(350,0),await l(500),await e("City.BayStart"),await Object(m.a)("General","I'm at a safe location now. We need to end this threat.\nHow are you holding up?",{portrait:"portraits.general"}),await a([async()=>{await Object(m.a)("John","I'm fine. That ship had some advanced weaponry on board.\nDid you know that?",{portrait:"portraits.pilot"}),await Object(m.a)("General","We can not acces the computer systems anymore. But this would\nmean they also have control over our R&D division.\nThis is really bad.",{portrait:"portraits.general"}),await Object(m.a)("John","I will try to reach the R&D center to investigate.",{portrait:"portraits.pilot"})},()=>u(Object(s.a)(4,"drone.straight",{delay:400,yOffset:.1,speed:330})),async()=>{await l(4e3),await u(Object(s.a)(4,"drone.straight",{delay:400,yOffset:-.1,speed:330}))},async()=>{await l(8e3),await u(Object(s.a)(4,"drone.straight",{delay:400,yOffset:-.3,speed:330}))},async()=>{await l(1e4),await u(Object(s.a)(4,"drone.straight",{delay:400,yOffset:-.1,speed:330}))},async()=>{await l(12e3),await u(Object(s.a)(4,"drone.straight",{delay:400,yOffset:.1,speed:330}))}])};var g=async({setScrollingSpeed:t,setScenery:e,loadSpriteSheets:i,loadAudio:n,parallel:o,setBackground:l,wait:d,exec:p,showHUD:f})=>{const m=Object(h.a)("Loading...");m.fadeIn(2e3),await i(["mega-texture"]),await n(["effects","hero"]),r.a.playAudio("hero"),await t(250,0,{instant:!0}),await e("City.Bay"),l("City.Sunrise",3,3),f(),m.remove(),p(Object(c.a)({existing:!0,hasLaser:!0})),await p(Object(s.a)(5,"drone.pattern1")),await p(Object(s.a)(8,"drone.pattern2")),await p(Object(u.b)()),await e("City.Bridge"),await p(a("heli.pattern1","heli.repeat1")),await o([()=>p(Object(s.a)(5,"drone.pattern3")),()=>p(Object(s.a)(5,"drone.pattern5"))]),await p(Object(u.b)()),await o([()=>p(a("heli.pattern1","heli.repeat2")),async()=>{await d(5e3),await p(a("heli.pattern1","heli.repeat1"))}]),await d(2e3),await o([()=>p(Object(s.a)(5,"drone.pattern3")),()=>p(Object(s.a)(5,"drone.pattern5"))])},v=i(34),_=i.n(v);const x=()=>async({exec:t})=>{const e=_()([{y:.8},{y:.7},{y:.6},{y:.5},{y:.4},{y:.3},{y:.2}]),i=Array(5).fill().map(async(i,n)=>{await t(((t,e)=>async({spawn:i,wait:n,moveTo:r,allowDamage:a,showState:s,waitForEvent:l})=>{let c=null;await n(100*t);const h=i("HeliRocket",{location:{rx:1.1,ry:e.y},defaultVelocity:500});l(h,"Dead",async()=>{c&&c.abort(),await s(h,"explode"),await n(500),h.destroy()}),await a(h,{health:3}),c=r(h,{x:-.1},null,o.a),await c.process,c.wasCompleted()&&h.destroy()})(n,e[n]))});await Promise.all(i)};var b=async({setScrollingSpeed:t,setScenery:e,loadSpriteSheets:i,loadAudio:n,setBackground:a,parallel:o,exec:s,waitTillInScreen:l,showHUD:u})=>{const d=Object(h.a)("Loading...");d.fadeIn(2e3),await i(["mega-texture"]),await n(["effects","hero"]),r.a.playAudio("hero"),await t(250,0,{instant:!0}),await e("City.BayFull"),a("City.Sunrise",3,3),u(),d.remove(),s(Object(c.a)({existing:!0,hasLaser:!0}));const p=Object(h.a)("Warning!",{color:"#FF0000"});await p.blink(500,4),p.remove(),await e("City.Bridge"),await o([async()=>{await l("City.Bridge",-625),await t(0,0)},async()=>{await s(x()),await s(x()),await s(x())}]),await s(async({moveWithPattern:t,playAnimation:e,setScrollingSpeed:i,showState:n,until:r,spawn:a,parallel:o,wait:s})=>{const l=a("LargeDrone",{location:{rx:1.1,ry:.2},defaultVelocity:200});let c=t(l,"largeDrone.intro");await c.process,await o([()=>Object(m.a)("Drone","**Bzzt** We are in control of your army now!\nJust give up!",{portrait:"portraits.drone"}),()=>n(l,"laugh")]),await r(()=>n(l,"shootRockets"),()=>(c=t(l,"largeDrone.eight"),c.process)),await r(()=>n(l,"rocketStrike"),()=>(c=t(l,"largeDrone.eight2"),c.process)),console.log("mine attack!"),await s(1e4);const h=e("City.Bridge",{max:2});await s(1e4),h.updateCheckpointLimit(1/0),await h.waitTillCheckpoint(3),await i(200,0),l.destroy()})};var w=async({setScrollingSpeed:t,setScenery:e,loadSpriteSheets:i,loadAudio:n,setBackground:r,addScreenTrauma:a,setAltitude:o,exec:l,wait:c,fadeIn:d})=>{const p=d(),f=Object(h.a)("Loading...");f.fadeIn(2e3),await i(["mega-texture"]),await n(["effects"]),await t(100,0,{instant:!0}),await e("City.Ocean"),r("City.Sunrise",0,5),f.remove(),await p.start(2e3),await c(5e3),await t(500,0),console.log("Say!"),await Object(m.a)("General","Let us escort you to the factory to install\nthe AI controlled defence systems. You are the last ship.",{portrait:"portraits.general"}),console.log("End Say!"),a(.8),a(.8),a(.8),a(.8),await Object(m.a)("John","Let's go!",{portrait:"portraits.pilot"}),await l(Object(s.a)(4,"drone.straight",500,.1)),a(.8),a(.8),a(.8),a(.8),await l(Object(s.a)(4,"drone.straight",500,-.1)),await l(Object(s.a)(4,"drone.straight",500,-.3)),await o(200),await l(Object(s.a)(5,"drone.pattern1",500)),await l(Object(s.a)(8,"drone.pattern2",500)),await o(0),await l(Object(s.a)(5,"drone.pattern3",500)),await t(100,0),await l(Object(u.b)()),await l(Object(s.a)(5,"drone.pattern3",500)),await e("City.CoastStart"),await l(Object(u.b)()),await t(250,0),await c(2e4),await e("City.BayStart"),await c(4e4),await e("City.Bridge"),await c(4e4)},C=i(166);var k=async()=>{const t=Object(h.a)("Congratulations!",{sup:"The end for now..."});await t.fadeIn(5e3),t.remove()};const S=[{name:"stage1.intro",script:n.a,tags:{campaign:!0}},{name:"stage1.hacked",script:d,tags:{campaign:!0}},{name:"stage1.battleship",script:f,tags:{campaign:!0}},{name:"stage1.battleshipEnd",script:y,tags:{campaign:!0}},{name:"stage1.bay",script:g,tags:{campaign:!0}},{name:"stage1.bridge",script:b,tags:{campaign:!0,wip:!0}},{name:"end",script:k,tags:{campaign:!0}},{name:"test.scenery",script:w,tags:{test:!0}},{name:"test.laser",script:C.a,tags:{test:!0}}];e.a=S},function(t,e,i){"use strict";i.r(e),function(t){i(177),i(180),i(346),i(248);var e=i(170),n=(i(345),i(21)),r=i(19),a=i(3),o=i(29);a.a.setEffectVolume(Object(o.a)("effectsVolume",.4)),a.a.setMusicVolume(Object(o.a)("musicVolume",.4)),Object(r.b)(1),t.paths({images:"./"});const s=document.getElementById("cr-stage");t.init(1024,576,s),t.background("#000000"),t.timer.FPS(60),t.createLayer("UILayerDOM","DOM",{scaleResponse:0,yResponse:0,xResponse:0,z:40}),t.createLayer("UILayerWebGL","WebGL",{scaleResponse:0,yResponse:0,xResponse:0,z:35}),t.e([n.a,"Color"].join(", ")).attr({name:"Player 1",z:0,playerNumber:1}).setName("Player 1").color("#FF0000"),Object(e.a)(),t.enterScene("Intro");const l=()=>{const t=document.getElementById("cr-stage"),e=t.clientHeight,i=t.clientWidth,n=window.innerHeight-60,r=window.innerWidth,a=n/e,o=r/i,s=Math.min(a,o);t.style.transform=`scale(${s})`;const l=Math.max(0,.5*(r-i*s));t.style.left=l+"px";const c=document.getElementsByTagName("footer")[0];c&&(c.style.top=576*s+"px")};window.addEventListener("resize",l),window.addEventListener("load",()=>{const t=document.getElementById("cr-stage");t.addEventListener("click",()=>{t.focus()})});const c=document.querySelector("button");c&&c.addEventListener("click",()=>{document.getElementById("theater").requestFullscreen(),document.body.classList.add("fullscreen"),l(),document.addEventListener("fullscreenchange",()=>{document.fullscreenElement||(document.body.classList.remove("fullscreen"),l())})}),setTimeout(l,0)}.call(this,i(0).default)},function(t,e,i){var n;!function t(e,i,n){function r(o,s){if(!i[o]){if(!e[o]){if(a)return a(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=i[o]={exports:{}};e[o][0].call(c.exports,(function(t){var i=e[o][1][t];return r(i||t)}),c,c.exports,t,e,i,n)}return i[o].exports}for(var a=!1,o=0;o<n.length;o++)r(n[o]);return r}({1:[function(t,e,i){var n,r,a=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function l(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var c,h=[],u=!1,d=-1;function p(){u&&c&&(u=!1,c.length?h=c.concat(h):d=-1,h.length&&f())}function f(){if(!u){var t=l(p);u=!0;for(var e=h.length;e;){for(c=h,h=[];++d<e;)c&&c[d].run();d=-1,e=h.length}c=null,u=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function m(t,e){this.fun=t,this.array=e}function y(){}a.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];h.push(new m(t,e)),1!==h.length||u||l(f)},m.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=y,a.addListener=y,a.once=y,a.off=y,a.removeListener=y,a.removeAllListeners=y,a.emit=y,a.binding=function(t){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(t){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},{}],2:[function(t,e,i){function n(t,e,i,n){Object.defineProperty(t,e,{enumerable:!1,configurable:!1,get:function(){return i[n]},set:function(t){i[n]=t}})}e.exports={defineAliases:function(t){n(t,"image_whitelist",t,"imageWhitelist"),n(t,"mouseDispatch",t.s("Mouse"),"processEvent"),n(t,"mouseButtonsDown",t.s("Mouse"),"_buttonDown"),n(t,"lastEvent",t.s("Mouse"),"lastMouseEvent"),n(t,"mouseObjs",t.s("Mouse"),"mouseObjs"),n(t,"keyboardDispatch",t.s("Keyboard"),"processEvent"),n(t,"keydown",t.s("Keyboard"),"_keyDown"),n(t,"resetKeyDown",t.s("Keyboard"),"resetKeyDown"),n(t,"touchDispatch",t,"_touchDispatch"),n(t,"touchObjs",t.s("Touch"),"touchObjs"),t.touchHandler={},n(t.touchHandler,"fingers",t.s("Touch"),"touchPoints")}}},{}],3:[function(t,e,i){var n=t("../core/core.js");function r(t){this.button=t}function a(t){this.key=t}function o(t){this.inputs=t}r.prototype={isDown:function(){var t=this.mouseSystem;return t||(this.mouseSystem=t=n.s("Mouse")),t.isButtonDown(this.button)}},a.prototype={isDown:function(){var t=this.keyboardSystem;return t||(this.keyboardSystem=t=n.s("Keyboard")),t.isKeyDown(this.key)}},o.prototype={timeDown:null,isActive:function(){for(var t in this.inputs){if(this.inputs[t].isDown())return this.timeDown||(this.timeDown=Date.now()),!0}return delete this.timeDown,!1},destroy:function(){for(var t in this.inputs)"function"==typeof this.inputs[t].destroy&&this.inputs[t].destroy()}},n.s("Controls",{init:function(){this._dpads={},this._triggers={},n.s("Mouse").bind("MouseDown",this.updateTriggers.bind(this)),n.s("Mouse").bind("MouseUp",this.updateTriggers.bind(this)),n.s("Mouse").bind("DoubleClick",this.updateTriggers.bind(this)),n.s("Mouse").bind("Click",this.updateTriggers.bind(this))},events:{EnterFrame:"runEvents",KeyDown:"updateTriggers",KeyUp:"updateTriggers"},updateTriggers:function(t){for(var e in this._triggers){var i=this._triggers[e];this.updateTriggerInput(i)}},runEvents:function(){for(var t in this._dpads){var e=this._dpads[t];e.oldX=e.x,e.oldY=e.y,this.updateDpadInput(e,e.multipleDirectionBehavior),this.updateActiveDirection(e,e.normalize),e.event.x=e.x,e.event.y=e.y,e.x===e.oldX&&e.y===e.oldY||n.trigger("DirectionalInput",e.event)}},getDpad:function(t){return this._dpads[t]},isTriggerDown:function(t){return this._triggers[t].active},defineTriggerGroup:function(t,e){var i;if(Array.isArray(e))i=e;else{if(i=[],e.mouseButtons)for(var s in e.mouseButtons)i.push(new r(e.mouseButtons[s]));if(e.keys)for(var l in e.keys)i.push(new a(e.keys[l]))}this.destroyTriggerGroup(t),this._triggers[t]={name:t,input:new o(i),downFor:0,active:!1},n.trigger("ControlDefined",{type:"TriggerGroup",name:t})},destroyTriggerGroup:function(t){this._triggers[t]&&(this._triggers[t].input.destroy(),delete this._triggers[t],n.trigger("ControlDestroyed",{type:"TriggerGroup",name:t}))},defineDpad:function(t,e,i){var r={};for(var s in e){var l=e[s],c=n.keys[s]||s;r[l]||(r[l]=[]),r[l].push(new a(c))}var h={};for(var u in r)h[u]={input:new o(r[u]),active:!1,n:this.parseDirection(u)};void 0===i&&(i={}),void 0===i.normalize&&(i.normalize=!1),void 0===i.multipleDirectionBehavior&&(i.multipleDirectionBehavior="all"),this.destroyDpad(t),this._dpads[t]={name:t,directions:h,x:0,y:0,oldX:0,oldY:0,event:{x:0,y:0,name:t},normalize:i.normalize,multipleDirectionBehavior:i.multipleDirectionBehavior},n.trigger("ControlDefined",{type:"Dpad",name:t})},destroyDpad:function(t){if(this._dpads[t]){for(var e in this._dpads[t].parsedDefinition)this._dpads[t].parsedDefinition[e].input.destroy();delete this._dpads[t],n.trigger("ControlDestroyed",{type:"Dpad",name:t})}},parseDirection:function(t){return{x:Math.round(1e3*Math.cos(t*(Math.PI/180)))/1e3,y:Math.round(1e3*Math.sin(t*(Math.PI/180)))/1e3}},updateActiveDirection:function(t,e){var i=0,n=0;for(var r in t.directions){var a=t.directions[r];a.active&&(i+=a.n.x,n+=a.n.y)}if(i=-1e-10<i&&i<1e-10?0:i,n=-1e-10<n&&n<1e-10?0:n,e){var o=Math.sqrt(i*i+n*n);o>0&&(i/=o,n/=o)}t.x=i,t.y=n},updateTriggerInput:function(t){t.active?t.input.isActive()||(t.active=!1,n.trigger("TriggerInputUp",t),t.downFor=0):t.input.isActive()&&(t.downFor=Date.now()-t.input.timeDown,t.active=!0,n.trigger("TriggerInputDown",t))},updateDpadInput:function(t,e){var i,n,r;for(i in t.directions)(n=t.directions[i]).active=!1,n.input.isActive()&&("all"===e?n.active=!0:r?("first"===e&&r.input.timeDown>n.input.timeDown&&(r=n),"last"===e&&r.input.timeDown<n.input.timeDown&&(r=n)):r=n);r&&(r.active=!0)}})},{"../core/core.js":10}],4:[function(t,e,i){var n=t("../core/core.js");n.c("Draggable",{_origX:null,_origY:null,_oldX:null,_oldY:null,_dir:null,required:"MouseDrag",events:{StartDrag:"_startDrag",Dragging:"_drag"},enableDrag:function(){return this.uniqueBind("Dragging",this._drag),this},disableDrag:function(){return this.unbind("Dragging",this._drag),this},dragDirection:function(t){if(void 0===t)this._dir=null;else if(+t===t)this._dir={x:Math.cos(t/180*Math.PI),y:Math.sin(t/180*Math.PI)};else if(0===t.x&&0===t.y)this._dir={x:0,y:0};else{var e=Math.sqrt(t.x*t.x+t.y*t.y);this._dir={x:t.x/e,y:t.y/e}}return this},_startDrag:function(t){this._origX=t.realX,this._origY=t.realY,this._oldX=this._x,this._oldY=this._y},_drag:function(t){if(this._dir){if(0!==this._dir.x||0!==this._dir.y){var e=(t.realX-this._origX)*this._dir.x+(t.realY-this._origY)*this._dir.y;this.x=this._oldX+e*this._dir.x,this.y=this._oldY+e*this._dir.y}}else this.x=this._oldX+(t.realX-this._origX),this.y=this._oldY+(t.realY-this._origY)}}),n.c("Controllable",{init:function(){this._inputBindings={DirectionalInput:{},TriggerInputDown:{},TriggerInputUp:{}}},events:{DirectionalInput:function(t){this._inputBindings.DirectionalInput[t.name]&&this._inputBindings.DirectionalInput[t.name].call(this,t)},TriggerInputDown:function(t){this._inputBindings.TriggerInputDown[t.name]&&this._inputBindings.TriggerInputDown[t.name].call(this,t)},TriggerInputUp:function(t){this._inputBindings.TriggerInputUp[t.name]&&this._inputBindings.TriggerInputUp[t.name].call(this,t)}},linkInput:function(t,e,i){return this._inputBindings[t][e]=i,this},unlinkInput:function(t,e){return delete this._inputBindings[t][e],this},disableControls:!1,enableControl:function(){return this.disableControls=!1,this},disableControl:function(){return this.disableControls=!0,this}}),n.c("Multiway",{_speed:null,init:function(){this.requires("Motion, Controllable"),this._dpadName="MultiwayDpad"+this[0],this._speed={x:150,y:150},this._direction={x:0,y:0}},remove:function(){this.disableControls||(this.vx=this.vy=0),this.unlinkInput("DirectionalInput",this._dpadName),n.s("Controls").destroyDpad(this._dpadName)},events:{UpdateFrame:function(){this.disableControls||(void 0!==this._speed.x&&null!==this._speed.x&&(this.vx=this._speed.x*this._direction.x),void 0!==this._speed.y&&null!==this._speed.y&&(this.vy=this._speed.y*this._direction.y))}},_updateDirection:function(t){this._direction.x=t.x,this._direction.y=t.y},multiway:function(t,e,i){var r=n.s("Controls");return e?this.speed(t):e=t,r.defineDpad(this._dpadName,e,i),this.linkInput("DirectionalInput",this._dpadName,this._updateDirection),this},speed:function(t){return"object"==typeof t?(this._speed.x=t.x,this._speed.y=t.y):(this._speed.x=t,this._speed.y=t),this}}),n.c("Jumper",{_jumpSpeed:300,canJump:!0,init:function(){this.requires("Supportable, Motion, Controllable")},remove:function(){this.unlinkInput("TriggerInputDown",this._jumpTriggerName),n.s("Controls").destroyTriggerGroup(this._jumpTriggerName)},_keydown_jumper:function(t){this.disableControls||this.jump()},jump:function(){var t=this.ground;return this.canJump=!!t,this.trigger("CheckJumping",t),this.canJump&&(this.vy=-this._jumpSpeed),this},jumper:function(t,e){if(e?this._jumpSpeed=t:e=t,this._jumpTriggerName="JumpTrigger"+this[0],Array.isArray(e)){for(var i=[],r=0;r<e.length;++r){var a=e[r],o=n.keys[a]||a;i.push(o)}n.s("Controls").defineTriggerGroup(this._jumpTriggerName,{keys:i})}else n.s("Controls").defineTriggerGroup(this._jumpTriggerName,e);return this.linkInput("TriggerInputDown",this._jumpTriggerName,this._keydown_jumper),this},jumpSpeed:function(t){return this._jumpSpeed=t,this}}),n.c("Fourway",{init:function(){this.requires("Multiway")},fourway:function(t,e){return this.multiway(t||this._speed,{UP_ARROW:-90,DOWN_ARROW:90,RIGHT_ARROW:0,LEFT_ARROW:180,W:-90,S:90,D:0,A:180,Z:-90,Q:180},e),this}}),n.c("Twoway",{init:function(){this.requires("Multiway, Jumper")},twoway:function(t,e){var i=t||this._speed;return this.multiway({x:i},{RIGHT_ARROW:0,LEFT_ARROW:180,D:0,A:180,Q:180}),this.jumper(e||2*t||this._jumpSpeed,[n.keys.UP_ARROW,n.keys.W,n.keys.Z]),this}})},{"../core/core.js":10}],5:[function(t,e,i){var n=t("../core/core.js");n.__keyboardStateTemplate={_keyDown:null,init:function(){this._keyDown={},this.triggerKeyEvent=this.triggerKeyEvent||this.trigger},isKeyDown:function(t){return"string"==typeof t&&(t=n.keys[t]),!!this._keyDown[t]},resetKeyDown:function(){var t={key:-1,eventName:"KeyUp"},e=this._keyDown;for(var i in e)!0===e[i]&&(t.key=+i,this.triggerKey("KeyUp",t));return this},triggerKey:function(t,e){var i=e.key;return"KeyDown"===t?!0!==this._keyDown[i]&&(this._keyDown[i]=!0,this.triggerKeyEvent(t,e)):"KeyUp"===t?!0===this._keyDown[i]&&(this._keyDown[i]=!1,this.triggerKeyEvent(t,e)):this.triggerKeyEvent(t,e),this}},n.c("KeyboardState",n.__keyboardStateTemplate),n.s("Keyboard",n.extend.call({triggerKeyEvent:function(t,e){n.trigger(t,e)}},n.__keyboardStateTemplate),{},!1)},{"../core/core.js":10}],6:[function(t,e,i){t("../core/core.js").extend({keys:{BACKSPACE:8,TAB:9,ENTER:13,PAUSE:19,CAPS:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,MULTIPLY:106,ADD:107,SUBSTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SHIFT:16,CTRL:17,ALT:18,PLUS:187,COMMA:188,MINUS:189,PERIOD:190,PULT_UP:29460,PULT_DOWN:29461,PULT_LEFT:4,PULT_RIGHT:5},mouseButtons:{LEFT:0,MIDDLE:1,RIGHT:2}})},{"../core/core.js":10}],7:[function(t,e,i){var n=t("../core/core.js");n.__mouseStateTemplate={_buttonDown:null,lastMouseEvent:null,init:function(){this._buttonDown={},this.triggerMouseEvent=this.triggerMouseEvent||this.trigger,this.lastMouseEvent={eventName:"",mouseButton:-1,target:null,realX:0,realY:0,clientX:0,clientY:0,originalEvent:null}},isButtonDown:function(t){return"string"==typeof t&&(t=n.mouseButtons[t]),!!this._buttonDown[t]},resetButtonDown:function(){var t=this.lastMouseEvent,e=this._buttonDown;for(var i in e)!0===e[i]&&(t.mouseButton=+i,t.eventName="MouseUp",this.triggerMouse("MouseUp",t));return this},triggerMouse:function(t,e){var i=this.lastMouseEvent;i.eventName=t,i.mouseButton=e.mouseButton,i.target=e.target,i.realX=e.realX,i.realY=e.realY,i.clientX=e.clientX,i.clientY=e.clientY,i.originalEvent=e.originalEvent;var n=e.mouseButton;return"MouseDown"===t?!0!==this._buttonDown[n]&&(this._buttonDown[n]=!0,this.triggerMouseEvent(t,e)):"MouseUp"===t?!0===this._buttonDown[n]&&(this._buttonDown[n]=!1,this.triggerMouseEvent(t,e)):this.triggerMouseEvent(t,e),this}},n.c("MouseState",n.__mouseStateTemplate),n.s("Mouse",n.extend.call({triggerMouseEvent:function(t,e){n.trigger(t,e)}},n.__mouseStateTemplate),{},!1)},{"../core/core.js":10}],8:[function(t,e,i){var n=t("../core/core.js");n.__touchStateTemplate={touchPoints:null,_touchPointsPool:null,init:function(){this.touchPoints=[],this._touchPointsPool=[],this.triggerTouchEvent=this.triggerTouchEvent||this.trigger},resetTouchPoints:function(){for(var t,e=this.touchPoints,i=e.length;i--;)(t=e[i]).eventName="TouchCancel",this.triggerTouch("TouchCancel",t);return this},triggerTouch:function(t,e){switch(t){case"TouchStart":this._handleStart(e);break;case"TouchMove":this._handleMove(e);break;case"TouchCancel":case"TouchEnd":this._handleEnd(e);break;default:this.triggerTouchEvent(t,e)}return this},_indexOfTouchPoint:function(t){for(var e=this.touchPoints,i=0,n=e.length;i<n;i++)if(e[i].identifier===t)return i;return-1},_setTouchPoint:function(t,e){t.eventName=e.eventName,t.identifier=e.identifier,t.target=e.target,t.entity=e.entity,t.realX=e.realX,t.realY=e.realY,t.originalEvent=e.originalEvent},_handleStart:function(t){var e=this._indexOfTouchPoint(t.identifier);if(!(e>=0?this.touchPoints[e]:null)){var i=this._touchPointsPool.pop()||{};this._setTouchPoint(i,t),this.touchPoints.push(i),this.triggerTouchEvent(i.eventName,i)}},_handleMove:function(t){var e=this._indexOfTouchPoint(t.identifier),i=e>=0?this.touchPoints[e]:null;i&&(this._setTouchPoint(i,t),this.triggerTouchEvent(i.eventName,i))},_handleEnd:function(t){var e=this._indexOfTouchPoint(t.identifier),i=e>=0?this.touchPoints[e]:null;i&&(this._setTouchPoint(i,t),this.triggerTouchEvent(i.eventName,i),this.touchPoints.splice(e,1),i.target=null,i.entity=null,i.originalEvent=null,this._touchPointsPool.push(i))}},n.c("TouchState",n.__touchStateTemplate),n.s("Touch",n.extend.call({triggerTouchEvent:function(t,e){n.trigger(t,e)}},n.__touchStateTemplate),{},!1)},{"../core/core.js":10}],9:[function(t,e,i){var n=t("../core/core.js"),r=function(t,e){this.timePerFrame=1e3/n.timer.FPS(),this.duration=t,"function"==typeof e?this.easing_function=e:"string"==typeof e&&this.standardEasingFunctions[e]?this.easing_function=this.standardEasingFunctions[e]:this.easing_function=this.standardEasingFunctions.linear,this.reset()};r.prototype={duration:0,clock:0,steps:null,complete:!1,paused:!1,reset:function(){this.loops=1,this.clock=0,this.complete=!1,this.paused=!1},repeat:function(t){this.loops=t},setProgress:function(t,e){this.clock=this.duration*t,void 0!==e&&(this.loops=e)},pause:function(){this.paused=!0},resume:function(){this.paused=!1,this.complete=!1},tick:function(t){if(!this.paused&&!this.complete)for(this.clock+=t,this.frames=Math.floor(this.clock/this.timePerFrame);this.clock>=this.duration&&!1===this.complete;)this.loops--,this.loops>0?this.clock-=this.duration:this.complete=!0},time:function(){return Math.min(this.clock/this.duration,1)},value:function(){return this.easing_function(this.time())},standardEasingFunctions:{linear:function(t){return t},smoothStep:function(t){return(3-2*t)*t*t},smootherStep:function(t){return(6*t*t-15*t+10)*t*t*t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<.5?2*t*t:(4-2*t)*t-1}}},e.exports=r},{"../core/core.js":10}],10:[function(t,e,i){var r,a,o,s,l,c,h,u,d,p=t("./version"),f=function(t){return new f.fn.init(t)};o={},h=Array.prototype.slice,u=/\s*,\s*/,d=/\s+/;var m,y,g,v,_,x,b,w,C,k,S,D,z=function(){r=1,a=0,s={},c={},l={},[]};function F(){var t=r++;return t in s?F():t}z(),f.fn=f.prototype={init:function(t){if("string"!=typeof t)return t||(t=0)in s||(s[t]=this),t in s?(this[0]=t,this.length=1,this.__c||(this.__c={}),this._callbacks||f._addCallbackMethods(this),s[t]||(s[t]=this),s[t]):(this.length=0,this);var e,i,n,r,a,o,l,h,p,m=0,y=!1,g=!1;if("*"===t){for(e in h=0,s)this[h]=+e,h++;return this.length=h,1===h?s[this[0]]:this}if(-1!==t.indexOf(",")?(g=!0,i=u):-1!==t.indexOf(" ")&&(y=!0,i=d),g){for(r={},h=0,p=(n=t.split(i)).length;h<p;h++)for(l in a=c[n[h]])r[l]=+l;for(l in r)this[m++]=r[l]}else if(y){for(l in n=t.split(i),r={},a=c[n[0]],o=c[n[1]],a)void 0!==o[l]&&(r[l]=+l);for(h=2,p=n.length;h<p;h++)for(l in a=c[n[h]],r)void 0===a[l]&&(r[l]=-1);for(l in r)(h=r[l])>=0&&(this[m++]=h)}else for(l in a=c[t])this[m++]=+l;return this.length=m,1===m?s[this[m-1]]:(f._addCallbackMethods(this),this)},setName:function(t){var e=String(t);return this._entityName=e,this.trigger("NewEntityName",e),this},getName:function(t){return this._entityName},addComponent:function(t){var e,i,n,r=0;for(e=1===arguments.length&&-1!==t.indexOf(",")?t.split(u):arguments;r<e.length;r++)if(i=e[r],!0!==this.__c[i]){if(this.__c[i]=!0,(c[i]=c[i]||{})[this[0]]=this,n=o[i],this.extend(n),n&&"required"in n&&this.requires(n.required),n&&"properties"in n){var a=n.properties;for(var s in a)Object.defineProperty(this,s,a[s])}if(n&&"events"in n){var l=n.events;for(var h in l){var d="function"==typeof l[h]?l[h]:n[l[h]];this.bind(h,d)}}n&&"init"in n&&n.init.call(this)}return this.trigger("NewComponent",e),this},toggleComponent:function(t){var e,i,n=0;if(arguments.length>1)for(e=arguments.length;n<e;n++)this.has(arguments[n])?this.removeComponent(arguments[n]):this.addComponent(arguments[n]);else if(-1!==t.indexOf(","))for(e=(i=t.split(u)).length;n<e;n++)this.has(i[n])?this.removeComponent(i[n]):this.addComponent(i[n]);else this.has(t)?this.removeComponent(t):this.addComponent(t);return this},requires:function(){return this.addComponent.apply(this,arguments)},removeComponent:function(t,e){var i=o[t];if(this.trigger("RemoveComponent",t),i&&"events"in i){var n=i.events;for(var r in n){var a="function"==typeof n[r]?n[r]:i[n[r]];this.unbind(r,a)}}if(i&&"remove"in i&&i.remove.call(this,!1),!1===e&&i)for(var s in i)delete this[s];return delete this.__c[t],c[t]&&delete c[t][this[0]],this},getId:function(){return this[0]},has:function(t){return!!this.__c[t]},attr:function(t,e,i,n){return 1===arguments.length&&"string"==typeof arguments[0]?this._attr_get(t):this._attr_set(t,e,i,n)},_attr_get:function(t,e){var i,n;return null==e&&(e=this),t.indexOf(".")>-1?(i=(n=t.split(".")).shift(),n.join("."),this._attr_get(n.join("."),e[i])):e[t]},_attr_set:function(){var t,e,i;return"string"==typeof arguments[0]?(t=this._set_create_object(arguments[0],arguments[1]),e=!!arguments[2],i=arguments[3]||arguments[0].indexOf(".")>-1):(t=arguments[0],e=!!arguments[1],i=!!arguments[2]),e||this.trigger("Change",t),i?this._recursive_extend(t,this):this.extend.call(this,t),this},_set_create_object:function(t,e){var i,n,r,a={};return t.indexOf(".")>-1?(n=(i=t.split(".")).shift(),r=i.join("."),a[n]=this._set_create_object(r,e)):a[t]=e,a},_recursive_extend:function(t,e){var i;for(i in t)t[i].constructor===Object?e[i]=this._recursive_extend(t[i],e[i]):e[i]=t[i];return e},toArray:function(){return h.call(this,0)},timeout:function(t,e){return this.each((function(){var i=this;setTimeout((function(){t.call(i)}),e)})),this},bind:function(t,e){if(1===this.length)this._bindCallback(t,e);else for(var i=0;i<this.length;i++){var n=s[this[i]];n&&n._bindCallback(t,e)}return this},uniqueBind:function(t,e){this.unbind(t,e),this.bind(t,e)},one:function(t,e){var i=this,n=function(r){e.call(i,r),i.unbind(t,n)};return i.bind(t,n)},unbind:function(t,e){var i,n;for(i=0;i<this.length;i++)(n=s[this[i]])&&n._unbindCallbacks(t,e);return this},trigger:function(t,e){if(1===this.length)this._runCallbacks(t,e);else for(var i=0;i<this.length;i++){var n=s[this[i]];n&&n._runCallbacks(t,e)}return this},each:function(t){for(var e=0,i=this.length;e<i;e++)s[this[e]]&&t.call(s[this[e]],e);return this},get:function(t){var e=this.length;if(void 0!==t){if(t>=e||t+e<0)return;return t>=0?s[this[t]]:s[this[t+e]]}for(var i=0,n=[];i<e;i++)s[this[i]]&&n.push(s[this[i]]);return n},clone:function(){var t,e,i=this.__c,n=f.e();for(t in i)n.addComponent(t);for(e in this)"0"!==e&&"_global"!==e&&"_changed"!==e&&"function"!=typeof this[e]&&"object"!=typeof this[e]&&(n[e]=this[e]);return n},setter:function(t,e){return this.defineField(t,(function(){}),e)},defineField:function(t,e,i){return f.defineField(this,t,e,i),this},destroy:function(){this.each((function(){var t;for(var e in this.trigger("Remove"),this.__c)(t=o[e])&&"remove"in t&&t.remove.call(this,!0),delete c[e][this[0]];this._unbindAll(),delete s[this[0]]}))},freeze:function(){if(1!==this.length||this.__frozen)for(var t=0;t<this.length;t++){var e=s[this[t]];e&&!e.__frozen&&(e.trigger("Freeze",e),e._freezeCallbacks(),e.__frozen=!0)}else this.trigger("Freeze",this),this._freezeCallbacks(),this.__frozen=!0;return this},unfreeze:function(){if(1===this.length&&this.__frozen)this.__frozen=!1,this._unfreezeCallbacks(),this.trigger("Unfreeze",this);else for(var t=0;t<this.length;t++){var e=s[this[t]];e&&e.__frozen&&(e.__frozen=!1,e._unfreezeCallbacks(),e.trigger("Unfreeze",e))}return this}},f.fn.init.prototype=f.fn,f.extend=f.fn.extend=function(t){var e;if(!t)return this;for(e in t)this!==t[e]&&(this[e]=t[e]);return this},f._callbackMethods={_bindCallback:function(t,e){var i=this._callbacks[t];i||((i=this._callbacks[t]=(l[t]||(l[t]={}))[this[0]]=[]).context=this,i.depth=0),i.push(e)},_runCallbacks:function(t,e){if(this._callbacks[t]&&!this.__callbacksFrozen){var i,n=this._callbacks[t],r=n.length;for(n.depth++,i=0;i<r;i++)void 0===n[i]?n.depth<=1&&(n.splice(i,1),i--,r--,0===n.length&&(delete this._callbacks[t],delete l[t][this[0]])):n[i].call(this,e);n.depth--}},_unbindCallbacks:function(t,e){if(this._callbacks[t])for(var i=this._callbacks[t],n=0;n<i.length;n++)e&&i[n]!==e||delete i[n]},_unbindAll:function(){if(this._callbacks)for(var t in this.__callbacksFrozen=!1,this._callbacks)this._callbacks[t]&&(this._unbindCallbacks(t),delete l[t][this[0]])},_freezeCallbacks:function(){if(this._callbacks){for(var t in this._callbacks)this._callbacks[t]&&delete l[t][this[0]];this.__callbacksFrozen=!0}},_unfreezeCallbacks:function(){if(this._callbacks)for(var t in this.__callbacksFrozen=!1,this._callbacks)this._callbacks[t]&&(l[t][this[0]]=this._callbacks[t])}},f._addCallbackMethods=function(t){t.extend(f._callbackMethods),t._callbacks={}},f._addCallbackMethods(f),f.extend({0:"global",init:function(t,e,i){if(!this._preBindDone)for(var n=0;n<this._bindOnInit.length;n++){var r=this._bindOnInit[n];f.bind(r.event,r.handler)}return f.viewport.init(t,e,i),this.trigger("Load"),this.timer.init(),this},initAsync:function(t,e,i,n){"object"!=typeof t&&(n=i,i=e,e=t,t=[]);var r=[];for(var a in t)"function"==typeof t[a]?r.push(t[a](f)):r.push(t[a]);if("complete"!==document.readyState)var o=new Promise((function(t,e){window.onload=t,r.push(o)}));return Promise.all(r).then((function(r){return f.init(e,i,n),r.slice(0,t.length)}))},_bindOnInit:[],_preBindDone:!1,_preBind:function(t,e){this._bindOnInit.push({event:t,handler:e})},getVersion:function(){return p},stop:function(t){if(f.trigger("CraftyStop",t),this.timer.stop(),t){for(var e in f.audio.remove(),f._systems)f._systems[e].destroy();if(f.stage&&f.stage.elem.parentNode){var i=document.createElement("div");i.id=f.stage.elem.id,f.stage.elem.parentNode.replaceChild(i,f.stage.elem)}f._unbindAll(),f._addCallbackMethods(f),this._preBindDone=!1,z()}return this},pause:function(t){return(1===arguments.length?t:!this._paused)?(this.trigger("Pause"),this._paused=!0,setTimeout((function(){f.timer.stop()}),0)):(this.trigger("Unpause"),this._paused=!1,setTimeout((function(){f.timer.init()}),0)),this},isPaused:function(){return this._paused},timer:(x="fixed",b=5,w=40,C=0,k=0,S=50,D=1e3/S,{init:function(){void 0===_&&(_=Date.now()-D);var t="undefined"!=typeof window&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||null);t?(g=function(){f.timer.step(),null!==g&&(v=t(g))})():g=setInterval((function(){f.timer.step()}),1e3/S)},stop:function(){f.trigger("CraftyStopTimer"),"function"!=typeof g&&clearInterval(g);var t="undefined"!=typeof window&&(window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||null);t&&t(v),g=null},steptype:function(t,e){if("variable"===t||"semifixed"===t)x=t,e&&(w=e),f.trigger("NewSteptype",{mode:x,maxTimeStep:w});else{if("fixed"!==t){if(void 0!==t)throw"Invalid step type specified";return{mode:x,maxTimeStep:"variable"===x||"semifixed"===x?w:b}}x="fixed",e&&(b=e),f.trigger("NewSteptype",{mode:x,maxTimeStep:b})}},step:function(){var t,e,i,n=0,r=Date.now();if(C>0&&f.trigger("MeasureWaitTime",r-C),_+k>=r)C=r;else{var o=r-(_+k);o>20*D&&(k+=o-D,o=D),"fixed"===x?(n=Math.ceil(o/D),n=Math.min(n,b),e=D):"variable"===x?(n=1,e=o,e=Math.min(e,w)):"semifixed"===x&&(e=o/(n=Math.ceil(o/w)));for(var s=0;s<n;s++){i=r;var l={frame:a++,dt:e,gameTime:_};f.trigger("EnterFrame",l),f.trigger("UpdateFrame",l),f.trigger("ExitFrame",l),_+=e,r=Date.now(),f.trigger("MeasureFrameTime",r-i)}n>0&&(t=r,f.trigger("PreRender"),f.trigger("RenderScene"),f.trigger("PostRender"),r=Date.now(),f.trigger("MeasureRenderTime",r-t)),C=r}},FPS:function(t){if(void 0===t)return S;D=1e3/(S=t),f.trigger("FPSChange",t)},simulateFrames:function(t,e){for(e=e||D;t-- >0;){var i={frame:a++,dt:e};f.trigger("EnterFrame",i),f.trigger("UpdateFrame",i),f.trigger("ExitFrame",i)}f.trigger("PreRender"),f.trigger("RenderScene"),f.trigger("PostRender")}}),e:function(){var t=F();return s[t]=null,s[t]=f(t),arguments.length>0&&s[t].addComponent.apply(s[t],arguments),s[t].setName("Entity #"+t),s[t].addComponent("obj"),f.trigger("NewEntity",{id:t}),s[t]},c:function(t,e){o[t]=e},trigger:function(t,e){var i,n,r=l[t]||(l[t]={});for(i in r)r.hasOwnProperty(i)&&(n=r[i])&&0!==n.length&&n.context._runCallbacks(t,e)},bind:function(t,e){return this._bindCallback(t,e),e},uniqueBind:function(t,e){return this.unbind(t,e),this.bind(t,e)},one:function(t,e){var i=this,n=function(r){e.call(i,r),i.unbind(t,n)};return i.bind(t,n)},unbind:function(t,e){this._unbindCallbacks(t,e)},frame:function(){return a},entities:function(){return s},components:function(){return o},isComp:function(t){return t in o},debug:function(t){return"handlers"===t?l:s},settings:(m={},y={},{register:function(t,e){y[t]=e},modify:function(t,e){y[t]&&(y[t].call(m[t],e),m[t]=e)},get:function(t){return m[t]}}),defineField:function(t,e,i,n){Object.defineProperty(t,e,{get:i,set:n,configurable:!1,enumerable:!0})},clone:function t(e){if(null===e||"object"!=typeof e)return e;var i=e.constructor();for(var n in e)i[n]=t(e[n]);return i}}),void 0===(n=function(){return f}.apply(i,[]))||(e.exports=n),e.exports=f},{"./version":20}],11:[function(t,e,i){(function(e){var i=t("../core/core.js"),n="undefined"!=typeof window&&window.document;!function(){var t=i.support={},r="undefined"!=typeof navigator&&navigator.userAgent.toLowerCase()||void 0!==e&&e.version,a=/(webkit)[ \/]([\w.]+)/.exec(r)||/(o)pera(?:.*version)?[ \/]([\w.]+)/.exec(r)||/(ms)ie ([\w.]+)/.exec(r)||/(moz)illa(?:.*? rv:([\w.]+))?/.exec(r)||/(v)\d+\.(\d+)/.exec(r)||[],o=/iPad|iPod|iPhone|Android|webOS|IEMobile/i.exec(r);if(o&&(i.mobile=o[0]),t.defineProperty=function(){if(!("defineProperty"in Object))return!1;try{Object.defineProperty({},"x",{})}catch(t){return!1}return!0}(),t.audio="undefined"!=typeof window&&"canPlayType"in n.createElement("audio"),t.prefix=a[1]||a[0],"moz"===t.prefix&&(t.prefix="Moz"),"o"===t.prefix&&(t.prefix="O"),"v"===t.prefix&&(t.prefix="node"),a[2]&&(t.versionName=a[2],t.version=+a[2].split(".")[0]),t.canvas="undefined"!=typeof window&&"getContext"in n.createElement("canvas"),t.canvas){var s;try{var l=n.createElement("canvas");(s=l.getContext("webgl")||l.getContext("experimental-webgl")).viewportWidth=t.canvas.width,s.viewportHeight=t.canvas.height}catch(t){}t.webgl=!!s}else t.webgl=!1;t.css3dtransform="undefined"!=typeof window&&(void 0!==n.createElement("div").style.Perspective||void 0!==n.createElement("div").style[t.prefix+"Perspective"]),t.deviceorientation="undefined"!=typeof window&&(void 0!==window.DeviceOrientationEvent||void 0!==window.OrientationEvent),t.devicemotion="undefined"!=typeof window&&void 0!==window.DeviceMotionEvent}()}).call(this,t("_process"))},{"../core/core.js":10,_process:1}],12:[function(t,e,i){var n=t("../core/core.js"),r=t("./utility");e.exports={assets:{},__paths:{audio:"",images:""},paths:function(t){if(void 0===t)return this.__paths;t.audio&&(this.__paths.audio=t.audio),t.images&&(this.__paths.images=t.images)},asset:function(t,e){return 1===arguments.length?n.assets[t]:n.assets[t]?void 0:(n.assets[t]=e,this.trigger("NewAsset",{key:t,value:e}),e)},imageWhitelist:["jpg","jpeg","gif","png","svg"],load:function(t,e,i,a){if(Array.isArray(t))n.log("Calling Crafty.load with an array of assets no longer works; see the docs for more details.");else{t="string"==typeof t?JSON.parse(t):t;var o,s,l,c,h,u,d=0,p=(t.audio?Object.keys(t.audio).length:0)+(t.images?Object.keys(t.images).length:0)+(t.sprites?Object.keys(t.sprites).length:0),f=n.paths(),m=function(t,e){return-1===e.search("://")?"audio"===t?f.audio+e:f.images+e:e},y=function(t){return n.asset(t)||null},g=function(t){return"data"===r.fileTypeOf(t).schema?URL.createObjectURL(r.toBlob(t)):t},v=function(t,e){t.onload=x,"webkit"===n.support.prefix&&(t.src=""),t.src=e};for(c in t)for(h in t[c])if(t[c].hasOwnProperty(h)){if(o=t[c][h],l=null,"audio"===c){o="object"==typeof o?o:{"":o+""};var _=Object.keys(o).filter((function(t){var e,i=m(c,o[t]);if(!y(i)&&(e=o[t],n.support.audio&&n.audio.supports(r.fileTypeOf(e).type))&&!n.audio.sounds[h])return g(i)}));_[0]&&(l=n.audio.add(h,_)),l&&(l=l.obj),l&&l.addEventListener&&l.addEventListener("canplaythrough",x,!1)}else s=m(c,h="sprites"===c?h:o),!y(s)&&(u=h,-1<n.imageWhitelist.indexOf(r.fileTypeOf(u).type))&&(l=new Image,s=g(s),"sprites"===c&&n.sprite(o.tile,o.tileh,s,o.map,o.paddingX,o.paddingY,o.paddingAroundBorder),n.asset(s,l),v(l,s));l?l.onerror=b:b.call({src:s})}0===p&&e&&e()}function x(){var t=this.src;this.removeEventListener&&this.removeEventListener("canplaythrough",x,!1),d++,i&&i({loaded:d,total:p,percent:d/p*100,src:t}),d===p&&e&&e()}function b(){var t=this.src;a&&a({loaded:d,total:p,percent:d/p*100,src:t}),++d===p&&e&&e()}},removeAssets:function(t){t="string"==typeof t?JSON.parse(t):t;var e,i,r,a,o=n.paths(),s=function(t,e){return-1===e.search("://")?"audio"===t?o.audio+e:o.images+e:e};for(r in t)for(a in t[r])if(t[r].hasOwnProperty(a))if(e=t[r][a],"audio"===r)if("object"==typeof e)for(var l in e)i=s(r,e[l]),n.asset(i)&&n.audio.remove(a);else"string"==typeof e&&(i=s(r,e),n.asset(i)&&n.audio.remove(a));else if(i=s(r,a="sprites"===r?a:e),n.asset(i)){if("sprites"===r)for(var c in e.map)delete n.components()[c];delete n.assets[i]}}}},{"../core/core.js":10,"./utility":19}],13:[function(t,e,i){var n=t("../core/core.js");e.exports={init:function(){this.changed=[],this.bind("Change",this._changed_attributes),this.bind("Change",this._changed_triggers)},_changed_triggers:function(t,e){var i;for(i in e=n.extend.call({pre:""},e),t)this.trigger("Change["+e.pre+i+"]",t[i]),t[i].constructor===Object&&this._changed_triggers(t[i],{pre:e.pre+i+"."})},_changed_attributes:function(t){var e;for(e in t)this.changed.push(e);return this},is_dirty:function(t){return 0===arguments.length?!!this.changed.length:this.changed.indexOf(t)>-1}}},{"../core/core.js":10}],14:[function(t,e,i){var n=t("../core/core.js");e.exports={_scenes:{},_current:null,scene:function(t,e,i){1!==arguments.length&&"function"==typeof arguments[1]?n.defineScene(t,e,i):n.enterScene(t,arguments[1])},defineScene:function(t,e,i){if("function"!=typeof e)throw"Init function is the wrong type.";this._scenes[t]={},this._scenes[t].initialize=e,void 0!==i&&(this._scenes[t].uninitialize=i)},enterScene:function(t,e){if("function"==typeof e)throw"Scene data cannot be a function";n.trigger("SceneDestroy",{newScene:t}),n.viewport.reset(),n("2D").each((function(){this.has("Persist")||this.destroy()})),null!==this._current&&"uninitialize"in this._scenes[this._current]&&this._scenes[this._current].uninitialize.call(this);var i=this._current;this._current=t,n.trigger("SceneChange",{oldScene:i,newScene:t}),this._scenes.hasOwnProperty(t)?this._scenes[t].initialize.call(this,e):n.error('The scene "'+t+'" does not exist')}}},{"../core/core.js":10}],15:[function(t,e,i){var n=t("../core/core.js");try{var r="undefined"!=typeof window&&window.localStorage||new t("node-localstorage").LocalStorage("./localStorage")}catch(t){r=null}var a=function(t,e){var i=e;if(!r)return n.error("Local storage is not accessible.  (Perhaps you are including crafty.js cross-domain?)"),!1;if(1===arguments.length)try{return JSON.parse(r.getItem(t))}catch(e){return r.getItem(t)}else"object"==typeof e&&(i=JSON.stringify(e)),r.setItem(t,i)};a.remove=function(t){r?r.removeItem(t):n.error("Local storage is not accessible.  (Perhaps you are including crafty.js cross-domain?)")},e.exports=a},{"../core/core.js":10}],16:[function(t,e,i){var n,r=t("../core/core.js");r._systems={},r.s=function(t,e,i,n){if(!e)return r._systems[t];"boolean"==typeof i&&(n=i,i=null),!1===n?(r._systems[t]=new r.CraftySystem(t,e,i),r.trigger("SystemLoaded",t)):r._registerLazySystem(t,e,i)},r._registerLazySystem=function(t,e,i){Object.defineProperty(r._systems,t,{get:function(){return Object.defineProperty(r._systems,t,{value:new r.CraftySystem(t,e,i),writable:!0,enumerable:!0,configurable:!0}),r.trigger("SystemLoaded",t),r._systems[t]},configurable:!0})},r.CraftySystem=(n=1,function(t,e,i){if(this.name=t,!e)return this;if(this._systemTemplate=e,this.extend(e),this.options=function(t,e){var i={};for(var n in e)i[n]=e[n];for(n in t)n in e||(i[n]=t[n]);return i}(this.options,i),r._addCallbackMethods(this),this[0]="system"+n++,"properties"in e){var a=e.properties;for(var o in a)Object.defineProperty(this,o,a[o])}if("events"in e){var s=e.events;for(var l in s){var c="function"==typeof s[l]?s[l]:e[s[l]];this.bind(l,c)}}"function"==typeof this.init&&this.init(t)}),r.CraftySystem.prototype={extend:function(t){for(var e in t)void 0===this[e]&&(this[e]=t[e])},bind:function(t,e){return this._bindCallback(t,e),this},trigger:function(t,e){return this._runCallbacks(t,e),this},unbind:function(t,e){return this._unbindCallbacks(t,e),this},one:function(t,e){var i=this,n=function(r){e.call(i,r),i.unbind(t,n)};return i.bind(t,n)},uniqueBind:function(t,e){return this.unbind(t,e),this.bind(t,e)},destroy:function(){r.trigger("SystemDestroyed",this),"function"==typeof this.remove&&this.remove(),this._unbindAll(),delete r._systems[this.name]}}},{"../core/core.js":10}],17:[function(t,e,i){e.exports={delaySpeed:1,init:function(){this._delays=[],this._delaysPaused=!1,this.bind("UpdateFrame",(function(t){if(!this._delaysPaused)for(var e=this._delays.length;--e>=0;){var i=this._delays[e];if(!1===i)this._delays.splice(e,1);else{for(i.accumulator+=t.dt*this.delaySpeed;i.accumulator>=i.delay&&i.repeat>=0;)i.accumulator-=i.delay,i.repeat--,i.callback.call(this);i.repeat<0&&(this._delays.splice(e,1),"function"==typeof i.callbackOff&&i.callbackOff.call(this))}}}))},delay:function(t,e,i,n){return this._delays.push({accumulator:0,callback:t,callbackOff:n,delay:e,repeat:(i<0?1/0:i)||0}),this},cancelDelay:function(t){for(var e=this._delays.length;--e>=0;){var i=this._delays[e];i&&i.callback===t&&(this._delays[e]=!1)}return this},pauseDelays:function(){this._delaysPaused=!0},resumeDelays:function(){this._delaysPaused=!1}}},{}],18:[function(t,e,i){var n=t("../core/core.js");e.exports={tweenSpeed:1,init:function(){this.tweenGroup={},this.tweenStart={},this.tweens=[],this.uniqueBind("UpdateFrame",this._tweenTick)},_tweenTick:function(t){var e,i,n;for(n=this.tweens.length-1;n>=0;n--)(e=this.tweens[n]).easing.tick(t.dt*this.tweenSpeed),i=e.easing.value(),this._doTween(e.props,i),e.easing.complete&&(this.tweens.splice(n,1),this._endTween(e.props))},_doTween:function(t,e){for(var i in t)this[i]=(1-e)*this.tweenStart[i]+e*t[i]},tween:function(t,e,i){var r={props:t,easing:new n.easing(e,i)};for(var a in t)void 0!==this.tweenGroup[a]&&this.cancelTween(a),this.tweenStart[a]=this[a],this.tweenGroup[a]=t;return this.tweens.push(r),this},cancelTween:function(t){if("string"==typeof t)"object"==typeof this.tweenGroup[t]&&delete this.tweenGroup[t][t];else if("object"==typeof t)for(var e in t)this.cancelTween(e);return this},pauseTweens:function(){this.tweens.map((function(t){t.easing.pause()}))},resumeTweens:function(){this.tweens.map((function(t){t.easing.resume()}))},_endTween:function(t){var e=!1;for(var i in t)e=!0,delete this.tweenGroup[i];e&&this.trigger("TweenEnd",t)}}},{"../core/core.js":10}],19:[function(t,e,i){i.blobOf=function(t){var e=new XMLHttpRequest;return e.responseType="blob",e.open("GET",t),new Promise((function(t,i){e.onload=function(){t(this.response)},e.onerror=i,e.send()}))};var n=/^data:(.+?\/(.+?))?(;base64)?,(\S+)/;i.fileTypeOf=function(t){var e=/^(?:(\w+):)?.+?(?:\.(\w+))?$/.exec(t);switch(e[1]){case"data":return{schema:"data",type:n.exec(t)[2]};case"blob":return i.blobOf(t).then((function(t){return{schema:"blob",type:t.type}}));default:return{schema:e[1],type:e[2]}}};var r=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;i.toBlob=function(t){var e=(t=n.exec(t))[1],i=t[3],a=t[4];a=i?window.atob(a):a;for(var o=new ArrayBuffer(a.length),s=new Uint8Array(o),l=0;a[l];l++)s[l]=a.charCodeAt(l);if(!r)return new window.Blob([o],{type:e});var c=new r;return c.append(o),c.getBlob(e)}},{}],20:[function(t,e,i){e.exports="0.8.0"},{}],21:[function(t,e,i){e.exports=function(e){e&&(t=e);var i=t("./core/core");t("./core/extensions"),i.easing=t("./core/animation"),i.c("Model",t("./core/model")),i.extend(t("./core/scenes")),i.storage=t("./core/storage"),i.c("Delay",t("./core/time")),i.c("Tween",t("./core/tween"));var n=t("./spatial/spatial-grid");return i.HashMap=n,i.map=new n,t("./core/systems"),t("./spatial/2d"),t("./spatial/motion"),t("./spatial/platform"),t("./spatial/collision"),t("./spatial/rect-manager"),t("./spatial/math"),t("./controls/controls-system"),t("./controls/controls"),t("./controls/keyboard"),t("./controls/keycodes"),t("./controls/mouse"),t("./controls/touch"),t("./debug/logging"),i}},{"./controls/controls":4,"./controls/controls-system":3,"./controls/keyboard":5,"./controls/keycodes":6,"./controls/mouse":7,"./controls/touch":8,"./core/animation":9,"./core/core":10,"./core/extensions":11,"./core/model":13,"./core/scenes":14,"./core/storage":15,"./core/systems":16,"./core/time":17,"./core/tween":18,"./debug/logging":24,"./spatial/2d":55,"./spatial/collision":56,"./spatial/math":57,"./spatial/motion":58,"./spatial/platform":59,"./spatial/rect-manager":60,"./spatial/spatial-grid":61}],22:[function(t,e,i){var n=t("./crafty-common.js")();n.extend(t("./core/loader")),n.extend(t("./inputs/dom-events")),t("./graphics/layers"),t("./graphics/canvas"),t("./graphics/canvas-layer"),t("./graphics/webgl"),t("./graphics/webgl-layer"),t("./graphics/color"),t("./graphics/dom"),t("./graphics/dom-helper"),t("./graphics/dom-layer"),t("./graphics/drawing"),t("./graphics/gl-textures"),t("./graphics/renderable"),t("./graphics/html"),t("./graphics/image"),t("./graphics/particles"),t("./graphics/sprite-animation"),t("./graphics/sprite"),t("./graphics/text"),t("./graphics/viewport"),t("./isometric/diamond-iso"),t("./isometric/isometric"),t("./inputs/util"),t("./inputs/device"),t("./inputs/keyboard"),t("./inputs/lifecycle"),t("./inputs/mouse"),t("./inputs/pointer"),t("./inputs/touch"),t("./sound/sound"),t("./debug/debug-layer"),t("./aliases").defineAliases(n),window&&(window.Crafty=n),e.exports=n},{"./aliases":2,"./core/loader":12,"./crafty-common.js":21,"./debug/debug-layer":23,"./graphics/canvas":26,"./graphics/canvas-layer":25,"./graphics/color":27,"./graphics/dom":30,"./graphics/dom-helper":28,"./graphics/dom-layer":29,"./graphics/drawing":31,"./graphics/gl-textures":32,"./graphics/html":33,"./graphics/image":34,"./graphics/layers":35,"./graphics/particles":36,"./graphics/renderable":37,"./graphics/sprite":39,"./graphics/sprite-animation":38,"./graphics/text":40,"./graphics/viewport":41,"./graphics/webgl":43,"./graphics/webgl-layer":42,"./inputs/device":44,"./inputs/dom-events":45,"./inputs/keyboard":46,"./inputs/lifecycle":47,"./inputs/mouse":48,"./inputs/pointer":49,"./inputs/touch":50,"./inputs/util":51,"./isometric/diamond-iso":52,"./isometric/isometric":53,"./sound/sound":54}],23:[function(t,e,i){var n=t("../core/core.js"),r=window.document;n.c("DebugCanvas",{init:function(){this.requires("2D"),n.DebugCanvas.context||n.DebugCanvas.init(),n.DebugCanvas.add(this),this._debug={alpha:1,lineWidth:1},this.bind("RemoveComponent",this.onDebugRemove),this.bind("Remove",this.onDebugDestroy)},onDebugRemove:function(t){"DebugCanvas"===t&&n.DebugCanvas.remove(this)},onDebugDestroy:function(t){n.DebugCanvas.remove(this)},debugAlpha:function(t){return this._debug.alpha=t,this},debugFill:function(t){return void 0===t&&(t="red"),this._debug.fillStyle=t,this},debugStroke:function(t){return void 0===t&&(t="red"),this._debug.strokeStyle=t,this},debugDraw:function(t){var e=t.globalAlpha,i=this._debug;i.alpha&&(t.globalAlpha=this._debug.alpha),i.strokeStyle&&(t.strokeStyle=i.strokeStyle),i.lineWidth&&(t.lineWidth=i.lineWidth),i.fillStyle&&(t.fillStyle=i.fillStyle),this.trigger("DebugDraw",t),t.globalAlpha=e}}),n.c("DebugRectangle",{init:function(){this.requires("2D, DebugCanvas")},debugRectangle:function(t){return this.debugRect=t,this.unbind("DebugDraw",this.drawDebugRect),this.bind("DebugDraw",this.drawDebugRect),this},drawDebugRect:function(t){var e=this.debugRect;null!=e&&e._h&&e._w&&(this._debug.fillStyle&&t.fillRect(e._x,e._y,e._w,e._h),this._debug.strokeStyle&&t.strokeRect(e._x,e._y,e._w,e._h))}}),n.c("WiredMBR",{init:function(){this.requires("DebugRectangle").debugStroke("purple")},events:{PreRender:function(){this.debugRectangle(this._mbr||this)}}});var a={init:function(){this.requires("DebugRectangle").debugFill("pink")},events:{PreRender:function(){this.debugRectangle(this._mbr||this)}}};n.c("SolidMBR",a),n.c("VisibleMBR",a),n.c("DebugPolygon",{init:function(){this.requires("2D, DebugCanvas")},debugPolygon:function(t){return this.polygon=t,this.unbind("DebugDraw",this.drawDebugPolygon),this.bind("DebugDraw",this.drawDebugPolygon),this},drawDebugPolygon:function(t){if(void 0!==this.polygon){t.beginPath();for(var e=this.polygon.points,i=e.length,n=0;n<i;n+=2)t.lineTo(e[n],e[n+1]);t.closePath(),this._debug.fillStyle&&t.fill(),this._debug.strokeStyle&&t.stroke()}}}),n.c("WiredHitBox",{init:function(){this.requires("DebugPolygon").debugStroke("red").matchHitBox(),this.bind("NewHitbox",this.matchHitBox)},matchHitBox:function(){this.debugPolygon(this.map)}}),n.c("SolidHitBox",{init:function(){this.requires("Collision, DebugPolygon").debugFill("orange").debugAlpha(.7).matchHitBox(),this.bind("NewHitbox",this.matchHitBox)},matchHitBox:function(){this.debugPolygon(this.map)}}),n.c("WiredAreaMap",{init:function(){this.requires("DebugPolygon").debugStroke("green").matchAreaMap(),this.bind("NewAreaMap",this.matchAreaMap)},matchAreaMap:function(){this.debugPolygon(this.mapArea)}}),n.c("SolidAreaMap",{init:function(){this.requires("DebugPolygon").debugFill("lime").debugAlpha(.7).matchAreaMap(),this.bind("NewAreaMap",this.matchAreaMap)},matchAreaMap:function(){this.debugPolygon(this.mapArea)}}),n.DebugCanvas={context:null,entities:[],onetimeEntities:[],add:function(t){this.entities.push(t)},remove:function(t){for(var e=this.entities,i=e.length-1;i>=0;i--)e[i]===t&&e.splice(i,1)},init:function(){if(!n.DebugCanvas.context){if(!n.support.canvas)return n.trigger("NoCanvas"),void n.stop();var t;(t=r.createElement("canvas")).width=n.viewport.width,t.height=n.viewport.height,t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.id="debug-canvas",t.style.zIndex=1e5,n.stage.elem.appendChild(t),n.DebugCanvas.context=t.getContext("2d"),n.DebugCanvas._canvas=t}n.unbind("RenderScene",n.DebugCanvas.renderScene),n.bind("RenderScene",n.DebugCanvas.renderScene)},renderScene:function(t){t=t||n.viewport.rect();var e,i=n.DebugCanvas.entities,r=0,a=i.length,o=n.DebugCanvas.context,s=n.viewport;o.setTransform(s._scale,0,0,s._scale,Math.round(s._x*s._scale),Math.round(s._y*s._scale)),o.clearRect(t._x,t._y,t._w,t._h);for(var l=null;r<a;r++)l!==(e=i[r])._drawLayer&&(e._drawLayer?(s=e._drawLayer._viewportRect(),o.setTransform(s._scale,0,0,s._scale,Math.round(-s._x*s._scale),Math.round(-s._y*s._scale))):(s=n.viewport,o.setTransform(s._scale,0,0,s._scale,Math.round(s._x*s._scale),Math.round(s._y*s._scale))),l=e._drawLayer),e.debugDraw(o)}}},{"../core/core.js":10}],24:[function(t,e,i){var n=t("../core/core.js");n.extend({loggingEnabled:!0,log:function(){n.loggingEnabled&&("undefined"!=typeof window?window.console:console)&&console.log&&console.log.apply(console,arguments)},error:function(){n.loggingEnabled&&("undefined"!=typeof window?window.console:console)&&console.error&&console.error.apply(console,arguments)}})},{"../core/core.js":10}],25:[function(t,e,i){var n=t("../core/core.js");n._registerLayerTemplate("Canvas",{type:"Canvas",layerCount:0,_changedObjs:null,_dirtyRects:null,_dirtyCells:null,_viewKeys:null,__tempRect:null,__tempSearchRect:null,__tempScreenRect:null,dirty:function(t){this._changedObjs.push(t)},attach:function(t){t._drawContext=this.context,this.layerCount++},detach:function(t){this.dirty(t),t._drawContext=null,this.layerCount--},context:null,_canvas:null,events:{LayerInit:"layerInit",LayerRemove:"layerRemove",RenderScene:"_render",PixelartSet:"_setPixelart",ViewportResize:"_resize"},layerInit:function(){if(!n.support.canvas)return n.trigger("NoCanvas"),void n.stop();var t;this._changedObjs=[],this._dirtyRects=[],this._dirtyCells={},this._viewKeys={x1:0,y1:0,x2:0,y2:0},this.__tempRect={_x:0,_y:0,_w:0,_h:0},this.__tempSearchRect={_x:0,_y:0,_w:0,_h:0},this.__tempScreenRect={_x:0,_y:0,_w:0,_h:0},(t=document.createElement("canvas")).width=n.viewport.width,t.height=n.viewport.height,t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.style.zIndex=this.options.z,n.stage.elem.appendChild(t),this.context=t.getContext("2d"),this._canvas=t;var e=n.viewport._scale;1!==e&&this.context.scale(e,e)},layerRemove:function(){this._canvas.parentNode.removeChild(this._canvas)},_render:function(){var t=this._dirtyViewport,e=this._changedObjs.length,i=this.context;if(e||t){var n=this.options;if(t&&n){var r=this._viewportRect(),a=r._scale,o=-r._x*a,s=-r._y*a;i.setTransform(a,0,0,a,Math.round(o),Math.round(s))}e/this.layerCount>.6||t?this._drawAll():this._drawDirtyCells(),this._clean()}},_drawDirtyCells:function(t){var e,i,r=this._viewportRect(),a=this.__tempRect,o=this._dirtyRects,s=n.rectManager.integerBounds,l=this.context;for(t=s(t||r),this._createDirtyCells(t),this._createDirtyRects(),e=0,i=o.length;e<i;e+=4)a._x=o[e+0],a._y=o[e+1],a._w=o[e+2],a._h=o[e+3],this._drawRect(a);if(!0===this.debugDirty){var c=n.frame(),h=(6*c+0)%255,u=(6*c+85)%255,d=(6*c+170)%255;for(l.strokeStyle="rgb("+h+", "+u+", "+d+")",e=0,i=o.length;e<i;e+=4)l.strokeRect(o[e+0],o[e+1],o[e+2],o[e+3])}},_drawAll:function(t){var e=this._viewportRect();this._drawRect(t||e)},_drawRect:function(t){var e,i,r,a,o,s=n.rectManager.integerBounds,l=this.context,c=this.__tempSearchRect,h=this.__tempScreenRect;for(h=s(h=this._viewTransformRect(t,h,!0)),t=s(t),c._x=t._x,c._y=t._y,c._w=t._w-1,c._h=t._h-1,(r=n.map.search(c)).sort(this._sort),l.save(),l.save(),l.setTransform(1,0,0,1,0,0),l.beginPath(),l.rect(h._x,h._y,h._w,h._h),l.clearRect(h._x,h._y,h._w,h._h),l.restore(),l.clip(),o=-1/0,e=0,i=r.length;e<i;++e)(a=r[e])._globalZ>o&&a._visible&&a._drawLayer===this&&(a.draw(l),a._changed=!1,o=a._globalZ);l.restore()},debug:function(){n.log(this._changedObjs)},_clean:function(){var t,e,i,n,r,a=this._changedObjs;for(n=0,r=a.length;n<r;n++)t=(i=a[n])._entry.keys,void 0===(e=i.staleKeys)&&(i.staleKeys=e={x1:0,y1:0,x2:0,y2:0}),e.x1=t.x1,e.y1=t.y1,e.x2=t.x2,e.y2=t.y2,i._changed=!1;a.length=0,this._dirtyCells={},this._dirtyRects.length=0,this._dirtyViewport=!1},_createDirtyCells:function(t){var e,i,r,a,o,s,l=this._changedObjs,c=this._dirtyCells,h=n.HashMap.key(t,this._viewKeys);for(e=0,i=l.length;e<i;e++){if(s=(o=l[e]).staleKeys)for(r=s.x1;r<=s.x2;r++)for(a=s.y1;a<=s.y2;a++)h.x1<=r&&r<=h.x2&&h.y1<=a&&a<=h.y2&&(c[r<<16^a]=!0);for(r=(s=o._entry.keys).x1;r<=s.x2;r++)for(a=s.y1;a<=s.y2;a++)h.x1<=r&&r<=h.x2&&h.y1<=a&&a<=h.y2&&(c[r<<16^a]=!0)}},_createDirtyRects:function(){var t,e,i,r=n.HashMap.cellsize(),a=this._dirtyCells,o=this._dirtyRects;for(var s in a)e=(i=(t=+s)<<16>>16)<0?~(t>>16):t>>16,o.push(e*r,i*r,r,r)},_resize:function(){var t=this._canvas;t.width=n.viewport.width,t.height=n.viewport.height},_setPixelart:function(t){var e=this.context;e.imageSmoothingEnabled=!t,e.mozImageSmoothingEnabled=!t,e.webkitImageSmoothingEnabled=!t,e.oImageSmoothingEnabled=!t,e.msImageSmoothingEnabled=!t}})},{"../core/core.js":10}],26:[function(t,e,i){var n=t("../core/core.js");n.c("Canvas",{init:function(){this.requires("Renderable"),this.currentRect={},this._customLayer||this._attachToLayer(n.s("DefaultCanvasLayer"))},remove:function(){this._detachFromLayer()},drawVars:{type:"canvas",pos:{},ctx:null,coord:[0,0,0,0],co:{x:0,y:0,w:0,h:0}},draw:function(t,e,i,n,r){if(this.ready){var a=this.drawVars.pos;a._x=this._x+(e||0),a._y=this._y+(i||0),a._w=n||this._w,a._h=r||this._h;var o,s=t||this._drawContext,l=this.__coord||[0,0,0,0],c=this.drawVars.co;return c.x=l[0]+(e||0),c.y=l[1]+(i||0),c.w=n||l[2],c.h=r||l[3],(this._flipX||this._flipY||this._rotation)&&s.save(),0!==this._rotation&&(s.translate(this._origin.x+this._x,this._origin.y+this._y),a._x=-this._origin.x,a._y=-this._origin.y,s.rotate(this._rotation%360*(Math.PI/180))),(this._flipX||this._flipY)&&(s.scale(this._flipX?-1:1,this._flipY?-1:1),this._flipX&&(a._x=-(a._x+a._w)),this._flipY&&(a._y=-(a._y+a._h))),this._alpha<1&&(o=s.globalAlpha,s.globalAlpha=this._alpha),this.drawVars.ctx=s,this.trigger("Draw",this.drawVars),(0!==this._rotation||this._flipX||this._flipY)&&s.restore(),o&&(s.globalAlpha=o),this}}})},{"../core/core.js":10}],27:[function(t,e,i){var n=t("../core/core.js"),r=window.document;n.extend({assignColor:function(){var t=r.createElement("div");t.style.display="none";var e=!1,i={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#00ff00",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"};function n(t){return t._red=t._blue=t._green=0,t}function a(t){var e=t.toString(16);return 1===e.length&&(e="0"+e),e}function o(t,e){var i,r,a,o=t.length;if(7===o)i=t.substr(1,2),r=t.substr(3,2),a=t.substr(5,2);else{if(4!==o)return n(e);i=t.substr(1,1),i+=i,r=t.substr(2,1),r+=r,a=t.substr(3,1),a+=a}return e._red=parseInt(i,16),e._green=parseInt(r,16),e._blue=parseInt(a,16),e}var s=/rgba?\s*\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,?\s*([0-9.]+)?\)/;function l(t,e){var i=s.exec(t);return null===i||4!==i.length&&5!==i.length?n(e):(e._red=Math.round(parseFloat(i[1])),e._green=Math.round(parseFloat(i[2])),e._blue=Math.round(parseFloat(i[3])),i[4]&&(e._strength=parseFloat(i[4])),e)}function c(n,r){var s,c,h;void 0===i[n]?(!1===e&&(window.document.body.appendChild(t),e=!0),t.style.color=n,l(window.getComputedStyle(t).color,r),i[n]=(s=r._red,c=r._green,h=r._blue,"#"+a(s)+a(c)+a(h))):o(i[n],r);return r}return function(t,e){e=e||{};"#"===(t=t.trim().toLowerCase())[0]?o(t,e):"r"===t[0]&&"g"===t[1]&&"b"===t[2]?l(t,e):c(t,e),e._strength=e._strength||1,e._color=function(t){return"rgba("+t._red+", "+t._green+", "+t._blue+", "+t._strength+")"}(e)}}()}),n.defaultShader("Color",new n.WebGLShader("attribute vec2 aPosition;\nattribute vec3 aOrientation;\nattribute vec2 aLayer;\nattribute vec4 aColor;\n\nvarying lowp vec4 vColor;\n\nuniform  vec4 uViewport;\n\nmat4 viewportScale = mat4(2.0 / uViewport.z, 0, 0, 0,    0, -2.0 / uViewport.w, 0,0,    0, 0,1,0,    -1,+1,0,1);\nvec4 viewportTranslation = vec4(uViewport.xy, 0, 0);\n\nvoid main() {\n  vec2 pos = aPosition;\n  vec2 entityOrigin = aOrientation.xy;\n  mat2 entityRotationMatrix = mat2(cos(aOrientation.z), sin(aOrientation.z), -sin(aOrientation.z), cos(aOrientation.z));\n\n  pos = entityRotationMatrix * (pos - entityOrigin) + entityOrigin;\n  gl_Position = viewportScale * (viewportTranslation + vec4(pos, 1.0/(1.0+exp(aLayer.x) ), 1) );\n  vColor = vec4(aColor.rgb*aColor.a*aLayer.y, aColor.a*aLayer.y);\n}","precision mediump float;\nvarying lowp vec4 vColor;\nvoid main(void) {\n\tgl_FragColor = vColor;\n}",[{name:"aPosition",width:2},{name:"aOrientation",width:3},{name:"aLayer",width:2},{name:"aColor",width:4}],(function(t,e){t.program.writeVector("aColor",e._red/255,e._green/255,e._blue/255,e._strength)}))),n.c("Color",{_red:0,_green:0,_blue:0,_strength:1,_color:"",ready:!0,init:function(){this.__coord=this.__coord||[0,0,0,0],this.bind("Draw",this._drawColor),this._drawLayer&&this._setupColor(this._drawLayer),this.trigger("Invalidate")},events:{LayerAttached:"_setupColor"},remove:function(){this.unbind("Draw",this._drawColor),this.has("DOM")&&(this._element.style.backgroundColor="transparent"),this.trigger("Invalidate")},_setupColor:function(t){"WebGL"===t.type&&this._establishShader("Color",n.defaultShader("Color"))},_drawColor:function(t){this._color&&("DOM"===t.type?(t.style.backgroundColor=this._color,t.style.lineHeight=0):"canvas"===t.type?(t.ctx.fillStyle=this._color,t.ctx.fillRect(t.pos._x,t.pos._y,t.pos._w,t.pos._h)):"webgl"===t.type&&t.program.draw(t,this))},color:function(t){return 0===arguments.length?this._color:(arguments.length>=3?(this._red=arguments[0],this._green=arguments[1],this._blue=arguments[2],"number"==typeof arguments[3]&&(this._strength=arguments[3])):(n.assignColor(t,this),"number"==typeof arguments[1]&&(this._strength=arguments[1])),this._color="rgba("+this._red+", "+this._green+", "+this._blue+", "+this._strength+")",this.trigger("Invalidate"),this)}})},{"../core/core.js":10}],28:[function(t,e,i){var n=t("../core/core.js"),r=window.document;n.extend({domHelper:{innerPosition:function(t,e){e=e||{};var i=t.getBoundingClientRect(),n=i.left+(window.pageXOffset?window.pageXOffset:r.body.scrollLeft),a=i.top+(window.pageYOffset?window.pageYOffset:r.body.scrollTop),o=parseInt(this.getStyle(t,"border-left-width")||0,10)||parseInt(this.getStyle(t,"borderLeftWidth")||0,10)||0,s=parseInt(this.getStyle(t,"border-top-width")||0,10)||parseInt(this.getStyle(t,"borderTopWidth")||0,10)||0;return e.x=n+o,e.y=a+s,e},getStyle:function(t,e){var i;return t.currentStyle?i=t.currentStyle[this.camelize(e)]:window.getComputedStyle&&(i=r.defaultView.getComputedStyle(t,null).getPropertyValue(this.csselize(e))),i},camelize:function(t){return t.replace(/-+(.)?/g,(function(t,e){return e?e.toUpperCase():""}))},csselize:function(t){return t.replace(/[A-Z]/g,(function(t){return t?"-"+t.toLowerCase():""}))},translate:function(t,e,i,a){a=a||{};var o,s=r.documentElement,l=r.body;return i?(o=i._viewportRect(),a.x=(t-n.stage.x+(s&&s.scrollLeft||l&&l.scrollLeft||0))/o._scale+o._x,a.y=(e-n.stage.y+(s&&s.scrollTop||l&&l.scrollTop||0))/o._scale+o._y):(o=n.viewport,a.x=(t-n.stage.x+(s&&s.scrollLeft||l&&l.scrollLeft||0))/o._scale-o._x,a.y=(e-n.stage.y+(s&&s.scrollTop||l&&l.scrollTop||0))/o._scale-o._y),a}}})},{"../core/core.js":10}],29:[function(t,e,i){var n=t("../core/core.js"),r=window.document;n._registerLayerTemplate("DOM",{type:"DOM",_changedObjs:[],_div:null,events:{LayerInit:"layerInit",LayerRemove:"layerRemove",RenderScene:"_render",PixelartSet:"_setPixelart"},layerInit:function(){this._changedObjs=[];var t=this._div=r.createElement("div");n.stage.elem.appendChild(t),t.style.position="absolute",t.style.zIndex=this.options.z,t.style.transformStyle="preserve-3d"},layerRemove:function(){this._div.parentNode.removeChild(this._div)},_setPixelArt:function(t){var e=this._div.style,i=n.domHelper.camelize;t?(e[i("image-rendering")]="optimizeSpeed",e[i("image-rendering")]="-moz-crisp-edges",e[i("image-rendering")]="-o-crisp-edges",e[i("image-rendering")]="-webkit-optimize-contrast",e[i("-ms-interpolation-mode")]="nearest-neighbor",e[i("image-rendering")]="optimize-contrast",e[i("image-rendering")]="pixelated",e[i("image-rendering")]="crisp-edges"):(e[i("image-rendering")]="optimizeQuality",e[i("-ms-interpolation-mode")]="bicubic",e[i("image-rendering")]="auto")},debug:function(){n.log(this._changedObjs)},_render:function(){var t=this._changedObjs;if(this._dirtyViewport&&(this._setViewport(),this._dirtyViewport=!1),t.length){for(var e=0,i=t.length;e<i;++e)t[e].draw()._changed=!1;t.length=0}},dirty:function(t){this._changedObjs.push(t)},attach:function(t){t._drawContext=this.context,this._div.appendChild(t._element),t._element.style.position="absolute",t._element.id="ent"+t[0]},detach:function(t){this._div.removeChild(t._element)},_setViewport:function(){var t=this._div.style,e=this._viewportRect(),i=e._scale,r=-e._x*i,a=-e._y*i;t.transform=t[n.support.prefix+"Transform"]="scale("+i+", "+i+")",t.left=Math.round(r)+"px",t.top=Math.round(a)+"px",t.zIndex=this.options.z}})},{"../core/core.js":10}],30:[function(t,e,i){var n=t("../core/core.js"),r=window.document;n.c("DOM",{_element:null,_cssStyles:null,avoidCss3dTransforms:!1,init:function(){this.requires("Renderable"),this._cssStyles={visibility:"",left:"",top:"",width:"",height:"",zIndex:"",opacity:"",transformOrigin:"",transform:""},this._element=r.createElement("div"),this._customLayer||this._attachToLayer(n.s("DefaultDOMLayer")),this.bind("NewComponent",this._updateClass),this.bind("RemoveComponent",this._removeClass)},remove:function(){this._detachFromLayer(),this.unbind("NewComponent",this._updateClass),this.unbind("RemoveComponent",this._removeClass)},getDomId:function(){return this._element.id},_removeClass:function(t){var e,i=this.__c,n="";for(e in i)e!==t&&(n+=" "+e);n=n.substr(1),this._element.className=n},_updateClass:function(){var t,e=this.__c,i="";for(t in e)i+=" "+t;i=i.substr(1),this._element.className=i},DOM:function(t){if(t&&t.nodeType){var e=this._drawLayer;this._detachFromLayer(),this._element=t,this._attachToLayer(e)}return this},draw:function(){var t=this._element.style,e=this.__coord||[0,0,0,0],i={x:e[0],y:e[1],w:e[2],h:e[3]},r=n.support.prefix,a=[];if(this._cssStyles.visibility!==this._visible&&(this._cssStyles.visibility=this._visible,this._visible?t.visibility="visible":t.visibility="hidden"),n.support.css3dtransform&&!this.avoidCss3dTransforms?a.push("translate3d("+~~this._x+"px,"+~~this._y+"px,0)"):(this._cssStyles.left!==this._x&&(this._cssStyles.left=this._x,t.left=~~this._x+"px"),this._cssStyles.top!==this._y&&(this._cssStyles.top=this._y,t.top=~~this._y+"px")),this._cssStyles.width!==this._w&&(this._cssStyles.width=this._w,t.width=~~this._w+"px"),this._cssStyles.height!==this._h&&(this._cssStyles.height=this._h,t.height=~~this._h+"px"),this._cssStyles.zIndex!==this._z&&(this._cssStyles.zIndex=this._z,t.zIndex=this._z),this._cssStyles.opacity!==this._alpha&&(this._cssStyles.opacity=this._alpha,t.opacity=this._alpha,t[r+"Opacity"]=this._alpha),this._mbr){var o=this._origin.x+"px "+this._origin.y+"px";t.transformOrigin=o,t[r+"TransformOrigin"]=o,n.support.css3dtransform?a.push("rotateZ("+this._rotation+"deg)"):a.push("rotate("+this._rotation+"deg)")}return this._flipX&&a.push("scaleX(-1)"),this._flipY&&a.push("scaleY(-1)"),this._cssStyles.transform!==a.join(" ")&&(this._cssStyles.transform=a.join(" "),t.transform=this._cssStyles.transform,t[r+"Transform"]=this._cssStyles.transform),this.trigger("Draw",{style:t,type:"DOM",co:i}),this},_setCssProperty:function(t,e,i){"number"==typeof i&&(i+="px"),t[e=n.domHelper.camelize(e)]=i,this.trigger("SetStyle",e)},css:function(t,e){var i,r,a=this._element,o=a.style;if("object"==typeof t)for(i in t)t.hasOwnProperty(i)&&(r=t[i],this._setCssProperty(o,i,r));else{if(!e)return n.domHelper.getStyle(a,t);this._setCssProperty(o,t,e)}return this.trigger("Invalidate"),this}})},{"../core/core.js":10}],31:[function(t,e,i){var n=t("../core/core.js");n.extend({background:function(t){n.stage.elem.style.background=t},_pixelartEnabled:!1,pixelart:function(t){n._pixelartEnabled=t,n.trigger("PixelartSet",t)}})},{"../core/core.js":10}],32:[function(t,e,i){var n=t("../core/core.js");function r(t,e){this.gl=t,this.webgl=e,this.max_units=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this.bound_textures=[],this.registered_textures={},this.active=null}function a(t,e){this.manager=t,this.gl=t.gl,this.glTexture=this.gl.createTexture(),this.id=e,this.active=!1,this.unit=null,this.powerOfTwo=!1}n.TextureManager=r,r.prototype={reset:function(){for(var t=0;t<this.bound_textures.length;t++)this.bound_textures[t].unbind();this.bound_textures=[],this.active=null},makeTexture:function(t,e,i){var n=this.webgl,r="texture-(r:"+i+")-"+t;if(void 0!==this.registered_textures[r])return this.registered_textures[r];var o=new a(this,r);return this.registered_textures[r]=o,this.bindTexture(o),o.setImage(e),o.setFilter(n.texture_filter),o.setRepeat(i),o},smallest:function(){for(var t=1/0,e=null,i=0;i<this.bound_textures.length;i++){var n=this.bound_textures[i];n.size<t&&(t=n.size,e=i)}return e},getAvailableUnit:function(){return this.bound_textures.length<this.max_units?this.bound_textures.length:this.smallest()},bindTexture:function(t){if(null===t.unit){var e=this.getAvailableUnit();this.bound_textures[e]&&this.unbindTexture(this.bound_textures[e]),this.bound_textures[e]=t,t.bind(e)}},unbindTexture:function(t){t.unbind()},setActiveTexture:function(t){this.active!==t.id&&(this.gl.activeTexture(this.gl[t.name]),this.active=t.unit)}},n.TextureWrapper=a,a.prototype={bind:function(t){var e=this.gl;this.unit=t,this.name="TEXTURE"+t,this.manager.setActiveTexture(this),e.bindTexture(e.TEXTURE_2D,this.glTexture)},isActive:function(){return this.manager.active===this.unit},unbind:function(){this.unit=null,this.name=null,this.isActive()&&(this.manager.active=null)},setImage:function(t){if(!this.isActive())throw"Trying to set image of texture that isn't active";this.width=t.width,this.height=t.height,this.size=t.width*t.height,this.powerOfTwo=!(Math.log(t.width)/Math.LN2!==Math.floor(Math.log(t.width)/Math.LN2)||Math.log(t.height)/Math.LN2!==Math.floor(Math.log(t.height)/Math.LN2));var e=this.gl;e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t)},setFilter:function(t){if(!this.isActive())throw"Trying to set filter of texture that isn't active";var e=this.gl;e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t)},setRepeat:function(t){if(!this.isActive())throw"Trying to set repeat property of texture that isn't active";if(t&&!this.powerOfTwo)throw"Can't create a repeating image whose dimensions aren't a power of 2 in WebGL contexts";var e=this.gl;this.repeatMode=t?e.REPEAT:e.CLAMP_TO_EDGE,e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,this.repeatMode),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,this.repeatMode)},setToProgram:function(t,e,i){if(null===this.unit)throw"Trying to use texture not set to a texture unit.";var n=this.gl;n.useProgram(t),n.uniform1i(n.getUniformLocation(t,e),this.unit),n.uniform2f(n.getUniformLocation(t,i),this.width,this.height)}}},{"../core/core.js":10}],33:[function(t,e,i){t("../core/core.js").c("HTML",{inner:"",init:function(){this.requires("2D, DOM")},replace:function(t){return this.inner=t,this._element.innerHTML=t,this},append:function(t){return this.inner+=t,this._element.innerHTML+=t,this},prepend:function(t){return this.inner=t+this.inner,this._element.innerHTML=t+this.inner,this}})},{"../core/core.js":10}],34:[function(t,e,i){var n=t("../core/core.js");n.defaultShader("Image",new n.WebGLShader("attribute vec2 aPosition;\nattribute vec3 aOrientation;\nattribute vec2 aLayer;\nattribute vec2 aTextureCoord;\n\nvarying mediump vec3 vTextureCoord;\n\nuniform vec4 uViewport;\nuniform mediump vec2 uTextureDimensions;\n\nmat4 viewportScale = mat4(2.0 / uViewport.z, 0, 0, 0,    0, -2.0 / uViewport.w, 0,0,    0, 0,1,0,    -1,+1,0,1);\nvec4 viewportTranslation = vec4(uViewport.xy, 0, 0);\n\nvoid main() {\n  vec2 pos = aPosition;\n  vec2 entityOrigin = aOrientation.xy;\n  mat2 entityRotationMatrix = mat2(cos(aOrientation.z), sin(aOrientation.z), -sin(aOrientation.z), cos(aOrientation.z));\n  \n  pos = entityRotationMatrix * (pos - entityOrigin) + entityOrigin ;\n  gl_Position = viewportScale * (viewportTranslation + vec4(pos, 1.0/(1.0+exp(aLayer.x) ), 1) );\n  vTextureCoord = vec3(aTextureCoord, aLayer.y);\n}","varying mediump vec3 vTextureCoord;\n  \nuniform sampler2D uSampler;\nuniform mediump vec2 uTextureDimensions;\n\nvoid main(void) {\n  highp vec2 coord =   vTextureCoord.xy / uTextureDimensions;\n  mediump vec4 base_color = texture2D(uSampler, coord);\n  gl_FragColor = vec4(base_color.rgb*base_color.a*vTextureCoord.z, base_color.a*vTextureCoord.z);\n}",[{name:"aPosition",width:2},{name:"aOrientation",width:3},{name:"aLayer",width:2},{name:"aTextureCoord",width:2}],(function(t,e){var i=t.pos;t.program.writeVector("aTextureCoord",0,0,0,i._h,i._w,0,i._w,i._h)}))),n.c("Image",{_repeat:"repeat",ready:!1,init:function(){this.bind("Draw",this._drawImage),this.bind("LayerAttached",this._setupImage)},remove:function(){this.unbind("LayerAttached",this._setupImage),this.unbind("Draw",this._drawImage)},image:function(t,e){if(this.__image=t,this._repeat=e||"no-repeat",this.img=n.asset(t),this.img)this._setupImage(this._drawLayer);else{this.img=new Image,n.asset(t,this.img),this.img.src=t;var i=this;this.img.onload=function(){i._setupImage(i._drawLayer)}}return this.trigger("Invalidate"),this},_setupImage:function(t){this.img&&t&&("Canvas"===t.type?this._pattern=this._drawContext.createPattern(this.img,this._repeat):"WebGL"===t.type&&(this._establishShader("image:"+this.__image,n.defaultShader("Image")),this.program.setTexture(this._drawLayer.makeTexture(this.__image,this.img,"no-repeat"!==this._repeat))),"no-repeat"===this._repeat&&(this.w=this.w||this.img.width,this.h=this.h||this.img.height),this.ready=!0,this.trigger("Invalidate"))},_drawImage:function(t){if("canvas"===t.type){if(!this.ready||!this._pattern)return;var e=t.ctx;e.fillStyle=this._pattern,e.save(),e.translate(t.pos._x,t.pos._y),e.fillRect(0,0,t.pos._w,t.pos._h),e.restore()}else"DOM"===t.type?this.__image&&(t.style.backgroundImage="url("+this.__image+")",t.style.backgroundRepeat=this._repeat):"webgl"===t.type&&t.program.draw(t,this)}})},{"../core/core.js":10}],35:[function(t,e,i){var n=t("../core/core.js");n.extend({_drawLayerTemplates:{},_drawLayers:[],_addDrawLayerInstance:function(t){n._drawLayers.push(t),this._drawLayers.sort((function(t,e){return t.options.z-e.options.z}))},_removeDrawLayerInstance:function(t){var e=this._drawLayers.indexOf(t);e>=0&&this._drawLayers.splice(e,1),this._drawLayers.sort((function(t,e){return t.options.z-e.options.z}))},_registerLayerTemplate:function(t,e){this._drawLayerTemplates[t]=e;var i=this._commonLayerProperties;for(var n in i)e[n]||(e[n]=i[n])},_commonLayerProperties:{options:{xResponse:1,yResponse:1,scaleResponse:1,z:0},_pointerEntities:0,_dirtyViewport:!1,_cachedViewportRect:null,init:function(){this._cachedViewportRect={},this.trigger("LayerInit"),this.uniqueBind("InvalidateViewport",(function(){this._dirtyViewport=!0})),this.trigger("PixelartSet",n._pixelartEnabled),n._addDrawLayerInstance(this)},remove:function(){this.trigger("LayerRemove"),n._removeDrawLayerInstance(this)},_sort:function(t,e){return t._globalZ-e._globalZ},_viewportRect:function(t){var e=this._cachedViewportRect;if(t)return e;var i=n.viewport,r=this.options,a=Math.pow(i._scale,r.scaleResponse);return e._scale=a,e._w=i._width/a,e._h=i._height/a,e._x=r.xResponse*-i._x-.5*(r.xResponse-1)*(1-1/a)*i._width,e._y=r.yResponse*-i._y-.5*(r.yResponse-1)*(1-1/a)*i._height,e},_viewTransformRect:function(t,e,i){var n=this._viewportRect(i),r=n._scale;return(e=e||{})._x=t._x*r+Math.round(-n._x*r),e._y=t._y*r+Math.round(-n._y*r),e._w=t._w*r,e._h=t._h*r,e}},createLayer:function(t,e,i){var r=this._drawLayerTemplates[e];n.s(t,r,i),n.c(t,{init:function(){this.requires("Renderable"),this._customLayer=!0,this.requires(r.type),this._attachToLayer(n.s(t))},remove:function(){this._detachFromLayer()}})}})},{"../core/core.js":10}],36:[function(t,e,i){var n=t("../core/core.js");n.c("Particles",{required:"Renderable",ready:!0,_particlesPaused:!1,init:function(){this._Particles=n.clone(this._Particles),this._Particles.init(),this._Particles.parentEntity=this},events:{UpdateFrame:function(){!this._particlesPaused&&this._Particles.active&&(this._Particles.update(),this.trigger("Invalidate"))},Draw:function(t){this._Particles.active&&"canvas"===t.type&&this._Particles.render(t)}},particles:function(t){return this._Particles.config(t),this._Particles.start(),this},_Particles:{presets:{maxParticles:150,size:18,sizeRandom:4,speed:1,speedRandom:1.2,lifeSpan:29,lifeSpanRandom:7,angle:65,angleRandom:34,startColour:[255,131,0,1],startColourRandom:[48,50,45,0],endColour:[245,35,0,0],endColourRandom:[60,60,60,0],sharpness:20,sharpnessRandom:10,spread:10,duration:-1,fastMode:!1,gravity:{x:0,y:.1},jitter:0,originOffset:{x:0,y:0}},emissionRate:0,elapsedFrames:0,emitCounter:0,active:!0,particles:[],init:function(){for(var t in this.presets)this[t]=this.presets[t]},config:function(t){for(var e in t=t||{})this[e]=t[e];if(this.emissionRate=this.maxParticles/this.lifeSpan,this.particles.length!==this.maxParticles){this.particles.length=0;for(var i=0,n=this.maxParticles;i<n;++i)this.particles.push(new this.Particle)}},start:function(){this.active=!0,this.elapsedFrames=0,this.emitCounter=0;for(var t=this.particles,e=0,i=t.length;e<i;++e)t[e].timeToLive=0;this.parentEntity.trigger("ParticleStart")},stop:function(){this.active=!1,this.parentEntity.trigger("ParticleEnd")},initParticle:function(t){var e,i,n,r,a,o,s,l,c,h,u,d,p,f;t.timeToLive=r=this.lifeSpan+this.lifeSpanRandom*this.RANDM1TO1(),t.positionX=this.originOffset.x+this.spread*this.RANDM1TO1(),t.positionY=this.originOffset.y+this.spread*this.RANDM1TO1(),e=(this.angle+this.angleRandom*this.RANDM1TO1())*(Math.PI/180),i=this.speed+this.speedRandom*this.RANDM1TO1(),t.directionX=Math.sin(e)*i,t.directionY=-Math.cos(e)*i,n=this.size+this.sizeRandom*this.RANDM1TO1(),t.size=n=n<0?0:~~n,a=this.sharpness+this.sharpnessRandom*this.RANDM1TO1(),t.sharpness=a=a>100?100:a<0?0:a,t.sizeSmall=~~(n/200*a),o=s=this.startColour[0]+this.startColourRandom[0]*this.RANDM1TO1(),t.colourR=o>255?255:o<0?0:~~o,o=l=this.startColour[1]+this.startColourRandom[1]*this.RANDM1TO1(),t.colourG=o>255?255:o<0?0:~~o,o=c=this.startColour[2]+this.startColourRandom[2]*this.RANDM1TO1(),t.colourB=o>255?255:o<0?0:~~o,o=h=this.startColour[3]+this.startColourRandom[3]*this.RANDM1TO1(),t.colourA=o>1?1:o<0?0:~~(100*o)/100,u=this.endColour[0]+this.endColourRandom[0]*this.RANDM1TO1(),d=this.endColour[1]+this.endColourRandom[1]*this.RANDM1TO1(),p=this.endColour[2]+this.endColourRandom[2]*this.RANDM1TO1(),f=this.endColour[3]+this.endColourRandom[3]*this.RANDM1TO1(),t.deltaColourR=(u-s)/r,t.deltaColourG=(d-l)/r,t.deltaColourB=(p-c)/r,t.deltaColourA=(f-h)/r},update:function(){var t=this.RANDM1TO1,e=this.gravity.x,i=this.gravity.y,n=this.jitter;this.elapsedFrames++,this.duration>=0&&this.duration<this.elapsedFrames&&this.stop();var r=this.emissionRate>0?1/this.emissionRate:1/0;this.emitCounter++;for(var a,o,s=this.particles,l=0,c=s.length;l<c;++l)(o=s[l]).timeToLive>0?(o.directionX+=e,o.directionY+=i,o.positionX+=o.directionX,o.positionY+=o.directionY,n&&(o.positionX+=n*t(),o.positionY+=n*t()),a=o.colourR+o.deltaColourR,o.colourR=a>255?255:a<0?0:~~a,a=o.colourG+o.deltaColourG,o.colourG=a>255?255:a<0?0:~~a,a=o.colourB+o.deltaColourB,o.colourB=a>255?255:a<0?0:~~a,a=o.colourA+o.deltaColourA,o.colourA=a>1?1:a<0?0:~~(100*a)/100,o.timeToLive--):this.emitCounter>r&&(this.initParticle(o),this.emitCounter-=r)},render:function(t){for(var e,i=t.ctx,n=this.particles,r=0,a=n.length;r<a;r++){var o=(e=n[r]).size,s=o>>1;if(!(e.positionX<0||e.positionX+o>t.pos._w||e.positionY<0||e.positionY+o>t.pos._h)){var l=~~(t.pos._x+e.positionX),c=~~(t.pos._y+e.positionY),h=e.colourR,u=e.colourG,d=e.colourB,p="rgba("+h+","+u+","+d+","+e.colourA+")";if(this.fastMode)i.fillStyle=p;else{var f="rgba("+h+","+u+","+d+",0)",m=i.createRadialGradient(l+s,c+s,e.sizeSmall,l+s,c+s,s);m.addColorStop(0,p),m.addColorStop(.9,f),i.fillStyle=m}i.fillRect(l,c,o,o)}}},Particle:function(){this.positionX=0,this.positionY=0,this.directionX=0,this.directionY=0,this.size=0,this.sizeSmall=0,this.timeToLive=0,this.colourR=0,this.colourG=0,this.colourB=0,this.colourA=0,this.deltaColourR=0,this.deltaColourG=0,this.deltaColourB=0,this.deltaColourA=0,this.sharpness=0},RANDM1TO1:function(){return 2*Math.random()-1}},pauseParticles:function(){this._particlesPaused=!0},resumeParticles:function(){this._particlesPaused=!1}})},{"../core/core.js":10}],37:[function(t,e,i){t("../core/core.js").c("Renderable",{_changed:!1,_alpha:1,_visible:!0,_setterRenderable:function(t,e){this[t]!==e&&(this[t]=e,this.trigger("Invalidate"))},properties:{alpha:{set:function(t){this._setterRenderable("_alpha",t)},get:function(){return this._alpha},configurable:!0,enumerable:!0},_alpha:{enumerable:!1},visible:{set:function(t){this._setterRenderable("_visible",t)},get:function(){return this._visible},configurable:!0,enumerable:!0},_visible:{enumerable:!1}},init:function(){},_hideOnUnfreeze:!1,events:{Freeze:function(){this._hideOnUnfreeze=!this._visible,this._visible=!1,this.trigger("Invalidate")},Unfreeze:function(){this._visible=!this._hideOnUnfreeze,this.trigger("Invalidate")}},_invalidateRenderable:function(){!1===this._changed&&(this._changed=!0,this._drawLayer.dirty(this))},_attachToLayer:function(t){this._drawLayer&&this._detachFromLayer(),this._drawLayer=t,t.attach(this),this.bind("Invalidate",this._invalidateRenderable),this.trigger("LayerAttached",t),this.trigger("Invalidate")},_detachFromLayer:function(){this._drawLayer&&(this._drawLayer.detach(this),this.unbind("Invalidate",this._invalidateRenderable),this.trigger("LayerDetached",this._drawLayer),delete this._drawLayer)},flip:function(t){return this["_flip"+(t=t||"X")]||(this["_flip"+t]=!0,this.trigger("Invalidate")),this},unflip:function(t){return this["_flip"+(t=t||"X")]&&(this["_flip"+t]=!1,this.trigger("Invalidate")),this}})},{"../core/core.js":10}],38:[function(t,e,i){var n=t("../core/core.js");n.c("SpriteAnimation",{_reels:null,_currentReelId:null,_currentReel:null,_isPlaying:!1,animationSpeed:1,init:function(){this._reels={}},reel:function(t,e,i,r,a,o){if(0===arguments.length)return this._currentReelId;if(1===arguments.length&&"string"==typeof t){if(void 0===this._reels[t])throw"The specified reel "+t+" is undefined.";return this.pauseAnimation(),this._currentReelId!==t&&(this._currentReelId=t,this._currentReel=this._reels[t],this._updateSprite(),this.trigger("ReelChange",this._currentReel)),this}var s,l;if((s={id:t,frames:[],currentFrame:0,easing:new n.easing(e),defaultLoops:1}).duration=s.easing.duration,"number"==typeof i)if(o=o||1/0,a>=0)for(l=0;l<a;++l)s.frames.push([i,r]),++i>=o&&(i=0,r++);else for(l=0;l>a;--l)s.frames.push([i,r]),--i<0&&(i=o-1,r--);else{if(3!==arguments.length||"object"!=typeof i)throw"Unrecognized arguments. Please see the documentation for 'reel(...)'.";s.frames=i}return this._reels[t]=s,this},animate:function(t,e){"string"==typeof t&&this.reel(t);var i=this._currentReel;if(null==i)throw"No reel is specified, and there is no currently active reel.";return this.pauseAnimation(),void 0===e&&(e="number"==typeof t?t:1),i.easing.reset(),this.loops(e),this._setFrame(0),this.bind("UpdateFrame",this._animationTick),this._isPlaying=!0,this.trigger("StartAnimation",i),this},resumeAnimation:function(){return!1===this._isPlaying&&null!==this._currentReel&&(this.bind("UpdateFrame",this._animationTick),this._isPlaying=!0,this._currentReel.easing.resume(),this.trigger("StartAnimation",this._currentReel)),this},pauseAnimation:function(){return!0===this._isPlaying&&(this.unbind("UpdateFrame",this._animationTick),this._isPlaying=!1,this._reels[this._currentReelId].easing.pause()),this},resetAnimation:function(){var t=this._currentReel;if(null===t)throw"No active reel to reset.";return this.reelPosition(0),t.easing.repeat(t.defaultLoops),this},loops:function(t){return 0===arguments.length?null!==this._currentReel?this._currentReel.easing.loops:0:(null!==this._currentReel&&(t<0&&(t=1/0),this._currentReel.easing.repeat(t),this._currentReel.defaultLoops=t),this)},reelPosition:function(t){if(null===this._currentReel)throw"No active reel.";if(0===arguments.length)return this._currentReel.currentFrame;var e,i=this._currentReel.frames.length;if("end"===t&&(t=i-1),t<1&&t>0)e=t,t=Math.floor(i*e);else{if(t!==Math.floor(t))throw"Position "+t+" is invalid.";t<0&&(t=i-1+t),e=t/i}return t=Math.min(t,i-1),t=Math.max(t,0),this._setProgress(e),this._setFrame(t),this},reelFrame:function(t){if(null===this._currentReel)throw"No active reel.";var e=this._currentReel.frames.indexOf(t);if(-1===e)throw"Frame name "+t+" is invalid.";return this.reelPosition(e),this},_animationTick:function(t){var e=this._reels[this._currentReelId];e.easing.tick(t.dt*this.animationSpeed);var i=e.easing.value(),n=Math.min(Math.floor(e.frames.length*i),e.frames.length-1);this._setFrame(n),!0===e.easing.complete&&(this.pauseAnimation(),this.trigger("AnimationEnd",this._currentReel))},_setFrame:function(t){var e=this._currentReel;t!==e.currentFrame&&(e.currentFrame=t,this._updateSprite(),this.trigger("FrameChange",e))},_updateSprite:function(){var t=this._currentReel,e=t.frames[t.currentFrame];"string"==typeof e?this.sprite(e):this.sprite(e[0],e[1])},_setProgress:function(t,e){this._currentReel.easing.setProgress(t,e)},isPlaying:function(t){return!!this._isPlaying&&(t?this._currentReelId===t:!!this._currentReelId)},getReel:function(t){if(0===arguments.length){if(!this._currentReelId)return null;t=this._currentReelId}return this._reels[t]}})},{"../core/core.js":10}],39:[function(t,e,i){var n=t("../core/core.js");n.defaultShader("Sprite",new n.WebGLShader("attribute vec2 aPosition;\nattribute vec3 aOrientation;\nattribute vec2 aLayer;\nattribute vec2 aTextureCoord;\n\nvarying mediump vec3 vTextureCoord;\n\nuniform vec4 uViewport;\nuniform mediump vec2 uTextureDimensions;\n\nmat4 viewportScale = mat4(2.0 / uViewport.z, 0, 0, 0,    0, -2.0 / uViewport.w, 0,0,    0, 0,1,0,    -1,+1,0,1);\nvec4 viewportTranslation = vec4(uViewport.xy, 0, 0);\n\nvoid main() {\n  vec2 pos = aPosition;\n  vec2 entityOrigin = aOrientation.xy;\n  mat2 entityRotationMatrix = mat2(cos(aOrientation.z), sin(aOrientation.z), -sin(aOrientation.z), cos(aOrientation.z));\n  \n  pos = entityRotationMatrix * (pos - entityOrigin) + entityOrigin ;\n  gl_Position = viewportScale * (viewportTranslation + vec4(pos, 1.0/(1.0+exp(aLayer.x) ), 1) );\n  vTextureCoord = vec3(aTextureCoord, aLayer.y);\n}","varying mediump vec3 vTextureCoord;\n  \nuniform sampler2D uSampler;\nuniform mediump vec2 uTextureDimensions;\n\nvoid main(void) {\n  highp vec2 coord =   vTextureCoord.xy / uTextureDimensions;\n  mediump vec4 base_color = texture2D(uSampler, coord);\n  gl_FragColor = vec4(base_color.rgb*base_color.a*vTextureCoord.z, base_color.a*vTextureCoord.z);\n}",[{name:"aPosition",width:2},{name:"aOrientation",width:3},{name:"aLayer",width:2},{name:"aTextureCoord",width:2}],(function(t,e){var i=t.co;t.program.writeVector("aTextureCoord",i.x,i.y,i.x,i.y+i.h,i.x+i.w,i.y,i.x+i.w,i.y+i.h)}))),n.extend({sprite:function(t,e,i,r,a,o,s){var l,c,h;"string"==typeof t&&(o=a,a=r,r=e,i=t,t=1,e=1),"string"==typeof e&&(o=a,a=r,r=i,i=e,e=t),!o&&a&&(o=a),a=parseInt(a||0,10),o=parseInt(o||0,10);var u=function(){this.ready=!0,this.trigger("Invalidate")};(h=n.asset(i))||((h=new Image).src=i,n.asset(i,h),h.onload=function(){for(var t in r)n(t).each(u)});var d=function(){this.requires("2D, Sprite"),this.__trim=[0,0,0,0],this.__image=i,this.__map=r,this.__coord=[this.__coord[0],this.__coord[1],this.__coord[2],this.__coord[3]],this.__tile=t,this.__tileh=e,this.__padding=[a,o],this.__padBorder=s,this.sprite(this.__coord[0],this.__coord[1],this.__coord[2],this.__coord[3]),this.img=h,this.img.complete&&this.img.width>0&&(this.ready=!0,this.trigger("Invalidate")),this.w=this.__coord[2],this.h=this.__coord[3],this._setupSpriteImage(this._drawLayer)};for(l in r)r.hasOwnProperty(l)&&(c=r[l],n.c(l,{ready:!1,__coord:[c[0],c[1],c[2]||1,c[3]||1],init:d}));return this}}),n.c("Sprite",{__image:"",__tile:0,__tileh:0,__padding:null,__trim:null,img:null,ready:!1,init:function(){this.__trim=[0,0,0,0],this.bind("Draw",this._drawSprite),this.bind("LayerAttached",this._setupSpriteImage)},remove:function(){this.unbind("Draw",this._drawSprite),this.unbind("LayerAttached",this._setupSpriteImage)},_setupSpriteImage:function(t){this.__image&&this.img&&t&&"WebGL"===t.type&&(this._establishShader(this.__image,n.defaultShader("Sprite")),this.program.setTexture(t.makeTexture(this.__image,this.img,!1)))},_drawSprite:function(t){var e=t.co,i=t.pos,n=t.ctx;if("canvas"===t.type)n.drawImage(this.img,e.x,e.y,e.w,e.h,i._x,i._y,i._w,i._h);else if("DOM"===t.type){var r=this._h/e.h,a=this._w/e.w,o=this._element.style,s=o.backgroundColor;"initial"===s&&(s="");var l=s+" url('"+this.__image+"') no-repeat";l!==o.background&&(o.background=l),o.backgroundPosition="-"+e.x*a+"px -"+e.y*r+"px",1===r&&1===a||(o.backgroundSize=this.img.width*a+"px "+this.img.height*r+"px")}else"webgl"===t.type&&t.program.draw(t,this)},sprite:function(t,e,i,n){if("string"==typeof t){var r=this.__map[t];if(!r)return this;t=r[0],e=r[1],i=r[2]||1,n=r[3]||1}return this.__coord=this.__coord||[0,0,0,0],this.__coord[0]=t*(this.__tile+this.__padding[0])+(this.__padBorder?this.__padding[0]:0)+this.__trim[0],this.__coord[1]=e*(this.__tileh+this.__padding[1])+(this.__padBorder?this.__padding[1]:0)+this.__trim[1],void 0!==i&&void 0!==n&&(this.__coord[2]=this.__trim[2]||i*this.__tile||this.__tile,this.__coord[3]=this.__trim[3]||n*this.__tileh||this.__tileh),this.trigger("Invalidate"),this},crop:function(t,e,i,n){var r=this._mbr||this.pos();return this.__trim=[],this.__trim[0]=t,this.__trim[1]=e,this.__trim[2]=i,this.__trim[3]=n,this.__coord[0]+=t,this.__coord[1]+=e,this.__coord[2]=i,this.__coord[3]=n,this._w=i,this._h=n,this.trigger("Invalidate",r),this}})},{"../core/core.js":10}],40:[function(t,e,i){var n,r,a=t("../core/core.js");a.c("Text",{_text:"",defaultSize:"10px",defaultFamily:"sans-serif",defaultVariant:"normal",defaultLineHeight:"normal",defaultTextAlign:"left",ready:!0,init:function(){this.requires("2D"),this._textFont={type:"",weight:"",size:this.defaultSize,lineHeight:this.defaultLineHeight,family:this.defaultFamily,variant:this.defaultVariant},this._textAlign=this.defaultTextAlign},events:{Draw:function(t){var e=this._fontString();if("DOM"===t.type){var i=this._element,n=i.style;n.color=this._textColor,n.font=e,n.textAlign=this._textAlign,i.innerHTML=this._text}else if("canvas"===t.type){var r=t.ctx;r.save(),r.textBaseline="top",r.fillStyle=this._textColor||"rgb(0,0,0)",r.font=e,r.textAlign=this._textAlign,r.fillText(this._text,t.pos._x,t.pos._y),r.restore()}},SetStyle:function(t){switch(t){case"textAlign":this._textAlign=this._element.style.textAlign;break;case"color":this.textColor(this._element.style.color);break;case"fontType":this._textFont.type=this._element.style.fontType;break;case"fontWeight":this._textFont.weight=this._element.style.fontWeight;break;case"fontSize":this._textFont.size=this._element.style.fontSize;break;case"fontFamily":this._textFont.family=this._element.style.fontFamily;break;case"fontVariant":this._textFont.variant=this._element.style.fontVariant;break;case"lineHeight":this._textFont.lineHeight=this._element.style.lineHeight}}},remove:function(){this.unbind(this._textUpdateEvent,this._dynamicTextUpdate)},_getFontHeight:(n=/([a-zA-Z]+)\b/,r={px:1,pt:4/3,pc:16,cm:96/2.54,mm:96/25.4,in:96,em:void 0,ex:void 0},function(t){var e=parseFloat(t),i=n.exec(t),a=i?i[1]:"px";return void 0!==r[a]?Math.ceil(e*r[a]):Math.ceil(e)}),_textGenerator:null,text:function(t,e){return null==t?this._text:("function"==typeof t?(this._text=t.call(this,e),this._textGenerator=t):(this._text=t,this._textGenerator=null),this.has("Canvas")&&this._resizeForCanvas(),this.trigger("Invalidate"),this)},_dynamicTextOn:!1,_textUpdateEvent:null,_dynamicTextUpdate:function(t){this._textGenerator&&this.text(this._textGenerator,t)},dynamicTextGeneration:function(t,e){return this.unbind(this._textUpdateEvent,this._dynamicTextUpdate),t&&(this._textUpdateEvent=e||"UpdateFrame",this.bind(this._textUpdateEvent,this._dynamicTextUpdate)),this},_resizeForCanvas:function(){var t=this._drawContext;t.font=this._fontString(),this.w=t.measureText(this._text).width;var e=this._textFont.size||this.defaultSize;this.h=1.1*this._getFontHeight(e),"left"===this._textAlign||"start"===this._textAlign?this.offsetBoundary(0,0,0,0):"center"===this._textAlign?this.offsetBoundary(this.w/2,0,-this.w/2,0):"end"!==this._textAlign&&"right"!==this._textAlign||this.offsetBoundary(this.w,0,-this.w,0)},_fontString:function(){return this._textFont.type+" "+this._textFont.variant+" "+this._textFont.weight+" "+this._textFont.size+" / "+this._textFont.lineHeight+" "+this._textFont.family},textColor:function(t){return a.assignColor(t,this),this._textColor="rgba("+this._red+", "+this._green+", "+this._blue+", "+this._strength+")",this.trigger("Invalidate"),this},textAlign:function(t){return this._textAlign=t,this.has("Canvas")&&this._resizeForCanvas(),this.trigger("Invalidate"),this},textFont:function(t,e){if(1===arguments.length){if("string"==typeof t)return this._textFont[t];if("object"==typeof t)for(var i in t)this._textFont[i]="family"===i?"'"+t[i]+"'":t[i]}else this._textFont[t]=e;return this.has("Canvas")&&this._resizeForCanvas(),this.trigger("Invalidate"),this},unselectable:function(){return this.has("DOM")&&(this.css({"-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",cursor:"default"}),this.trigger("Invalidate")),this}})},{"../core/core.js":10}],41:[function(t,e,i){var n=t("../core/core.js"),r=window.document;n.extend({viewport:{clampToEntities:!0,_width:0,_height:0,_x:0,_y:0,_scale:1,bounds:null,scroll:function(t,e){this[t]=e,n.trigger("ViewportScroll"),n.trigger("InvalidateViewport")},rect_object:{_x:0,_y:0,_w:0,_h:0},rect:function(t){return(t=t||this.rect_object)._x=-this._x,t._y=-this._y,t._w=this._width/this._scale,t._h=this._height/this._scale,t},pan:function(){var t,e,i,r,a;function o(o){a.tick(o.dt);var l=a.value();n.viewport.x=(1-l)*i+l*t,n.viewport.y=(1-l)*r+l*e,n.viewport._clamp(),a.complete&&(s(),n.trigger("CameraAnimationDone"))}function s(){n.unbind("UpdateFrame",o)}return n._preBind("StopCamera",s),function(s,l,c,h){n.trigger("StopCamera"),"reset"!==s&&(i=n.viewport._x,r=n.viewport._y,t=i-s,e=r-l,a=new n.easing(c,h),n.uniqueBind("UpdateFrame",o))}}(),follow:function(){var t,e,i;function r(){var t=n.viewport._scale;n.viewport.scroll("_x",-(this.x+this.w/2-n.viewport.width/2/t-e*t)),n.viewport.scroll("_y",-(this.y+this.h/2-n.viewport.height/2/t-i*t)),n.viewport._clamp()}return n._preBind("StopCamera",(function(){t&&(t.unbind("Move",r),t.unbind("ViewportScale",r),t.unbind("ViewportResize",r))})),function(a,o,s){a&&a.has("2D")&&(n.trigger("StopCamera"),t=a,e=void 0!==o?o:0,i=void 0!==s?s:0,a.bind("Move",r),a.bind("ViewportScale",r),a.bind("ViewportResize",r),r.call(a))}}(),centerOn:function(t,e){var i=t.x+n.viewport.x,r=t.y+n.viewport.y,a=t.w/2,o=t.h/2,s=i+a-n.viewport.width/2/n.viewport._scale,l=r+o-n.viewport.height/2/n.viewport._scale;n.viewport.pan(s,l,e)},zoom:function(){function t(){n.unbind("UpdateFrame",h)}var e,i,r,a,o,s,l,c;function h(i){var h,u;c.tick(i.dt),h=Math.pow(r,c.value()),u=1===r?c.value():(1/h-1)/(1/r-1),n.viewport.scale(h*e),n.viewport.scroll("_x",a*(1-u)+o*u),n.viewport.scroll("_y",s*(1-u)+l*u),n.viewport._clamp(),c.complete&&(t(),n.trigger("CameraAnimationDone"))}return n._preBind("StopCamera",t),function(t,u,d,p,f){t?(arguments.length<=2&&(p=u,u=n.viewport.x-n.viewport.width,d=n.viewport.y-n.viewport.height),n.trigger("StopCamera"),e=n.viewport._scale,i=e*(r=t),a=n.viewport.x,s=n.viewport.y,o=-(u-n.viewport.width/(2*i)),l=-(d-n.viewport.height/(2*i)),c=new n.easing(p,f),n.uniqueBind("UpdateFrame",h)):n.viewport.scale(1)}}(),scale:function(t){this._scale=t||1,n.trigger("InvalidateViewport"),n.trigger("ViewportScale")},mouselook:function(){var t,e=!1,i=!1,r={x:0,y:0},a={x:0,y:0};function o(t){i||t.target||(n.trigger("StopCamera"),r.x=t.clientX,r.y=t.clientY,i=!0)}function s(t){if(i){a.x=t.clientX-r.x,a.y=t.clientY-r.y,r.x=t.clientX,r.y=t.clientY;var e=n.viewport;e.x+=a.x/e._scale,e.y+=a.y/e._scale,e._clamp()}}function l(t){i&&(i=!1)}return function(i){t=n.s("Mouse"),i&&!e?(t.bind("MouseDown",o),t.bind("MouseMove",s),t.bind("MouseUp",l),e=i):!i&&e&&(t.unbind("MouseDown",o),t.unbind("MouseMove",s),t.unbind("MouseUp",l),e=i)}}(),_clamp:function(){if(this.clampToEntities){var t=n.clone(this.bounds)||n.map.boundaries();t.max.x*=this._scale,t.min.x*=this._scale,t.max.y*=this._scale,t.min.y*=this._scale,t.max.x-t.min.x>n.viewport.width?n.viewport.x<(-t.max.x+n.viewport.width)/this._scale?n.viewport.x=(-t.max.x+n.viewport.width)/this._scale:n.viewport.x>-t.min.x&&(n.viewport.x=-t.min.x):n.viewport.x=-1*(t.min.x+(t.max.x-t.min.x)/2-n.viewport.width/2),t.max.y-t.min.y>n.viewport.height?n.viewport.y<(-t.max.y+n.viewport.height)/this._scale?n.viewport.y=(-t.max.y+n.viewport.height)/this._scale:n.viewport.y>-t.min.y&&(n.viewport.y=-t.min.y):n.viewport.y=-1*(t.min.y+(t.max.y-t.min.y)/2-n.viewport.height/2)}},init:function(t,e,i){var a;if(void 0===i&&void 0===e&&void 0!==t&&"number"!=typeof t&&(i=t,t=window.innerWidth,e=window.innerHeight),n.createLayer("DefaultCanvasLayer","Canvas",{z:20}),n.createLayer("DefaultDOMLayer","DOM",{z:30}),n.createLayer("DefaultWebGLLayer","WebGL",{z:10}),this._defineViewportProperties(),this._x=0,this._y=0,this._scale=1,this.bounds=null,this._width=t||window.innerWidth,this._height=e||window.innerHeight,void 0===i&&(i="cr-stage"),"string"==typeof i)a=r.getElementById(i);else{if(!("undefined"!=typeof HTMLElement?i instanceof HTMLElement:i instanceof Element))throw new TypeError("stage_elem must be a string or an HTMLElement");a=i}n.stage={x:0,y:0,fullscreen:!1,elem:a||r.createElement("div")},t||e||(r.body.style.overflow="hidden",n.stage.fullscreen=!0),n.addEvent(this,window,"resize",n.viewport.reload),n.addEvent(this,window,"blur",(function(){n.settings.get("autoPause")&&(n._paused||n.pause())})),n.addEvent(this,window,"focus",(function(){n._paused&&n.settings.get("autoPause")&&n.pause()})),n.settings.register("stageSelectable",(function(t){n.stage.elem.onselectstart=t?function(){return!0}:function(){return!1}})),n.settings.modify("stageSelectable",!1),n.settings.register("stageContextMenu",(function(t){n.stage.elem.oncontextmenu=t?function(){return!0}:function(){return!1}})),n.settings.modify("stageContextMenu",!1),n.settings.register("autoPause",(function(){})),n.settings.modify("autoPause",!1),a||(r.body.appendChild(n.stage.elem),n.stage.elem.id=i);var o,s=n.stage.elem.style;if(s.width=this.width+"px",s.height=this.height+"px",s.overflow="hidden",n.bind("ViewportResize",(function(){n.trigger("InvalidateViewport")})),n.mobile){void 0!==typeof s.webkitTapHighlightColor&&(s.webkitTapHighlightColor="rgba(0,0,0,0)");var l=r.createElement("meta"),c=r.getElementsByTagName("head")[0];(l=r.createElement("meta")).setAttribute("name","apple-mobile-web-app-capable"),l.setAttribute("content","yes"),c.appendChild(l),n.addEvent(this,n.stage.elem,"touchmove",(function(t){t.preventDefault()}))}s.position="relative",o=n.domHelper.innerPosition(n.stage.elem),n.stage.x=o.x,n.stage.y=o.y,n.uniqueBind("ViewportResize",this._resize)},_resize:function(){n.stage.elem.style.width=n.viewport.width+"px",n.stage.elem.style.height=n.viewport.height+"px"},_defineViewportProperties:function(){Object.defineProperty(this,"x",{set:function(t){this.scroll("_x",t)},get:function(){return this._x},configurable:!0}),Object.defineProperty(this,"y",{set:function(t){this.scroll("_y",t)},get:function(){return this._y},configurable:!0}),Object.defineProperty(this,"width",{set:function(t){this._width=t,n.trigger("ViewportResize")},get:function(){return this._width},configurable:!0}),Object.defineProperty(this,"height",{set:function(t){this._height=t,n.trigger("ViewportResize")},get:function(){return this._height},configurable:!0})},reload:function(){var t,e=window.innerWidth,i=window.innerHeight;n.stage.fullscreen&&(this._width=e,this._height=i,n.trigger("ViewportResize")),t=n.domHelper.innerPosition(n.stage.elem),n.stage.x=t.x,n.stage.y=t.y},reset:function(){n.viewport.mouselook(!1),n.trigger("StopCamera"),n.viewport.scroll("_x",0),n.viewport.scroll("_y",0),n.viewport.scale(1)},onScreen:function(t){return n.viewport._x+t._x+t._w>0&&n.viewport._y+t._y+t._h>0&&n.viewport._x+t._x<n.viewport.width&&n.viewport._y+t._y<n.viewport.height}}})},{"../core/core.js":10}],42:[function(t,e,i){var n=t("../core/core.js"),r=window.document;function a(t,e){this.shader=e,this.layer=t,this.context=t.context,this.draw=function(){},this.array_size=16,this.max_size=1024,this._indexArray=new Uint16Array(6*this.array_size),this._indexBuffer=t.context.createBuffer()}a.prototype={initAttributes:function(t){this.attributes=t,this._attribute_table={};for(var e=0,i=0;i<t.length;i++){var n=t[i];this._attribute_table[n.name]=n,n.bytes=n.bytes||Float32Array.BYTES_PER_ELEMENT,n.type=n.type||this.context.FLOAT,n.offset=e,n.location=this.context.getAttribLocation(this.shader,n.name),this.context.enableVertexAttribArray(n.location),e+=n.width}this.stride=e,this._attributeArray=new Float32Array(4*this.array_size*this.stride),this._attributeBuffer=this.context.createBuffer(),this._registryHoles=[],this._registrySize=0},growArrays:function(t){if(!(this.array_size>=this.max_size)){var e=Math.min(t,this.max_size),i=new Float32Array(4*e*this.stride),n=new Uint16Array(6*e);i.set(this._attributeArray),n.set(this._indexArray),this._attributeArray=i,this._indexArray=n,this.array_size=e}},registerEntity:function(t){if(0===this._registryHoles.length){if(this._registrySize>=this.max_size)throw"Number of entities exceeds maximum limit.";this._registrySize>=this.array_size&&this.growArrays(2*this.array_size),t._glBufferIndex=this._registrySize,this._registrySize++}else t._glBufferIndex=this._registryHoles.pop()},unregisterEntity:function(t){"number"==typeof t._glBufferIndex&&this._registryHoles.push(t._glBufferIndex),t._glBufferIndex=null},resetRegistry:function(){this._maxElement=0,this._registryHoles.length=0},setCurrentEntity:function(t){this.ent_offset=4*t._glBufferIndex,this.ent=t},switchTo:function(){var t=this.context;t.useProgram(this.shader),t.bindBuffer(t.ARRAY_BUFFER,this._attributeBuffer);for(var e,i=this.attributes,n=0;n<i.length;n++)e=i[n],t.vertexAttribPointer(e.location,e.width,e.type,!1,this.stride*e.bytes,e.offset*e.bytes);var r=this.texture_obj;r&&null===r.unit&&this.layer.texture_manager.bindTexture(r),this.index_pointer=0},setTexture:function(t){void 0===this.texture_obj&&(t.setToProgram(this.shader,"uSampler","uTextureDimensions"),this.texture_obj=t)},addIndices:function(t){var e=this._indexArray,i=this.index_pointer;e[0+i]=0+t,e[1+i]=1+t,e[2+i]=2+t,e[3+i]=1+t,e[4+i]=2+t,e[5+i]=3+t,this.index_pointer+=6},renderBatch:function(){var t=this.context;t.bindBuffer(t.ARRAY_BUFFER,this._attributeBuffer),t.bufferData(t.ARRAY_BUFFER,this._attributeArray,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this._indexArray,t.STATIC_DRAW),t.drawElements(t.TRIANGLES,this.index_pointer,t.UNSIGNED_SHORT,0)},setViewportUniforms:function(t,e){var i=this.context;i.useProgram(this.shader),i.uniform4f(this.shader.viewport,-t._x,-t._y,t._w,t._h)},writeVector:function(t,e,i){for(var n=this._attribute_table[t],r=this.stride,a=n.offset+this.ent_offset*r,o=n.width,s=arguments.length-1,l=this._attributeArray,c=0;c<4;c++)for(var h=0;h<o;h++)l[a+r*c+h]=arguments[(o*c+h)%s+1]}},n._registerLayerTemplate("WebGL",{type:"WebGL",context:null,_compileShader:function(t,e){var i=this.context,n=i.createShader(e);if(i.shaderSource(n,t),i.compileShader(n),!i.getShaderParameter(n,i.COMPILE_STATUS))throw i.getShaderInfoLog(n);return n},_makeProgram:function(t){var e=this.context,i=this._compileShader(t.fragmentCode,e.FRAGMENT_SHADER),n=this._compileShader(t.vertexCode,e.VERTEX_SHADER),r=e.createProgram();if(e.attachShader(r,n),e.attachShader(r,i),e.linkProgram(r),!e.getProgramParameter(r,e.LINK_STATUS))throw"Could not initialise shaders";return r.viewport=e.getUniformLocation(r,"uViewport"),r},getProgramWrapper:function(t,e){if(void 0===this.programs[t]){var i=new a(this,this._makeProgram(e));i.name=t,i.initAttributes(e.attributeList),i.draw=e.drawCallback,i.setViewportUniforms(this._viewportRect(),this.options),this.programs[t]=i}return this.programs[t]},makeTexture:function(t,e,i){return this.texture_manager.makeTexture(t,e,i)},events:{LayerInit:"layerInit",LayerRemove:"layerRemove",RenderScene:"_render",PixelartSet:"_setPixelart",ViewportResize:"_resize"},layerInit:function(){if(!n.support.webgl)return n.trigger("NoWebGL"),void n.stop();var t,e;this.programs={},(t=r.createElement("canvas")).width=n.viewport.width,t.height=n.viewport.height,t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.style.zIndex=this.options.z,n.stage.elem.appendChild(t);try{(e=t.getContext("webgl",{premultipliedalpha:!0})||t.getContext("experimental-webgl",{premultipliedalpha:!0})).viewportWidth=t.width,e.viewportHeight=t.height}catch(t){return n.trigger("NoWebGL"),void n.stop()}this.context=e,this._canvas=t,e.clearColor(0,0,0,0),e.disable(e.DEPTH_TEST),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),e.enable(e.BLEND),this.texture_manager=new n.TextureManager(e,this),this._dirtyViewport=!0},layerRemove:function(){this._canvas.parentNode.removeChild(this._canvas)},_resize:function(){var t=this._canvas;t.width=n.viewport.width,t.height=n.viewport.height;var e=this.context;e.viewportWidth=t.width,e.viewportHeight=t.height},_setPixelart:function(t){var e=this.context;this.texture_filter=t?e.NEAREST:e.LINEAR},visible_gl:[],_render:function(t){t=t||this._viewportRect();var e=this.context;e.viewport(0,0,e.viewportWidth,e.viewportHeight),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);var i=this.programs;if(this._dirtyViewport){var r=this._viewportRect();for(var a in i)i[a].setViewportUniforms(r,this.options);this._dirtyViewport=!1}var o,s=n.map.search(t),l=0,c=s.length,h=this.visible_gl;for(h.length=0,l=0;l<c;l++)(o=s[l])._visible&&o.program&&o._drawLayer===this&&h.push(o);h.sort(this._sort),c=h.length;var u=null;for(l=0;l<c;l++)u!==(o=h[l]).program&&(null!==u&&u.renderBatch(),(u=o.program).index_pointer=0,u.switchTo()),o.draw(),o._changed=!1;null!==u&&u.renderBatch()},dirty:function(t){},attach:function(t){t._drawContext=this.context},detach:function(t){t.program&&t.program.unregisterEntity(t)}})},{"../core/core.js":10}],43:[function(t,e,i){var n=t("../core/core.js");n.extend({WebGLShader:function(t,e,i,n){this.vertexCode=t,this.fragmentCode=e,this.attributeList=i,this.drawCallback=n},defaultShader:function(t,e){if(this._defaultShaders=this._defaultShaders||{},1===arguments.length)return this._defaultShaders[t];this._defaultShaders[t]=e}}),n.c("WebGL",{init:function(){this.requires("Renderable"),this._customLayer||this._attachToLayer(n.s("DefaultWebGLLayer"))},remove:function(){this._detachFromLayer()},drawVars:{type:"webgl",pos:{},ctx:null,coord:[0,0,0,0],co:{x:0,y:0,w:0,h:0}},draw:function(){if(this.ready){var t=this.drawVars.pos;t._x=this._x,t._y=this._y,t._w=this._w,t._h=this._h;var e=this.__coord||[0,0,0,0],i=this.drawVars.co;i.x=e[0],i.y=e[1],i.w=e[2],i.h=e[3],this._flipX&&(i.x=i.x+i.w,i.w=-i.w),this._flipY&&(i.y=i.y+i.h,i.h=-i.h);var n=this._drawContext;this.drawVars.gl=n;var r=this.drawVars.program=this.program;return r.setCurrentEntity(this),r.writeVector("aPosition",this._x,this._y,this._x,this._y+this._h,this._x+this._w,this._y,this._x+this._w,this._y+this._h),r.writeVector("aOrientation",this._origin.x+this._x,this._origin.y+this._y,this._rotation*Math.PI/180),r.writeVector("aLayer",this._globalZ,this._alpha),this.trigger("Draw",this.drawVars),r.addIndices(r.ent_offset),this}},_establishShader:function(t,e){this.program=this._drawLayer.getProgramWrapper(t,e),this.program.registerEntity(this),this.ready=!0}})},{"../core/core.js":10}],44:[function(t,e,i){var n=t("../core/core.js");n.extend({device:{_deviceOrientationCallback:!1,_deviceMotionCallback:!1,_normalizeDeviceOrientation:function(t){var e;window.DeviceOrientationEvent?e={tiltLR:t.gamma,tiltFB:t.beta,dir:t.alpha,motUD:null}:window.OrientationEvent&&(e={tiltLR:90*t.x,tiltFB:-90*t.y,dir:null,motUD:t.z}),n.device._deviceOrientationCallback(e)},_normalizeDeviceMotion:function(t){var e=t.accelerationIncludingGravity,i=e.z>0?1:-1,r={acceleration:e,rawAcceleration:"["+Math.round(e.x)+", "+Math.round(e.y)+", "+Math.round(e.z)+"]",facingUp:i,tiltLR:Math.round(e.x/9.81*-90),tiltFB:Math.round((e.y+9.81)/9.81*90*i)};n.device._deviceMotionCallback(r)},deviceOrientation:function(t){this._deviceOrientationCallback=t,n.support.deviceorientation&&(window.DeviceOrientationEvent?n.addEvent(this,window,"deviceorientation",this._normalizeDeviceOrientation):window.OrientationEvent&&n.addEvent(this,window,"MozOrientation",this._normalizeDeviceOrientation))},deviceMotion:function(t){this._deviceMotionCallback=t,n.support.devicemotion&&window.DeviceMotionEvent&&n.addEvent(this,window,"devicemotion",this._normalizeDeviceMotion)}}})},{"../core/core.js":10}],45:[function(t,e,i){e.exports={_events:{},addEvent:function(t,e,i,n){3===arguments.length&&(n=i,i=e,e=window.document);var r=t[0]||"",a=function(e){n.call(t,e)};this._events[r+e+i+n]||(this._events[r+e+i+n]=a,e.addEventListener(i,a,!1))},removeEvent:function(t,e,i,n){3===arguments.length&&(n=i,i=e,e=window.document);var r=t[0]||"",a=this._events[r+e+i+n];a&&(e.removeEventListener(i,a,!1),delete this._events[r+e+i+n])}}},{}],46:[function(t,e,i){var n=t("../core/core.js");n.s("Keyboard",n.extend.call(n.extend.call(new n.__eventDispatcher,{_evt:{eventName:"",key:0,which:0,originalEvent:null},prepareEvent:function(t){var e=this._evt,i=t.type;return e.eventName="keydown"===i?"KeyDown":"keyup"===i?"KeyUp":i,e.which=null!==t.charCode?t.charCode:t.keyCode,e.key=t.keyCode||t.which,e.originalEvent=t,e},triggerKeyEvent:function(t,e){n.trigger(t,e)},dispatchEvent:function(t){var e=this.prepareEvent(t);this.triggerKey(e.eventName,e)}}),n.__keyboardStateTemplate),{},!1),n.c("Keyboard",{isDown:function(t){return n.s("Keyboard").isKeyDown(t)}})},{"../core/core.js":10}],47:[function(t,e,i){var n=t("../core/core.js"),r=window.document,a=void 0!==r.onwheel?"wheel":void 0!==r.onmousewheel?"mousewheel":"DOMMouseScroll";n._preBind("Load",(function(){n.addEvent(this,r.body,"mouseup",n.detectBlur),n.addEvent(n.s("Keyboard"),window,"blur",n.s("Keyboard").resetKeyDown),n.addEvent(n.s("Mouse"),window,"mouseup",n.s("Mouse").resetButtonDown),n.addEvent(n.s("Touch"),window,"touchend",n.s("Touch").resetTouchPoints),n.addEvent(n.s("Touch"),window,"touchcancel",n.s("Touch").resetTouchPoints),n.addEvent(n.s("Keyboard"),"keydown",n.s("Keyboard").processEvent),n.addEvent(n.s("Keyboard"),"keyup",n.s("Keyboard").processEvent),n.addEvent(n.s("Mouse"),n.stage.elem,"mousedown",n.s("Mouse").processEvent),n.addEvent(n.s("Mouse"),n.stage.elem,"mouseup",n.s("Mouse").processEvent),n.addEvent(n.s("Mouse"),n.stage.elem,"mousemove",n.s("Mouse").processEvent),n.addEvent(n.s("Mouse"),n.stage.elem,"click",n.s("Mouse").processEvent),n.addEvent(n.s("Mouse"),n.stage.elem,"dblclick",n.s("Mouse").processEvent),n.addEvent(this,n.stage.elem,"touchstart",this._touchDispatch),n.addEvent(this,n.stage.elem,"touchmove",this._touchDispatch),n.addEvent(this,n.stage.elem,"touchend",this._touchDispatch),n.addEvent(this,n.stage.elem,"touchcancel",this._touchDispatch),n.addEvent(this,n.stage.elem,"touchleave",this._touchDispatch),n.addEvent(n.s("MouseWheel"),n.stage.elem,a,n.s("MouseWheel").processEvent)})),n.bind("Pause",(function(){n.s("Keyboard").resetKeyDown(),n.s("Mouse").resetButtonDown()})),n._preBind("CraftyStop",(function(){n.s("Keyboard").resetKeyDown(),n.s("Mouse").resetButtonDown()})),n._preBind("CraftyStop",(function(){n.removeEvent(this,r.body,"mouseup",n.detectBlur),n.removeEvent(n.s("Keyboard"),window,"blur",n.s("Keyboard").resetKeyDown),n.removeEvent(n.s("Mouse"),window,"mouseup",n.s("Mouse").resetButtonDown),n.removeEvent(n.s("Touch"),window,"touchend",n.s("Touch").resetTouchPoints),n.removeEvent(n.s("Touch"),window,"touchcancel",n.s("Touch").resetTouchPoints),n.removeEvent(n.s("Keyboard"),"keydown",n.s("Keyboard").processEvent),n.removeEvent(n.s("Keyboard"),"keyup",n.s("Keyboard").processEvent),n.stage&&(n.removeEvent(n.s("Mouse"),n.stage.elem,"mousedown",n.s("Mouse").processEvent),n.removeEvent(n.s("Mouse"),n.stage.elem,"mouseup",n.s("Mouse").processEvent),n.removeEvent(n.s("Mouse"),n.stage.elem,"mousemove",n.s("Mouse").processEvent),n.removeEvent(n.s("Mouse"),n.stage.elem,"click",n.s("Mouse").processEvent),n.removeEvent(n.s("Mouse"),n.stage.elem,"dblclick",n.s("Mouse").processEvent),n.removeEvent(this,n.stage.elem,"touchstart",this._touchDispatch),n.removeEvent(this,n.stage.elem,"touchmove",this._touchDispatch),n.removeEvent(this,n.stage.elem,"touchend",this._touchDispatch),n.removeEvent(this,n.stage.elem,"touchcancel",this._touchDispatch),n.removeEvent(this,n.stage.elem,"touchleave",this._touchDispatch),n.removeEvent(n.s("MouseWheel"),n.stage.elem,a,n.s("MouseWheel").processEvent))}))},{"../core/core.js":10}],48:[function(t,e,i){var n=t("../core/core.js");n.s("MouseWheel",n.extend.call(new n.__eventDispatcher,{_evt:{eventName:"",direction:0,target:null,clientX:0,clientY:0,realX:0,realY:0,originalEvent:null},_mouseSystem:null,prepareEvent:function(t){var e=this._mouseSystem;e||(this._mouseSystem=e=n.s("Mouse"));var i=this._evt;return i.eventName="MouseWheelScroll",i.direction=t.detail<0||t.wheelDelta>0||t.deltaY<0?1:-1,i.clientX=void 0!==t.clientX?t.clientX:e.lastMouseEvent.clientX,i.clientY=void 0!==t.clientY?t.clientY:e.lastMouseEvent.clientY,n.translatePointerEventCoordinates(t,i),i.target=e.mouseObjs?n.findPointerEventTargetByComponent("Mouse",t):null,i.originalEvent=t,i},dispatchEvent:function(t){var e=this.prepareEvent(t);n.trigger("MouseWheelScroll",e)}}),{},!1),n.s("Mouse",n.extend.call(n.extend.call(new n.__eventDispatcher,{normedEventNames:{mousedown:"MouseDown",mouseup:"MouseUp",dblclick:"DoubleClick",click:"Click",mousemove:"MouseMove"},_evt:{eventName:"",mouseButton:-1,target:null,clientX:0,clientY:0,realX:0,realY:0,originalEvent:null},mouseObjs:0,over:null,prepareEvent:function(t){var e=this._evt,i=t.type;return e.eventName=this.normedEventNames[i]||i,void 0===t.which?e.mouseButton=t.button<2?n.mouseButtons.LEFT:4===t.button?n.mouseButtons.MIDDLE:n.mouseButtons.RIGHT:e.mouseButton=t.which<2?n.mouseButtons.LEFT:2===t.which?n.mouseButtons.MIDDLE:n.mouseButtons.RIGHT,e.clientX=t.clientX,e.clientY=t.clientY,n.translatePointerEventCoordinates(t,e),e.target=this.mouseObjs?n.findPointerEventTargetByComponent("Mouse",t):null,e.originalEvent=t,e},triggerMouseEvent:function(t,e){this.trigger(t,e);var i=this.over,n=e.target;"MouseMove"===t&&i!==n&&(i&&(e.eventName="MouseOut",e.target=i,i.trigger("MouseOut",e),e.eventName="MouseMove",e.target=n),this.over=n,n&&(e.eventName="MouseOver",n.trigger("MouseOver",e),e.eventName="MouseMove")),n&&n.trigger(t,e)},dispatchEvent:function(t){var e=this.prepareEvent(t);this.triggerMouse(e.eventName,e)}}),n.__mouseStateTemplate),{},!1),n.c("Mouse",{required:"AreaMap",init:function(){n.s("Mouse").mouseObjs++},remove:function(){n.s("Mouse").mouseObjs--}}),n.c("MouseDrag",{_dragging:!1,required:"Mouse",events:{MouseDown:"_ondown"},init:function(){this._ondown=this._ondown.bind(this),this._ondrag=this._ondrag.bind(this),this._onup=this._onup.bind(this)},_ondown:function(t){t.mouseButton===n.mouseButtons.LEFT&&this.startDrag(t)},_ondrag:function(t){if(!this._dragging||0===t.realX||0===t.realY)return!1;this.trigger("Dragging",t)},_onup:function(t){t.mouseButton===n.mouseButtons.LEFT&&this.stopDrag(t)},startDrag:function(t){if(!this._dragging)return this._dragging=!0,n.s("Mouse").bind("MouseMove",this._ondrag),n.s("Mouse").bind("MouseUp",this._onup),this.trigger("StartDrag",t||n.s("Mouse").lastMouseEvent),this},stopDrag:function(t){if(this._dragging)return this._dragging=!1,n.s("Mouse").unbind("MouseMove",this._ondrag),n.s("Mouse").unbind("MouseUp",this._onup),this.trigger("StopDrag",t||n.s("Mouse").lastMouseEvent),this}})},{"../core/core.js":10}],49:[function(t,e,i){var n=t("../core/core.js");n.extend({findPointerEventTargetByComponent:function(t,e,i){var r=e.target||e.srcElement||n.stage.elem;i=void 0!==i?i:e.clientY,e=void 0!==e.clientX?e.clientX:e;var a,o,s,l,c,h=null,u=-1/0;if("CANVAS"!==r.nodeName){for(;"string"!=typeof r.id&&-1===r.id.indexOf("ent");)r=r.parentNode;var d=n(parseInt(r.id.replace("ent",""),10));c=n.domHelper.translate(e,i,d._drawLayer),d.__c[t]&&d.isAt(c.x,c.y)&&(h=d)}if(!h)for(var p in n._drawLayers){var f=n._drawLayers[p];if(!(f._pointerEntities<=0))for(c=n.domHelper.translate(e,i,f),l=0,s=(o=n.map.unfilteredSearch({_x:c.x,_y:c.y,_w:1,_h:1})).length;l<s;++l)(a=o[l])._visible&&a._drawLayer===f&&a._globalZ>u&&a.__c[t]&&a.isAt(c.x,c.y)&&(u=a._globalZ,h=a)}return h},translatePointerEventCoordinates:function(t,e){e=e||t;var i=n.domHelper.translate(t.clientX,t.clientY,void 0,this.__pointerPos);e.realX=i.x,e.realY=i.y},__pointerPos:{x:0,y:0}}),n.c("AreaMap",{init:function(){this.has("Renderable")&&this._drawLayer&&this._drawLayer._pointerEntities++},remove:function(t){!t&&this.has("Renderable")&&this._drawLayer&&this._drawLayer._pointerEntities--},events:{LayerAttached:function(t){t._pointerEntities++},LayerDetached:function(t){t._pointerEntities--}},areaMap:function(t){if(arguments.length>1){var e=Array.prototype.slice.call(arguments,0);t=new n.polygon(e)}else t=t.constructor===Array?new n.polygon(t.slice()):t.clone();return t.shift(this._x,this._y),this.mapArea=t,this.attach(this.mapArea),this.trigger("NewAreaMap",t),this}}),n.c("Button",{init:function(){var t=!n.mobile||n.mobile&&!n.multitouch()?"Mouse":"Touch";this.requires(t)}})},{"../core/core.js":10}],50:[function(t,e,i){var n,r,a,o=t("../core/core.js");o.extend({multitouch:function(t){return"boolean"!=typeof t?this._multitouch:(this._multitouch=t,this)},_multitouch:!1,_touchDispatch:(r=0,a=0,function(t){o._multitouch?(n||(n=o.s("Touch")),n.processEvent(t)):function(t){var e,i;"touchstart"===t.type?e="mousedown":"touchmove"===t.type?e="mousemove":("touchend"===t.type||"touchcancel"===t.type||"touchleave"===t.type)&&(e="mouseup"),t.touches&&t.touches.length?i=t.touches[0]:t.changedTouches&&t.changedTouches.length&&(i=t.changedTouches[0]);var n=document.createEvent("MouseEvent");if(n.initMouseEvent(e,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,t.relatedTarget),i.target.dispatchEvent(n),"mousedown"===e)r=i.clientX,a=i.clientY;else if("mouseup"===e){var o=i.clientX-r,s=i.clientY-a;o*o+s*s<=256&&(e="click",(n=document.createEvent("MouseEvent")).initMouseEvent(e,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,t.relatedTarget),i.target.dispatchEvent(n))}t.preventDefault()}(t)})}),o.s("Touch",o.extend.call(o.extend.call(new o.__eventDispatcher,{normedEventNames:{touchstart:"TouchStart",touchmove:"TouchMove",touchend:"TouchEnd",touchcancel:"TouchCancel"},_evt:{eventName:"",identifier:-1,target:null,entity:null,realX:0,realY:0,originalEvent:null},touchObjs:0,overs:{},prepareEvent:function(t,e){var i=this._evt;return i.eventName=this.normedEventNames[e]||e,i.identifier=t.identifier,o.translatePointerEventCoordinates(t,i),i.target=this.touchObjs?o.findPointerEventTargetByComponent("Touch",t):null,i.entity=i.target,i},triggerTouchEvent:function(t,e){this.trigger(t,e);var i=e.identifier,n=e.target,r=this.overs[i];r&&("TouchMove"===t&&r!==n||"TouchEnd"===t||"TouchCancel"===t)&&(e.eventName="TouchOut",e.target=r,e.entity=r,r.trigger("TouchOut",e),e.eventName=t,e.target=n,e.entity=n,delete this.overs[i]),n&&n.trigger(t,e),n&&("TouchStart"===t||"TouchMove"===t&&r!==n)&&(e.eventName="TouchOver",n.trigger("TouchOver",e),e.eventName=t,this.overs[i]=n)},dispatchEvent:function(t){for(var e,i=t.changedTouches,n=0,r=i.length;n<r;n++)(e=this.prepareEvent(i[n],t.type)).originalEvent=t,this.triggerTouch(e.eventName,e)}}),o.__touchStateTemplate),{},!1),o.c("Touch",{required:"AreaMap",init:function(){o.s("Touch").touchObjs++},remove:function(){o.s("Touch").touchObjs--}})},{"../core/core.js":10}],51:[function(t,e,i){var n=t("../core/core.js");n.__eventDispatcher=function(){},n.__eventDispatcher.prototype={processEvent:function(t){return this.dispatchEvent(t),this.preventBubbling(t)},dispatchEvent:function(t){},preventBubbling:function(t){if(n.selected&&!(8===t.key||t.key>=112&&t.key<=135))return t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,!(!t.target||"INPUT"!==t.target.nodeName&&"TEXTAREA"!==t.target.nodeName)||(t.preventDefault?t.preventDefault():t.returnValue=!1,!1)}},n.extend({selected:!0,detectBlur:function(t){var e=t.clientX>n.stage.x&&t.clientX<n.stage.x+n.viewport.width&&t.clientY>n.stage.y&&t.clientY<n.stage.y+n.viewport.height;!n.selected&&e&&n.trigger("CraftyFocus"),n.selected&&!e&&n.trigger("CraftyBlur"),n.selected=e}})},{"../core/core.js":10}],52:[function(t,e,i){var n=t("../core/core.js");n.extend({diamondIso:{_tile:{width:0,height:0},getTileDimensions:function(){return{w:this._tile.width,h:this._tile.height}},_map:{width:0,height:0},_origin:{x:0,y:0},_tiles:[],getTile:function(t,e,i){return this._tiles[t][e][i]},init:function(t,e,i,n,r,a){this._tile.width=parseInt(t,10),this._tile.height=parseInt(e,10)||parseInt(t,10)/2,this._tile.r=this._tile.width/this._tile.height,this._map.width=parseInt(i,10),this._map.height=parseInt(n,10)||parseInt(i,10);for(var o=0;o<i;o++){this._tiles[o]=Array();for(var s=0;s<n;s++)this._tiles[o][s]=Array()}return this.x=parseInt(r,10)||0,this.y=parseInt(a,10)||0,this.layerZLevel=i+n+1,this},place:function(t,e,i,n){var r=this.pos2px(e,i),a=t.h/this._tile.height;t.x=r.x,t.y=r.y-(a-2)*this._tile.height-this._tile.height*n,t.z=this.getZAtLoc(e,i,n);for(var o=0;o<=a-2;o++){var s=this._tiles[e][i][n+o];s&&s!==t&&s.destroy(),this._tiles[e][i][n+o]=t}return this},detachTile:function(t){for(var e=0;e<this._map.width;e++)for(var i=0;i<this._map.height;i++)for(var n=this._tiles[e][i].length,r=0;r<n;r++)if(this._tiles[e][i][r]&&t===this._tiles[e][i][r]){for(var a=t.h/this._tile.height,o=0;o<a;o++)this._tiles[e][i][r+o]=void 0;return{x:e,y:i,z:r}}return!1},centerAt:function(t,e){var i=this.pos2px(t,e);n.viewport.x=-i.x+n.viewport.width/2-this._tile.width,n.viewport.y=-i.y+n.viewport.height/2},getZAtLoc:function(t,e,i){return this.layerZLevel*i+t+e},pos2px:function(t,e){return{x:this.x+(t-e-1)*this._tile.width/2,y:this.y+(t+e)*this._tile.height/2}},px2pos:function(t,e){var i=(e-this.y)/this._tile.height,n=(t-this.x)/this._tile.width,r=i+n,a=i-n,o=r>0&&r<this._map.width,s=a>0&&a<this._map.height;if(o&&s)return{x:~~r,y:~~a}},getOverlappingTiles:function(t,e){var i=this.px2pos(t,e),n=[],r=~~i.x,a=~~i.y,o=this._map.width-r,s=this._map.height-a,l=Math.min(o,s),c=this._tiles[r][a][1];c&&n.push(c);for(var h=1;h<l;h++){var u=this._tiles[r+h][a+h][h];u&&n.push(u)}return n},polygon:function(t){t.requires("Collision");var e=[0,t.h-0-this._tile.height/2,0-this._tile.width/2,t.h-0-0,0-this._tile.width,t.h-0-this._tile.height/2,0-this._tile.width/2,t.h-0-this._tile.height];return new n.polygon(e)}}})},{"../core/core.js":10}],53:[function(t,e,i){var n=t("../core/core.js");n.extend({isometric:{_tile:{width:0,height:0},_elements:{},_pos:{x:0,y:0},_z:0,size:function(t,e){return this._tile.width=t,this._tile.height=e>0?e:t/2,this},place:function(t,e,i,r){var a=this.pos2px(t,e);return a.top-=i*(this._tile.height/2),r.x=a.left+n.viewport._x,r.y=a.top+n.viewport._y,r.z+=i,this},pos2px:function(t,e){return{left:t*this._tile.width+(1&e)*(this._tile.width/2),top:e*this._tile.height/2}},px2pos:function(t,e){return{x:-Math.ceil(-t/this._tile.width-.5*(1&e)),y:e/this._tile.height*2}},centerAt:function(t,e){if("number"==typeof t&&"number"==typeof e){var i=this.pos2px(t,e);return n.viewport._x=-i.left+n.viewport.width/2-this._tile.width/2,n.viewport._y=-i.top+n.viewport.height/2-this._tile.height/2,this}return{top:-n.viewport._y+n.viewport.height/2-this._tile.height/2,left:-n.viewport._x+n.viewport.width/2-this._tile.width/2}},area:function(){var t=this.centerAt(),e=this.px2pos(-t.left+n.viewport.width/2,-t.top+n.viewport.height/2),i=this.px2pos(-t.left-n.viewport.width/2,-t.top-n.viewport.height/2);return{x:{start:e.x,end:i.x},y:{start:e.y,end:i.y}}}}})},{"../core/core.js":10}],54:[function(t,e,i){var n=t("../core/core.js"),r=window.document;n.extend({audio:{sounds:{},supported:null,codecs:{ogg:'audio/ogg; codecs="vorbis"',wav:'audio/wav; codecs="1"',webma:'audio/webm; codecs="vorbis"',mp3:'audio/mpeg; codecs="mp3"',m4a:'audio/mp4; codecs="mp4a.40.2"'},volume:1,muted:!1,paused:!1,playCheck:null,_canPlay:function(){if(this.supported={},n.support.audio){var t,e=this.audioElement();for(var i in this.codecs)t=e.canPlayType(this.codecs[i]),this.supported[i]=""!==t&&"no"!==t}},supports:function(t){return null===this.supported&&this._canPlay(),!!this.supported[t]},audioElement:function(){return"undefined"!=typeof Audio?new Audio(""):r.createElement("audio")},create:function(t,e){var i=e.substr(e.lastIndexOf(".")+1).toLowerCase();if(!this.supports(i))return!1;var r=this.audioElement();return r.id=t,r.preload="auto",r.volume=n.audio.volume,r.src=e,n.asset(e,r),this.sounds[t]={obj:r,played:0,volume:n.audio.volume},this.sounds[t]},add:function(t,e){if(n.support.audio){var i,r;if(1===arguments.length&&"object"==typeof t)for(var a in t)for(i in t[a])if(r=n.audio.create(a,t[a][i]))break;if("string"==typeof t&&("string"==typeof e&&(r=n.audio.create(t,e)),"object"==typeof e))for(i in e)if(r=n.audio.create(t,e[i]))break;return r}},play:function(t,e,i){if(0!==e&&n.support.audio&&this.sounds[t]){var r=this.sounds[t],a=this.getOpenChannel();if(!a)return null;a.id=t,a.repeat=e;var o=a.obj;return a.volume=r.volume=r.obj.volume=i||n.audio.volume,o.volume=r.volume,o.src=r.obj.src,this.muted&&(o.volume=0),o.play(),r.played++,a.onEnd=function(){r.played<a.repeat||-1===a.repeat?(this.currentTime&&(this.currentTime=0),this.play(),r.played++):(a.active=!1,this.pause(),this.removeEventListener("ended",a.onEnd,!0),this.currentTime=0,n.trigger("SoundComplete",{id:a.id}))},o.addEventListener("ended",a.onEnd,!0),o}},maxChannels:7,setChannels:function(t){this.maxChannels=t,t<this.channels.length&&(this.channels.length=t)},channels:[],getOpenChannel:function(){for(var t=0;t<this.channels.length;t++){var e=this.channels[t];if(!1===e.active||e.obj.ended&&e.repeat<=this.sounds[e.id].played)return e.active=!0,e}if(t<this.maxChannels){var i={obj:this.audioElement(),active:!0,_is:function(t){return this.id===t&&this.active}};return this.channels.push(i),i}return null},remove:function(t){if(n.support.audio){var e,i,r=n.paths().audio;if(t)this.sounds[t]&&(i=(e=this.sounds[t]).obj.src.split("/").pop(),n.audio.stop(t),delete n.assets[r+i],delete n.assets[e.obj.src],delete n.audio.sounds[t]);else for(var a in this.sounds)i=(e=this.sounds[a]).obj.src.split("/").pop(),n.audio.stop(t),delete n.assets[r+i],delete n.assets[e.obj.src],delete n.audio.sounds[t]}},stop:function(t){var e;if(n.support.audio)for(var i in this.channels)e=this.channels[i],(!t&&e.active||e._is(t))&&(e.active=!1,e.obj.pause())},_mute:function(t){if(n.support.audio){var e;for(var i in this.channels)(e=this.channels[i]).obj.volume=t?0:e.volume;this.muted=t}},toggleMute:function(){this.muted?this._mute(!1):this._mute(!0)},mute:function(){this._mute(!0)},unmute:function(){this._mute(!1)},pause:function(t){var e;if(n.support.audio&&t&&this.sounds[t])for(var i in this.channels)(e=this.channels[i])._is(t)&&!e.obj.paused&&e.obj.pause()},unpause:function(t){var e;if(n.support.audio&&t&&this.sounds[t])for(var i in this.channels)(e=this.channels[i])._is(t)&&e.obj.paused&&e.obj.play()},togglePause:function(t){var e;if(n.support.audio&&t&&this.sounds[t])for(var i in this.channels)(e=this.channels[i])._is(t)&&(e.obj.paused?e.obj.play():e.obj.pause())},isPlaying:function(t){if(!n.support.audio)return!1;for(var e in this.channels)if(this.channels[e]._is(t))return!0;return!1}}})},{"../core/core.js":10}],55:[function(t,e,i){var n=t("../core/core.js"),r=Math.PI/180,a=function(t){var e=Math.cos(t);return e=-1e-10<e&&e<1e-10?0:e},o=function(t){var e=Math.sin(t);return e=-1e-10<e&&e<1e-10?0:e};n.c("2D",{_x:0,_y:0,_w:0,_h:0,_z:0,_globalZ:null,_rotation:0,_origin:null,_mbr:null,_entry:null,_children:null,_parent:null,properties:{x:{set:function(t){this._setter2d("_x",t)},get:function(){return this._x},configurable:!0,enumerable:!0},_x:{enumerable:!1},y:{set:function(t){this._setter2d("_y",t)},get:function(){return this._y},configurable:!0,enumerable:!0},_y:{enumerable:!1},w:{set:function(t){this._setter2d("_w",t)},get:function(){return this._w},configurable:!0,enumerable:!0},_w:{enumerable:!1},h:{set:function(t){this._setter2d("_h",t)},get:function(){return this._h},configurable:!0,enumerable:!0},_h:{enumerable:!1},z:{set:function(t){this._setter2d("_z",t)},get:function(){return this._z},configurable:!0,enumerable:!0},_z:{enumerable:!1},rotation:{set:function(t){this._setter2d("_rotation",t)},get:function(){return this._rotation},configurable:!0,enumerable:!0},_rotation:{enumerable:!1},ox:{set:function(t){var e=t-this._origin.x;this._setter2d("_x",e)},get:function(){return this._x+this._origin.x},configurable:!0,enumerable:!0},oy:{set:function(t){var e=t-this._origin.y;this._setter2d("_y",e)},get:function(){return this._y+this._origin.y},configurable:!0,enumerable:!0}},init:function(){this._globalZ=this[0],this._origin={x:0,y:0},this._bx1=0,this._bx2=0,this._by1=0,this._by2=0,this._children=[],this._entry=n.map.insert(this),this.bind("Move",(function(t){var e=this._cbr||this._mbr||this;this._entry.update(e),this._children.length>0&&this._cascade(t)})),this.bind("Rotate",(function(t){var e=this._cbr||this._mbr||this;this._entry.update(e),this._children.length>0&&this._cascadeRotation(t)})),this.bind("Remove",(function(){if(this._children){for(var t=0;t<this._children.length;t++)delete this._children[t]._parent,this._children[t].destroy&&this._children[t].destroy();this._children=[]}this._parent&&this._parent.detach(this),n.map.remove(this._entry),this.detach()}))},events:{Freeze:function(){n.map.remove(this._entry)},Unfreeze:function(){this._entry=n.map.insert(this,this._entry)}},offsetBoundary:function(t,e,i,n){return 1===arguments.length&&(e=i=n=t),this._bx1=t,this._bx2=i,this._by1=e,this._by2=n,this.trigger("BoundaryOffset"),this._calculateMBR(),this},_calculateMBR:function(){var t=this._origin.x+this._x,e=this._origin.y+this._y,i=-this._rotation*r,n=this._x-this._bx1-t,s=this._x+this._w+this._bx2-t,l=this._y-this._by1-e,c=this._y+this._h+this._by2-e,h=a(i),u=o(i),d=n*h+l*u,p=-n*u+l*h,f=s*h+l*u,m=-s*u+l*h,y=s*h+c*u,g=-s*u+c*h,v=n*h+c*u,_=-n*u+c*h,x=Math.floor(Math.min(d,f,y,v)+t),b=Math.floor(Math.min(p,m,g,_)+e),w=Math.ceil(Math.max(d,f,y,v)+t),C=Math.ceil(Math.max(p,m,g,_)+e);if(this._mbr?(this._mbr._x=x,this._mbr._y=b,this._mbr._w=w-x,this._mbr._h=C-b):this._mbr={_x:x,_y:b,_w:w-x,_h:C-b},this._cbr){var k=this._cbr,S=k.cx,D=k.cy,z=k.r,F=t+(S+this._x-t)*h+(D+this._y-e)*u,A=e-(S+this._x-t)*u+(D+this._y-e)*h;k._x=Math.min(F-z,x),k._y=Math.min(A-z,b),k._w=Math.max(F+z,w)-k._x,k._h=Math.max(A+z,C)-k._y}},_rotate:function(t){var e=this._rotation-t;0!==e&&(this._rotation=t,this._calculateMBR(),this.trigger("Rotate",e))},area:function(){return this._w*this._h},intersect:function(t,e,i,n){var r,a=this._mbr||this;return r="object"==typeof t?t:{_x:t,_y:e,_w:i,_h:n},a._x<r._x+r._w&&a._x+a._w>r._x&&a._y<r._y+r._h&&a._y+a._h>r._y},within:function(t,e,i,n){var r,a=this._mbr||this;return(r="object"==typeof t?t:{_x:t,_y:e,_w:i,_h:n})._x<=a._x&&r._x+r._w>=a._x+a._w&&r._y<=a._y&&r._y+r._h>=a._y+a._h},contains:function(t,e,i,n){var r,a=this._mbr||this;return(r="object"==typeof t?t:{_x:t,_y:e,_w:i,_h:n})._x>=a._x&&r._x+r._w<=a._x+a._w&&r._y>=a._y&&r._y+r._h<=a._y+a._h},pos:function(t){return(t=t||{})._x=this._x,t._y=this._y,t._w=this._w,t._h=this._h,t},mbr:function(t){return t=t||{},this._mbr?(t._x=this._mbr._x,t._y=this._mbr._y,t._w=this._mbr._w,t._h=this._mbr._h,t):this.pos(t)},isAt:function(t,e){if(this.mapArea)return this.mapArea.containsPoint(t,e);if(this.map)return this.map.containsPoint(t,e);var i=this._mbr||this;return i._x<=t&&i._x+i._w>=t&&i._y<=e&&i._y+i._h>=e},move:function(t,e){return"n"===t.charAt(0)&&(this.y-=e),"s"===t.charAt(0)&&(this.y+=e),"e"!==t&&"e"!==t.charAt(1)||(this.x+=e),"w"!==t&&"w"!==t.charAt(1)||(this.x-=e),this},shift:function(t,e,i,n){return(t||e)&&this._setPosition(this._x+t,this._y+e),i&&(this.w+=i),n&&(this.h+=n),this},_cascade:function(t){if(t){var e=this._x-t._x,i=this._y-t._y,n=this._w-t._w,r=this._h-t._h;this._cascadeInner(e,i,n,r)}},_cascadeInner:function(t,e,i,n){for(var r,a=0,o=this._children,s=o.length;a<s;++a)(r=o[a]).__frozen||r.shift(t,e,i,n)},_cascadeRotation:function(t){if(t)for(var e,i=0,n=this._children,s=n.length,l=t*r,c=a(l),h=o(l),u=this._origin.x+this._x,d=this._origin.y+this._y;i<s;++i)(e=n[i]).__frozen||"rotate"in e&&e.rotate(t,u,d,c,h)},attach:function(){for(var t,e=0,i=arguments,n=arguments.length;e<n;++e)(t=i[e])._parent&&t._parent.detach(t),t._parent=this,this._children.push(t);return this},detach:function(t){var e;if(!t){for(e=0;e<this._children.length;e++)this._children[e]._parent=null;return this._children=[],this}for(e=0;e<this._children.length;e++)this._children[e]===t&&this._children.splice(e,1);return t._parent=null,this},origin:function(t,e){if("string"==typeof t)if("centre"===t||"center"===t||-1===t.indexOf(" "))t=this._w/2,e=this._h/2;else{var i=t.split(" ");"top"===i[0]?e=0:"bottom"===i[0]?e=this._h:"middle"!==i[0]&&"center"!==i[1]&&"centre"!==i[1]||(e=this._h/2),"center"===i[1]||"centre"===i[1]||"middle"===i[1]?t=this._w/2:"left"===i[1]?t=0:"right"===i[1]&&(t=this._w)}if(this.rotation){var n=-this._rotation*r,s=t-this._origin.x,l=e-this._origin.y,c=a(n),h=o(n),u=s*(1-c)-l*h,d=l*(1-c)+s*h;this._cascadeInner(u,d,0,0)}return this._origin.x=t,this._origin.y=e,this._mbr&&this._calculateMBR(),this._entry.update(this._cbr||this._mbr||this),this.trigger("OriginChanged"),this.trigger("Invalidate"),this},rotate:function(t,e,i,n,r){var a,o;a=(this._x+this._origin.x-e)*n+(this._y+this._origin.y-i)*r+(e-this._origin.x),o=(this._y+this._origin.y-i)*n-(this._x+this._origin.x-e)*r+(i-this._origin.y),this._setter2d("_rotation",this._rotation-t),this._setter2d("_x",a),this._setter2d("_y",o)},_setPosition:function(t,e){if(t!==this._x||e!==this._y){var i=n.rectManager._pool.copy(this),r=this._mbr;r&&(r._x-=this._x-t,r._y-=this._y-e,this._cbr&&(this._cbr._x-=this._x-t,this._cbr._y-=this._y-e)),this._x=t,this._y=e,this.trigger("Move",i),this.trigger("Invalidate"),n.rectManager._pool.recycle(i)}},_setter2d:function(t,e){if(this[t]!==e){var i,r=n.rectManager._pool.copy(this);if("_rotation"===t)this._rotate(e);else if("_x"===t||"_y"===t)(i=this._mbr)&&(i[t]-=this[t]-e,this._cbr&&(this._cbr[t]-=this[t]-e)),this[t]=e,this.trigger("Move",r);else if("_h"===t||"_w"===t){i=this._mbr;var a=this[t];this[t]=e,i&&this._calculateMBR(),"_w"===t?this.trigger("Resize",{axis:"w",amount:e-a}):"_h"===t&&this.trigger("Resize",{axis:"h",amount:e-a}),this.trigger("Move",r)}else if("_z"===t){var o=e<<0;e=e===o?o:o+1,this._globalZ=1e5*e+this[0],this[t]=e,this.trigger("Reorder")}this[t]=e,this.trigger("Invalidate"),n.rectManager._pool.recycle(r)}}}),n.polygon=function(t){arguments.length>1&&(t=Array.prototype.slice.call(arguments,0)),this.points=t},n.polygon.prototype={containsPoint:function(t,e){var i,n,r=this.points,a=r.length/2,o=!1;for(i=0,n=a-1;i<a;n=i++)r[2*i+1]>e!=r[2*n+1]>e&&t<(r[2*n]-r[2*i])*(e-r[2*i+1])/(r[2*n+1]-r[2*i+1])+r[2*i]&&(o=!o);return o},shift:function(t,e){for(var i=0,n=this.points,r=n.length;i<r;i+=2)n[i]+=t,n[i+1]+=e},clone:function(){return new n.polygon(this.points.slice(0))},rotate:function(t,e,i,n,r){for(var a,o,s=0,l=this.points,c=l.length;s<c;s+=2)a=e+(l[s]-e)*n+(l[s+1]-i)*r,o=i-(l[s]-e)*r+(l[s+1]-i)*n,l[s]=a,l[s+1]=o},intersectRay:function(t,e){for(var i,n,r,a,o,s,l,c,h,u=this.points,d=1/0,p=t._x,f=e.x,m=t._y,y=e.y,g=0,v=u.length,_=u[v-2],x=u[v-1];g<v;g+=2)s=u[g],n=(_-p)*(h=(c=u[g+1])-x)-(x-m)*(l=s-_),a=(_-p)*y-(x-m)*f,0!==(o=f*h-y*l)?(i=n/o,(r=a/o)>=0&&r<=1&&i>=0&&i<d&&(d=i)):0!==n&&0!==a||((i=(_-p)*f+(x-m)*y)>=0&&i<d&&(d=i),(i=(s-p)*f+(c-m)*y)>=0&&i<d&&(d=i)),_=s,x=c;return d}},n.circle=function(t,e,i){var n;this.x=t,this.y=e,this.radius=i,this.points=[];for(var r=0;r<16;r+=2)n=r*Math.PI/8,this.points[r]=this.x+Math.sin(n)*i,this.points[r+1]=this.y+Math.cos(n)*i},n.circle.prototype={containsPoint:function(t,e){var i=this.radius,n=this.x-t,r=this.y-e;return n*n+r*r<i*i},shift:function(t,e){this.x+=t,this.y+=e;for(var i=0,n=this.points,r=n.length;i<r;i+=2)n[i]+=t,n[i+1]+=e},rotate:function(){}},n.matrix=function(t){this.mtx=t,this.width=t[0].length,this.height=t.length},n.matrix.prototype={x:function(t){if(this.width===t.height){for(var e=[],i=0;i<this.height;i++){e[i]=[];for(var r=0;r<t.width;r++){for(var a=0,o=0;o<this.width;o++)a+=this.mtx[i][o]*t.mtx[o][r];e[i][r]=a}}return new n.matrix(e)}},e:function(t,e){return t<1||t>this.mtx.length||e<1||e>this.mtx[0].length?null:this.mtx[t-1][e-1]}}},{"../core/core.js":10}],56:[function(t,e,i){var n=t("../core/core.js"),r=Math.PI/180;n.extend({raycast:function(t,e){for(var i,r,a="obj",o=1/0,s=!0,l=2,c=arguments.length;l<c;++l)"number"===(r=typeof(i=arguments[l]))?o=i+1e-6:"string"===r?a=i:"boolean"===r&&(s=i);var h=t._x,u=t._y,d=e.x,p=e.y,f={},m=[];if(o<0){var y=null,g=1/0;n.map.traverseRay(t,e,(function(i,n){if(y&&g<n)return m.push({obj:y,distance:g,x:h+g*d,y:u+g*p}),y=null,g=1/0,!0;if(i.map&&i.__c[a]&&!f[i[0]]){f[i[0]]=!0;var r=i.map.intersectRay(t,e);r<g&&(y=i,g=r)}})),y&&m.push({obj:y,distance:g,x:h+g*d,y:u+g*p})}else n.map.traverseRay(t,e,(function(i,n){if(n>o)return!0;if(i.map&&i.__c[a]&&!f[i[0]]){f[i[0]]=!0;var r=i.map.intersectRay(t,e);r<o&&m.push({obj:i,distance:r,x:h+r*d,y:u+r*p})}}));return s&&m.sort((function(t,e){return t.distance-e.distance})),m}}),n.c("Collision",{init:function(){this.requires("2D"),this._collisionData={},this.collision()},remove:function(){this._cbr=null,this.unbind("Resize",this._resizeMap),this.unbind("Resize",this._checkBounds)},collision:function(t){if(this.unbind("Resize",this._resizeMap),this.unbind("Resize",this._checkBounds),t){if(arguments.length>1){var e=Array.prototype.slice.call(arguments,0);t=new n.polygon(e)}else t=t.constructor===Array?new n.polygon(t.slice()):t.clone();this._findBounds(t.points)}else t=new n.polygon([0,0,this._w,0,this._w,this._h,0,this._h]),this.bind("Resize",this._resizeMap),this._cbr=null;return this.rotation&&t.rotate(this.rotation,this._origin.x,this._origin.y,Math.cos(-this.rotation*r),Math.sin(-this.rotation*r)),this.map=t,this.attach(this.map),this.map.shift(this._x,this._y),this.trigger("NewHitbox",t),this},cbr:function(t){return t=t||{},this._cbr?(t._x=this._cbr._x,t._y=this._cbr._y,t._w=this._cbr._w,t._h=this._cbr._h,t):this.mbr(t)},_findBounds:function(t){for(var e=1/0,i=-1/0,n=1/0,r=-1/0,a=t.length,o=0;o<a;o+=2)t[o]<e&&(e=t[o]),t[o]>i&&(i=t[o]),t[o+1]<n&&(n=t[o+1]),t[o+1]>r&&(r=t[o+1]);var s={cx:(e+i)/2,cy:(n+r)/2,r:Math.sqrt((i-e)*(i-e)+(r-n)*(r-n))/2};return e>=0&&n>=0&&(this._checkBounds=function(){null===this._cbr&&this._w<i||this._h<r?(this._cbr=s,this._calculateMBR()):this._cbr&&(this._cbr=null,this._calculateMBR())},this.bind("Resize",this._checkBounds)),e>=0&&n>=0&&i<=this._w&&r<=this._h?(this._cbr=null,!1):(this._cbr=s,this._calculateMBR(),!0)},_resizeMap:function(t){var e,i,n=this.rotation*r,a=this.map.points;"w"===t.axis?(n?(e=t.amount*Math.cos(n),i=t.amount*Math.sin(n)):(e=t.amount,i=0),a[2]+=e,a[3]+=i):(n?(i=t.amount*Math.cos(n),e=-t.amount*Math.sin(n)):(e=0,i=t.amount),a[6]+=e,a[7]+=i),a[4]+=e,a[5]+=i},_collisionHitDupes:[],_collisionHitResults:[],hit:function(t,e){var i=this._cbr||this._mbr||this,r=this._collisionHitResults;r.length=0;var a=(r=n.map.unfilteredSearch(i,r)).length;if(!a)return null;var o,s,l=0,c=this._collisionHitDupes;for(e=e||[],c.length=0;l<a;++l)if((s=r[l])&&!c[o=s[0]]&&this[0]!==o&&s.__c[t])if(c[o]=s,s.map){var h=this._SAT(this.map,s.map);h&&(e.push(h),h.obj=s,h.type="SAT")}else n.rectManager.overlap(i,s._cbr||s._mbr||s)&&e.push({obj:s,type:"MBR"});return e.length?e:null},onHit:function(t,e,i){var n=!1;return this.bind("UpdateFrame",(function(){var r=this.hit(t);r?(e.call(this,r,!n),n=!0):n&&("function"==typeof i&&i.call(this),n=!1)})),this},_createCollisionHandler:function(t,e){return function(){var i=this.hit(t);if(!0===e.occurring){if(null!==i)return;e.occurring=!1,this.trigger("HitOff",t)}else null!==i&&(e.occurring=!0,this.trigger("HitOn",i))}},checkHits:function(){var t=arguments,e=0;for(1===t.length&&(t=t[0].split(/\s*,\s*/));e<t.length;++e){var i=t[e],n=this._collisionData[i];void 0===n&&(this._collisionData[i]=n={occurring:!1,handler:null},n.handler=this._createCollisionHandler(i,n),this.bind("UpdateFrame",n.handler))}return this},ignoreHits:function(){var t,e=arguments,i=0;if(0===e.length){for(t in this._collisionData)this.unbind("UpdateFrame",t.handler);this._collisionData={}}for(1===e.length&&(e=e[0].split(/\s*,\s*/));i<e.length;++i){var n=e[i];void 0!==(t=this._collisionData[n])&&(this.unbind("UpdateFrame",t.handler),delete this._collisionData[n])}return this},resetHitChecks:function(){var t,e=arguments,i=0;if(0===e.length)for(t in this._collisionData)this._collisionData[t].occurring=!1;for(1===e.length&&(e=e[0].split(/\s*,\s*/));i<e.length;++i){var n=e[i];void 0!==(t=this._collisionData[n])&&(t.occurring=!1)}return this},_SAT:function(t,e){for(var i,n,r,a,o,s,l,c,h,u=0,d=t.points,p=e.points,f=d.length/2,m=p.length/2,y=0,g=0,v=-1/0,_=null,x=null;u<f;u++){for(h=u===f-1?0:u+1,y=-(d[2*u+1]-d[2*h+1]),g=d[2*u]-d[2*h],y/=n=Math.sqrt(y*y+g*g),g/=n,r=a=1/0,o=s=-1/0,i=0;i<f;++i)(c=d[2*i]*y+d[2*i+1]*g)>o&&(o=c),c<r&&(r=c);for(i=0;i<m;++i)(c=p[2*i]*y+p[2*i+1]*g)>s&&(s=c),c<a&&(a=c);if(r<a?(l=a-o,y=-y,g=-g):l=r-s,l>=0)return!1;l>v&&(v=l,_=y,x=g)}for(u=0;u<m;u++){for(h=u===m-1?0:u+1,y=-(p[2*u+1]-p[2*h+1]),g=p[2*u]-p[2*h],y/=n=Math.sqrt(y*y+g*g),g/=n,r=a=1/0,o=s=-1/0,i=0;i<f;++i)(c=d[2*i]*y+d[2*i+1]*g)>o&&(o=c),c<r&&(r=c);for(i=0;i<m;++i)(c=p[2*i]*y+p[2*i+1]*g)>s&&(s=c),c<a&&(a=c);if(r<a?(l=a-o,y=-y,g=-g):l=r-s,l>=0)return!1;l>v&&(v=l,_=y,x=g)}return{overlap:v,nx:_,ny:x}}})},{"../core/core.js":10}],57:[function(t,e,i){var n=t("../core/core.js");n.math={abs:function(t){return t<0?-t:t},amountOf:function(t,e,i){return e<i?(t-e)/(i-e):(t-i)/(e-i)},clamp:function(t,e,i){return t>i?i:t<e?e:t},degToRad:function(t){return t*Math.PI/180},distance:function(t,e,i,r){var a=n.math.squaredDistance(t,e,i,r);return Math.sqrt(parseFloat(a))},lerp:function(t,e,i){return t+(e-t)*i},negate:function(t){return Math.random()<t?-1:1},radToDeg:function(t){return 180*t/Math.PI},randomElementOfArray:function(t){return t[Math.floor(t.length*Math.random())]},randomInt:function(t,e){return t+Math.floor((1+e-t)*Math.random())},randomNumber:function(t,e){return t+(e-t)*Math.random()},squaredDistance:function(t,e,i,n){return(t-i)*(t-i)+(e-n)*(e-n)},withinRange:function(t,e,i){return t>=e&&t<=i}},n.math.Vector2D=function(){function t(e,i){if(e instanceof t)this.x=e.x,this.y=e.y;else if(2===arguments.length)this.x=e,this.y=i;else if(arguments.length>0)throw"Unexpected number of arguments for Vector2D()"}return t.prototype.x=0,t.prototype.y=0,t.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.angleBetween=function(t){return Math.atan2(this.x*t.y-this.y*t.x,this.x*t.x+this.y*t.y)},t.prototype.angleTo=function(t){return Math.atan2(t.y-this.y,t.x-this.x)},t.prototype.clone=function(){return new t(this)},t.prototype.distance=function(t){return Math.sqrt((t.x-this.x)*(t.x-this.x)+(t.y-this.y)*(t.y-this.y))},t.prototype.distanceSq=function(t){return(t.x-this.x)*(t.x-this.x)+(t.y-this.y)*(t.y-this.y)},t.prototype.divide=function(t){return this.x/=t.x,this.y/=t.y,this},t.prototype.dotProduct=function(t){return this.x*t.x+this.y*t.y},t.prototype.crossProduct=function(t){return this.x*t.y-this.y*t.x},t.prototype.equals=function(e){return e instanceof t&&this.x===e.x&&this.y===e.y},t.prototype.perpendicular=function(e){return(e=e||new t).setValues(-this.y,this.x)},t.prototype.getNormal=function(e,i){return(i=i||new t).setValues(e.y-this.y,this.x-e.x).normalize()},t.prototype.isZero=function(){return 0===this.x&&0===this.y},t.prototype.magnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.prototype.magnitudeSq=function(){return this.x*this.x+this.y*this.y},t.prototype.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},t.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},t.prototype.normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y);return 0===t?(this.x=1,this.y=0):(this.x/=t,this.y/=t),this},t.prototype.scale=function(t,e){return void 0===e&&(e=t),this.x*=t,this.y*=e,this},t.prototype.scaleToMagnitude=function(t){var e=t/this.magnitude();return this.x*=e,this.y*=e,this},t.prototype.setValues=function(e,i){return e instanceof t?(this.x=e.x,this.y=e.y):(this.x=e,this.y=i),this},t.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},t.prototype.toString=function(){return"Vector2D("+this.x+", "+this.y+")"},t.prototype.translate=function(t,e){return void 0===e&&(e=t),this.x+=t,this.y+=e,this},t.tripleProduct=function(t,e,i,r){r=r||new n.math.Vector2D;var a=t.dotProduct(i),o=e.dotProduct(i);return r.setValues(e.x*a-t.x*o,e.y*a-t.y*o)},t}(),n.math.Matrix2D=function(){function t(e,i,n,r,a,o){if(e instanceof t)this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.e=e.e,this.f=e.f;else if(6===arguments.length)this.a=e,this.b=i,this.c=n,this.d=r,this.e=a,this.f=o;else if(arguments.length>0)throw"Unexpected number of arguments for Matrix2D()"}return t.prototype.a=1,t.prototype.b=0,t.prototype.c=0,t.prototype.d=1,t.prototype.e=0,t.prototype.f=0,t.prototype.apply=function(t){var e=t.x;return t.x=e*this.a+t.y*this.c+this.e,t.y=e*this.b+t.y*this.d+this.f,t},t.prototype.clone=function(){return new t(this)},t.prototype.combine=function(t){var e=this.a;return this.a=e*t.a+this.b*t.c,this.b=e*t.b+this.b*t.d,e=this.c,this.c=e*t.a+this.d*t.c,this.d=e*t.b+this.d*t.d,e=this.e,this.e=e*t.a+this.f*t.c+t.e,this.f=e*t.b+this.f*t.d+t.f,this},t.prototype.equals=function(e){return e instanceof t&&this.a===e.a&&this.b===e.b&&this.c===e.c&&this.d===e.d&&this.e===e.e&&this.f===e.f},t.prototype.determinant=function(){return this.a*this.d-this.b*this.c},t.prototype.invert=function(){var t=this.determinant();if(0!==t){var e={a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f};this.a=e.d/t,this.b=-e.b/t,this.c=-e.c/t,this.d=e.a/t,this.e=(e.c*e.f-e.e*e.d)/t,this.f=(e.e*e.b-e.a*e.f)/t}return this},t.prototype.isIdentity=function(){return 1===this.a&&0===this.b&&0===this.c&&1===this.d&&0===this.e&&0===this.f},t.prototype.isInvertible=function(){return 0!==this.determinant()},t.prototype.preRotate=function(t){var e=Math.cos(t),i=Math.sin(t),n=this.a;return this.a=e*n-i*this.b,this.b=i*n+e*this.b,n=this.c,this.c=e*n-i*this.d,this.d=i*n+e*this.d,this},t.prototype.preScale=function(t,e){return void 0===e&&(e=t),this.a*=t,this.b*=e,this.c*=t,this.d*=e,this},t.prototype.preTranslate=function(t,e){return"number"==typeof t?(this.e+=t,this.f+=e):(this.e+=t.x,this.f+=t.y),this},t.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),n=this.a;return this.a=e*n-i*this.b,this.b=i*n+e*this.b,n=this.c,this.c=e*n-i*this.d,this.d=i*n+e*this.d,n=this.e,this.e=e*n-i*this.f,this.f=i*n+e*this.f,this},t.prototype.scale=function(t,e){return void 0===e&&(e=t),this.a*=t,this.b*=e,this.c*=t,this.d*=e,this.e*=t,this.f*=e,this},t.prototype.setValues=function(e,i,n,r,a,o){return e instanceof t?(this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.e=e.e,this.f=e.f):(this.a=e,this.b=i,this.c=n,this.d=r,this.e=a,this.f=o),this},t.prototype.toString=function(){return"Matrix2D(["+this.a+", "+this.c+", "+this.e+"] ["+this.b+", "+this.d+", "+this.f+"] [0, 0, 1])"},t.prototype.translate=function(t,e){return"number"==typeof t?(this.e+=this.a*t+this.c*e,this.f+=this.b*t+this.d*e):(this.e+=this.a*t.x+this.c*t.y,this.f+=this.b*t.x+this.d*t.y),this},t}()},{"../core/core.js":10}],58:[function(t,e,i){var n=t("../core/core.js"),r=function(t,e,i,r){var a=e+i,o="_"+a,s={key:"",oldValue:0};r?n.defineField(t,a,(function(){return this[o]}),(function(t){var e=this[o];t!==e&&(this[o]=t,s.key=a,s.oldValue=e,this.trigger("MotionChange",s))})):n.defineField(t,a,(function(){return this[o]}),(function(t){})),Object.defineProperty(t,o,{value:0,writable:!0,enumerable:!1,configurable:!1})},a=function(t,e,i,r){var a=e+"x",o=e+"y",s="_"+a,l="_"+o;return i?(n.defineField(r,"x",(function(){return t[s]}),(function(e){t[a]=e})),n.defineField(r,"y",(function(){return t[l]}),(function(e){t[o]=e}))):(n.defineField(r,"x",(function(){return t[s]}),(function(t){})),n.defineField(r,"y",(function(){return t[l]}),(function(t){}))),Object.seal&&Object.seal(r),r};n.c("AngularMotion",{_vrotation:0,_arotation:0,_drotation:0,init:function(){this.requires("2D"),r(this,"v","rotation",!0),r(this,"a","rotation",!0),r(this,"d","rotation",!1),this.__oldRotationDirection=0,this.bind("UpdateFrame",this._angularMotionTick)},remove:function(t){this.unbind("UpdateFrame",this._angularMotionTick)},resetAngularMotion:function(){return this._drotation=0,this.vrotation=0,this.arotation=0,this},_angularMotionTick:function(t){var e=t.dt/1e3,i=this._rotation,n=this._vrotation,r=this._arotation,a=i+n*e+.5*r*e*e;this.vrotation=n+r*e;var o=this._vrotation,s=o?o<0?-1:1:0;this.__oldRotationDirection!==s&&(this.__oldRotationDirection=s,this.trigger("NewRotationDirection",s)),this._drotation=a-i,0!==this._drotation&&(this.rotation=a,this.trigger("Rotated",i))}}),n.c("Motion",{_vx:0,_vy:0,_ax:0,_ay:0,_dx:0,_dy:0,init:function(){this.requires("2D"),r(this,"v","x",!0),r(this,"v","y",!0),this._velocity=a(this,"v",!0,new n.math.Vector2D),r(this,"a","x",!0),r(this,"a","y",!0),this._acceleration=a(this,"a",!0,new n.math.Vector2D),r(this,"d","x",!1),r(this,"d","y",!1),this._motionDelta=a(this,"d",!1,new n.math.Vector2D),this.__oldDirection={x:0,y:0},this.bind("UpdateFrame",this._linearMotionTick)},remove:function(t){this.unbind("UpdateFrame",this._linearMotionTick)},resetMotion:function(){return this.vx=0,this.vy=0,this.ax=0,this.ay=0,this._dx=0,this._dy=0,this},motionDelta:function(){return this._motionDelta},velocity:function(){return this._velocity},acceleration:function(){return this._acceleration},ccdbr:function(t){var e=this._cbr||this._mbr||this,i=this._dx,n=this._dy,r=0,a=0,o=i>0?r=i:-i,s=n>0?a=n:-n;return(t=t||{})._x=e._x-r,t._y=e._y-a,t._w=e._w+o,t._h=e._h+s,t},_linearMotionTick:function(t){var e=t.dt/1e3,i=this._vx,n=this._ax,r=this._vy,a=this._ay,o=i*e+.5*n*e*e,s=r*e+.5*a*e*e;this.vx=i+n*e,this.vy=r+a*e;var l=this.__oldDirection,c=this._vx,h=c?c<0?-1:1:0,u=this._vy,d=u?u<0?-1:1:0;l.x===h&&l.y===d||(l.x=h,l.y=d,this.trigger("NewDirection",l)),this._dx=o,this._dy=s,this._setPosition(this._x+o,this._y+s)}})},{"../core/core.js":10}],59:[function(t,e,i){var n=t("../core/core.js");n.c("Supportable",{_ground:null,_groundComp:null,_preventGroundTunneling:!1,canLand:!0,init:function(){this.requires("2D"),this.__area={_x:0,_y:0,_w:0,_h:0},this.defineField("ground",(function(){return this._ground}),(function(t){}))},remove:function(t){this.unbind("UpdateFrame",this._detectGroundTick)},startGroundDetection:function(t){return t&&(this._groundComp=t),this.uniqueBind("UpdateFrame",this._detectGroundTick),this},stopGroundDetection:function(){return this.unbind("UpdateFrame",this._detectGroundTick),this},preventGroundTunneling:function(t){return void 0===t&&(t=!0),t&&this.requires("Motion"),this._preventGroundTunneling=t,this},_detectGroundTick:function(){var t,e=this._groundComp,i=this._ground,r=n.rectManager.overlap;if(this._preventGroundTunneling)t=this.ccdbr(this.__area);else{var a=this._cbr||this._mbr||this;(t=this.__area)._x=a._x,t._y=a._y,t._w=a._w,t._h=a._h}if(t._h++,i){var o=i._cbr||i._mbr||i;i.__c[e]&&n(i[0])===i&&r(o,t)||(this._ground=null,this.trigger("LiftedOffGround",i),i=null)}if(!i)for(var s,l,c=n.map.unfilteredSearch(t),h=0,u=c.length;h<u;++h)if(l=(s=c[h])._cbr||s._mbr||s,s!==this&&s.__c[e]&&r(l,t)&&(this.canLand=!0,this.trigger("CheckLanding",s),this.canLand)){this._ground=i=s,this.y=i._y-this._h,this._x>i._x+i._w?this.x=i._x+i._w-1:this._x+this._w<i._x&&(this.x=i._x-this._w+1),this.trigger("LandedOnGround",i);break}}}),n.c("GroundAttacher",{_groundAttach:function(t){t.attach(this)},_groundDetach:function(t){t.detach(this)},init:function(){this.requires("Supportable"),this.bind("LandedOnGround",this._groundAttach),this.bind("LiftedOffGround",this._groundDetach)},remove:function(t){this.unbind("LandedOnGround",this._groundAttach),this.unbind("LiftedOffGround",this._groundDetach)}}),n.c("Gravity",{_gravityConst:500,_gravityActive:!1,init:function(){this.requires("2D, Supportable, Motion"),this.bind("LiftedOffGround",this._startGravity),this.bind("LandedOnGround",this._stopGravity)},remove:function(t){this.unbind("LiftedOffGround",this._startGravity),this.unbind("LandedOnGround",this._stopGravity)},_gravityCheckLanding:function(t){this._dy<0&&(this.canLand=!1)},gravity:function(t){return this.uniqueBind("CheckLanding",this._gravityCheckLanding),this.startGroundDetection(t),this._startGravity(),this},antigravity:function(){return this._stopGravity(),this.stopGroundDetection(),this.unbind("CheckLanding",this._gravityCheckLanding),this},gravityConst:function(t){return this._gravityActive&&(this.ay-=this._gravityConst,this.ay+=t),this._gravityConst=t,this},_startGravity:function(){this._gravityActive||(this._gravityActive=!0,this.ay+=this._gravityConst)},_stopGravity:function(){this._gravityActive&&(this._gravityActive=!1,this.ay=0,this.vy=0)}})},{"../core/core.js":10}],60:[function(t,e,i){var n,r;t("../core/core.js").extend({rectManager:{merge:function(t,e,i){return void 0===i&&(i={}),i._h=Math.max(t._y+t._h,e._y+e._h),i._w=Math.max(t._x+t._w,e._x+e._w),i._x=Math.min(t._x,e._x),i._y=Math.min(t._y,e._y),i._w-=i._x,i._h-=i._y,i},overlap:function(t,e){return t._x<e._x+e._w&&t._x+t._w>e._x&&t._y<e._y+e._h&&t._y+t._h>e._y},integerBounds:function(t){return t._x=Math.floor(t._x),t._y=Math.floor(t._y),t._w=Math.ceil(t._w),t._h=Math.ceil(t._h),t},mergeSet:function(t){if(t.length<2)return t;for(var e=t.length-1;e--;)this.overlap(t[e],t[e+1])&&(this.merge(t[e],t[e+1],t[e]),t.splice(e+1,1));return t},boundingRect:function(t){if(t&&t.length){var e,i,n=1,r=t.length,a=t[0];for(a=[a._x,a._y,a._x+a._w,a._y+a._h];n<r;)(i=[(e=t[n])._x,e._y,e._x+e._w,e._y+e._h])[0]<a[0]&&(a[0]=i[0]),i[1]<a[1]&&(a[1]=i[1]),i[2]>a[2]&&(a[2]=i[2]),i[3]>a[3]&&(a[3]=i[3]),n++;return a={_x:(i=a)[0],_y:i[1],_w:i[2]-i[0],_h:i[3]-i[1]}}},_pool:(n=[],r=0,{get:function(t,e,i,a){n.length<=r&&n.push({});var o=n[r++];return o._x=t,o._y=e,o._w=i,o._h=a,o},copy:function(t){n.length<=r&&n.push({});var e=n[r++];return e._x=t._x,e._y=t._y,e._w=t._w,e._h=t._h,e},recycle:function(t){r--}})}})},{"../core/core.js":10}],61:[function(t,e,i){var n,r={},a=function(t){n=t||64,this.map={},this.boundsDirty=!1,this.coordBoundsDirty=!1,this.boundsHash={maxX:-1/0,maxY:-1/0,minX:1/0,minY:1/0},this.boundsCoords={maxX:-1/0,maxY:-1/0,minX:1/0,minY:1/0}};function o(t,e,i){this.keys=t,this.map=i,this.obj=e}a.key=function(t,e){return t=t._cbr||t._mbr||t,(e=e||{}).x1=Math.floor(t._x/n),e.y1=Math.floor(t._y/n),e.x2=Math.floor((t._w+t._x)/n),e.y2=Math.floor((t._h+t._y)/n),e},a.hash=function(t){return t.x1+" "+t.y1+" "+t.x2+" "+t.y2},a.cellsize=function(){return n},a.prototype={insert:function(t,e){var i,n,r,s=a.key(t,e&&e.keys);for(e=e||new o(s,t,this),i=s.x1;i<=s.x2;i++)for(n=s.y1;n<=s.y2;n++)r=i<<16^n,this.map[r]||(this.map[r]=[]),this.map[r].push(t);return this.boundsDirty=!0,e},_searchHolder:[],search:function(t,e){var i,n,o,s,l,c=a.key(t,r),h=this._searchHolder;for(e=e||[],h.length=0,i=c.x1;i<=c.x2;i++)for(n=c.y1;n<=c.y2;n++)if(s=this.map[i<<16^n])for(o=0;o<s.length;o++)h[s[o][0]]||(l=(l=h[s[o][0]]=s[o])._cbr||l._mbr||l)._x<t._x+t._w&&l._x+l._w>t._x&&l._y<t._y+t._h&&l._y+l._h>t._y&&e.push(s[o]);return e},unfilteredSearch:function(t,e){var i,n,o,s,l=a.key(t,r);for(e=e||[],i=l.x1;i<=l.x2;i++)for(n=l.y1;n<=l.y2;n++)if(s=this.map[i<<16^n])for(o=0;o<s.length;o++)e.push(s[o]);return e},remove:function(t){var e,i,n=t.keys,r=t.obj,a=0;for(a=n.x1;a<=n.x2;a++)for(e=n.y1;e<=n.y2;e++)if(i=a<<16^e,this.map[i]){var o,s=this.map[i],l=s.length;for(o=0;o<l;o++)s[o]&&s[o][0]===r[0]&&s.splice(o,1)}this.boundsDirty=!0},refresh:function(t){var e,i,n,r,o,s=t.keys,l=t.obj;for(i=s.x1;i<=s.x2;i++)for(n=s.y1;n<=s.y2;n++)if(e=this.map[i<<16^n])for(o=e.length,r=0;r<o;r++)e[r]&&e[r][0]===l[0]&&e.splice(r,1);for(a.key(l,s),i=s.x1;i<=s.x2;i++)for(n=s.y1;n<=s.y2;n++)(e=this.map[i<<16^n])||(e=this.map[i<<16^n]=[]),e.push(l);return this.boundsDirty=!0,t},boundaries:function(){this._updateBoundaries();var t=this.boundsCoords;return{min:{x:t.minX,y:t.minY},max:{x:t.maxX,y:t.maxY}}},_keyBoundaries:function(){return this._updateBoundaries(),this.boundsHash},_updateBoundaries:function(){if(this.boundsDirty||this.coordBoundsDirty){var t=this.boundsHash;this.boundsDirty&&(t.maxX=-1/0,t.maxY=-1/0,t.minX=1/0,t.minY=1/0);var e,i,n,r=this.boundsCoords;for(var a in r.maxX=-1/0,r.maxY=-1/0,r.minX=1/0,r.minY=1/0,this.map)if((n=this.map[a]).length){var o=a>>16,s=a<<16>>16;if(s<0&&(o=~o),o>=t.maxX)for(e in t.maxX=o,n)"object"==typeof(i=n[e])&&"requires"in i&&(r.maxX=Math.max(r.maxX,i.x+i.w));if(o<=t.minX)for(e in t.minX=o,n)"object"==typeof(i=n[e])&&"requires"in i&&(r.minX=Math.min(r.minX,i.x));if(s>=t.maxY)for(e in t.maxY=s,n)"object"==typeof(i=n[e])&&"requires"in i&&(r.maxY=Math.max(r.maxY,i.y+i.h));if(s<=t.minY)for(e in t.minY=s,n)"object"==typeof(i=n[e])&&"requires"in i&&(r.minY=Math.min(r.minY,i.y))}this.boundsDirty=!1,this.coordBoundsDirty=!1}},traverseRay:function(t,e,i){var o=e.x,s=e.y;t={_x:t._x,_y:t._y,_w:0,_h:0};var l,c,h=this._keyBoundaries(),u=a.key(t,r),d=u.x1,p=u.y1,f=h.minX,m=h.minY,y=h.maxX,g=h.maxY,v=o>0?1:o<0?-1:0,_=s>0?1:s<0?-1:0,x=s>=0?(p+1)*n:p*n,b=-1/0,w=0,C=0,k=1/0,S=1/0;for(0!==o&&(l=1/o,k=((o>=0?(d+1)*n:d*n)-t._x)*l,w=n*v*l),0!==s&&(l=1/s,S=(x-t._y)*l,C=n*_*l);1===v&&d<f&&f!==1/0||-1===v&&d>y&&y!==-1/0||1===_&&p<m&&m!==1/0||-1===_&&p>g&&g!==-1/0;)k<S?(b=k,d+=v,k+=w):(b=S,p+=_,S+=C);for(;f<=d&&d<=y&&m<=p&&p<=g;){if(c=this.map[d<<16^p])for(var D=0;D<c.length;D++)if(i(c[D],b))return;k<S?(b=k,d+=v,k+=w):(b=S,p+=_,S+=C)}}},o.prototype={update:function(t){a.hash(a.key(t,r))!==a.hash(this.keys)?this.map.refresh(this):this.map.coordBoundsDirty=!0}},e.exports=a},{}]},{},[22])},function(t,e,i){var n=i(178);"string"==typeof n&&(n=[[t.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};i(99)(n,r);n.locals&&(t.exports=n.locals)},function(t,e,i){(t.exports=i(98)(!1)).push([t.i,'/*! normalize.css v2.1.1 | MIT License | git.io/normalize */article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}audio,canvas,video{display:inline-block}audio:not([controls]){display:none;height:0}[hidden]{display:none}html{background:#fff;color:#000;font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}a:focus{outline:thin dotted}a:active,a:hover{outline:0}h1{font-size:2em;margin:0.67em 0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:bold}dfn{font-style:italic}hr{box-sizing:content-box;height:0}mark{background:#ff0;color:#000}code,kbd,pre,samp{font-family:monospace, serif;font-size:1em}pre{white-space:pre-wrap}q{quotes:"“" "”" "‘" "’"}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-0.5em}sub{bottom:-0.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:0}fieldset{border:1px solid #c0c0c0;margin:0 2px;padding:0.35em 0.625em 0.75em}legend{border:0;padding:0}button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}button,input{line-height:normal}button,select{text-transform:none}button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}input[type="search"]{-webkit-appearance:textfield;box-sizing:content-box}input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}textarea{overflow:auto;vertical-align:top}table{border-collapse:collapse;border-spacing:0}\n',""])},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var i=e.protocol+"//"+e.host,n=i+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(t,e){var r,a=e.trim().replace(/^"(.*)"$/,(function(t,e){return e})).replace(/^'(.*)'$/,(function(t,e){return e}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(a)?t:(r=0===a.indexOf("//")?a:0===a.indexOf("/")?i+a:n+a.replace(/^\.\//,""),"url("+JSON.stringify(r)+")")}))}},function(t,e,i){var n=i(181);"string"==typeof n&&(n=[[t.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};i(99)(n,r);n.locals&&(t.exports=n.locals)},function(t,e,i){e=t.exports=i(98)(!1);var n=i(182)(i(183));e.push([t.i,'html,body{margin:0 0;background:#000}html{box-sizing:border-box}*,*::before,*::after{box-sizing:inherit}@font-face{font-family:\'Press Start 2P\';font-style:normal;font-weight:400;src:local("Press Start 2P Regular"),local("PressStart2P-Regular"),url('+n+') format("woff2"),url(https://fonts.gstatic.com/s/pressstart2p/v8/e3t4euO8T-267oIAQAu6jDQyK3nVivNm4I81.woff2) format("woff2");unicode-range:U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD}#cr-stage{image-rendering:-moz-crisp-edges;image-rendering:-o-crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:crisp-edges;-ms-interpolation-mode:nearest-neighbor;transform-origin:top left}h1{font-size:1.2em}h2{font-size:1.1em}footer{color:#ddd;padding:1em;display:flex;justify-content:center;align-items:center;position:absolute;top:0;left:0;font-family:"Press Start 2P";font-size:8px;width:100%}footer *{margin-right:1em}footer button{padding:0.6em;border-radius:0.2em;background:#ddd}#version::before{content:"Ver: "}a{color:#fff}.fullscreen #theater{position:absolute;top:0;left:0;background:#000}\n',""])},function(t,e,i){"use strict";t.exports=function(t,e){return"string"!=typeof t?t:(/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),/["'() \t\n]/.test(t)||e?'"'+t.replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"':t)}},function(t,e,i){t.exports=i.p+"assets/3e51a876e64628fb3548d66d273af459.woff2"},function(t,e,i){"use strict";(function(t){var e=i(27);t.c("Hideable",{_hidden:!1,properties:{hidden:{set(t){this._updateHidden(t)},get(){return this._hidden},configurable:!0,enumerable:!0},_hidden:{enumerable:!1}},init(){this.requires(e.a)},sendToBackground(t,e){return this._originalZ=this.z,this.attr({scale:t,z:e}),Array.from(this._children).filter(t=>t.attr).forEach(t=>{const i=t.z-this._originalZ;t.attr({z:e+i})}),this.hidden=!0,this},_updateHidden(t){this._hidden!==t&&(this._hidden=t,t?this.trigger("Hiding",this):this.trigger("Revealing",this))},hide(t,e){return this.hideMarker=t,e.below&&this.has("Sprite")&&0===this.rotation?(this.hideAt=e.below,Array.from(this._children).filter(t=>t.attr).forEach(t=>t.attr({hideAt:e.below}))):(this.attr({alpha:0}),Array.from(this._children).filter(t=>t.attr).forEach(t=>t.attr({alpha:0}))),this.hidden=!0,this},hideBelow(t){this.hideAt=t,Array.from(this._children).filter(t=>t.attr).forEach(e=>e.attr({hideAt:t}))},reveal(){null!=this.hideMarker&&this.hideMarker.destroy();return Array.from(this._children).filter(t=>t.attr).forEach(t=>{const e=t.z-this.z;t.attr({z:this._originalZ+e})}),this.attr({scale:1,alpha:1,z:this._originalZ,hideAt:null}),Array.from(this._children).filter(t=>t.attr).forEach(t=>t.attr({alpha:1,hideAt:null})),this.hidden=!1,this},remove(){this.hideMarker&&(this.hideMarker.hasPool?this.hideMarker.recycle():this.hideMarker.destroy())}})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var e=i(1),n=i(8);t.c("Aimable",{init(){this.aim=this.aim.bind(this),this.resetAim=this.resetAim.bind(this)},async aim({target:t,speed:i=100,easing:r=e.b}){if(!t)return;const a=[],o=this.aimParts||[];this.forEachPart((e,s)=>{const l=this.spriteOptions(s);if(o.includes(l.key)){const o=e._parent,s=[o.x+l.ro[0],o.y+l.ro[1]],c=[t.x+t.w/2,t.y+t.h/2],h=s[0]-c[0],u=s[1]-c[1],d=180*Math.atan2(u,h)/Math.PI;e.addComponent(n.a);const p=Math.abs(e.rotation-d),f=1e3/i*p;a.push(e.tweenPromise({rotation:d},f,r))}}),await Promise.all(a)},async resetAim({speed:t=100,easing:i=e.b}={}){const r=[],a=this.aimParts||[];this.forEachPart((e,o)=>{const s=this.spriteOptions(o);if(a.includes(s.key)){e.addComponent(n.a);const a=Math.abs(e.rotation),o=1e3/t*a;r.push(e.tweenPromise({rotation:0},o,i))}}),await Promise.all(r)}})}).call(this,i(0).default)},function(t,e,i){(function(t){t.c("BezierMove",{events:{GameLoop:"_moveBezierTick",Freeze:"remove"},remove(){this.bezierTimer.complete||this.trigger("BezierMoveEnd")},bezierMove(e,i){const n=i.speed||this.defaultSpeed,r=e.length/n*1e3;this.bezierTimer=new t.easing(r,i.easing||"linear"),this.bezierPath=e},_moveBezierTick(t){this.bezierTimer.complete||(this.bezierTimer.tick(t.dt),this._doMove(this.bezierTimer.value(),t),this.bezierTimer.complete&&this.trigger("BezierMoveEnd"))},_doMove(t,e){const i=this.bezierPath.get(t),n=i.x-this.x,r=i.y-this.y;if(this.updateMovementVisuals){const i=this.bezierPath.rotationAt(t);this.updateMovementVisuals(i,n,r,e.dt)}this.shift(n,r)}})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var e=i(130),n=i.n(e),r=i(131),a=i.n(r);t.defaultShader("Color",new t.WebGLShader(n.a,a.a,[{name:"aPosition",width:2},{name:"aOrientation",width:3},{name:"aLayer",width:2},{name:"aColor",width:4},{name:"aDesaturation",width:4},{name:"aGradient",width:2}],(function(t,e){const i=null!=e.desaturationColor?e.desaturationColor:{_red:0,_green:0,_blue:0};t.program.writeVector("aColor",e._red/255,e._green/255,e._blue/255,e._strength),t.program.writeVector("aDesaturation",i._red/255,i._green/255,i._blue/255,1);const n=null!=e.scale?e.scale:1,r=null!=e.topDesaturation?e.topDesaturation:0,a=null!=e.bottomDesaturation?e.bottomDesaturation:0;return t.program.writeVector("aGradient",r+1.15*(1-n),a+1.15*(1-n))})))}).call(this,i(0).default)},function(t,e,i){(function(t){t.c("HideBelow",{properties:{hideBelow:{set(t){this._hideBelow=t,this.trigger("Invalidate")},get(){return this._hideBelow},configurable:!0,enumerable:!0},_hideBelow:{writable:!0,enumerable:!1,configurable:!1},hideAbove:{set(t){this._hideAbove=t,this.trigger("Invalidate")},get(){return this._hideAbove},configurable:!0,enumerable:!0},_hideAbove:{writable:!0,enumerable:!1,configurable:!1}}})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){t.c("ViewportLocked",{events:{Move:"checkMotion"},checkMotion(){this._x<0&&(this.x=0,this.vx<0&&(this.vx=0)),this._y<0&&(this.y=0,this.vy<0&&(this.vy=0));const e=t.viewport.width-this.w;this._x>e&&(this.x=e,this.vx>0&&(this.vx=0));const i=t.viewport.height-this.h;this._y>i&&(this.y=i,this.vy>0&&(this.vy=0))}})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var e=i(12),n=i(43),r=i(4),a=i(20),o=i.n(a);t.c("GravitySupport",{init(){this.activateGravity=this.activateGravity.bind(this),this._onGravityCollisonHit=this._onGravityCollisonHit.bind(this)},activateGravity(t=["GravitySolid","GravityLiquid"]){this.addComponent("Motion","Collision",n.a),this.ay=400,this.bind("HitOn",this._onGravityCollisonHit),this.checkHits(...t)},_onGravityCollisonHit(i){let n="none",a=null;if(i.forEach(t=>{const e=t.obj;e.has("GravitySolid")&&(n="solid",a=e),e.has("GravityLiquid")&&(n="liquid",a=e)}),"solid"===n&&(this.vy>200?this.attr({vy:-this.vy/4}):(this.attr({ay:0,ax:0,vx:0,vy:0}),this.showState&&this.showState("crashed"),a.attach(this))),"liquid"===n){if(this.attr({ax:0,ay:0,vx:0,vy:this.vy/a.liquidDensity,hideBelow:a.y+30,surfaceLevel:a.y}),a.liquidParticles){const i=[].concat(a.liquidParticles,{emitter:{w:this.w,h:10,amount:1.5*this.w}}),n=o()({},Object(r.d)(i[0]),i[1]);this.liquidEmitter=t.e(e.a).attr({x:this.x,y:a.y+20}).particles(n)}this.uniqueBind("GameLoop",this._sinkAway)}},_sinkAway(){const t=this.y>this.hideBelow;Object.values(this.currentAttachHooks).forEach(t=>{t.currentAttachment&&t.currentAttachment.emitter&&t.currentAttachment.emitter.emissionRate>0&&t.y>this.hideBelow&&t.currentAttachment.emitter.stopEmission()}),t&&(this.liquidEmitter.stopEmission(),this.liquidEmitter.autoDestruct=!0,this.destroy(),this.unbind("GameLoop",this._sinkAway))}})}).call(this,i(0).default)},function(t,e,i){var n=i(54),r=i(102),a=i(104),o=i(222),s=i(14),l=i(62),c=i(110);t.exports=function t(e,i,h,u,d){e!==i&&a(i,(function(a,l){if(d||(d=new n),s(a))o(e,i,l,h,t,u,d);else{var p=u?u(c(e,l),a,l+"",e,i,d):void 0;void 0===p&&(p=a),r(e,l,p)}}),l)}},function(t,e){t.exports=function(){this.__data__=[],this.size=0}},function(t,e,i){var n=i(56),r=Array.prototype.splice;t.exports=function(t){var e=this.__data__,i=n(e,t);return!(i<0)&&(i==e.length-1?e.pop():r.call(e,i,1),--this.size,!0)}},function(t,e,i){var n=i(56);t.exports=function(t){var e=this.__data__,i=n(e,t);return i<0?void 0:e[i][1]}},function(t,e,i){var n=i(56);t.exports=function(t){return n(this.__data__,t)>-1}},function(t,e,i){var n=i(56);t.exports=function(t,e){var i=this.__data__,r=n(i,t);return r<0?(++this.size,i.push([t,e])):i[r][1]=e,this}},function(t,e,i){var n=i(55);t.exports=function(){this.__data__=new n,this.size=0}},function(t,e){t.exports=function(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i}},function(t,e){t.exports=function(t){return this.__data__.get(t)}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e,i){var n=i(55),r=i(74),a=i(76);t.exports=function(t,e){var i=this.__data__;if(i instanceof n){var o=i.__data__;if(!r||o.length<199)return o.push([t,e]),this.size=++i.size,this;i=this.__data__=new a(o)}return i.set(t,e),this.size=i.size,this}},function(t,e,i){var n=i(75),r=i(206),a=i(14),o=i(101),s=/^\[object .+?Constructor\]$/,l=Function.prototype,c=Object.prototype,h=l.toString,u=c.hasOwnProperty,d=RegExp("^"+h.call(u).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!a(t)||r(t))&&(n(t)?d:s).test(o(t))}},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){var n=i(37),r=Object.prototype,a=r.hasOwnProperty,o=r.toString,s=n?n.toStringTag:void 0;t.exports=function(t){var e=a.call(t,s),i=t[s];try{t[s]=void 0;var n=!0}catch(t){}var r=o.call(t);return n&&(e?t[s]=i:delete t[s]),r}},function(t,e){var i=Object.prototype.toString;t.exports=function(t){return i.call(t)}},function(t,e,i){var n,r=i(207),a=(n=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";t.exports=function(t){return!!a&&a in t}},function(t,e,i){var n=i(23)["__core-js_shared__"];t.exports=n},function(t,e){t.exports=function(t,e){return null==t?void 0:t[e]}},function(t,e,i){var n=i(210),r=i(55),a=i(74);t.exports=function(){this.size=0,this.__data__={hash:new n,map:new(a||r),string:new n}}},function(t,e,i){var n=i(211),r=i(212),a=i(213),o=i(214),s=i(215);function l(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=r,l.prototype.get=a,l.prototype.has=o,l.prototype.set=s,t.exports=l},function(t,e,i){var n=i(57);t.exports=function(){this.__data__=n?n(null):{},this.size=0}},function(t,e){t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},function(t,e,i){var n=i(57),r=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(n){var i=e[t];return"__lodash_hash_undefined__"===i?void 0:i}return r.call(e,t)?e[t]:void 0}},function(t,e,i){var n=i(57),r=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return n?void 0!==e[t]:r.call(e,t)}},function(t,e,i){var n=i(57);t.exports=function(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=n&&void 0===e?"__lodash_hash_undefined__":e,this}},function(t,e,i){var n=i(58);t.exports=function(t){var e=n(this,t).delete(t);return this.size-=e?1:0,e}},function(t,e){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},function(t,e,i){var n=i(58);t.exports=function(t){return n(this,t).get(t)}},function(t,e,i){var n=i(58);t.exports=function(t){return n(this,t).has(t)}},function(t,e,i){var n=i(58);t.exports=function(t,e){var i=n(this,t),r=i.size;return i.set(t,e),this.size+=i.size==r?0:1,this}},function(t,e){t.exports=function(t){return function(e,i,n){for(var r=-1,a=Object(e),o=n(e),s=o.length;s--;){var l=o[t?s:++r];if(!1===i(a[l],l,a))break}return e}}},function(t,e,i){var n=i(102),r=i(105),a=i(106),o=i(80),s=i(108),l=i(59),c=i(16),h=i(225),u=i(60),d=i(75),p=i(14),f=i(227),m=i(84),y=i(110),g=i(229);t.exports=function(t,e,i,v,_,x,b){var w=y(t,i),C=y(e,i),k=b.get(C);if(k)n(t,i,k);else{var S=x?x(w,C,i+"",t,e,b):void 0,D=void 0===S;if(D){var z=c(C),F=!z&&u(C),A=!z&&!F&&m(C);S=C,z||F||A?c(w)?S=w:h(w)?S=o(w):F?(D=!1,S=r(C,!0)):A?(D=!1,S=a(C,!0)):S=[]:f(C)||l(C)?(S=w,l(w)?S=g(w):p(w)&&!d(w)||(S=s(C))):D=!1}D&&(b.set(C,S),_(S,C,v,x,b),b.delete(C)),n(t,i,S)}}},function(t,e,i){var n=i(14),r=Object.create,a=function(){function t(){}return function(e){if(!n(e))return{};if(r)return r(e);t.prototype=e;var i=new t;return t.prototype=void 0,i}}();t.exports=a},function(t,e,i){var n=i(36),r=i(25);t.exports=function(t){return r(t)&&"[object Arguments]"==n(t)}},function(t,e,i){var n=i(38),r=i(25);t.exports=function(t){return r(t)&&n(t)}},function(t,e){t.exports=function(){return!1}},function(t,e,i){var n=i(36),r=i(81),a=i(25),o=Function.prototype,s=Object.prototype,l=o.toString,c=s.hasOwnProperty,h=l.call(Object);t.exports=function(t){if(!a(t)||"[object Object]"!=n(t))return!1;var e=r(t);if(null===e)return!0;var i=c.call(e,"constructor")&&e.constructor;return"function"==typeof i&&i instanceof i&&l.call(i)==h}},function(t,e,i){var n=i(36),r=i(83),a=i(25),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1,t.exports=function(t){return a(t)&&r(t.length)&&!!o[n(t)]}},function(t,e,i){var n=i(49),r=i(62);t.exports=function(t){return n(t,r(t))}},function(t,e){t.exports=function(t,e){for(var i=-1,n=Array(t);++i<t;)n[i]=e(i);return n}},function(t,e,i){var n=i(14),r=i(82),a=i(232),o=Object.prototype.hasOwnProperty;t.exports=function(t){if(!n(t))return a(t);var e=r(t),i=[];for(var s in t)("constructor"!=s||!e&&o.call(t,s))&&i.push(s);return i}},function(t,e){t.exports=function(t){var e=[];if(null!=t)for(var i in Object(t))e.push(i);return e}},function(t,e,i){var n=i(113),r=i(114);t.exports=function(t){return n((function(e,i){var n=-1,a=i.length,o=a>1?i[a-1]:void 0,s=a>2?i[2]:void 0;for(o=t.length>3&&"function"==typeof o?(a--,o):void 0,s&&r(i[0],i[1],s)&&(o=a<3?void 0:o,a=1),e=Object(e);++n<a;){var l=i[n];l&&t(e,l,n,o)}return e}))}},function(t,e,i){var n=i(235),r=Math.max;t.exports=function(t,e,i){return e=r(void 0===e?t.length-1:e,0),function(){for(var a=arguments,o=-1,s=r(a.length-e,0),l=Array(s);++o<s;)l[o]=a[e+o];o=-1;for(var c=Array(e+1);++o<e;)c[o]=a[o];return c[e]=i(l),n(t,this,c)}}},function(t,e){t.exports=function(t,e,i){switch(i.length){case 0:return t.call(e);case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2])}return t.apply(e,i)}},function(t,e,i){var n=i(237),r=i(239)(n);t.exports=r},function(t,e,i){var n=i(238),r=i(103),a=i(63),o=r?function(t,e){return r(t,"toString",{configurable:!0,enumerable:!1,value:n(e),writable:!0})}:a;t.exports=o},function(t,e){t.exports=function(t){return function(){return t}}},function(t,e){var i=Date.now;t.exports=function(t){var e=0,n=0;return function(){var r=i(),a=16-(r-n);if(n=r,a>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}},function(t,e,i){"use strict";(function(t){var e=i(12),n=i(4),r=i(20),a=i.n(r);t.c("SubmergeSupport",{init(){this._onGravityCollisonHit=this._onGravityCollisonHit.bind(this),this.addComponent("Motion","Collision"),this.bind("HitOn",this._onGravityCollisonHit),this.checkHits("GravityLiquid"),this.clearShadow=this.clearShadow.bind(this)},events:{Freeze(){this.liquidEmitter&&(this.liquidEmitter.stopEmission(),this.liquidEmitter.autoDestruct=!0,this.liquidEmitter=null),this.shadow&&(this.shadow.destroy(),this.shadow=null)},Remove(){this.liquidEmitter&&(this.liquidEmitter.stopEmission(),this.liquidEmitter.autoDestruct=!0,this.liquidEmitter=null),this.shadow&&(this.shadow.destroy(),this.shadow=null)}},_onGravityCollisonHit(i){if(this.surface)return;let r=null;if(i.forEach(t=>{const e=t.obj;e.has("GravityLiquid")&&(r=e)}),this.attr({hideBelow:r.y+30,surface:r}),r.liquidParticles){const i=[].concat(r.liquidParticles,{emitter:{w:this.w,h:10,amount:Math.min(Math.max(1.5*this.w,100),500)}}),o=a()({},Object(n.d)(i[0]),i[1]);this.liquidEmitter=t.e(e.a).attr({x:this.x,y:r.y+20}).particles(o)}this.uniqueBind("EnterFrame",this._sinkAway)},clearShadow(){this.shadow&&(this.shadow.destroy(),this.shadow=null)},_sinkAway(){const i=this.y>this.hideBelow,r=this.y+this.h<this.hideBelow-30;if(Object.values(this.currentAttachHooks).forEach(t=>{t.currentAttachment&&t.currentAttachment.emitter&&t.currentAttachment.emitter.emissionRate>0&&t.y>this.hideBelow&&t.currentAttachment.emitter.stopEmission()}),this.shadow&&(this.shadow.x=this.x,this.shadow.alpha=1-(this.y-this.hideBelow)/200),(i||r)&&this.liquidEmitter)this.liquidEmitter.stopEmission(),this.liquidEmitter.autoDestruct=!0,this.liquidEmitter=null,i&&(this.shadow=t.e("2D, WebGL, "+this.submergeSprite).attr({w:this.w,x:this.x,y:this.hideBelow-20}),this.uniqueBind("Remove",this.clearShadow));else if(null===this.liquidEmitter&&!i&&!r){this.shadow&&(this.shadow.destroy(),this.shadow=null);const i=[].concat(this.surface.liquidParticles,{emitter:{w:this.w,h:10,amount:Math.min(Math.max(1.5*this.w,100),500)}}),r=a()({},Object(n.d)(i[0]),i[1]);this.liquidEmitter=t.e(e.a).attr({x:this.x,y:this.surface.y+20}).particles(r)}}})}).call(this,i(0).default)},function(t,e,i){(function(t){t.c("Invincible",{init(){this.requires("Delay"),this.blinkOn=!0},_blink(){this.blinkOn=!this.blinkOn,this.alpha=this.blinkOn?.5:1},remove(){this.cancelDelay(this._blink),this.alpha=1},invincibleDuration(t){return this.delay(this._blink,250,-1),-1!==t&&this.delay(()=>this.removeComponent("Invincible"),t,0),this}})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var e=i(44),n=i(10),r=i(69),a=i(70),o=i(26);t.c("ShipSpawnable",{required:e.a,events:{Activated:"spawnShip"},spawnPosition(t){return this.spawnPosition=t,null==this.spawnPosition&&(this.spawnPosition=()=>({x:this.x,y:this.y})),this},spawnShip({existing:e=!1}){if(!this.has(n.a))return;if(!(this.lives>0))return;let i=this.spawnPosition();return i.x<10&&(i.x=10),null!=this.ship&&(i={x:this.ship.x,y:this.ship.y},this.ship.destroy(),this.ship=null),this.ship=e&&t(this.shipType).get(0)||Object(o.b)(this.shipType,{location:i}),this.ship.addComponent(r.a,a.a),this.ship.allowDamage({health:50}),this.has(n.a)&&this.assignControls(this.ship),this.trigger("ShipSpawned",this.ship),t.trigger("ShipSpawned",this.ship),this.ship}})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){t.c("Rotating",{required:"2D",events:{GameLoop({dt:t}){0!==this.vr&&(this.rotation=(this.rotation+this.vr*t/1e3)%360)}}})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var e=i(142),n=i.n(e),r=i(143),a=i.n(r);const o=t=>{if(t._parent){const e=[];if(t.hideBelow){const i=t._parent.y+t.hideBelow;e.push(i)}return e.concat(o(t._parent))}return t.hideBelow?[t.hideBelow]:[]},s=t=>{if(t._parent){const e=[];if(t.hideAbove){const i=t._parent.y+t.hideAbove;e.push(i)}return e.concat(s(t._parent))}return t.hideAbove?[t.hideAbove]:[]};t.defaultShader("Sprite",new t.WebGLShader(n.a,a.a,[{name:"aPosition",width:2},{name:"aOrientation",width:3},{name:"aLayer",width:2},{name:"aTextureCoord",width:2},{name:"aColor",width:4},{name:"aOverrideColor",width:4},{name:"aGradient",width:4},{name:"aSpriteDimensions",width:4}],(function(t,e){let i;const{co:n}=t;t.program.writeVector("aTextureCoord",n.x+1,n.y+1,n.x+1,n.y+n.h-1,n.x+n.w-1,n.y+1,n.x+n.w-1,n.y+n.h-1),t.program.writeVector("aSpriteDimensions",n.x,n.y,n.w,n.h);const r=null!=e.desaturationColor?e.desaturationColor:{_red:0,_green:0,_blue:0};let a=null!=e.overrideColor?e.overrideColor:{_red:0,_green:0,_blue:0},l=null!=e.lightness?e.lightness:1;i=e.hidden&&null!=e.scale?e.scale:1;let c=(null!=e.topDesaturation?e.topDesaturation:0)+1.15*(1-i),h=(null!=e.bottomDesaturation?e.bottomDesaturation:0)+1.15*(1-i);e.hitFlash&&(a=e.hitFlash,c=0,h=0),t.program.writeVector("aColor",r._red,r._green,r._blue,l);let u=0;null!=e.overrideColor&&(u=1+e.overrideColorStrength),"partial"===e.overrideColorMode&&(u=4+e.overrideColorStrength),"none"===e.overrideColorMode&&(u=0),e.hitFlash&&(u=6),t.program.writeVector("aOverrideColor",a._red,a._green,a._blue,u);let d=-1;e.hideAt&&(d=Math.max(0,n.y+(e.hideAt-e.y)/e.h*n.h));const p=(t=>{const e=o(t);return 0===e.length?null:Math.min(...e)})(e);null!==p&&(d=Math.max(0,n.y+(p-e.y)/e.h*n.h));let f=-1;const m=(t=>{const e=s(t);return 0===e.length?null:Math.min(...e)})(e);null!==m&&(f=Math.max(0,n.y+(m-e.y)/e.h*n.h)),t.program.writeVector("aGradient",c,h,f,d)})))}).call(this,i(0).default)},function(t,e,i){(function(t){t.c("TextInput",{init(){this.requires("2D, DOM, Text")},remove(){},textInput(e,i){return new Promise(n=>{let r="A  ",a=0;this.text(r),e.bind("Up",()=>{r=this._updateText(r,a,1),this.text(r)}),e.bind("Down",()=>{r=this._updateText(r,a,-1),this.text(r)}),e.bind("Left",()=>(a=Math.max(a-1,0),this._updateCursor(a))),e.bind("Right",()=>{a=Math.min(a+1,i-1),this._updateCursor(a)}),e.bind("Fire",()=>{const t=a;a=Math.min(a+1,i-1),this._updateCursor(a),a===t&&a===i-1&&(e.unbind("Up"),e.unbind("Down"),e.unbind("Left"),e.unbind("Right"),e.unbind("Fire"),n(r))}),this.cursor=t.e("2D, DOM, Text").attr({x:this.x,y:this.y,w:this.w}).text("_  ").textColor("#0000FF").textAlign("left").textFont({size:"20px",weight:"bold",family:"Press Start 2P"}),this.attach(this.cursor)})},_updateCursor(t){const e=Array(t+1).join("&nbsp;")+"_";this.cursor.text(e)},_updateText(t,e,i){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890-_.=!$& ",r=t[e],a=n.indexOf(r)+n.length,o=n[(a+i)%n.length];return t.slice(0,e)+o+t.slice(e+1)}})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){t.c("LightGlare",{required:"2D, WebGL",events:{EnterFrame(){const e=t.viewport.width/2,i=t.viewport.height/2,n=this.x+this.w/2-e,r=this.y+this.h/2-i,a=this.glareLink||this.getElementByKey(this.glareAlphaLink),o=a?a.alpha:1,s=(t,e)=>{e.attr({x:this.x+this.w/2-e.w/2+(-n-n)*t,y:this.y+this.h/2-e.h/2+(-r-r)*t,alpha:e.baseAlpha*o})};s(1.1,this.bigGlare),s(.9,this.blueGlare),s(.8,this.redGlare)}},init(){this.bigGlare=t.e("2D, WebGL, Glare, bigGlare, Horizon").crop(0,0,200,200).attr({w:200,h:200,z:91,baseAlpha:.3,alpha:0}).origin("center").saturationGradient(.1,.1),this.blueGlare=t.e("2D, WebGL, Glare, bigGlare, Horizon").crop(0,0,200,200).attr({w:80,h:80,z:91,baseAlpha:.5,alpha:0}).origin("center").saturationGradient(1,1),this.redGlare=t.e("2D, WebGL, Glare, bigGlare, ColorEffects").crop(0,0,200,200).attr({w:20,h:20,z:91,baseAlpha:.7,alpha:0}).colorOverride("#fd6565").origin("center")}})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){t.c("Overlap",{required:"2D,  Collision",events:{UpdateFrame(){const t=[0],e=this.area(),i=this.hit(this.checkCollission);i&&i.forEach(e=>{const i=e.obj,n=Math.max(this.x,i.x),r=Math.min(this.x+this.w,i.x+i.w)-n,a=Math.max(this.y,i.y),o=Math.min(this.y+this.h,i.y+i.h)-a;t.push(r*o)});const n=1.7*Math.max(...t),r=n>e?1:n/e,a=this.glareLink||this.getElementByKey(this.applyAlphaTo);a.alpha=(1-r)*a.maxAlpha}}})}).call(this,i(0).default)},function(t,e,i){"use strict";i(249),i(260),i(342),i(343),i(344)},function(t,e,i){"use strict";(function(t){var e=i(144),n=i(174),r=i(167),a=i(45),o=i(3),s=i(15),l=i(19),c=i(21);const h=["campaign"];t.defineScene("Game",(async function({start:i=null,tags:a=h}={}){let c=null;Object(l.b)(1),t.bind("GamePause",e=>{if(e){const e=t("Player").get(0);null===c?c=t.e(r.a).showMenu(e):(c.unfreeze(),c.showMenu(e))}else c.freeze()});let u=null;t.one("EndGame",t=>{u=t.mode}),t.viewport.x=0,t.viewport.y=0,this.state={lives:2,score:0};const d=Object(e.a)(this.state);let p=null;try{let e=!1;for(const t of n.a)(e||null===i||i===t.name)&&a.every(e=>!0===t.tags[e])&&(t.tags.wip,e=!0,p=t.name,await d(t.script));const r=Object(s.c)();o.a.fadeMusicVolume(0,2e3),await r.start(2e3),t.enterScene("GameOver",{gameCompleted:!this.state.gameEnded,score:this.state.score})}catch(e){if(null!==u)return;"Game Over"!==e.message&&console.error(e);const i=Object(s.c)();o.a.fadeMusicVolume(0,2e3),await i.start(2e3),t.enterScene("GameOver",{score:this.state.score,checkpoint:p})}}),(function(){this.state.gameEnded=!0,o.a.stopMusic(),t(c.a).each((function(){this.removeComponent("ShipSpawnable")})),t(a.a).each((function(){this.destroy()})),t.unbind("GameOver"),t.unbind("ScriptFinished"),t.unbind("GamePause")}))}).call(this,i(0).default)},function(t,e,i){var n=i(80),r=i(115);t.exports=function(t){return r(n(t))}},function(t,e){var i=Math.floor,n=Math.random;t.exports=function(t,e){return t+i(n()*(e-t+1))}},function(t,e,i){var n=i(115),r=i(253);t.exports=function(t){return n(r(t))}},function(t,e,i){var n=i(254),r=i(39);t.exports=function(t){return null==t?[]:n(t,r(t))}},function(t,e,i){var n=i(87);t.exports=function(t,e){return n(e,(function(e){return t[e]}))}},function(t,e,i){var n=i(82),r=i(256),a=Object.prototype.hasOwnProperty;t.exports=function(t){if(!n(t))return r(t);var e=[];for(var i in Object(t))a.call(t,i)&&"constructor"!=i&&e.push(i);return e}},function(t,e,i){var n=i(109)(Object.keys,Object);t.exports=n},function(t,e,i){!function(){"use strict";var e=i(117),n=function(t){this.curves=[],this._3d=!1,t&&(this.curves=t,this._3d=this.curves[0]._3d)};n.prototype={valueOf:function(){return this.toString()},toString:function(){return"["+this.curves.map((function(t){return e.pointsToString(t.points)})).join(", ")+"]"},addCurve:function(t){this.curves.push(t),this._3d=this._3d||t._3d},length:function(){return this.curves.map((function(t){return t.length()})).reduce((function(t,e){return t+e}))},curve:function(t){return this.curves[t]},bbox:function(){for(var t=this.curves,i=t[0].bbox(),n=1;n<t.length;n++)e.expandbox(i,t[n].bbox());return i},offset:function(t){var e=[];return this.curves.forEach((function(i){e=e.concat(i.offset(t))})),new n(e)}},t.exports=n}()},function(t,e,i){var n=i(259),r={x:!1,y:!1};function a(t,e,i){if("Z"!==e){if("M"!==e){var n=[!1,r.x,r.y].concat(i),a=new(t.bind.apply(t,n)),o=i.slice(-2);return r={x:o[0],y:o[1]},a}r={x:i[0],y:i[1]}}}t.exports=function(t,e){for(var i,r,o=n(e).split(" "),s=new RegExp("[MLCQZ]",""),l=[],c={C:6,Q:4,L:2,M:2};o.length;)i=o.splice(0,1)[0],s.test(i)&&(r=a(t,i,o.splice(0,c[i]).map(parseFloat)))&&l.push(r);return new t.PolyBezier(l)}},function(t,e){t.exports=function(t){var e,i,n,r,a,o,s=(t=t.replace(/,/g," ").replace(/-/g," - ").replace(/-\s+/g,"-").replace(/([a-zA-Z])/g," $1 ")).replace(/([a-zA-Z])\s?/g,"|$1").split("|"),l=s.length,c=[],h=0,u=0,d=0,p=0,f=0,m=0,y=0,g=0,v="";for(e=1;e<l;e++)if(r=(n=(i=s[e]).substring(0,1)).toLowerCase(),a=(c=(c=i.replace(n,"").trim().split(" ")).filter((function(t){return""!==t})).map(parseFloat)).length,"m"===r){if(v+="M ","m"===n?(d+=c[0],p+=c[1]):(d=c[0],p=c[1]),h=d,u=p,v+=d+" "+p+" ",a>2)for(o=0;o<a;o+=2)"m"===n?(d+=c[o],p+=c[o+1]):(d=c[o],p=c[o+1]),v+=["L",d,p,""].join(" ")}else if("l"===r)for(o=0;o<a;o+=2)"l"===n?(d+=c[o],p+=c[o+1]):(d=c[o],p=c[o+1]),v+=["L",d,p,""].join(" ");else if("h"===r)for(o=0;o<a;o++)"h"===n?d+=c[o]:d=c[o],v+=["L",d,p,""].join(" ");else if("v"===r)for(o=0;o<a;o++)"v"===n?p+=c[o]:p=c[o],v+=["L",d,p,""].join(" ");else if("q"===r)for(o=0;o<a;o+=4)"q"===n?(f=d+c[o],m=p+c[o+1],d+=c[o+2],p+=c[o+3]):(f=c[o],m=c[o+1],d=c[o+2],p=c[o+3]),v+=["Q",f,m,d,p,""].join(" ");else if("t"===r)for(o=0;o<a;o+=2)f=d+(d-f),m=p+(p-m),"t"===n?(d+=c[o],p+=c[o+1]):(d=c[o],p=c[o+1]),v+=["Q",f,m,d,p,""].join(" ");else if("c"===r)for(o=0;o<a;o+=6)"c"===n?(f=d+c[o],m=p+c[o+1],y=d+c[o+2],g=p+c[o+3],d+=c[o+4],p+=c[o+5]):(f=c[o],m=c[o+1],y=c[o+2],g=c[o+3],d=c[o+4],p=c[o+5]),v+=["C",f,m,y,g,d,p,""].join(" ");else if("s"===r)for(o=0;o<a;o+=4)f=d+(d-y),m=p+(p-g),"s"===n?(y=d+c[o],g=p+c[o+1],d+=c[o+2],p+=c[o+3]):(y=c[o],g=c[o+1],d=c[o+2],p=c[o+3]),v+=["C",f,m,y,g,d,p,""].join(" ");else"z"===r&&(v+="Z ",d=h,p=u);return v.trim()}},function(t,e,i){"use strict";(function(t){var e=i(169),n=i.n(e),r=i(71),a=i.n(r),o=i(30),s=i.n(o),l=i(46);t.defineScene("GameOver",async({gameCompleted:e=!1,score:i=0,checkpoint:r=null}={})=>{t.background("#000"),t.viewport.x=0,t.viewport.y=0;const o=t.viewport.width,c=t.viewport.height,h=e?"Congratulations":"Game Over";t.e("2D, DOM, Text").attr({x:0,y:.2*c,w:o}).text(h).textColor("#FF0000").textAlign("center").textFont({size:"50px",weight:"bold",family:"Press Start 2P"});const u=[];let d=n()(Object(l.a)());t("Player ControlScheme").each((function(e){var n;d.push({initials:null,player:this,score:i}),u.push((n={index:e,name:this.name,points:i,player:this,color:this.color()},async()=>{let e,i=null;for(let t=0;t<d.length;t++)e=d[t],e.player===n.player&&(i=t);let r=`${n.name}: ${n.points}`;if(i<10&&(r+=" - "+(()=>{switch(i){case 0:return"ACE";case 1:return"2nd";case 2:return"3rd";default:return i+1+"th"}})()),t.e("2D, DOM, Text").attr({x:0,y:.45*c+45*n.index,w:o}).text(r).textColor(n.color).textAlign("center").textFont({size:"20px",weight:"bold",family:"Press Start 2P"}),i>=10)return;const a=t.e("2D, DOM, Text").attr({x:.25*o,y:.45*c+45*(n.index+1),w:o}).text("Enter name: ").textColor(n.color).textAlign("left").textFont({size:"20px",weight:"bold",family:"Press Start 2P"}),l=t.e("TextInput").attr({x:.6*o,y:.45*c+45*(n.index+1),w:o}).textColor(n.color).textAlign("left").textFont({size:"20px",weight:"bold",family:"Press Start 2P"}),h=await l.textInput(n.player,3),u=function(){const t=localStorage.getItem("SPDLZR");if(!t)return[];const i=t.slice(0,20),n=t.slice(20);e=s.a.AES.decrypt(n,i);const r=e.toString(s.a.enc.Utf8);return r.length>1?JSON.parse(r):[]}();u.push({initials:h,score:n.points,time:(new Date).getTime()});const p=JSON.stringify(u),f=s.a.AES.encrypt(p,"secret").toString().slice(8,28),m=s.a.AES.encrypt(p,f).toString();localStorage.setItem("SPDLZR",f+m),a.destroy(),l.destroy()}))})),d=a()(d,"score").reverse(),await u.reduce((t,e)=>t.then(e),Promise.resolve()),t.e("Delay").delay((function(){if(e)this.delay(()=>t.enterScene("Scores"),5e3);else{let e=10;t.e("2D, DOM, Text").attr({x:0,y:.8*c,w:o}).textColor("#FF0000").textAlign("center").textFont({size:"15px",weight:"bold",family:"Press Start 2P"}).text("Game over. Continue game?");const i=t.e("2D, DOM, Text").attr({x:0,y:.8*c+30,w:o}).textColor("#FF0000").textAlign("center").textFont({size:"15px",weight:"bold",family:"Press Start 2P"}),n="Press fire to continue";i.text(`${n} ${("00"+e).slice(-2)}`),this.delay((function(){e-=1,i.text(`${n} ${("00"+e).slice(-2)}`)}),1e3,e,()=>t.enterScene("Scores")),t("Player").each((function(){this.reset(),this.one("Activated",()=>t.enterScene("Game",{start:r}))}))}}),2e3,0)},()=>{t("Delay").each((function(){this.destroy()})),t("Player").each((function(){this.unbind("Activated")}))})}).call(this,i(0).default)},function(t,e,i){var n=i(54),r=i(262),a=i(111),o=i(263),s=i(264),l=i(105),c=i(80),h=i(265),u=i(267),d=i(120),p=i(268),f=i(64),m=i(273),y=i(274),g=i(108),v=i(16),_=i(60),x=i(278),b=i(14),w=i(280),C=i(39),k={};k["[object Arguments]"]=k["[object Array]"]=k["[object ArrayBuffer]"]=k["[object DataView]"]=k["[object Boolean]"]=k["[object Date]"]=k["[object Float32Array]"]=k["[object Float64Array]"]=k["[object Int8Array]"]=k["[object Int16Array]"]=k["[object Int32Array]"]=k["[object Map]"]=k["[object Number]"]=k["[object Object]"]=k["[object RegExp]"]=k["[object Set]"]=k["[object String]"]=k["[object Symbol]"]=k["[object Uint8Array]"]=k["[object Uint8ClampedArray]"]=k["[object Uint16Array]"]=k["[object Uint32Array]"]=!0,k["[object Error]"]=k["[object Function]"]=k["[object WeakMap]"]=!1,t.exports=function t(e,i,S,D,z,F){var A,P=1&i,E=2&i,O=4&i;if(S&&(A=z?S(e,D,z,F):S(e)),void 0!==A)return A;if(!b(e))return e;var T=v(e);if(T){if(A=m(e),!P)return c(e,A)}else{var M=f(e),B="[object Function]"==M||"[object GeneratorFunction]"==M;if(_(e))return l(e,P);if("[object Object]"==M||"[object Arguments]"==M||B&&!z){if(A=E||B?{}:g(e),!P)return E?u(e,s(A,e)):h(e,o(A,e))}else{if(!k[M])return z?e:{};A=y(e,M,P)}}F||(F=new n);var R=F.get(e);if(R)return R;F.set(e,A),w(e)?e.forEach((function(n){A.add(t(n,i,S,n,e,F))})):x(e)&&e.forEach((function(n,r){A.set(r,t(n,i,S,r,e,F))}));var L=O?E?p:d:E?keysIn:C,j=T?void 0:L(e);return r(j||e,(function(n,r){j&&(n=e[r=n]),a(A,r,t(n,i,S,r,e,F))})),A}},function(t,e){t.exports=function(t,e){for(var i=-1,n=null==t?0:t.length;++i<n&&!1!==e(t[i],i,t););return t}},function(t,e,i){var n=i(49),r=i(39);t.exports=function(t,e){return t&&n(e,r(e),t)}},function(t,e,i){var n=i(49),r=i(62);t.exports=function(t,e){return t&&n(e,r(e),t)}},function(t,e,i){var n=i(49),r=i(88);t.exports=function(t,e){return n(t,r(t),e)}},function(t,e){t.exports=function(t,e){for(var i=-1,n=null==t?0:t.length,r=0,a=[];++i<n;){var o=t[i];e(o,i,t)&&(a[r++]=o)}return a}},function(t,e,i){var n=i(49),r=i(119);t.exports=function(t,e){return n(t,r(t),e)}},function(t,e,i){var n=i(121),r=i(119),a=i(62);t.exports=function(t){return n(t,a,r)}},function(t,e,i){var n=i(32)(i(23),"DataView");t.exports=n},function(t,e,i){var n=i(32)(i(23),"Promise");t.exports=n},function(t,e,i){var n=i(32)(i(23),"Set");t.exports=n},function(t,e,i){var n=i(32)(i(23),"WeakMap");t.exports=n},function(t,e){var i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&i.call(t,"index")&&(n.index=t.index,n.input=t.input),n}},function(t,e,i){var n=i(79),r=i(275),a=i(276),o=i(277),s=i(106);t.exports=function(t,e,i){var l=t.constructor;switch(e){case"[object ArrayBuffer]":return n(t);case"[object Boolean]":case"[object Date]":return new l(+t);case"[object DataView]":return r(t,i);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return s(t,i);case"[object Map]":return new l;case"[object Number]":case"[object String]":return new l(t);case"[object RegExp]":return a(t);case"[object Set]":return new l;case"[object Symbol]":return o(t)}}},function(t,e,i){var n=i(79);t.exports=function(t,e){var i=e?n(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}},function(t,e){var i=/\w*$/;t.exports=function(t){var e=new t.constructor(t.source,i.exec(t));return e.lastIndex=t.lastIndex,e}},function(t,e,i){var n=i(37),r=n?n.prototype:void 0,a=r?r.valueOf:void 0;t.exports=function(t){return a?Object(a.call(t)):{}}},function(t,e,i){var n=i(279),r=i(61),a=i(85),o=a&&a.isMap,s=o?r(o):n;t.exports=s},function(t,e,i){var n=i(64),r=i(25);t.exports=function(t){return r(t)&&"[object Map]"==n(t)}},function(t,e,i){var n=i(281),r=i(61),a=i(85),o=a&&a.isSet,s=o?r(o):n;t.exports=s},function(t,e,i){var n=i(64),r=i(25);t.exports=function(t){return r(t)&&"[object Set]"==n(t)}},function(t,e,i){var n=i(89),r=i(283);t.exports=function t(e,i,a,o,s){var l=-1,c=e.length;for(a||(a=r),s||(s=[]);++l<c;){var h=e[l];i>0&&a(h)?i>1?t(h,i-1,a,o,s):n(s,h):o||(s[s.length]=h)}return s}},function(t,e,i){var n=i(37),r=i(59),a=i(16),o=n?n.isConcatSpreadable:void 0;t.exports=function(t){return a(t)||r(t)||!!(o&&t&&t[o])}},function(t,e,i){var n=i(87),r=i(285),a=i(312),o=i(316),s=i(61),l=i(317),c=i(63);t.exports=function(t,e,i){var h=-1;e=n(e.length?e:[c],s(r));var u=a(t,(function(t,i,r){return{criteria:n(e,(function(e){return e(t)})),index:++h,value:t}}));return o(u,(function(t,e){return l(t,e,i)}))}},function(t,e,i){var n=i(286),r=i(299),a=i(63),o=i(16),s=i(309);t.exports=function(t){return"function"==typeof t?t:null==t?a:"object"==typeof t?o(t)?r(t[0],t[1]):n(t):s(t)}},function(t,e,i){var n=i(287),r=i(298),a=i(125);t.exports=function(t){var e=r(t);return 1==e.length&&e[0][2]?a(e[0][0],e[0][1]):function(i){return i===t||n(i,t,e)}}},function(t,e,i){var n=i(54),r=i(122);t.exports=function(t,e,i,a){var o=i.length,s=o,l=!a;if(null==t)return!s;for(t=Object(t);o--;){var c=i[o];if(l&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++o<s;){var h=(c=i[o])[0],u=t[h],d=c[1];if(l&&c[2]){if(void 0===u&&!(h in t))return!1}else{var p=new n;if(a)var f=a(u,d,h,t,e,p);if(!(void 0===f?r(d,u,3,a,p):f))return!1}}return!0}},function(t,e,i){var n=i(54),r=i(123),a=i(294),o=i(297),s=i(64),l=i(16),c=i(60),h=i(84),u="[object Object]",d=Object.prototype.hasOwnProperty;t.exports=function(t,e,i,p,f,m){var y=l(t),g=l(e),v=y?"[object Array]":s(t),_=g?"[object Array]":s(e),x=(v="[object Arguments]"==v?u:v)==u,b=(_="[object Arguments]"==_?u:_)==u,w=v==_;if(w&&c(t)){if(!c(e))return!1;y=!0,x=!1}if(w&&!x)return m||(m=new n),y||h(t)?r(t,e,i,p,f,m):a(t,e,v,i,p,f,m);if(!(1&i)){var C=x&&d.call(t,"__wrapped__"),k=b&&d.call(e,"__wrapped__");if(C||k){var S=C?t.value():t,D=k?e.value():e;return m||(m=new n),f(S,D,i,p,m)}}return!!w&&(m||(m=new n),o(t,e,i,p,f,m))}},function(t,e,i){var n=i(76),r=i(290),a=i(291);function o(t){var e=-1,i=null==t?0:t.length;for(this.__data__=new n;++e<i;)this.add(t[e])}o.prototype.add=o.prototype.push=r,o.prototype.has=a,t.exports=o},function(t,e){t.exports=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e){t.exports=function(t,e){for(var i=-1,n=null==t?0:t.length;++i<n;)if(e(t[i],i,t))return!0;return!1}},function(t,e){t.exports=function(t,e){return t.has(e)}},function(t,e,i){var n=i(37),r=i(107),a=i(48),o=i(123),s=i(295),l=i(296),c=n?n.prototype:void 0,h=c?c.valueOf:void 0;t.exports=function(t,e,i,n,c,u,d){switch(i){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!u(new r(t),new r(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return a(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var p=s;case"[object Set]":var f=1&n;if(p||(p=l),t.size!=e.size&&!f)return!1;var m=d.get(t);if(m)return m==e;n|=2,d.set(t,e);var y=o(p(t),p(e),n,c,u,d);return d.delete(t),y;case"[object Symbol]":if(h)return h.call(t)==h.call(e)}return!1}},function(t,e){t.exports=function(t){var e=-1,i=Array(t.size);return t.forEach((function(t,n){i[++e]=[n,t]})),i}},function(t,e){t.exports=function(t){var e=-1,i=Array(t.size);return t.forEach((function(t){i[++e]=t})),i}},function(t,e,i){var n=i(120),r=Object.prototype.hasOwnProperty;t.exports=function(t,e,i,a,o,s){var l=1&i,c=n(t),h=c.length;if(h!=n(e).length&&!l)return!1;for(var u=h;u--;){var d=c[u];if(!(l?d in e:r.call(e,d)))return!1}var p=s.get(t);if(p&&s.get(e))return p==e;var f=!0;s.set(t,e),s.set(e,t);for(var m=l;++u<h;){var y=t[d=c[u]],g=e[d];if(a)var v=l?a(g,y,d,e,t,s):a(y,g,d,t,e,s);if(!(void 0===v?y===g||o(y,g,i,a,s):v)){f=!1;break}m||(m="constructor"==d)}if(f&&!m){var _=t.constructor,x=e.constructor;_==x||!("constructor"in t)||!("constructor"in e)||"function"==typeof _&&_ instanceof _&&"function"==typeof x&&x instanceof x||(f=!1)}return s.delete(t),s.delete(e),f}},function(t,e,i){var n=i(124),r=i(39);t.exports=function(t){for(var e=r(t),i=e.length;i--;){var a=e[i],o=t[a];e[i]=[a,o,n(o)]}return e}},function(t,e,i){var n=i(122),r=i(300),a=i(306),o=i(90),s=i(124),l=i(125),c=i(66);t.exports=function(t,e){return o(t)&&s(e)?l(c(t),e):function(i){var o=r(i,t);return void 0===o&&o===e?a(i,t):n(e,o,3)}}},function(t,e,i){var n=i(126);t.exports=function(t,e,i){var r=null==t?void 0:n(t,e);return void 0===r?i:r}},function(t,e,i){var n=i(302),r=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,a=/\\(\\)?/g,o=n((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(r,(function(t,i,n,r){e.push(n?r.replace(a,"$1"):i||t)})),e}));t.exports=o},function(t,e,i){var n=i(303);t.exports=function(t){var e=n(t,(function(t){return 500===i.size&&i.clear(),t})),i=e.cache;return e}},function(t,e,i){var n=i(76);function r(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var i=function(){var n=arguments,r=e?e.apply(this,n):n[0],a=i.cache;if(a.has(r))return a.get(r);var o=t.apply(this,n);return i.cache=a.set(r,o)||a,o};return i.cache=new(r.Cache||n),i}r.Cache=n,t.exports=r},function(t,e,i){var n=i(305);t.exports=function(t){return null==t?"":n(t)}},function(t,e,i){var n=i(37),r=i(87),a=i(16),o=i(65),s=n?n.prototype:void 0,l=s?s.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(a(e))return r(e,t)+"";if(o(e))return l?l.call(e):"";var i=e+"";return"0"==i&&1/e==-1/0?"-0":i}},function(t,e,i){var n=i(307),r=i(308);t.exports=function(t,e){return null!=t&&r(t,e,n)}},function(t,e){t.exports=function(t,e){return null!=t&&e in Object(t)}},function(t,e,i){var n=i(127),r=i(59),a=i(16),o=i(86),s=i(83),l=i(66);t.exports=function(t,e,i){for(var c=-1,h=(e=n(e,t)).length,u=!1;++c<h;){var d=l(e[c]);if(!(u=null!=t&&i(t,d)))break;t=t[d]}return u||++c!=h?u:!!(h=null==t?0:t.length)&&s(h)&&o(d,h)&&(a(t)||r(t))}},function(t,e,i){var n=i(310),r=i(311),a=i(90),o=i(66);t.exports=function(t){return a(t)?n(o(t)):r(t)}},function(t,e){t.exports=function(t){return function(e){return null==e?void 0:e[t]}}},function(t,e,i){var n=i(126);t.exports=function(t){return function(e){return n(e,t)}}},function(t,e,i){var n=i(313),r=i(38);t.exports=function(t,e){var i=-1,a=r(t)?Array(t.length):[];return n(t,(function(t,n,r){a[++i]=e(t,n,r)})),a}},function(t,e,i){var n=i(314),r=i(315)(n);t.exports=r},function(t,e,i){var n=i(104),r=i(39);t.exports=function(t,e){return t&&n(t,e,r)}},function(t,e,i){var n=i(38);t.exports=function(t,e){return function(i,r){if(null==i)return i;if(!n(i))return t(i,r);for(var a=i.length,o=e?a:-1,s=Object(i);(e?o--:++o<a)&&!1!==r(s[o],o,s););return i}}},function(t,e){t.exports=function(t,e){var i=t.length;for(t.sort(e);i--;)t[i]=t[i].value;return t}},function(t,e,i){var n=i(318);t.exports=function(t,e,i){for(var r=-1,a=t.criteria,o=e.criteria,s=a.length,l=i.length;++r<s;){var c=n(a[r],o[r]);if(c)return r>=l?c:c*("desc"==i[r]?-1:1)}return t.index-e.index}},function(t,e,i){var n=i(65);t.exports=function(t,e){if(t!==e){var i=void 0!==t,r=null===t,a=t==t,o=n(t),s=void 0!==e,l=null===e,c=e==e,h=n(e);if(!l&&!h&&!o&&t>e||o&&s&&c&&!l&&!h||r&&s&&c||!i&&c||!a)return 1;if(!r&&!o&&!h&&t<e||h&&i&&a&&!r&&!o||l&&i&&a||!s&&a||!c)return-1}return 0}},function(t,e,i){var n;t.exports=(n=i(5),function(){if("function"==typeof ArrayBuffer){var t=n.lib.WordArray,e=t.init;(t.init=function(t){if(t instanceof ArrayBuffer&&(t=new Uint8Array(t)),(t instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array)&&(t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength)),t instanceof Uint8Array){for(var i=t.byteLength,n=[],r=0;r<i;r++)n[r>>>2]|=t[r]<<24-r%4*8;e.call(this,n,i)}else e.apply(this,arguments)}).prototype=t}}(),n.lib.WordArray)},function(t,e,i){var n;t.exports=(n=i(5),function(){var t=n,e=t.lib.WordArray,i=t.enc;function r(t){return t<<8&4278255360|t>>>8&16711935}i.Utf16=i.Utf16BE={stringify:function(t){for(var e=t.words,i=t.sigBytes,n=[],r=0;r<i;r+=2){var a=e[r>>>2]>>>16-r%4*8&65535;n.push(String.fromCharCode(a))}return n.join("")},parse:function(t){for(var i=t.length,n=[],r=0;r<i;r++)n[r>>>1]|=t.charCodeAt(r)<<16-r%2*16;return e.create(n,2*i)}},i.Utf16LE={stringify:function(t){for(var e=t.words,i=t.sigBytes,n=[],a=0;a<i;a+=2){var o=r(e[a>>>2]>>>16-a%4*8&65535);n.push(String.fromCharCode(o))}return n.join("")},parse:function(t){for(var i=t.length,n=[],a=0;a<i;a++)n[a>>>1]|=r(t.charCodeAt(a)<<16-a%2*16);return e.create(n,2*i)}}}(),n.enc.Utf16)},function(t,e,i){var n,r,a,o,s,l;t.exports=(l=i(5),i(128),r=(n=l).lib.WordArray,a=n.algo,o=a.SHA256,s=a.SHA224=o.extend({_doReset:function(){this._hash=new r.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var t=o._doFinalize.call(this);return t.sigBytes-=4,t}}),n.SHA224=o._createHelper(s),n.HmacSHA224=o._createHmacHelper(s),l.SHA224)},function(t,e,i){var n,r,a,o,s,l,c,h;t.exports=(h=i(5),i(67),i(129),r=(n=h).x64,a=r.Word,o=r.WordArray,s=n.algo,l=s.SHA512,c=s.SHA384=l.extend({_doReset:function(){this._hash=new o.init([new a.init(3418070365,3238371032),new a.init(1654270250,914150663),new a.init(2438529370,812702999),new a.init(355462360,4144912697),new a.init(1731405415,4290775857),new a.init(2394180231,1750603025),new a.init(3675008525,1694076839),new a.init(1203062813,3204075428)])},_doFinalize:function(){var t=l._doFinalize.call(this);return t.sigBytes-=16,t}}),n.SHA384=l._createHelper(c),n.HmacSHA384=l._createHmacHelper(c),h.SHA384)},function(t,e,i){var n;t.exports=(n=i(5),i(67),function(t){var e=n,i=e.lib,r=i.WordArray,a=i.Hasher,o=e.x64.Word,s=e.algo,l=[],c=[],h=[];!function(){for(var t=1,e=0,i=0;i<24;i++){l[t+5*e]=(i+1)*(i+2)/2%64;var n=(2*t+3*e)%5;t=e%5,e=n}for(t=0;t<5;t++)for(e=0;e<5;e++)c[t+5*e]=e+(2*t+3*e)%5*5;for(var r=1,a=0;a<24;a++){for(var s=0,u=0,d=0;d<7;d++){if(1&r){var p=(1<<d)-1;p<32?u^=1<<p:s^=1<<p-32}128&r?r=r<<1^113:r<<=1}h[a]=o.create(s,u)}}();var u=[];!function(){for(var t=0;t<25;t++)u[t]=o.create()}();var d=s.SHA3=a.extend({cfg:a.cfg.extend({outputLength:512}),_doReset:function(){for(var t=this._state=[],e=0;e<25;e++)t[e]=new o.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(t,e){for(var i=this._state,n=this.blockSize/2,r=0;r<n;r++){var a=t[e+2*r],o=t[e+2*r+1];a=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),o=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),(F=i[r]).high^=o,F.low^=a}for(var s=0;s<24;s++){for(var d=0;d<5;d++){for(var p=0,f=0,m=0;m<5;m++)p^=(F=i[d+5*m]).high,f^=F.low;var y=u[d];y.high=p,y.low=f}for(d=0;d<5;d++){var g=u[(d+4)%5],v=u[(d+1)%5],_=v.high,x=v.low;for(p=g.high^(_<<1|x>>>31),f=g.low^(x<<1|_>>>31),m=0;m<5;m++)(F=i[d+5*m]).high^=p,F.low^=f}for(var b=1;b<25;b++){var w=(F=i[b]).high,C=F.low,k=l[b];k<32?(p=w<<k|C>>>32-k,f=C<<k|w>>>32-k):(p=C<<k-32|w>>>64-k,f=w<<k-32|C>>>64-k);var S=u[c[b]];S.high=p,S.low=f}var D=u[0],z=i[0];for(D.high=z.high,D.low=z.low,d=0;d<5;d++)for(m=0;m<5;m++){var F=i[b=d+5*m],A=u[b],P=u[(d+1)%5+5*m],E=u[(d+2)%5+5*m];F.high=A.high^~P.high&E.high,F.low=A.low^~P.low&E.low}F=i[0];var O=h[s];F.high^=O.high,F.low^=O.low}},_doFinalize:function(){var e=this._data,i=e.words,n=(this._nDataBytes,8*e.sigBytes),a=32*this.blockSize;i[n>>>5]|=1<<24-n%32,i[(t.ceil((n+1)/a)*a>>>5)-1]|=128,e.sigBytes=4*i.length,this._process();for(var o=this._state,s=this.cfg.outputLength/8,l=s/8,c=[],h=0;h<l;h++){var u=o[h],d=u.high,p=u.low;d=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8),p=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8),c.push(p),c.push(d)}return new r.init(c,s)},clone:function(){for(var t=a.clone.call(this),e=t._state=this._state.slice(0),i=0;i<25;i++)e[i]=e[i].clone();return t}});e.SHA3=a._createHelper(d),e.HmacSHA3=a._createHmacHelper(d)}(Math),n.SHA3)},function(t,e,i){var n;t.exports=(n=i(5),function(t){var e=n,i=e.lib,r=i.WordArray,a=i.Hasher,o=e.algo,s=r.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),l=r.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),c=r.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),h=r.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),u=r.create([0,1518500249,1859775393,2400959708,2840853838]),d=r.create([1352829926,1548603684,1836072691,2053994217,0]),p=o.RIPEMD160=a.extend({_doReset:function(){this._hash=r.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var i=0;i<16;i++){var n=e+i,r=t[n];t[n]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}var a,o,p,x,b,w,C,k,S,D,z,F=this._hash.words,A=u.words,P=d.words,E=s.words,O=l.words,T=c.words,M=h.words;for(w=a=F[0],C=o=F[1],k=p=F[2],S=x=F[3],D=b=F[4],i=0;i<80;i+=1)z=a+t[e+E[i]]|0,z+=i<16?f(o,p,x)+A[0]:i<32?m(o,p,x)+A[1]:i<48?y(o,p,x)+A[2]:i<64?g(o,p,x)+A[3]:v(o,p,x)+A[4],z=(z=_(z|=0,T[i]))+b|0,a=b,b=x,x=_(p,10),p=o,o=z,z=w+t[e+O[i]]|0,z+=i<16?v(C,k,S)+P[0]:i<32?g(C,k,S)+P[1]:i<48?y(C,k,S)+P[2]:i<64?m(C,k,S)+P[3]:f(C,k,S)+P[4],z=(z=_(z|=0,M[i]))+D|0,w=D,D=S,S=_(k,10),k=C,C=z;z=F[1]+p+S|0,F[1]=F[2]+x+D|0,F[2]=F[3]+b+w|0,F[3]=F[4]+a+C|0,F[4]=F[0]+o+k|0,F[0]=z},_doFinalize:function(){var t=this._data,e=t.words,i=8*this._nDataBytes,n=8*t.sigBytes;e[n>>>5]|=128<<24-n%32,e[14+(n+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),t.sigBytes=4*(e.length+1),this._process();for(var r=this._hash,a=r.words,o=0;o<5;o++){var s=a[o];a[o]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}return r},clone:function(){var t=a.clone.call(this);return t._hash=this._hash.clone(),t}});function f(t,e,i){return t^e^i}function m(t,e,i){return t&e|~t&i}function y(t,e,i){return(t|~e)^i}function g(t,e,i){return t&i|e&~i}function v(t,e,i){return t^(e|~i)}function _(t,e){return t<<e|t>>>32-e}e.RIPEMD160=a._createHelper(p),e.HmacRIPEMD160=a._createHmacHelper(p)}(Math),n.RIPEMD160)},function(t,e,i){var n,r,a,o,s,l,c,h,u;t.exports=(u=i(5),i(91),i(92),r=(n=u).lib,a=r.Base,o=r.WordArray,s=n.algo,l=s.SHA1,c=s.HMAC,h=s.PBKDF2=a.extend({cfg:a.extend({keySize:4,hasher:l,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var i=this.cfg,n=c.create(i.hasher,t),r=o.create(),a=o.create([1]),s=r.words,l=a.words,h=i.keySize,u=i.iterations;s.length<h;){var d=n.update(e).finalize(a);n.reset();for(var p=d.words,f=p.length,m=d,y=1;y<u;y++){m=n.finalize(m),n.reset();for(var g=m.words,v=0;v<f;v++)p[v]^=g[v]}r.concat(d),l[0]++}return r.sigBytes=4*h,r}}),n.PBKDF2=function(t,e,i){return h.create(i).compute(t,e)},u.PBKDF2)},function(t,e,i){var n;t.exports=(n=i(5),i(9),n.mode.CFB=function(){var t=n.lib.BlockCipherMode.extend();function e(t,e,i,n){var r=this._iv;if(r){var a=r.slice(0);this._iv=void 0}else a=this._prevBlock;n.encryptBlock(a,0);for(var o=0;o<i;o++)t[e+o]^=a[o]}return t.Encryptor=t.extend({processBlock:function(t,i){var n=this._cipher,r=n.blockSize;e.call(this,t,i,r,n),this._prevBlock=t.slice(i,i+r)}}),t.Decryptor=t.extend({processBlock:function(t,i){var n=this._cipher,r=n.blockSize,a=t.slice(i,i+r);e.call(this,t,i,r,n),this._prevBlock=a}}),t}(),n.mode.CFB)},function(t,e,i){var n,r,a;t.exports=(a=i(5),i(9),a.mode.CTR=(n=a.lib.BlockCipherMode.extend(),r=n.Encryptor=n.extend({processBlock:function(t,e){var i=this._cipher,n=i.blockSize,r=this._iv,a=this._counter;r&&(a=this._counter=r.slice(0),this._iv=void 0);var o=a.slice(0);i.encryptBlock(o,0),a[n-1]=a[n-1]+1|0;for(var s=0;s<n;s++)t[e+s]^=o[s]}}),n.Decryptor=r,n),a.mode.CTR)},function(t,e,i){var n;t.exports=(n=i(5),i(9),n.mode.CTRGladman=function(){var t=n.lib.BlockCipherMode.extend();function e(t){if(255==(t>>24&255)){var e=t>>16&255,i=t>>8&255,n=255&t;255===e?(e=0,255===i?(i=0,255===n?n=0:++n):++i):++e,t=0,t+=e<<16,t+=i<<8,t+=n}else t+=1<<24;return t}var i=t.Encryptor=t.extend({processBlock:function(t,i){var n=this._cipher,r=n.blockSize,a=this._iv,o=this._counter;a&&(o=this._counter=a.slice(0),this._iv=void 0),function(t){0===(t[0]=e(t[0]))&&(t[1]=e(t[1]))}(o);var s=o.slice(0);n.encryptBlock(s,0);for(var l=0;l<r;l++)t[i+l]^=s[l]}});return t.Decryptor=i,t}(),n.mode.CTRGladman)},function(t,e,i){var n,r,a;t.exports=(a=i(5),i(9),a.mode.OFB=(n=a.lib.BlockCipherMode.extend(),r=n.Encryptor=n.extend({processBlock:function(t,e){var i=this._cipher,n=i.blockSize,r=this._iv,a=this._keystream;r&&(a=this._keystream=r.slice(0),this._iv=void 0),i.encryptBlock(a,0);for(var o=0;o<n;o++)t[e+o]^=a[o]}}),n.Decryptor=r,n),a.mode.OFB)},function(t,e,i){var n,r;t.exports=(r=i(5),i(9),r.mode.ECB=((n=r.lib.BlockCipherMode.extend()).Encryptor=n.extend({processBlock:function(t,e){this._cipher.encryptBlock(t,e)}}),n.Decryptor=n.extend({processBlock:function(t,e){this._cipher.decryptBlock(t,e)}}),n),r.mode.ECB)},function(t,e,i){var n;t.exports=(n=i(5),i(9),n.pad.AnsiX923={pad:function(t,e){var i=t.sigBytes,n=4*e,r=n-i%n,a=i+r-1;t.clamp(),t.words[a>>>2]|=r<<24-a%4*8,t.sigBytes+=r},unpad:function(t){var e=255&t.words[t.sigBytes-1>>>2];t.sigBytes-=e}},n.pad.Ansix923)},function(t,e,i){var n;t.exports=(n=i(5),i(9),n.pad.Iso10126={pad:function(t,e){var i=4*e,r=i-t.sigBytes%i;t.concat(n.lib.WordArray.random(r-1)).concat(n.lib.WordArray.create([r<<24],1))},unpad:function(t){var e=255&t.words[t.sigBytes-1>>>2];t.sigBytes-=e}},n.pad.Iso10126)},function(t,e,i){var n;t.exports=(n=i(5),i(9),n.pad.Iso97971={pad:function(t,e){t.concat(n.lib.WordArray.create([2147483648],1)),n.pad.ZeroPadding.pad(t,e)},unpad:function(t){n.pad.ZeroPadding.unpad(t),t.sigBytes--}},n.pad.Iso97971)},function(t,e,i){var n;t.exports=(n=i(5),i(9),n.pad.ZeroPadding={pad:function(t,e){var i=4*e;t.clamp(),t.sigBytes+=i-(t.sigBytes%i||i)},unpad:function(t){for(var e=t.words,i=t.sigBytes-1;!(e[i>>>2]>>>24-i%4*8&255);)i--;t.sigBytes=i+1}},n.pad.ZeroPadding)},function(t,e,i){var n;t.exports=(n=i(5),i(9),n.pad.NoPadding={pad:function(){},unpad:function(){}},n.pad.NoPadding)},function(t,e,i){var n,r,a,o;t.exports=(o=i(5),i(9),r=(n=o).lib.CipherParams,a=n.enc.Hex,n.format.Hex={stringify:function(t){return t.ciphertext.toString(a)},parse:function(t){var e=a.parse(t);return r.create({ciphertext:e})}},o.format.Hex)},function(t,e,i){var n;t.exports=(n=i(5),i(40),i(41),i(33),i(9),function(){var t=n,e=t.lib.BlockCipher,i=t.algo,r=[],a=[],o=[],s=[],l=[],c=[],h=[],u=[],d=[],p=[];!function(){for(var t=[],e=0;e<256;e++)t[e]=e<128?e<<1:e<<1^283;var i=0,n=0;for(e=0;e<256;e++){var f=n^n<<1^n<<2^n<<3^n<<4;f=f>>>8^255&f^99,r[i]=f,a[f]=i;var m=t[i],y=t[m],g=t[y],v=257*t[f]^16843008*f;o[i]=v<<24|v>>>8,s[i]=v<<16|v>>>16,l[i]=v<<8|v>>>24,c[i]=v,v=16843009*g^65537*y^257*m^16843008*i,h[f]=v<<24|v>>>8,u[f]=v<<16|v>>>16,d[f]=v<<8|v>>>24,p[f]=v,i?(i=m^t[t[t[g^m]]],n^=t[t[n]]):i=n=1}}();var f=[0,1,2,4,8,16,32,64,128,27,54],m=i.AES=e.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var t=this._keyPriorReset=this._key,e=t.words,i=t.sigBytes/4,n=4*((this._nRounds=i+6)+1),a=this._keySchedule=[],o=0;o<n;o++)if(o<i)a[o]=e[o];else{var s=a[o-1];o%i?i>6&&o%i==4&&(s=r[s>>>24]<<24|r[s>>>16&255]<<16|r[s>>>8&255]<<8|r[255&s]):(s=r[(s=s<<8|s>>>24)>>>24]<<24|r[s>>>16&255]<<16|r[s>>>8&255]<<8|r[255&s],s^=f[o/i|0]<<24),a[o]=a[o-i]^s}for(var l=this._invKeySchedule=[],c=0;c<n;c++)o=n-c,s=c%4?a[o]:a[o-4],l[c]=c<4||o<=4?s:h[r[s>>>24]]^u[r[s>>>16&255]]^d[r[s>>>8&255]]^p[r[255&s]]}},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,o,s,l,c,r)},decryptBlock:function(t,e){var i=t[e+1];t[e+1]=t[e+3],t[e+3]=i,this._doCryptBlock(t,e,this._invKeySchedule,h,u,d,p,a),i=t[e+1],t[e+1]=t[e+3],t[e+3]=i},_doCryptBlock:function(t,e,i,n,r,a,o,s){for(var l=this._nRounds,c=t[e]^i[0],h=t[e+1]^i[1],u=t[e+2]^i[2],d=t[e+3]^i[3],p=4,f=1;f<l;f++){var m=n[c>>>24]^r[h>>>16&255]^a[u>>>8&255]^o[255&d]^i[p++],y=n[h>>>24]^r[u>>>16&255]^a[d>>>8&255]^o[255&c]^i[p++],g=n[u>>>24]^r[d>>>16&255]^a[c>>>8&255]^o[255&h]^i[p++],v=n[d>>>24]^r[c>>>16&255]^a[h>>>8&255]^o[255&u]^i[p++];c=m,h=y,u=g,d=v}m=(s[c>>>24]<<24|s[h>>>16&255]<<16|s[u>>>8&255]<<8|s[255&d])^i[p++],y=(s[h>>>24]<<24|s[u>>>16&255]<<16|s[d>>>8&255]<<8|s[255&c])^i[p++],g=(s[u>>>24]<<24|s[d>>>16&255]<<16|s[c>>>8&255]<<8|s[255&h])^i[p++],v=(s[d>>>24]<<24|s[c>>>16&255]<<16|s[h>>>8&255]<<8|s[255&u])^i[p++],t[e]=m,t[e+1]=y,t[e+2]=g,t[e+3]=v},keySize:8});t.AES=e._createHelper(m)}(),n.AES)},function(t,e,i){var n;t.exports=(n=i(5),i(40),i(41),i(33),i(9),function(){var t=n,e=t.lib,i=e.WordArray,r=e.BlockCipher,a=t.algo,o=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],s=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],l=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],c=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],h=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],u=a.DES=r.extend({_doReset:function(){for(var t=this._key.words,e=[],i=0;i<56;i++){var n=o[i]-1;e[i]=t[n>>>5]>>>31-n%32&1}for(var r=this._subKeys=[],a=0;a<16;a++){var c=r[a]=[],h=l[a];for(i=0;i<24;i++)c[i/6|0]|=e[(s[i]-1+h)%28]<<31-i%6,c[4+(i/6|0)]|=e[28+(s[i+24]-1+h)%28]<<31-i%6;for(c[0]=c[0]<<1|c[0]>>>31,i=1;i<7;i++)c[i]=c[i]>>>4*(i-1)+3;c[7]=c[7]<<5|c[7]>>>27}var u=this._invSubKeys=[];for(i=0;i<16;i++)u[i]=r[15-i]},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._subKeys)},decryptBlock:function(t,e){this._doCryptBlock(t,e,this._invSubKeys)},_doCryptBlock:function(t,e,i){this._lBlock=t[e],this._rBlock=t[e+1],d.call(this,4,252645135),d.call(this,16,65535),p.call(this,2,858993459),p.call(this,8,16711935),d.call(this,1,1431655765);for(var n=0;n<16;n++){for(var r=i[n],a=this._lBlock,o=this._rBlock,s=0,l=0;l<8;l++)s|=c[l][((o^r[l])&h[l])>>>0];this._lBlock=o,this._rBlock=a^s}var u=this._lBlock;this._lBlock=this._rBlock,this._rBlock=u,d.call(this,1,1431655765),p.call(this,8,16711935),p.call(this,2,858993459),d.call(this,16,65535),d.call(this,4,252645135),t[e]=this._lBlock,t[e+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function d(t,e){var i=(this._lBlock>>>t^this._rBlock)&e;this._rBlock^=i,this._lBlock^=i<<t}function p(t,e){var i=(this._rBlock>>>t^this._lBlock)&e;this._lBlock^=i,this._rBlock^=i<<t}t.DES=r._createHelper(u);var f=a.TripleDES=r.extend({_doReset:function(){var t=this._key.words;this._des1=u.createEncryptor(i.create(t.slice(0,2))),this._des2=u.createEncryptor(i.create(t.slice(2,4))),this._des3=u.createEncryptor(i.create(t.slice(4,6)))},encryptBlock:function(t,e){this._des1.encryptBlock(t,e),this._des2.decryptBlock(t,e),this._des3.encryptBlock(t,e)},decryptBlock:function(t,e){this._des3.decryptBlock(t,e),this._des2.encryptBlock(t,e),this._des1.decryptBlock(t,e)},keySize:6,ivSize:2,blockSize:2});t.TripleDES=r._createHelper(f)}(),n.TripleDES)},function(t,e,i){var n;t.exports=(n=i(5),i(40),i(41),i(33),i(9),function(){var t=n,e=t.lib.StreamCipher,i=t.algo,r=i.RC4=e.extend({_doReset:function(){for(var t=this._key,e=t.words,i=t.sigBytes,n=this._S=[],r=0;r<256;r++)n[r]=r;r=0;for(var a=0;r<256;r++){var o=r%i,s=e[o>>>2]>>>24-o%4*8&255;a=(a+n[r]+s)%256;var l=n[r];n[r]=n[a],n[a]=l}this._i=this._j=0},_doProcessBlock:function(t,e){t[e]^=a.call(this)},keySize:8,ivSize:0});function a(){for(var t=this._S,e=this._i,i=this._j,n=0,r=0;r<4;r++){i=(i+t[e=(e+1)%256])%256;var a=t[e];t[e]=t[i],t[i]=a,n|=t[(t[e]+t[i])%256]<<24-8*r}return this._i=e,this._j=i,n}t.RC4=e._createHelper(r);var o=i.RC4Drop=r.extend({cfg:r.cfg.extend({drop:192}),_doReset:function(){r._doReset.call(this);for(var t=this.cfg.drop;t>0;t--)a.call(this)}});t.RC4Drop=e._createHelper(o)}(),n.RC4)},function(t,e,i){var n;t.exports=(n=i(5),i(40),i(41),i(33),i(9),function(){var t=n,e=t.lib.StreamCipher,i=t.algo,r=[],a=[],o=[],s=i.Rabbit=e.extend({_doReset:function(){for(var t=this._key.words,e=this.cfg.iv,i=0;i<4;i++)t[i]=16711935&(t[i]<<8|t[i]>>>24)|4278255360&(t[i]<<24|t[i]>>>8);var n=this._X=[t[0],t[3]<<16|t[2]>>>16,t[1],t[0]<<16|t[3]>>>16,t[2],t[1]<<16|t[0]>>>16,t[3],t[2]<<16|t[1]>>>16],r=this._C=[t[2]<<16|t[2]>>>16,4294901760&t[0]|65535&t[1],t[3]<<16|t[3]>>>16,4294901760&t[1]|65535&t[2],t[0]<<16|t[0]>>>16,4294901760&t[2]|65535&t[3],t[1]<<16|t[1]>>>16,4294901760&t[3]|65535&t[0]];for(this._b=0,i=0;i<4;i++)l.call(this);for(i=0;i<8;i++)r[i]^=n[i+4&7];if(e){var a=e.words,o=a[0],s=a[1],c=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),h=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),u=c>>>16|4294901760&h,d=h<<16|65535&c;for(r[0]^=c,r[1]^=u,r[2]^=h,r[3]^=d,r[4]^=c,r[5]^=u,r[6]^=h,r[7]^=d,i=0;i<4;i++)l.call(this)}},_doProcessBlock:function(t,e){var i=this._X;l.call(this),r[0]=i[0]^i[5]>>>16^i[3]<<16,r[1]=i[2]^i[7]>>>16^i[5]<<16,r[2]=i[4]^i[1]>>>16^i[7]<<16,r[3]=i[6]^i[3]>>>16^i[1]<<16;for(var n=0;n<4;n++)r[n]=16711935&(r[n]<<8|r[n]>>>24)|4278255360&(r[n]<<24|r[n]>>>8),t[e+n]^=r[n]},blockSize:4,ivSize:2});function l(){for(var t=this._X,e=this._C,i=0;i<8;i++)a[i]=e[i];for(e[0]=e[0]+1295307597+this._b|0,e[1]=e[1]+3545052371+(e[0]>>>0<a[0]>>>0?1:0)|0,e[2]=e[2]+886263092+(e[1]>>>0<a[1]>>>0?1:0)|0,e[3]=e[3]+1295307597+(e[2]>>>0<a[2]>>>0?1:0)|0,e[4]=e[4]+3545052371+(e[3]>>>0<a[3]>>>0?1:0)|0,e[5]=e[5]+886263092+(e[4]>>>0<a[4]>>>0?1:0)|0,e[6]=e[6]+1295307597+(e[5]>>>0<a[5]>>>0?1:0)|0,e[7]=e[7]+3545052371+(e[6]>>>0<a[6]>>>0?1:0)|0,this._b=e[7]>>>0<a[7]>>>0?1:0,i=0;i<8;i++){var n=t[i]+e[i],r=65535&n,s=n>>>16,l=((r*r>>>17)+r*s>>>15)+s*s,c=((4294901760&n)*n|0)+((65535&n)*n|0);o[i]=l^c}t[0]=o[0]+(o[7]<<16|o[7]>>>16)+(o[6]<<16|o[6]>>>16)|0,t[1]=o[1]+(o[0]<<8|o[0]>>>24)+o[7]|0,t[2]=o[2]+(o[1]<<16|o[1]>>>16)+(o[0]<<16|o[0]>>>16)|0,t[3]=o[3]+(o[2]<<8|o[2]>>>24)+o[1]|0,t[4]=o[4]+(o[3]<<16|o[3]>>>16)+(o[2]<<16|o[2]>>>16)|0,t[5]=o[5]+(o[4]<<8|o[4]>>>24)+o[3]|0,t[6]=o[6]+(o[5]<<16|o[5]>>>16)+(o[4]<<16|o[4]>>>16)|0,t[7]=o[7]+(o[6]<<8|o[6]>>>24)+o[5]|0}t.Rabbit=e._createHelper(s)}(),n.Rabbit)},function(t,e,i){var n;t.exports=(n=i(5),i(40),i(41),i(33),i(9),function(){var t=n,e=t.lib.StreamCipher,i=t.algo,r=[],a=[],o=[],s=i.RabbitLegacy=e.extend({_doReset:function(){var t=this._key.words,e=this.cfg.iv,i=this._X=[t[0],t[3]<<16|t[2]>>>16,t[1],t[0]<<16|t[3]>>>16,t[2],t[1]<<16|t[0]>>>16,t[3],t[2]<<16|t[1]>>>16],n=this._C=[t[2]<<16|t[2]>>>16,4294901760&t[0]|65535&t[1],t[3]<<16|t[3]>>>16,4294901760&t[1]|65535&t[2],t[0]<<16|t[0]>>>16,4294901760&t[2]|65535&t[3],t[1]<<16|t[1]>>>16,4294901760&t[3]|65535&t[0]];this._b=0;for(var r=0;r<4;r++)l.call(this);for(r=0;r<8;r++)n[r]^=i[r+4&7];if(e){var a=e.words,o=a[0],s=a[1],c=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),h=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),u=c>>>16|4294901760&h,d=h<<16|65535&c;for(n[0]^=c,n[1]^=u,n[2]^=h,n[3]^=d,n[4]^=c,n[5]^=u,n[6]^=h,n[7]^=d,r=0;r<4;r++)l.call(this)}},_doProcessBlock:function(t,e){var i=this._X;l.call(this),r[0]=i[0]^i[5]>>>16^i[3]<<16,r[1]=i[2]^i[7]>>>16^i[5]<<16,r[2]=i[4]^i[1]>>>16^i[7]<<16,r[3]=i[6]^i[3]>>>16^i[1]<<16;for(var n=0;n<4;n++)r[n]=16711935&(r[n]<<8|r[n]>>>24)|4278255360&(r[n]<<24|r[n]>>>8),t[e+n]^=r[n]},blockSize:4,ivSize:2});function l(){for(var t=this._X,e=this._C,i=0;i<8;i++)a[i]=e[i];for(e[0]=e[0]+1295307597+this._b|0,e[1]=e[1]+3545052371+(e[0]>>>0<a[0]>>>0?1:0)|0,e[2]=e[2]+886263092+(e[1]>>>0<a[1]>>>0?1:0)|0,e[3]=e[3]+1295307597+(e[2]>>>0<a[2]>>>0?1:0)|0,e[4]=e[4]+3545052371+(e[3]>>>0<a[3]>>>0?1:0)|0,e[5]=e[5]+886263092+(e[4]>>>0<a[4]>>>0?1:0)|0,e[6]=e[6]+1295307597+(e[5]>>>0<a[5]>>>0?1:0)|0,e[7]=e[7]+3545052371+(e[6]>>>0<a[6]>>>0?1:0)|0,this._b=e[7]>>>0<a[7]>>>0?1:0,i=0;i<8;i++){var n=t[i]+e[i],r=65535&n,s=n>>>16,l=((r*r>>>17)+r*s>>>15)+s*s,c=((4294901760&n)*n|0)+((65535&n)*n|0);o[i]=l^c}t[0]=o[0]+(o[7]<<16|o[7]>>>16)+(o[6]<<16|o[6]>>>16)|0,t[1]=o[1]+(o[0]<<8|o[0]>>>24)+o[7]|0,t[2]=o[2]+(o[1]<<16|o[1]>>>16)+(o[0]<<16|o[0]>>>16)|0,t[3]=o[3]+(o[2]<<8|o[2]>>>24)+o[1]|0,t[4]=o[4]+(o[3]<<16|o[3]>>>16)+(o[2]<<16|o[2]>>>16)|0,t[5]=o[5]+(o[4]<<8|o[4]>>>24)+o[3]|0,t[6]=o[6]+(o[5]<<16|o[5]>>>16)+(o[4]<<16|o[4]>>>16)|0,t[7]=o[7]+(o[6]<<8|o[6]>>>24)+o[5]|0}t.RabbitLegacy=e._createHelper(s)}(),n.RabbitLegacy)},function(t,e,i){"use strict";(function(t){var e=i(46),n=i(21);t.defineScene("Intro",()=>{t.background("#000000"),t.viewport.x=0,t.viewport.y=0;const i=t.viewport.width,r=t.viewport.height;t.e("2D, DOM, Text, Tween, Delay").attr({x:.35*i,y:.4*r,w:400}).text("Speedlazer").textColor("#0000ff").textFont({size:"40px",weight:"bold",family:"Press Start 2P"}).delay((function(){this.tween({x:.65*i-400},2e3),this.one("TweenEnd",(function(){this.tween({x:.35*i},2e3)}))}),4e3,-1),t.e("2D, DOM, Text, Tween, Delay").attr({x:.5*i-150,y:.6*r,w:300}).text("Press fire to start!").textColor("#FF0000").textFont({size:"15px",weight:"bold",family:"Press Start 2P"}).delay((function(){this.tween({alpha:.5},1e3),this.one("TweenEnd",(function(){this.tween({alpha:1},1e3)}))}),2e3,-1);const a=Object(e.a)()[0];t.e("2D, DOM, Text").attr({x:0,y:.85*r,w:i}).text(`HI SCORE: ${a.score} ${a.initials}`).textColor("#FFFF00").textAlign("center").textFont({size:"10px",weight:"bold",family:"Press Start 2P"});const o=t.e("2D, DOM, Text").attr({x:0,y:.95*r,w:i}).text("").textColor("#303030").textAlign("center").textFont({size:"10px",weight:"bold",family:"Press Start 2P"});window.addEventListener("gamepadconnected",()=>{o.text("Gamepad detected!")});const s=window.navigator.getGamepads();Array.from(s).some(t=>t&&t.connected)&&o.text("Gamepad detected!"),t(n.a).each((function(){this.reset(),this.one("Activated",()=>t.enterScene("Game",{}))})),t.e("Delay").delay(()=>t.enterScene("Scores"),2e4)},()=>{t("Delay").each((function(){this.destroy()})),t(n.a).each((function(){this.unbind("Activated")}))})}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var e=i(46);t.defineScene("Scores",(function(){t.background("#000000"),t.viewport.x=0,t.viewport.y=0;const i=t.viewport.width,n=t.viewport.height;t.e("2D, DOM, Text").attr({x:0,y:.1*n,w:i}).text("Highscores").textColor("#FFFF00").textAlign("center").textFont({size:"40px",weight:"bold",family:"Press Start 2P"});const r=Object(e.a)();let a=0;t.e("Delay").delay((function(){const e=r[a];if(e){const r=(t=>{switch(t){case 0:return"ACE";case 1:return"2nd";case 2:return"3rd";default:return t+1+"th"}})(a),o=(t=>{switch(t){case 0:return"20px";case 1:case 2:return"18px";default:return"15px"}})(a);t.e("2D, DOM, Text").attr({x:0,y:.25*n+36*a,w:i}).text(`${r}  ${e.score} ${e.initials}`).textColor("#FFFF00").textAlign("center").textFont({size:o,weight:"bold",family:"Press Start 2P"}),a+=1}}),500,9),t("Player").each((function(){this.reset(),this.one("Activated",()=>t.enterScene("Game"))})),t.e("Delay").delay(()=>t.enterScene("Credits"),2e4)}),(function(){return t("Delay").each((function(){this.destroy()})),t("Player").each((function(){this.unbind("Activated")}))}))}).call(this,i(0).default)},function(t,e,i){(function(t){const e=[["Designed by",["Matthijs Groen"]],["Programming",["Matthijs Groen"]],["Graphics",["Matthijs Groen"]],["Music",["Symsonic"]],["Testing",["Hiddo Groen"]]];t.defineScene("Credits",(function(){t.background("#000000"),t.viewport.x=0,t.viewport.y=0;const i=t.viewport.width,n=t.viewport.height;let r=0;t.e("2D, DOM, Text, CreditTask").attr({x:0,y:.4*n,w:i}).textColor("#FFFF00").textAlign("center").textFont({size:"30px",weight:"bold",family:"Press Start 2P"}),t.e("2D, DOM, Text, CreditNames").attr({x:0,y:.5*n,w:i}).textColor("#FFFF00").textAlign("center").textFont({size:"20px",weight:"bold",family:"Press Start 2P"});const a=e[r][0],o=e[r][1];t("CreditTask").text(a),t("CreditNames").text(o.join("\n")),t.e("Delay").delay(()=>{r+=1;const i=e[r][0],n=e[r][1];t("CreditTask").text(i),t("CreditNames").text(n.join("\n"))},1500,e.length-2),t("Player").each((function(){this.reset(),this.one("Activated",()=>t.enterScene("Game"))})),t.e("Delay").delay(()=>t.enterScene("Intro"),1500*e.length)}),(function(){return t("Delay").each((function(){this.destroy()})),t("Player").each((function(){this.unbind("Activated")}))}))}).call(this,i(0).default)},function(t,e,i){"use strict";(function(t){var e=i(17),n=i(19);let r=0;t.uniqueBind("UpdateFrame",i=>{i.dt=i.dt*Object(n.a)(),Object(e.a)()||(r+=i.dt),i.inGameTime=r,0!==i.dt&&t.trigger("GameLoop",i)})}).call(this,i(0).default)},function(t,e,i){"use strict";i(50),i(184),i(68),i(185),i(186),i(6),i(187),i(18),i(93),i(189),i(51),i(190),i(240),i(24),i(241),i(242),i(243),i(244),i(245),i(246),i(247)}]);
//# sourceMappingURL=game.798c0f5be1355d6412f8.js.map